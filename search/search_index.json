{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Notes \u4e00\u4e9b\u8bf4\u660e \u4e3b\u8981\u662f\u4e2a\u4eba\u7684\u4e00\u4e9b\u5b66\u4e60\u7b14\u8bb0\uff0c\u7531\u4e8e\u6c34\u5e73\u6709\u9650\u96be\u514d\u4f1a\u51fa\u73b0\u4e00\u4e9b\u9519\u8bef\u7684\u5730\u65b9\u3002 \u5982\u679c\u9519\u8bef\u4e4b\u5904\uff0c\u8bf7\u8c05\u89e3\u5e76\u6307\u6b63\u3002","title":"Home"},{"location":"#notes","text":"\u4e00\u4e9b\u8bf4\u660e \u4e3b\u8981\u662f\u4e2a\u4eba\u7684\u4e00\u4e9b\u5b66\u4e60\u7b14\u8bb0\uff0c\u7531\u4e8e\u6c34\u5e73\u6709\u9650\u96be\u514d\u4f1a\u51fa\u73b0\u4e00\u4e9b\u9519\u8bef\u7684\u5730\u65b9\u3002 \u5982\u679c\u9519\u8bef\u4e4b\u5904\uff0c\u8bf7\u8c05\u89e3\u5e76\u6307\u6b63\u3002","title":"Notes"},{"location":"AOP/Aspectj\u5207\u9762\u7ec7\u5165/","text":"\u4f7f\u7528AspectJ\u5c06\u81ea\u5b9a\u4e49\u5207\u9762\u6765\u7ec7\u5165\u5df2\u6709jar \u547d\u4ee4\u884c\u65b9\u5f0f java -jar $ASPECTJ_TOOLS -cp $MY_ASPECT:$ASPECTJ_RT -source 1.8 -inpath target/classes -d target/classes -aspectpath $MY_ASPECT \u6216\u8005 java -jar $ASPECTJ_TOOLS -cp $MY_ASPECT:$ASPECTJ_RT -source 1.8 -inpath $IN_JAR -outjar $OUT_JAR -aspectpath $MY_ASPECT #\u5176\u4e2d $ASPECTJ_TOOLS \u4e3aaspectjtools-1.8.9.jar\u6240\u5728\u4f4d\u7f6e #$ASPECTJ_RT\u4e3aaspectjrt-1.8.9.jar\u6240\u5728\u4f4d\u7f6e #$MY_ASPECT\u4e3a\u8981\u7ec7\u5165\u7684\u5207\u9762\u6240\u5728\u7684jar\u5305 AspectJ Compiler 1.8.9 Usage: <options> <source file | @argfile>.. AspectJ-specific options: -inpath <list> use classes in dirs and jars/zips in <list> as source (<list> uses platform-specific path delimiter) -injars <jarList> use classes in <jarList> zip files as source (<jarList> uses classpath delimiter) deprecated - use inpath instead. -aspectpath <list> weave aspects in .class files from <list> dirs and jars/zip into sources (<list> uses classpath delimiter) -outjar <file> put output classes in zip file <file> -outxml generate META-INF/aop.xml -outxmlfile <file> specify alternate destination output of -outxml -argfile <file> specify line-delimited list of source files -showWeaveInfo display information about weaving -incremental continuously-running compiler, needs -sourceroots (reads stdin: enter to recompile and 'q' to quit) -sourceroots <dirs> compile all .aj and .java files in <dirs> (<dirs> uses classpath delimiter) -crossrefs generate .ajsym file into the output directory -emacssym generate .ajesym symbol files for emacs support -Xlint same as '-Xlint:warning' -Xlint:<level> set default level for crosscutting messages (<level> may be ignore, warning, or error) -Xlintfile <file> specify properties file to set per-message levels (cf org/aspectj/weaver/XlintDefault.properties) -X print help on non-standard options Standard Eclipse compiler options: Options enabled by default are prefixed with '+' Classpath options: -cp -classpath <directories and zip/jar files separated by ;> specify location for application classes and sources -bootclasspath <directories and zip/jar files separated by ;> specify location for system classes -d <dir> destination directory (if omitted, no directory is created) -d none generate no .class files -encoding <enc> specify custom encoding for all sources. Each file/directory can override it when suffixed with '['<enc>']' (e.g. X.java[utf8]) Compliance options: -1.3 use 1.3 compliance level (implicit -source 1.3 -target 1.1) -1.4 + use 1.4 compliance level -1.5 -5 -5.0 use 1.5 compliance (-source 1.5 -target 1.5) -1.6 -6 -6.0 use 1.6 compliance (-source 1.6 -target 1.6) -1.7 -7 -7.0 use 1.7 compliance (-source 1.7 -target 1.7) -1.8 -8 -8.0 use 1.8 compliance (-source 1.8 -target 1.8) -source <version> set source level: 1.3 to 1.8 (or 5, 5.0, etc) -target <version> set classfile target: 1.1 to 1.8 (or 5, 5.0, etc) Warning options: -deprecation + deprecation outside deprecated code -nowarn -warn:none disable all warnings -warn:<warnings separated by ,> enable exactly the listed warnings -warn:+<warnings separated by ,> enable additional warnings -warn:-<warnings separated by ,> disable specific warnings allDeadCode dead code including trivial if(DEBUG) check allDeprecation deprecation including inside deprecated code allJavadoc invalid or missing javadoc allOver-ann all missing @Override annotations all-static-method all method can be declared as static warnings assertIdentifier + 'assert' used as identifier boxing autoboxing conversion charConcat + char[] in String concat compareIdentical + comparing identical expressions conditionAssign possible accidental boolean assignment constructorName + method with constructor name deadCode + dead code excluding trivial if (DEBUG) check dep-ann missing @Deprecated annotation deprecation + deprecation outside deprecated code discouraged + use of types matching a discouraged access rule emptyBlock undocumented empty block enumIdentifier 'enum' used as identifier enumSwitch incomplete enum switch fallthrough possible fall-through case fieldHiding field hiding another variable finalBound type parameter with final bound finally + finally block not completing normally forbidden + use of types matching a forbidden access rule hashCode missing hashCode() method when overriding equals() hiding macro for fieldHiding, localHiding, typeHiding and maskedCatchBlock includeAssertNull raise null warnings for variables that got tainted in an assert expression indirectStatic indirect reference to static member intfAnnotation + annotation type used as super interface intfNonInherited + interface non-inherited method compatibility intfRedundant find redundant superinterfaces javadoc invalid javadoc localHiding local variable hiding another variable maskedCatchBlock + hidden catch block nls string literal lacking non-nls tag //$NON-NLS-<n>$ noEffectAssign + assignment without effect null potential missing or redundant null check nullDereference + missing null check over-ann missing @Override annotation (superclass) paramAssign assignment to a parameter pkgDefaultMethod + attempt to override package-default method raw + usage of raw type semicolon unnecessary semicolon, empty statement serial + missing serialVersionUID specialParamHiding constructor or setter parameter hiding a field static-method method can be declared as static static-access macro for indirectStatic and staticReceiver staticReceiver + non-static reference to static member super overriding a method without making a super invocation suppress + enable @SuppressWarnings When used with -err:, it can also silent optional errors and warnings syncOverride missing synchronized in synchr. method override syntheticAccess synthetic access for innerclass tasks(<tags separated by |>) tasks identified by tags inside comments typeHiding + type parameter hiding another type unavoidableGenericProblems + ignore unavoidable type safety problems due to raw APIs unchecked + unchecked type operation unnecessaryElse unnecessary else clause unqualifiedField unqualified reference to field unused macro for unusedAllocation, unusedArgument, unusedImport, unusedLabel, unusedLocal, unusedPrivate, unusedThrown, and unusedTypeArgs unusedAllocation allocating an object that is not used unusedArgument unread method parameter unusedImport + unused import declaration unusedLabel + unused label unusedLocal + unread local variable unusedPrivate + unused private member declaration unusedThrown unused declared thrown exception unusedTypeArgs + unused type arguments for method and constructor uselessTypeCheck unnecessary cast/instanceof operation varargsCast + varargs argument need explicit cast warningToken + unsupported or unnecessary @SuppressWarnings maven\u63d2\u4ef6\u65b9\u5f0f <plugin> <groupId>org.codehaus.mojo</groupId> <artifactId>aspectj-maven-plugin</artifactId> <version>1.10</version> <configuration> <source>1.8</source> <target>1.8</target> <complianceLevel>1.8</complianceLevel> <!-- \u5728aspectLibraries\u5b50\u6807\u7b7e\u6307\u5b9a\u81ea\u5b9a\u4e49\u5207\u9762jar\u5305 --> <aspectLibraries> <aspectLibrary> <groupId>com.ginkoc.learning</groupId> <artifactId>aspectj</artifactId> </aspectLibrary> </aspectLibraries> </configuration> <executions> <execution> <goals> <goal>compile</goal> </goals> </execution> </executions> </plugin>","title":"Aspectj\u5207\u9762\u7ec7\u5165"},{"location":"Algorithm/\u80cc\u5305\u95ee\u9898/","text":"\u6211\u5bf9\u80cc\u5305\u95ee\u9898\u7406\u89e3 \u80cc\u5305\u95ee\u9898 \u80cc\u5305\u95ee\u9898\u662f\u7ecf\u5178\u7684\u8003\u5bdf\u52a8\u6001\u89c4\u5212\u5e94\u7528\u7684\u9898\u76ee\uff0c\u5bf9\u5176\u52a0\u4e0a\u4e0d\u540c\u7684\u9650\u5236\u548c\u6761\u4ef6\uff0c\u53ef\u4ee5\u884d\u751f\u51fa\u8bf8\u591a\u53d8\u79cd\uff0c\u82e5\u8981\u5168\u9762\u7406\u89e3\u52a8\u6001\u89c4\u5212\uff0c\u638c\u63e1\u80cc\u5305\u95ee\u9898\u662f\u5fc5\u4e0d\u53ef\u5c11\u7684\u3002\u7531\u4e8e\u672c\u4eba\u6c34\u5e73\u6709\u9650\uff0c\u672c\u6587\u53ea\u662f\u4e2a\u4eba\u5bf9\u80cc\u5305\u95ee\u9898\u7684\u7406\u89e3\uff0c\u5982\u6709\u4e0d\u6b63\u786e\u4e4b\u5904\u8fd8\u8bf7\u8c05\u89e3\u548c\u6307\u6b63\u3002 \u9898\u76ee\u63cf\u8ff0 \u6709N\u4ef6\u7269\u54c1\u548c\u4e00\u4e2a\u5bb9\u91cf\u4e3aV\u7684\u80cc\u5305\u3002\u7b2ci\u4ef6\u7269\u54c1\u7684\u8d39\u7528\u662fc[i]\uff0c\u4ef7\u503c\u662fw[i]\u3002\u6c42\u89e3\u5c06\u54ea\u4e9b\u7269\u54c1\u88c5\u5165\u80cc\u5305\u53ef\u4f7f\u8fd9\u4e9b\u7269\u54c1\u7684\u8d39\u7528\u603b\u548c\u4e0d\u8d85\u8fc7\u80cc\u5305\u5bb9\u91cf\uff0c\u4e14\u4ef7\u503c\u603b\u548c\u6700\u5927\u3002 \u6240\u6709\u80cc\u5305\u95ee\u9898\u7684\u4e3b\u5e72\u4e0e\u9898\u76ee\u63cf\u8ff0\u4e2d\u7684\u4e00\u81f4\uff0c\u4f46\u662f\u52a0\u4e0a\u4e0d\u540c\u7684\u6761\u4ef6\u9650\u5236\u540e\uff0c\u4f1a\u5f62\u6210\u5404\u79cd\u80cc\u5305\u95ee\u9898\u7684\u53d8\u79cd\u3002\u4e0b\u6587\u662f\u4f5c\u8005\u5bf90-1\u80cc\u5305\u548c\u5b8c\u5168\u80cc\u5305\u95ee\u9898\u7684\u7406\u89e3\u7b14\u8bb0\u3002\u4e3a\u5565\u53ea\u6709\u8fd9\u4e24\u79cd\uff0c\u6c34\u5e73\u5b9e\u5728\u6709\u9650\u3002 0-1\u80cc\u5305\u95ee\u9898 0-1\u80cc\u5305\u95ee\u9898\u662f\u6700\u57fa\u7840\u7684\u80cc\u5305\u95ee\u9898\uff0c\u987e\u540d\u601d\u4e490-1\u80cc\u5305\u5373\u6bcf\u79cd\u7684\u7269\u54c1\u4ec5\u6709\u4e00\u4ef6\uff0c\u90a3\u4e48\u5bf9\u4e8e\u6307\u5b9a\u7684\u7269\u54c1\u7684\u9009\u62e9\u53ea\u6709\u53d6\u6216\u8005\u4e0d\u53d6\u4e24\u79cd\u72b6\u6001\u3002\u73b0\u5728\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u72b6\u6001 F[i][v] \u7528\u6765\u8868\u793a\u53ef\u9009\u62e9\u7684\u7269\u54c1\u8303\u56f4\u4e3a\u524di\u4ef6\u7269\u54c1\u5e76\u4e14\u6240\u6709\u7269\u54c1\u7684\u4f53\u79ef\u603b\u548c\u4e0d\u8d85\u8fc7v\u65f6\uff0c\u80cc\u5305\u5185\u6240\u6709\u7269\u54c1\u7684\u4ef7\u503c\u603b\u548c\u6700\u5927\u3002\u90a3\u4e48\uff0c F[i][v] \u5219\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u4e24\u79cd\u72b6\u6001\u8f6c\u79fb\u5f97\u5230\uff1a \u5982\u679c\u4e0d\u9009\u7b2ci\u4ef6\u7269\u54c1\uff0c\u90a3\u4e48\u6700\u5927\u4ef7\u503c\u603b\u548c\u4e3a\u53d6\u524di-1\u4ef6\u7269\u54c1\u4e14\u80cc\u5305\u5bb9\u91cf\u4e0d\u8d85\u8fc7v\u65f6\u7684\u6700\u5927\u4ef7\u503c\uff0c\u5373 F[i][v] = F[i-1][v] \u5982\u679c\u9009\u62e9\u7b2ci\u4ef6\u7269\u54c1\uff0c\u90a3\u4e48\u6700\u5927\u4ef7\u503c\u603b\u548c\u4e3a\u53d6\u524di-1\u4ef6\u7269\u54c1\u4e14\u80cc\u5305\u5bb9\u91cf\u4e0d\u8d85\u8fc7v-c[i]\u65f6\u7684\u6700\u5927\u4ef7\u503c\u52a0\u4e0a\u7b2ci\u4ef6\u7269\u54c1\u7684\u4ef7\u503c\uff0c\u5373 F[i][v] = F[i-1][v-c[i]] + w[i] \u4f46\u662f\u4ece\u54ea\u79cd\u72b6\u6001\u8f6c\u79fb\u8fc7\u6765\u7684\u6700\u5927\u4ef7\u503c\u603b\u66f4\u5927\u5462\uff0c\u6240\u4ee5\u8981\u5bf9\u8f6c\u79fb\u7684\u72b6\u6001\u8fdb\u884c\u6bd4\u8f83\uff0c\u53d6\u66f4\u5927\u7684\u4ef7\u503c\uff0c\u56e0\u6b64\u5f97\u5230\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5982\u4e0b\uff1a F[i][v] = max{F[i-1][v], F[i-1][v-c[i]] + w[i]}; \u8fd9\u4e2a\u65b9\u7a0b\u975e\u5e38\u91cd\u8981\uff0c\u57fa\u672c\u4e0a\u6240\u6709\u8ddf\u80cc\u5305\u76f8\u5173\u7684\u95ee\u9898\u7684\u65b9\u7a0b\u90fd\u662f\u7531\u5b83\u884d\u751f\u51fa\u6765\u7684\u3002 \u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u6765\u5bf9\u6240\u6709\u7684\u72b6\u6001\u8fdb\u884c\u679a\u4e3e\uff0c\u5373\u901a\u8fc7\u904d\u5386\u6240\u6709\u7684\u7269\u54c1\u548c\u4f53\u79ef\u6765\u627e\u51fa\u6700\u5927\u4ef7\u503c\u603b\u548c\uff0c\u904d\u5386\u987a\u5e8f\u4e3a\u7b2c\u4e00\u5c42\u5faa\u73af\u904d\u5386\u6240\u6709\u7684\u7269\u54c1\uff0c\u7b2c\u4e8c\u5c42\u5faa\u73af\u904d\u5386\u80cc\u5305\u5bb9\u91cf\uff0c\u5373\u8003\u8651\u7684\u662f\u53d6\u6216\u4e0d\u53d6\u7b2ci\u4ef6\u7269\u54c1\u5bf9\u80cc\u5305\u53ef\u7528\u4f53\u79ef\u7684\u5f71\u54cd\uff0c\u5982\u4e0b\uff1a public int findMaxValue(int[] c, int[] w, int idx, int vol) { int[][] dp = new int[idx + 1][vol + 1]; // i\u662f\u4ece1\u5f00\u59cb\uff0c\u6240\u4ee5\u5728cw\u6570\u7ec4\u53d6\u503c\u65f6\u90fd\u8981\u51cf\u4e00 for (int i = 1; i <= idx; i++) { for (int v = 0; v <= vol; v++) { dp[i][v] = dp[i - 1][v]; if (v >= c[i-1]) { dp[i][v] = Math.max(dp[i][v], dp[i-1][v - c[i-1]] + w[i-1]); } } } return dp[idx][vol]; } \u63a5\u4e0b\u6765\u5bf9\u4e0a\u8ff0\u65b9\u6cd5\u7684\u4e24\u4e2a\u65b9\u9762\u8fdb\u884c\u8bf4\u660e\uff1a \u4e3a\u4ec0\u4e48dp\u6570\u7ec4\u7684\u957f\u5ea6\u4e3a idx+1 \u548c vol+1 \uff1f \u56e0\u4e3a\u52a8\u6001\u89c4\u5212\u95ee\u9898\u4e2d\u7684\u8fb9\u754c\u6761\u4ef6\u5bf9\u7ed3\u679c\u7684\u5f71\u54cd\u5f88\u5927\uff0c\u56e0\u6b64\u9700\u8981\u7559\u51fa\u7a7a\u95f4\u5bf9\u8fb9\u754c\u503c\u8fdb\u884c\u8d4b\u503c\uff0c\u800c\u5728\u80cc\u5305\u95ee\u9898\u4e2d\uff0c\u4e0d\u540c\u7684\u8fb9\u754c\u503c\u53ef\u4ee5\u4ea7\u751f\u4e0d\u540c\u7684\u7ed3\u679c\uff0c\u4e0b\u6587\u4f1a\u8fdb\u884c\u4ecb\u7ecd\u3002 \u4e3a\u4ec0\u4e48\u6700\u5927\u503c\u662f dp[idx][vol] \u800c\u4e0d\u662f dp[idx][0...vol] \u4e2d\u7684\u6700\u5927\u503c\u5462\uff1f \u5b9e\u9645\u4e0a\u8fd9\u4e0e\u6211\u4eec\u5bf9\u8fb9\u754c\u503c\u7684\u521d\u59cb\u5316\u6709\u5173\uff0c\u5f53\u628a F[0][0...vol] \u90fd\u521d\u59cb\u5316\u4e3a0\u65f6\uff0c\u6240\u6709 F[i][v] \u4e2d\u7684\u503c\u8868\u793a\u7684\u662f\u80cc\u5305\u5bb9\u91cf \u4e0d\u8d85\u8fc7 v\u65f6\u7684\u6700\u5927\u4ef7\u503c\uff0c\u5373 dp[idx][vol] \u53ef\u4ee5\u7531idx-1\u4e0b\u4f53\u79ef\u4e0d\u8d85\u8fc7vol-w\u6216vol\u65f6\u7684\u6700\u5927\u4ef7\u503c\u8f6c\u79fb\u800c\u6765\uff1b\u5f53\u628a F[0][0] \u90fd\u521d\u59cb\u5316\u4e3a0\uff0c\u800c F[0][1...vol] \u90fd\u521d\u59cb\u5316\u4e3a\u8d1f\u65e0\u7a77\u65f6\uff0c\u6240\u6709 F[i][v] \u4e2d\u7684\u503c\u8868\u793a\u7684\u662f\u80cc\u5305\u5bb9\u91cf \u6070\u597d\u4e3a v\u65f6\u7684\u6700\u5927\u4ef7\u503c\uff0c\u5373 dp[idx][vol] \u53ea\u80fd\u7531idx-1\u4e0b\u4f53\u79ef\u6070\u597d\u4e3avol-w\u6216vol\u65f6\u7684\u6700\u5927\u4ef7\u503c\u8f6c\u79fb\u800c\u6765\u3002 \u6211\u4eec\u4e5f\u53ef\u4ee5\u8fd9\u6837\u7406\u89e3\uff0c\u5982\u679c\u8981\u6c42\u80cc\u5305\u6070\u597d\u88c5\u6ee1\uff0c\u90a3\u4e48\u6ca1\u6709\u7269\u54c1\u53ef\u4ee5\u9009\u62e9\u7684\u60c5\u51b5\u4e0b\uff08i=0\u65f6\uff09\uff0c\u53ea\u6709\u4f53\u79ef\u4e3a0\u662f\u6ee1\u8db3\u6070\u597d\u88c5\u6ee1\u7684\u5e76\u4e14\u6b64\u65f6\u7684\u6700\u5927\u4ef7\u503c\u4e3a0\uff08 F[0][0]=0 \uff09\uff0c\u800c\u5176\u4ed6\u4f53\u79ef\u662f\u4e0d\u53ef\u80fd\u8fbe\u5230\u7684\u7528\u8d1f\u65e0\u7a77\u8868\u793a\uff08 F[0][0...val]=-INF \uff09\uff1b\u5982\u679c\u6ca1\u6709\u8981\u6c42\u80cc\u5305\u5fc5\u987b\u88c5\u6ee1\uff0c\u90a3\u4e48\u6ca1\u6709\u7269\u54c1\u53ef\u4ee5\u9009\u62e9\u7684\u60c5\u51b5\u4e0b\uff0c\u80cc\u5305\u6ca1\u6709\u586b\u6ee1\u4e5f\u662f\u5408\u6cd5\u7684\u4e14\u6b64\u65f6\u7684\u6700\u5927\u4ef7\u503c\u4e3a0\uff08 F[0][0...val]=0 \uff09\u3002 \u4ece\u6570\u5b57\u5c42\u9762\u6765\u8bf4\uff0c\u5f53i\u4e3a1\u65f6\uff0c\u5982\u679c dp[0][0...vol] \u4e3a0\uff0c\u90a3\u4e48 dp[1][0...vol] \u5728\u80cc\u5305\u4f53\u79efv\u5927\u4e8e\u7269\u54c1\u4f53\u79ef\u7684\u60c5\u51b5\u4e0b\u4e00\u5b9a\u4e3a w[i-1] \uff08dp\u5728\u672a\u521d\u59cb\u5316\u65f6\u9ed8\u8ba4\u6240\u6709\u503c\u90fd\u4e3a0\uff0c\u53d6\u6700\u5927\u503c\u540e\u4e00\u5b9a\u4e3a w[i-1] \uff09\uff1b\u5982\u679c dp[0][1...vol] \u4e3a\u8d1f\u65e0\u7a77\uff0c\u90a3\u4e48\u5728\u80cc\u5305\u4f53\u79ef\u4e0d\u6070\u597d\u7b49\u4e8e\u7269\u54c1\u4f53\u79ef\uff0c\u5373 vol-c[i-1] \u4e0d\u4e3a0\u65f6 dp[1][vol] \u4e3a\u8d1f\u65e0\u7a77\uff0c\u6240\u4ee5\u5728\u540e\u7eed\u7684\u72b6\u6001\u8f6c\u79fb\u8fc7\u7a0b\u4e2d\u5982\u679c\u662f\u4ece\u8d1f\u65e0\u7a77\u8f6c\u79fb\u8fc7\u6765\u7684\uff0c\u90a3\u4e48\u8f6c\u79fb\u5f97\u5230\u7684\u72b6\u6001\u4e5f\u4e3a\u8d1f\u65e0\u7a77\u3002 \u6240\u4ee5\uff0c\u5728\u4e0a\u8ff0\u65b9\u6cd5\u4e2d\u6211\u4eec\u5c06 dp[0][0...vol] \u9690\u5f0f\u5730\u521d\u59cb\u5316\u4e3a\u4e860\uff0c\u6240\u4ee5\u6700\u7ec8\u7ed3\u679c dp[idx][vol] \u5c31\u662f\u6700\u5927\u4ef7\u503c\uff1b\u5982\u679c\u6211\u4eec\u5c06 dp[0][1...vol] \u4e3a\u8d1f\u65e0\u7a77\uff0c\u90a3\u4e48\u6700\u5927\u503c\u5219\u5728 dp[idx][0...vol] \u4e4b\u95f4\uff0c\u56e0\u4e3a\u4f53\u79ef\u6070\u597d\u88c5\u6ee1\u65f6\uff0c\u4ef7\u503c\u4e0d\u4e00\u5b9a\u662f\u6700\u5927\u7684\u3002 \u7a7a\u95f4\u590d\u6742\u5ea6\u4f18\u5316 \u4ece\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0c F[i][v] \u662f\u7531 F[i-1][v] \u548c F[i-1] [v-c[i]] \u4e24\u4e2a\u5b50\u95ee\u9898\u9012\u63a8\u800c\u6765\uff0c\u5373 F[i][...] \u7684\u503c\u53ea\u4e0e F[i-1][...] \u6709\u5173\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c\u7a7a\u95f4\u538b\u7f29\uff0c\u53ea\u7528\u4e00\u7ef4\u6570\u7ec4\u6765\u4fdd\u5b58\u7b2ci-1\u6b21\u5faa\u73af\u7684\u503c\u3002\u90a3\u5982\u4f55\u4fdd\u8bc1\u5728\u63a8\u5728\u7b2ci\u6b21\u4e3b\u5faa\u73af\u4e2d\u63a8 F[v] \u65f6\u5f97\u5230\u7684\u662f F[i-1][v] \u548c F[i-1][v -c[i]] \u7684\u503c\uff0c\u5b9e\u9645\u4e0a\u53ea\u6bcf\u6b21\u4e3b\u5faa\u73af\u4e2d\u6211\u4eec\u4ee5 v=V..0 \u7684\u987a\u5e8f\u63a8 F[v] \uff0c\u8fd9\u6837\u624d\u80fd\u4fdd\u8bc1\u63a8 F[v] \u65f6 F[v-c[i]] \u4fdd\u5b58\u7684\u662f\u72b6\u6001 F[i-1][v-c[i]] \u7684\u503c\u3002\u4ee3\u7801\u5982\u4e0b\uff1a public int findMaxValue(int[] c, int[] w, int idx, int vol) { int[] dp = new int[vol + 1]; // i\u662f\u4ece1\u5f00\u59cb\uff0c\u6240\u4ee5\u5728cw\u6570\u7ec4\u53d6\u503c\u65f6\u90fd\u8981\u51cf\u4e00 for (int i = 1; i <= idx; i++) { for (int v = vol; v >= c[i-1]; v--) { dp[v] = Math.max(dp[v], dp[v - c[i-1]] + w[i-1]); } } return dp[vol]; } \u4e3a\u4ec0\u4e48\u4ee5 v=V..0 \u7684\u987a\u5e8f\u63a8 F[v] \u624d\u80fd\u4fdd\u8bc1\u8f6c\u79fb\u7684\u72b6\u6001\u7684\u662f\u6b63\u786e\u7684\u5462\uff1f\u9700\u8981\u6ce8\u610f\u5230\u7684\u662f F[v] \u7684\u72b6\u6001\u8f6c\u79fb\u662f\u4f9d\u8d56\u4e8e F[v-c[i]] \u7684\uff0c\u4ece v...0 \u7684\u987a\u5e8f\u904d\u5386\u53ef\u4ee5\u4fdd\u8bc1\u6bcf\u6b21\u4ece F[v-c[i]] \u8f6c\u79fb\u7684\u503c\u90fd\u662f\u4ecei-1\u8f6e\u5faa\u73af\u8ba1\u7b97\u5f97\u5230\u7684\uff08\u5f53\u67d0\u4e2av\u4ecei-1\u8f6e\u5faa\u73af\u7684v-c[i]\u8f6c\u79fb\u5f97\u5230 F[v] \u540e\uff0c F[v] \u5219\u8868\u793a\u53d6\u4e86\u4e00\u4ef6\u7269\u54c1i\u7684\u6700\u5927\u4ef7\u503c\uff0c\u7531\u4e8ev\u9012\u51cf\u800cc[i]\u4e3a\u56fa\u5b9a\u503c\uff0cv-c[i]\u7684\u503c\u4e0d\u53ef\u80fd\u6bd4\u4e0a\u4e2a\u7ecf\u8fc7\u72b6\u6001\u8f6c\u79fb\u7684v\u66f4\u5927\uff0c\u6240\u4ee5v-c[i]\u53ea\u4f1a\u53d6\u5230\u4e0a\u4e00\u8f6e[i-1\u8f6e]\u7684\u503c\uff0c\u4e0d\u53ef\u80fd\u53d6\u5230\u672c\u8f6e[i\u8f6e]\u8f6c\u79fb\u540e\u7684\u503c\uff09\uff0c\u4ece\u903b\u8f91\u610f\u4e49\u4e0a\u6765\u8bf4\u8fd9\u6837\u7684\u5faa\u73af\u987a\u5e8f\u80fd\u591f\u4fdd\u8bc1\uff0c\u5230\u9009\u62e9\u7b2ci\u4ef6\u7269\u54c1\u65f6\uff0c\u80fd\u591f\u8fdb\u884c\u8f6c\u79fb\u7684\u503c\u90fd\u662f\u4e0d\u5305\u542b\u7b2ci\u4ef6\u7269\u54c1\u7684\uff1b\u5982\u679c\u904d\u5386\u987a\u5e8f\u4e3a 0...v \u5219\u4e0d\u80fd\u4fdd\u8bc1\u4ecev-c[i]\u5f97\u5230\u7684\u503c\u90fd\u662f\u4ece F[i-1] \u8ba1\u7b97\u5f97\u5230\u7684\uff0c\u56e0\u4e3a\u5728v\u9010\u6e10\u9012\u589e\u7684\u8fc7\u7a0b\u4e2dv-c[i]\u53ef\u80fd\u4f1a\u7b49\u4e8e\u4e4b\u524d\u5df2\u7ecf\u8f6c\u79fb\u8fc7\u7684\u67d0\u4e2av\u503c\uff0c\u5bfc\u81f4\u53ef\u8f6c\u79fb\u7684\u503c\u53ef\u80fd\u5df2\u7ecf\u5305\u542b\u4e86\u7b2ci\u4ef6\u7269\u54c1\uff0c\u8fd9\u4e0e\u672c\u9898\u610f\u4e0d\u7b26\uff0c\u4f46\u5b83\u5374\u662f\u5b8c\u5168\u80cc\u5305\u95ee\u9898\u6700\u7b80\u6377\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u6545\u5b66\u4e60\u53ea\u7528\u4e00\u7ef4\u6570\u7ec4\u89e30-1\u80cc\u5305\u95ee\u9898\u662f\u5341\u5206\u5fc5\u8981\u7684\u3002 \u603b\u7ed3 0-1\u80cc\u5305\u95ee\u9898\u662f\u6700\u57fa\u672c\u7684\u80cc\u5305\u95ee\u9898\uff0c\u5b83\u5305\u542b\u4e86\u80cc\u5305\u95ee\u9898\u4e2d\u8bbe\u8ba1\u72b6\u6001\u3001\u65b9\u7a0b\u7684\u6700\u57fa\u672c\u601d\u60f3\uff0c\u53e6\u5916\uff0c\u522b\u7684\u7c7b\u578b\u7684\u80cc\u5305\u95ee\u9898\u5f80\u5f80\u4e5f\u53ef\u4ee5\u8f6c\u6362\u62100-1\u80cc\u5305\u95ee\u9898\u6c42\u89e3\u3002\u4e00\u5b9a\u8981\u660e\u767d\u57fa\u672c\u601d\u8def\u7684\u5f97\u51fa\u65b9\u6cd5\uff0c\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u7684\u610f\u4e49\uff0c\u4ee5\u53ca\u6700\u540e\u600e\u6837\u4f18\u5316\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u3002 \u5b8c\u5168\u80cc\u5305\u95ee\u9898 \u5b8c\u5168\u80cc\u5305\u95ee\u9898\u4e0e0-1\u80cc\u5305\u95ee\u9898\u4e0d\u540c\u7684\u5730\u65b9\u5728\u4e8e\uff0c0-1\u80cc\u5305\u6bcf\u79cd\u7269\u54c1\u53ea\u80fd\u9009\u4e00\u6b21\uff0c\u4f60\u7684\u9009\u62e9\u53ea\u6709\u9009\u6216\u8005\u4e0d\u9009\u4e24\u8005\uff1b\u800c\u5b8c\u5168\u80cc\u5305\u6bcf\u79cd\u7269\u54c1\u53ef\u4ee5\u9009\u65e0\u9650\u6b21\uff0c\u4f46\u662f\u9009\u62e9\u7684\u6570\u91cf\u4e0a\u9650\u6700\u591a\u4e3a v/c[i] \u3002\u7531\u6b64\u6211\u4eec\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u60f3\u5230\uff0c\u57280-1\u80cc\u5305\u7684\u57fa\u7840\u4e0a\u518d\u52a0\u4e00\u5c42\u5faa\u73af\u6765\u8868\u793a\uff0c\u9009\u62e9\u7b2ci\u4ef6\u7269\u54c1\u7684\u4e2a\u6570\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a public int findMaxValue(int[] c, int[] w, int idx, int vol) { int[][] dp = new int[idx + 1][vol + 1]; // i\u662f\u4ece1\u5f00\u59cb\uff0c\u6240\u4ee5\u5728cw\u6570\u7ec4\u53d6\u503c\u65f6\u90fd\u8981\u51cf\u4e00 for (int i = 1; i <= idx; i++) { for (int v = 0; v <= vol; v++) { for (int k = 0; k * c[i-1] <= v; k++) { dp[i][v] = Math.max(dp[i][v], dp[i - 1][j - k * c[i-1]] + k * w[i-1]); } } } return dp[idx][vol]; } \u8be5\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u8868\u793a\uff0c\u5728\u53ef\u9009\u7684\u7269\u54c1\u4e3a\u524di\u4ef6\u4e14\u4f53\u79ef\u5c0f\u4e8ev\u65f6\u7684\u6700\u5927\u4ef7\u503c\uff0c\u4ece\u6570\u5b66\u610f\u4e49\u4e0a\u6765\u8bb2\u5c31\u662f\u5728\u7b2c\u4e09\u5c42\u5faa\u73af\u65f6\u786e\u5b9a F[i][v] \u7684\u6700\u5927\u4ef7\u503c\uff1a\u5f53k=0\u65f6\uff0c dp[i][v] \u7b49\u4e8e d[i-1][v] \uff0c\u7136\u540e\u968f\u7740k\u4e0d\u65ad\u589e\u5927\uff0c dp[i - 1][j - k * c[i]] + k * w[i] \u8868\u793a\u5728\u672a\u9009\u62e9\u7b2ci\u4ef6\u7269\u54c1\u7684\u57fa\u7840\u4e0a\u5206\u522b\u9009\u62e90...v/c[i]\u4ef6\u7b2ci\u4ef6\u7269\u54c1\u7684\u6700\u5927\u4ef7\u503c\uff0c\u5e76\u4e14\u6bcf\u6b21\u90fd\u4e0e dp[i][v] \u8fdb\u884c\u6bd4\u8f83\uff0c\u4ece\u800c\u786e\u5b9a dp[i][v] \u7684\u6700\u5927\u4ef7\u503c\u3002 \u8fd9\u79cd\u65b9\u5f0f\u56e0\u4e3a\u6709\u4e09\u5c42\u5faa\u73af\u6240\u4ee5\u65f6\u95f4\u590d\u6742\u5ea6\u4f1a\u6bd4\u8f83\u9ad8\uff0c\u6240\u4ee5\u6211\u4eec\u6362\u4e00\u79cd\u601d\u8003\u65b9\u5f0f\u30020-1\u80cc\u5305\u95ee\u9898\u7531\u4e8e\u6bcf\u4ef6\u7269\u54c1\u53ea\u80fd\u9009\u62e9\u4e00\u6b21\uff0c\u6240\u4ee5\u5728\u9009\u62e9\u7b2ci\u4ef6\u7269\u54c1\u65f6\u53ea\u80fd\u4ece\u7b2ci-1\u4ef6\u7269\u54c1\u7684\u72b6\u6001\u4e0b\u8f6c\u79fb\u83b7\u5f97\uff0c\u4f46\u5b8c\u5168\u80cc\u5305\u95ee\u9898\u6bcf\u4ef6\u7269\u54c1\u80fd\u9009\u65e0\u9650\u6b21\uff0c\u6240\u4ee5\u5728\u4f53\u79ef\u4e3av\u7684\u72b6\u6001\u8981\u8003\u8651\u4ece\u53ef\u80fd\u9009\u62e9\u4e86\u7b2ci\u4ef6\u7269\u54c1\u7684\u72b6\u6001\u548c\u672a\u9009\u7b2ci\u4ef6\u7269\u54c1\u7684\u72b6\u6001\u8fdb\u884c\u8f6c\u79fb\u3002\u4ee3\u7801\u5982\u4e0b\uff1a public int findMaxValue(int[] c, int[] w, int idx, int vol) { int[][] dp = new int[idx + 1][vol + 1]; // i\u662f\u4ece1\u5f00\u59cb\uff0c\u6240\u4ee5\u5728cw\u6570\u7ec4\u53d6\u503c\u65f6\u90fd\u8981\u51cf\u4e00 for (int i = 1; i <= idx; i++) { for (int v = 0; v <= vol; v++) { dp[i][v] = dp[i-1][v]; if(v >= c[i-1]) { dp[i][v] = Math.max(dp[i][v], dp[i][v - c[i-1]] + w[i-1]); } } } return dp[idx][vol]; } \u7a7a\u95f4\u590d\u6742\u5ea6\u4f18\u5316 \u5728\u4ecb\u7ecd0-1\u80cc\u5305\u95ee\u9898\u65f6\uff0c\u9610\u8ff0\u4e86\u4e3a\u4ec0\u4e48\u8981\u6309\u4f53\u79ef\u9006\u5e8f\u904d\u5386\u624d\u80fd\u4fdd\u8bc1\u6bcf\u4ef6\u7269\u54c1\u53ea\u80fd\u9009\u62e9\u4e00\u6b21\uff1b\u540c\u65f6\u4e5f\u8bf4\u660e\u4e3a\u4ec0\u4e48\u4f53\u79ef\u6b63\u5e8f\u904d\u5386\u8868\u793a\u6bcf\u4ef6\u7269\u54c1\u80fd\u9009\u591a\u6b21\u3002\u6240\u4ee5\u5b8c\u5168\u80cc\u5305\u95ee\u9898\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u4f18\u5316\u53ea\u8981\u6539\u53d8\u4f53\u79ef\u7684\u904d\u5386\u65b9\u5411\u5373\u53ef\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a public int findMaxValue(int[] c, int[] w, int idx, int vol) { int[] dp = new int[vol + 1]; // i\u662f\u4ece1\u5f00\u59cb\uff0c\u6240\u4ee5\u5728cw\u6570\u7ec4\u53d6\u503c\u65f6\u90fd\u8981\u51cf\u4e00 for (int i = 1; i <= idx; i++) { for (int v = c[i]; v <= vol; v++) { dp[v] = Math.max(dp[v], dp[v - c[i-1]] + w[i-1]); } } return dp[vol]; } \u603b\u7ed3 \u5982\u679c\u80fd\u591f\u5bf9\u8fd9\u4e24\u4e2a\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u90fd\u4ed4\u7ec6\u5730\u4f53\u4f1a\uff0c\u4e0d\u4ec5\u8bb0\u4f4f\uff0c\u4e5f\u8981\u5f04\u660e\u767d\u5b83\u4eec\u662f\u600e\u4e48\u5f97\u51fa\u6765\u7684\uff0c\u6700\u597d\u80fd\u591f\u81ea\u5df1\u60f3\u4e00\u79cd\u5f97\u5230\u8fd9\u4e9b\u65b9\u7a0b\u7684\u65b9\u6cd5\u3002\u4e8b\u5b9e\u4e0a\uff0c\u5bf9\u6bcf\u4e00\u9053\u52a8\u6001\u89c4\u5212\u9898\u76ee\u90fd\u601d\u8003\u5176\u65b9\u7a0b\u7684\u610f\u4e49\u4ee5\u53ca\u5982\u4f55\u5f97\u6765\uff0c\u662f\u52a0\u6df1\u5bf9\u52a8\u6001\u89c4\u5212\u7684\u7406\u89e3\u3001\u63d0\u9ad8\u52a8\u6001\u89c4\u5212\u529f\u529b\u7684\u597d\u65b9\u6cd5\u3002 \u53c2\u8003 \u8fd9\u7bc7\u7b14\u8bb0\u4e3b\u8981\u53c2\u8003\u4e86dd\u5927\u795e\u7684 \u80cc\u53059\u8bb2 \u4e00\u6587\u4ee5\u53cayxc\u5927\u795e\u7684 \u80cc\u53059\u8bb2\u89c6\u9891 \u3002","title":"\u6211\u5bf9\u80cc\u5305\u95ee\u9898\u7406\u89e3"},{"location":"Algorithm/\u80cc\u5305\u95ee\u9898/#_1","text":"","title":"\u6211\u5bf9\u80cc\u5305\u95ee\u9898\u7406\u89e3"},{"location":"Algorithm/\u80cc\u5305\u95ee\u9898/#_2","text":"\u80cc\u5305\u95ee\u9898\u662f\u7ecf\u5178\u7684\u8003\u5bdf\u52a8\u6001\u89c4\u5212\u5e94\u7528\u7684\u9898\u76ee\uff0c\u5bf9\u5176\u52a0\u4e0a\u4e0d\u540c\u7684\u9650\u5236\u548c\u6761\u4ef6\uff0c\u53ef\u4ee5\u884d\u751f\u51fa\u8bf8\u591a\u53d8\u79cd\uff0c\u82e5\u8981\u5168\u9762\u7406\u89e3\u52a8\u6001\u89c4\u5212\uff0c\u638c\u63e1\u80cc\u5305\u95ee\u9898\u662f\u5fc5\u4e0d\u53ef\u5c11\u7684\u3002\u7531\u4e8e\u672c\u4eba\u6c34\u5e73\u6709\u9650\uff0c\u672c\u6587\u53ea\u662f\u4e2a\u4eba\u5bf9\u80cc\u5305\u95ee\u9898\u7684\u7406\u89e3\uff0c\u5982\u6709\u4e0d\u6b63\u786e\u4e4b\u5904\u8fd8\u8bf7\u8c05\u89e3\u548c\u6307\u6b63\u3002 \u9898\u76ee\u63cf\u8ff0 \u6709N\u4ef6\u7269\u54c1\u548c\u4e00\u4e2a\u5bb9\u91cf\u4e3aV\u7684\u80cc\u5305\u3002\u7b2ci\u4ef6\u7269\u54c1\u7684\u8d39\u7528\u662fc[i]\uff0c\u4ef7\u503c\u662fw[i]\u3002\u6c42\u89e3\u5c06\u54ea\u4e9b\u7269\u54c1\u88c5\u5165\u80cc\u5305\u53ef\u4f7f\u8fd9\u4e9b\u7269\u54c1\u7684\u8d39\u7528\u603b\u548c\u4e0d\u8d85\u8fc7\u80cc\u5305\u5bb9\u91cf\uff0c\u4e14\u4ef7\u503c\u603b\u548c\u6700\u5927\u3002 \u6240\u6709\u80cc\u5305\u95ee\u9898\u7684\u4e3b\u5e72\u4e0e\u9898\u76ee\u63cf\u8ff0\u4e2d\u7684\u4e00\u81f4\uff0c\u4f46\u662f\u52a0\u4e0a\u4e0d\u540c\u7684\u6761\u4ef6\u9650\u5236\u540e\uff0c\u4f1a\u5f62\u6210\u5404\u79cd\u80cc\u5305\u95ee\u9898\u7684\u53d8\u79cd\u3002\u4e0b\u6587\u662f\u4f5c\u8005\u5bf90-1\u80cc\u5305\u548c\u5b8c\u5168\u80cc\u5305\u95ee\u9898\u7684\u7406\u89e3\u7b14\u8bb0\u3002\u4e3a\u5565\u53ea\u6709\u8fd9\u4e24\u79cd\uff0c\u6c34\u5e73\u5b9e\u5728\u6709\u9650\u3002","title":"\u80cc\u5305\u95ee\u9898"},{"location":"Algorithm/\u80cc\u5305\u95ee\u9898/#0-1","text":"0-1\u80cc\u5305\u95ee\u9898\u662f\u6700\u57fa\u7840\u7684\u80cc\u5305\u95ee\u9898\uff0c\u987e\u540d\u601d\u4e490-1\u80cc\u5305\u5373\u6bcf\u79cd\u7684\u7269\u54c1\u4ec5\u6709\u4e00\u4ef6\uff0c\u90a3\u4e48\u5bf9\u4e8e\u6307\u5b9a\u7684\u7269\u54c1\u7684\u9009\u62e9\u53ea\u6709\u53d6\u6216\u8005\u4e0d\u53d6\u4e24\u79cd\u72b6\u6001\u3002\u73b0\u5728\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u72b6\u6001 F[i][v] \u7528\u6765\u8868\u793a\u53ef\u9009\u62e9\u7684\u7269\u54c1\u8303\u56f4\u4e3a\u524di\u4ef6\u7269\u54c1\u5e76\u4e14\u6240\u6709\u7269\u54c1\u7684\u4f53\u79ef\u603b\u548c\u4e0d\u8d85\u8fc7v\u65f6\uff0c\u80cc\u5305\u5185\u6240\u6709\u7269\u54c1\u7684\u4ef7\u503c\u603b\u548c\u6700\u5927\u3002\u90a3\u4e48\uff0c F[i][v] \u5219\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u4e24\u79cd\u72b6\u6001\u8f6c\u79fb\u5f97\u5230\uff1a \u5982\u679c\u4e0d\u9009\u7b2ci\u4ef6\u7269\u54c1\uff0c\u90a3\u4e48\u6700\u5927\u4ef7\u503c\u603b\u548c\u4e3a\u53d6\u524di-1\u4ef6\u7269\u54c1\u4e14\u80cc\u5305\u5bb9\u91cf\u4e0d\u8d85\u8fc7v\u65f6\u7684\u6700\u5927\u4ef7\u503c\uff0c\u5373 F[i][v] = F[i-1][v] \u5982\u679c\u9009\u62e9\u7b2ci\u4ef6\u7269\u54c1\uff0c\u90a3\u4e48\u6700\u5927\u4ef7\u503c\u603b\u548c\u4e3a\u53d6\u524di-1\u4ef6\u7269\u54c1\u4e14\u80cc\u5305\u5bb9\u91cf\u4e0d\u8d85\u8fc7v-c[i]\u65f6\u7684\u6700\u5927\u4ef7\u503c\u52a0\u4e0a\u7b2ci\u4ef6\u7269\u54c1\u7684\u4ef7\u503c\uff0c\u5373 F[i][v] = F[i-1][v-c[i]] + w[i] \u4f46\u662f\u4ece\u54ea\u79cd\u72b6\u6001\u8f6c\u79fb\u8fc7\u6765\u7684\u6700\u5927\u4ef7\u503c\u603b\u66f4\u5927\u5462\uff0c\u6240\u4ee5\u8981\u5bf9\u8f6c\u79fb\u7684\u72b6\u6001\u8fdb\u884c\u6bd4\u8f83\uff0c\u53d6\u66f4\u5927\u7684\u4ef7\u503c\uff0c\u56e0\u6b64\u5f97\u5230\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5982\u4e0b\uff1a F[i][v] = max{F[i-1][v], F[i-1][v-c[i]] + w[i]}; \u8fd9\u4e2a\u65b9\u7a0b\u975e\u5e38\u91cd\u8981\uff0c\u57fa\u672c\u4e0a\u6240\u6709\u8ddf\u80cc\u5305\u76f8\u5173\u7684\u95ee\u9898\u7684\u65b9\u7a0b\u90fd\u662f\u7531\u5b83\u884d\u751f\u51fa\u6765\u7684\u3002 \u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u6765\u5bf9\u6240\u6709\u7684\u72b6\u6001\u8fdb\u884c\u679a\u4e3e\uff0c\u5373\u901a\u8fc7\u904d\u5386\u6240\u6709\u7684\u7269\u54c1\u548c\u4f53\u79ef\u6765\u627e\u51fa\u6700\u5927\u4ef7\u503c\u603b\u548c\uff0c\u904d\u5386\u987a\u5e8f\u4e3a\u7b2c\u4e00\u5c42\u5faa\u73af\u904d\u5386\u6240\u6709\u7684\u7269\u54c1\uff0c\u7b2c\u4e8c\u5c42\u5faa\u73af\u904d\u5386\u80cc\u5305\u5bb9\u91cf\uff0c\u5373\u8003\u8651\u7684\u662f\u53d6\u6216\u4e0d\u53d6\u7b2ci\u4ef6\u7269\u54c1\u5bf9\u80cc\u5305\u53ef\u7528\u4f53\u79ef\u7684\u5f71\u54cd\uff0c\u5982\u4e0b\uff1a public int findMaxValue(int[] c, int[] w, int idx, int vol) { int[][] dp = new int[idx + 1][vol + 1]; // i\u662f\u4ece1\u5f00\u59cb\uff0c\u6240\u4ee5\u5728cw\u6570\u7ec4\u53d6\u503c\u65f6\u90fd\u8981\u51cf\u4e00 for (int i = 1; i <= idx; i++) { for (int v = 0; v <= vol; v++) { dp[i][v] = dp[i - 1][v]; if (v >= c[i-1]) { dp[i][v] = Math.max(dp[i][v], dp[i-1][v - c[i-1]] + w[i-1]); } } } return dp[idx][vol]; } \u63a5\u4e0b\u6765\u5bf9\u4e0a\u8ff0\u65b9\u6cd5\u7684\u4e24\u4e2a\u65b9\u9762\u8fdb\u884c\u8bf4\u660e\uff1a \u4e3a\u4ec0\u4e48dp\u6570\u7ec4\u7684\u957f\u5ea6\u4e3a idx+1 \u548c vol+1 \uff1f \u56e0\u4e3a\u52a8\u6001\u89c4\u5212\u95ee\u9898\u4e2d\u7684\u8fb9\u754c\u6761\u4ef6\u5bf9\u7ed3\u679c\u7684\u5f71\u54cd\u5f88\u5927\uff0c\u56e0\u6b64\u9700\u8981\u7559\u51fa\u7a7a\u95f4\u5bf9\u8fb9\u754c\u503c\u8fdb\u884c\u8d4b\u503c\uff0c\u800c\u5728\u80cc\u5305\u95ee\u9898\u4e2d\uff0c\u4e0d\u540c\u7684\u8fb9\u754c\u503c\u53ef\u4ee5\u4ea7\u751f\u4e0d\u540c\u7684\u7ed3\u679c\uff0c\u4e0b\u6587\u4f1a\u8fdb\u884c\u4ecb\u7ecd\u3002 \u4e3a\u4ec0\u4e48\u6700\u5927\u503c\u662f dp[idx][vol] \u800c\u4e0d\u662f dp[idx][0...vol] \u4e2d\u7684\u6700\u5927\u503c\u5462\uff1f \u5b9e\u9645\u4e0a\u8fd9\u4e0e\u6211\u4eec\u5bf9\u8fb9\u754c\u503c\u7684\u521d\u59cb\u5316\u6709\u5173\uff0c\u5f53\u628a F[0][0...vol] \u90fd\u521d\u59cb\u5316\u4e3a0\u65f6\uff0c\u6240\u6709 F[i][v] \u4e2d\u7684\u503c\u8868\u793a\u7684\u662f\u80cc\u5305\u5bb9\u91cf \u4e0d\u8d85\u8fc7 v\u65f6\u7684\u6700\u5927\u4ef7\u503c\uff0c\u5373 dp[idx][vol] \u53ef\u4ee5\u7531idx-1\u4e0b\u4f53\u79ef\u4e0d\u8d85\u8fc7vol-w\u6216vol\u65f6\u7684\u6700\u5927\u4ef7\u503c\u8f6c\u79fb\u800c\u6765\uff1b\u5f53\u628a F[0][0] \u90fd\u521d\u59cb\u5316\u4e3a0\uff0c\u800c F[0][1...vol] \u90fd\u521d\u59cb\u5316\u4e3a\u8d1f\u65e0\u7a77\u65f6\uff0c\u6240\u6709 F[i][v] \u4e2d\u7684\u503c\u8868\u793a\u7684\u662f\u80cc\u5305\u5bb9\u91cf \u6070\u597d\u4e3a v\u65f6\u7684\u6700\u5927\u4ef7\u503c\uff0c\u5373 dp[idx][vol] \u53ea\u80fd\u7531idx-1\u4e0b\u4f53\u79ef\u6070\u597d\u4e3avol-w\u6216vol\u65f6\u7684\u6700\u5927\u4ef7\u503c\u8f6c\u79fb\u800c\u6765\u3002 \u6211\u4eec\u4e5f\u53ef\u4ee5\u8fd9\u6837\u7406\u89e3\uff0c\u5982\u679c\u8981\u6c42\u80cc\u5305\u6070\u597d\u88c5\u6ee1\uff0c\u90a3\u4e48\u6ca1\u6709\u7269\u54c1\u53ef\u4ee5\u9009\u62e9\u7684\u60c5\u51b5\u4e0b\uff08i=0\u65f6\uff09\uff0c\u53ea\u6709\u4f53\u79ef\u4e3a0\u662f\u6ee1\u8db3\u6070\u597d\u88c5\u6ee1\u7684\u5e76\u4e14\u6b64\u65f6\u7684\u6700\u5927\u4ef7\u503c\u4e3a0\uff08 F[0][0]=0 \uff09\uff0c\u800c\u5176\u4ed6\u4f53\u79ef\u662f\u4e0d\u53ef\u80fd\u8fbe\u5230\u7684\u7528\u8d1f\u65e0\u7a77\u8868\u793a\uff08 F[0][0...val]=-INF \uff09\uff1b\u5982\u679c\u6ca1\u6709\u8981\u6c42\u80cc\u5305\u5fc5\u987b\u88c5\u6ee1\uff0c\u90a3\u4e48\u6ca1\u6709\u7269\u54c1\u53ef\u4ee5\u9009\u62e9\u7684\u60c5\u51b5\u4e0b\uff0c\u80cc\u5305\u6ca1\u6709\u586b\u6ee1\u4e5f\u662f\u5408\u6cd5\u7684\u4e14\u6b64\u65f6\u7684\u6700\u5927\u4ef7\u503c\u4e3a0\uff08 F[0][0...val]=0 \uff09\u3002 \u4ece\u6570\u5b57\u5c42\u9762\u6765\u8bf4\uff0c\u5f53i\u4e3a1\u65f6\uff0c\u5982\u679c dp[0][0...vol] \u4e3a0\uff0c\u90a3\u4e48 dp[1][0...vol] \u5728\u80cc\u5305\u4f53\u79efv\u5927\u4e8e\u7269\u54c1\u4f53\u79ef\u7684\u60c5\u51b5\u4e0b\u4e00\u5b9a\u4e3a w[i-1] \uff08dp\u5728\u672a\u521d\u59cb\u5316\u65f6\u9ed8\u8ba4\u6240\u6709\u503c\u90fd\u4e3a0\uff0c\u53d6\u6700\u5927\u503c\u540e\u4e00\u5b9a\u4e3a w[i-1] \uff09\uff1b\u5982\u679c dp[0][1...vol] \u4e3a\u8d1f\u65e0\u7a77\uff0c\u90a3\u4e48\u5728\u80cc\u5305\u4f53\u79ef\u4e0d\u6070\u597d\u7b49\u4e8e\u7269\u54c1\u4f53\u79ef\uff0c\u5373 vol-c[i-1] \u4e0d\u4e3a0\u65f6 dp[1][vol] \u4e3a\u8d1f\u65e0\u7a77\uff0c\u6240\u4ee5\u5728\u540e\u7eed\u7684\u72b6\u6001\u8f6c\u79fb\u8fc7\u7a0b\u4e2d\u5982\u679c\u662f\u4ece\u8d1f\u65e0\u7a77\u8f6c\u79fb\u8fc7\u6765\u7684\uff0c\u90a3\u4e48\u8f6c\u79fb\u5f97\u5230\u7684\u72b6\u6001\u4e5f\u4e3a\u8d1f\u65e0\u7a77\u3002 \u6240\u4ee5\uff0c\u5728\u4e0a\u8ff0\u65b9\u6cd5\u4e2d\u6211\u4eec\u5c06 dp[0][0...vol] \u9690\u5f0f\u5730\u521d\u59cb\u5316\u4e3a\u4e860\uff0c\u6240\u4ee5\u6700\u7ec8\u7ed3\u679c dp[idx][vol] \u5c31\u662f\u6700\u5927\u4ef7\u503c\uff1b\u5982\u679c\u6211\u4eec\u5c06 dp[0][1...vol] \u4e3a\u8d1f\u65e0\u7a77\uff0c\u90a3\u4e48\u6700\u5927\u503c\u5219\u5728 dp[idx][0...vol] \u4e4b\u95f4\uff0c\u56e0\u4e3a\u4f53\u79ef\u6070\u597d\u88c5\u6ee1\u65f6\uff0c\u4ef7\u503c\u4e0d\u4e00\u5b9a\u662f\u6700\u5927\u7684\u3002","title":"0-1\u80cc\u5305\u95ee\u9898"},{"location":"Algorithm/\u80cc\u5305\u95ee\u9898/#_3","text":"\u4ece\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0c F[i][v] \u662f\u7531 F[i-1][v] \u548c F[i-1] [v-c[i]] \u4e24\u4e2a\u5b50\u95ee\u9898\u9012\u63a8\u800c\u6765\uff0c\u5373 F[i][...] \u7684\u503c\u53ea\u4e0e F[i-1][...] \u6709\u5173\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c\u7a7a\u95f4\u538b\u7f29\uff0c\u53ea\u7528\u4e00\u7ef4\u6570\u7ec4\u6765\u4fdd\u5b58\u7b2ci-1\u6b21\u5faa\u73af\u7684\u503c\u3002\u90a3\u5982\u4f55\u4fdd\u8bc1\u5728\u63a8\u5728\u7b2ci\u6b21\u4e3b\u5faa\u73af\u4e2d\u63a8 F[v] \u65f6\u5f97\u5230\u7684\u662f F[i-1][v] \u548c F[i-1][v -c[i]] \u7684\u503c\uff0c\u5b9e\u9645\u4e0a\u53ea\u6bcf\u6b21\u4e3b\u5faa\u73af\u4e2d\u6211\u4eec\u4ee5 v=V..0 \u7684\u987a\u5e8f\u63a8 F[v] \uff0c\u8fd9\u6837\u624d\u80fd\u4fdd\u8bc1\u63a8 F[v] \u65f6 F[v-c[i]] \u4fdd\u5b58\u7684\u662f\u72b6\u6001 F[i-1][v-c[i]] \u7684\u503c\u3002\u4ee3\u7801\u5982\u4e0b\uff1a public int findMaxValue(int[] c, int[] w, int idx, int vol) { int[] dp = new int[vol + 1]; // i\u662f\u4ece1\u5f00\u59cb\uff0c\u6240\u4ee5\u5728cw\u6570\u7ec4\u53d6\u503c\u65f6\u90fd\u8981\u51cf\u4e00 for (int i = 1; i <= idx; i++) { for (int v = vol; v >= c[i-1]; v--) { dp[v] = Math.max(dp[v], dp[v - c[i-1]] + w[i-1]); } } return dp[vol]; } \u4e3a\u4ec0\u4e48\u4ee5 v=V..0 \u7684\u987a\u5e8f\u63a8 F[v] \u624d\u80fd\u4fdd\u8bc1\u8f6c\u79fb\u7684\u72b6\u6001\u7684\u662f\u6b63\u786e\u7684\u5462\uff1f\u9700\u8981\u6ce8\u610f\u5230\u7684\u662f F[v] \u7684\u72b6\u6001\u8f6c\u79fb\u662f\u4f9d\u8d56\u4e8e F[v-c[i]] \u7684\uff0c\u4ece v...0 \u7684\u987a\u5e8f\u904d\u5386\u53ef\u4ee5\u4fdd\u8bc1\u6bcf\u6b21\u4ece F[v-c[i]] \u8f6c\u79fb\u7684\u503c\u90fd\u662f\u4ecei-1\u8f6e\u5faa\u73af\u8ba1\u7b97\u5f97\u5230\u7684\uff08\u5f53\u67d0\u4e2av\u4ecei-1\u8f6e\u5faa\u73af\u7684v-c[i]\u8f6c\u79fb\u5f97\u5230 F[v] \u540e\uff0c F[v] \u5219\u8868\u793a\u53d6\u4e86\u4e00\u4ef6\u7269\u54c1i\u7684\u6700\u5927\u4ef7\u503c\uff0c\u7531\u4e8ev\u9012\u51cf\u800cc[i]\u4e3a\u56fa\u5b9a\u503c\uff0cv-c[i]\u7684\u503c\u4e0d\u53ef\u80fd\u6bd4\u4e0a\u4e2a\u7ecf\u8fc7\u72b6\u6001\u8f6c\u79fb\u7684v\u66f4\u5927\uff0c\u6240\u4ee5v-c[i]\u53ea\u4f1a\u53d6\u5230\u4e0a\u4e00\u8f6e[i-1\u8f6e]\u7684\u503c\uff0c\u4e0d\u53ef\u80fd\u53d6\u5230\u672c\u8f6e[i\u8f6e]\u8f6c\u79fb\u540e\u7684\u503c\uff09\uff0c\u4ece\u903b\u8f91\u610f\u4e49\u4e0a\u6765\u8bf4\u8fd9\u6837\u7684\u5faa\u73af\u987a\u5e8f\u80fd\u591f\u4fdd\u8bc1\uff0c\u5230\u9009\u62e9\u7b2ci\u4ef6\u7269\u54c1\u65f6\uff0c\u80fd\u591f\u8fdb\u884c\u8f6c\u79fb\u7684\u503c\u90fd\u662f\u4e0d\u5305\u542b\u7b2ci\u4ef6\u7269\u54c1\u7684\uff1b\u5982\u679c\u904d\u5386\u987a\u5e8f\u4e3a 0...v \u5219\u4e0d\u80fd\u4fdd\u8bc1\u4ecev-c[i]\u5f97\u5230\u7684\u503c\u90fd\u662f\u4ece F[i-1] \u8ba1\u7b97\u5f97\u5230\u7684\uff0c\u56e0\u4e3a\u5728v\u9010\u6e10\u9012\u589e\u7684\u8fc7\u7a0b\u4e2dv-c[i]\u53ef\u80fd\u4f1a\u7b49\u4e8e\u4e4b\u524d\u5df2\u7ecf\u8f6c\u79fb\u8fc7\u7684\u67d0\u4e2av\u503c\uff0c\u5bfc\u81f4\u53ef\u8f6c\u79fb\u7684\u503c\u53ef\u80fd\u5df2\u7ecf\u5305\u542b\u4e86\u7b2ci\u4ef6\u7269\u54c1\uff0c\u8fd9\u4e0e\u672c\u9898\u610f\u4e0d\u7b26\uff0c\u4f46\u5b83\u5374\u662f\u5b8c\u5168\u80cc\u5305\u95ee\u9898\u6700\u7b80\u6377\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u6545\u5b66\u4e60\u53ea\u7528\u4e00\u7ef4\u6570\u7ec4\u89e30-1\u80cc\u5305\u95ee\u9898\u662f\u5341\u5206\u5fc5\u8981\u7684\u3002","title":"\u7a7a\u95f4\u590d\u6742\u5ea6\u4f18\u5316"},{"location":"Algorithm/\u80cc\u5305\u95ee\u9898/#_4","text":"0-1\u80cc\u5305\u95ee\u9898\u662f\u6700\u57fa\u672c\u7684\u80cc\u5305\u95ee\u9898\uff0c\u5b83\u5305\u542b\u4e86\u80cc\u5305\u95ee\u9898\u4e2d\u8bbe\u8ba1\u72b6\u6001\u3001\u65b9\u7a0b\u7684\u6700\u57fa\u672c\u601d\u60f3\uff0c\u53e6\u5916\uff0c\u522b\u7684\u7c7b\u578b\u7684\u80cc\u5305\u95ee\u9898\u5f80\u5f80\u4e5f\u53ef\u4ee5\u8f6c\u6362\u62100-1\u80cc\u5305\u95ee\u9898\u6c42\u89e3\u3002\u4e00\u5b9a\u8981\u660e\u767d\u57fa\u672c\u601d\u8def\u7684\u5f97\u51fa\u65b9\u6cd5\uff0c\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u7684\u610f\u4e49\uff0c\u4ee5\u53ca\u6700\u540e\u600e\u6837\u4f18\u5316\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u3002","title":"\u603b\u7ed3"},{"location":"Algorithm/\u80cc\u5305\u95ee\u9898/#_5","text":"\u5b8c\u5168\u80cc\u5305\u95ee\u9898\u4e0e0-1\u80cc\u5305\u95ee\u9898\u4e0d\u540c\u7684\u5730\u65b9\u5728\u4e8e\uff0c0-1\u80cc\u5305\u6bcf\u79cd\u7269\u54c1\u53ea\u80fd\u9009\u4e00\u6b21\uff0c\u4f60\u7684\u9009\u62e9\u53ea\u6709\u9009\u6216\u8005\u4e0d\u9009\u4e24\u8005\uff1b\u800c\u5b8c\u5168\u80cc\u5305\u6bcf\u79cd\u7269\u54c1\u53ef\u4ee5\u9009\u65e0\u9650\u6b21\uff0c\u4f46\u662f\u9009\u62e9\u7684\u6570\u91cf\u4e0a\u9650\u6700\u591a\u4e3a v/c[i] \u3002\u7531\u6b64\u6211\u4eec\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u60f3\u5230\uff0c\u57280-1\u80cc\u5305\u7684\u57fa\u7840\u4e0a\u518d\u52a0\u4e00\u5c42\u5faa\u73af\u6765\u8868\u793a\uff0c\u9009\u62e9\u7b2ci\u4ef6\u7269\u54c1\u7684\u4e2a\u6570\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a public int findMaxValue(int[] c, int[] w, int idx, int vol) { int[][] dp = new int[idx + 1][vol + 1]; // i\u662f\u4ece1\u5f00\u59cb\uff0c\u6240\u4ee5\u5728cw\u6570\u7ec4\u53d6\u503c\u65f6\u90fd\u8981\u51cf\u4e00 for (int i = 1; i <= idx; i++) { for (int v = 0; v <= vol; v++) { for (int k = 0; k * c[i-1] <= v; k++) { dp[i][v] = Math.max(dp[i][v], dp[i - 1][j - k * c[i-1]] + k * w[i-1]); } } } return dp[idx][vol]; } \u8be5\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u8868\u793a\uff0c\u5728\u53ef\u9009\u7684\u7269\u54c1\u4e3a\u524di\u4ef6\u4e14\u4f53\u79ef\u5c0f\u4e8ev\u65f6\u7684\u6700\u5927\u4ef7\u503c\uff0c\u4ece\u6570\u5b66\u610f\u4e49\u4e0a\u6765\u8bb2\u5c31\u662f\u5728\u7b2c\u4e09\u5c42\u5faa\u73af\u65f6\u786e\u5b9a F[i][v] \u7684\u6700\u5927\u4ef7\u503c\uff1a\u5f53k=0\u65f6\uff0c dp[i][v] \u7b49\u4e8e d[i-1][v] \uff0c\u7136\u540e\u968f\u7740k\u4e0d\u65ad\u589e\u5927\uff0c dp[i - 1][j - k * c[i]] + k * w[i] \u8868\u793a\u5728\u672a\u9009\u62e9\u7b2ci\u4ef6\u7269\u54c1\u7684\u57fa\u7840\u4e0a\u5206\u522b\u9009\u62e90...v/c[i]\u4ef6\u7b2ci\u4ef6\u7269\u54c1\u7684\u6700\u5927\u4ef7\u503c\uff0c\u5e76\u4e14\u6bcf\u6b21\u90fd\u4e0e dp[i][v] \u8fdb\u884c\u6bd4\u8f83\uff0c\u4ece\u800c\u786e\u5b9a dp[i][v] \u7684\u6700\u5927\u4ef7\u503c\u3002 \u8fd9\u79cd\u65b9\u5f0f\u56e0\u4e3a\u6709\u4e09\u5c42\u5faa\u73af\u6240\u4ee5\u65f6\u95f4\u590d\u6742\u5ea6\u4f1a\u6bd4\u8f83\u9ad8\uff0c\u6240\u4ee5\u6211\u4eec\u6362\u4e00\u79cd\u601d\u8003\u65b9\u5f0f\u30020-1\u80cc\u5305\u95ee\u9898\u7531\u4e8e\u6bcf\u4ef6\u7269\u54c1\u53ea\u80fd\u9009\u62e9\u4e00\u6b21\uff0c\u6240\u4ee5\u5728\u9009\u62e9\u7b2ci\u4ef6\u7269\u54c1\u65f6\u53ea\u80fd\u4ece\u7b2ci-1\u4ef6\u7269\u54c1\u7684\u72b6\u6001\u4e0b\u8f6c\u79fb\u83b7\u5f97\uff0c\u4f46\u5b8c\u5168\u80cc\u5305\u95ee\u9898\u6bcf\u4ef6\u7269\u54c1\u80fd\u9009\u65e0\u9650\u6b21\uff0c\u6240\u4ee5\u5728\u4f53\u79ef\u4e3av\u7684\u72b6\u6001\u8981\u8003\u8651\u4ece\u53ef\u80fd\u9009\u62e9\u4e86\u7b2ci\u4ef6\u7269\u54c1\u7684\u72b6\u6001\u548c\u672a\u9009\u7b2ci\u4ef6\u7269\u54c1\u7684\u72b6\u6001\u8fdb\u884c\u8f6c\u79fb\u3002\u4ee3\u7801\u5982\u4e0b\uff1a public int findMaxValue(int[] c, int[] w, int idx, int vol) { int[][] dp = new int[idx + 1][vol + 1]; // i\u662f\u4ece1\u5f00\u59cb\uff0c\u6240\u4ee5\u5728cw\u6570\u7ec4\u53d6\u503c\u65f6\u90fd\u8981\u51cf\u4e00 for (int i = 1; i <= idx; i++) { for (int v = 0; v <= vol; v++) { dp[i][v] = dp[i-1][v]; if(v >= c[i-1]) { dp[i][v] = Math.max(dp[i][v], dp[i][v - c[i-1]] + w[i-1]); } } } return dp[idx][vol]; }","title":"\u5b8c\u5168\u80cc\u5305\u95ee\u9898"},{"location":"Algorithm/\u80cc\u5305\u95ee\u9898/#_6","text":"\u5728\u4ecb\u7ecd0-1\u80cc\u5305\u95ee\u9898\u65f6\uff0c\u9610\u8ff0\u4e86\u4e3a\u4ec0\u4e48\u8981\u6309\u4f53\u79ef\u9006\u5e8f\u904d\u5386\u624d\u80fd\u4fdd\u8bc1\u6bcf\u4ef6\u7269\u54c1\u53ea\u80fd\u9009\u62e9\u4e00\u6b21\uff1b\u540c\u65f6\u4e5f\u8bf4\u660e\u4e3a\u4ec0\u4e48\u4f53\u79ef\u6b63\u5e8f\u904d\u5386\u8868\u793a\u6bcf\u4ef6\u7269\u54c1\u80fd\u9009\u591a\u6b21\u3002\u6240\u4ee5\u5b8c\u5168\u80cc\u5305\u95ee\u9898\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u4f18\u5316\u53ea\u8981\u6539\u53d8\u4f53\u79ef\u7684\u904d\u5386\u65b9\u5411\u5373\u53ef\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a public int findMaxValue(int[] c, int[] w, int idx, int vol) { int[] dp = new int[vol + 1]; // i\u662f\u4ece1\u5f00\u59cb\uff0c\u6240\u4ee5\u5728cw\u6570\u7ec4\u53d6\u503c\u65f6\u90fd\u8981\u51cf\u4e00 for (int i = 1; i <= idx; i++) { for (int v = c[i]; v <= vol; v++) { dp[v] = Math.max(dp[v], dp[v - c[i-1]] + w[i-1]); } } return dp[vol]; }","title":"\u7a7a\u95f4\u590d\u6742\u5ea6\u4f18\u5316"},{"location":"Algorithm/\u80cc\u5305\u95ee\u9898/#_7","text":"\u5982\u679c\u80fd\u591f\u5bf9\u8fd9\u4e24\u4e2a\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u90fd\u4ed4\u7ec6\u5730\u4f53\u4f1a\uff0c\u4e0d\u4ec5\u8bb0\u4f4f\uff0c\u4e5f\u8981\u5f04\u660e\u767d\u5b83\u4eec\u662f\u600e\u4e48\u5f97\u51fa\u6765\u7684\uff0c\u6700\u597d\u80fd\u591f\u81ea\u5df1\u60f3\u4e00\u79cd\u5f97\u5230\u8fd9\u4e9b\u65b9\u7a0b\u7684\u65b9\u6cd5\u3002\u4e8b\u5b9e\u4e0a\uff0c\u5bf9\u6bcf\u4e00\u9053\u52a8\u6001\u89c4\u5212\u9898\u76ee\u90fd\u601d\u8003\u5176\u65b9\u7a0b\u7684\u610f\u4e49\u4ee5\u53ca\u5982\u4f55\u5f97\u6765\uff0c\u662f\u52a0\u6df1\u5bf9\u52a8\u6001\u89c4\u5212\u7684\u7406\u89e3\u3001\u63d0\u9ad8\u52a8\u6001\u89c4\u5212\u529f\u529b\u7684\u597d\u65b9\u6cd5\u3002","title":"\u603b\u7ed3"},{"location":"Algorithm/\u80cc\u5305\u95ee\u9898/#_8","text":"\u8fd9\u7bc7\u7b14\u8bb0\u4e3b\u8981\u53c2\u8003\u4e86dd\u5927\u795e\u7684 \u80cc\u53059\u8bb2 \u4e00\u6587\u4ee5\u53cayxc\u5927\u795e\u7684 \u80cc\u53059\u8bb2\u89c6\u9891 \u3002","title":"\u53c2\u8003"},{"location":"Docker/Docker\u955c\u50cf\u5c42/","text":"docker\u955c\u50cf\u5c42\u4e4b\u95f4\u7684\u5173\u7cfb\uff08UnionFS\uff09 Docker\u955c\u50cf\u662f\u7531\u591a\u4e2a\u6587\u4ef6\u7cfb\u7edf\uff08\u53ea\u8bfb\u5c42\uff09\u53e0\u52a0\u800c\u6210\u3002\u5f53\u6211\u4eec\u542f\u52a8\u4e00\u4e2a\u5bb9\u5668\u7684\u65f6\u5019\uff0cDocker\u4f1a\u52a0\u8f7d\u53ea\u8bfb\u955c\u50cf\u5c42\u5e76\u5728\u5176\u4e0a\uff08\u8bd1\u8005\u6ce8\uff1a\u955c\u50cf\u6808\u9876\u90e8\uff09\u6dfb\u52a0\u4e00\u4e2a\u8bfb\u5199\u5c42\u3002\u5982\u679c\u8fd0\u884c\u4e2d\u7684\u5bb9\u5668\u4fee\u6539\u4e86\u73b0\u6709\u7684\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u6587\u4ef6\uff0c\u90a3\u8be5\u6587\u4ef6\u5c06\u4f1a\u4ece\u8bfb\u5199\u5c42\u4e0b\u9762\u7684\u53ea\u8bfb\u5c42\u590d\u5236\u5230\u8bfb\u5199\u5c42\uff0c\u8be5\u6587\u4ef6\u7684\u53ea\u8bfb\u7248\u672c\u4ecd\u7136\u5b58\u5728\uff0c\u53ea\u662f\u5df2\u7ecf\u88ab\u8bfb\u5199\u5c42\u4e2d\u8be5\u6587\u4ef6\u7684\u526f\u672c\u6240\u9690\u85cf\u3002\u5f53\u5220\u9664Docker\u5bb9\u5668\uff0c\u5e76\u901a\u8fc7\u8be5\u955c\u50cf\u91cd\u65b0\u542f\u52a8\u65f6\uff0c\u4e4b\u524d\u7684\u66f4\u6539\u5c06\u4f1a\u4e22\u5931\u3002\u5728Docker\u4e2d\uff0c\u53ea\u8bfb\u5c42\u53ca\u5728\u9876\u90e8\u7684\u8bfb\u5199\u5c42\u7684\u7ec4\u5408\u88ab\u79f0\u4e3a Union File System \uff08\u8054\u5408\u6587\u4ef6\u7cfb\u7edf\uff09\u3002 \u955c\u50cf\u6784\u5efa\u65f6\uff0c\u4f1a\u4e00\u5c42\u5c42\u6784\u5efa\uff0c\u524d\u4e00\u5c42\u662f\u540e\u4e00\u5c42\u7684\u57fa\u7840\u3002\u6bcf\u4e00\u5c42\u6784\u5efa\u5b8c\u5c31\u4e0d\u4f1a\u518d\u53d1\u751f\u6539\u53d8\uff0c\u540e\u4e00\u5c42\u4e0a\u7684\u4efb\u4f55\u6539\u53d8\u53ea\u53d1\u751f\u5728\u81ea\u5df1\u8fd9\u4e00\u5c42\u3002\u6bd4\u5982\uff0c\u5220\u9664\u524d\u4e00\u5c42\u6587\u4ef6\u7684\u64cd\u4f5c\uff0c\u5b9e\u9645\u4e0d\u662f\u771f\u7684\u5220\u9664\u524d\u4e00\u5c42\u7684\u6587\u4ef6\uff0c\u800c\u662f\u4ec5\u5728\u5f53\u524d\u5c42\u6807\u8bb0\u4e3a\u8be5\u6587\u4ef6\u5df2\u5220\u9664\u3002\u5728\u6700\u7ec8\u5bb9\u5668\u8fd0\u884c\u7684\u65f6\u5019\uff0c\u867d\u7136\u4e0d\u4f1a\u770b\u5230\u8fd9\u4e2a\u6587\u4ef6\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u8be5\u6587\u4ef6\u4f1a\u4e00\u76f4\u8ddf\u968f\u955c\u50cf\u3002\u56e0\u6b64\uff0c\u5728\u6784\u5efa\u955c\u50cf\u7684\u65f6\u5019\uff0c\u9700\u8981\u989d\u5916\u5c0f\u5fc3\uff0c\u6bcf\u4e00\u5c42\u5c3d\u91cf\u53ea\u5305\u542b\u8be5\u5c42\u9700\u8981\u6dfb\u52a0\u7684\u4e1c\u897f\uff0c\u4efb\u4f55\u989d\u5916\u7684\u4e1c\u897f\u5e94\u8be5\u5728\u8be5\u5c42\u6784\u5efa\u7ed3\u675f\u524d\u6e05\u7406\u6389\u3002 \u5bf9\u4e8e\u6587\u4ef6\u7684\u64cd\u4f5c\u65e0\u975e\u4ee5\u4e0b\u56db\u79cd\uff1a \u589e\u52a0\u4e86\u67d0\u6587\u4ef6\uff08\u6587\u4ef6\u5939\u4e5f\u53ef\u4ee5\u770b\u505a\u662f\u6587\u4ef6\uff0c\u4e0b\u9762\u7edf\u5199\u4e3a\u6587\u4ef6\uff09 \u5220\u9664\u4e86\u67d0\u6587\u4ef6 \u4fee\u6539\u4e86\u67d0\u6587\u4ef6 \u67d0\u6587\u4ef6\u4e0d\u53d8 \u5728\u5b50\u955c\u50cf\u5c42\u4e2d\u5bf9\u6587\u4ef6\u8fdb\u884c\u4ee5\u4e0a\u64cd\u4f5c\u65f6\uff0c\u5bf9\u5e94\u53d8\u5316\u4e3a\uff1a \u589e\u52a0\u4e86\u67d0\u6587\u4ef6\uff1a\u5219\u5728\u5b50\u955c\u50cf\u5c42\u4e2d\u76f4\u63a5\u589e\u52a0\u8be5\u6587\u4ef6\u3002\u6bd4\u5982\u7236\u955c\u50cf\u5c42\u4e2d\u6ca1\u6709/d.txt\uff0c\u800c\u5728\u5b50\u955c\u50cf\u6709\uff0c\u90a3\u4e48\u5b50\u955c\u50cf\u4e2d\u76f4\u63a5\u5728\u6839\u4e2d\u52a0\u4e00\u4e2ad.txt\u3002 \u5220\u9664\u4e86\u67d0\u6587\u4ef6\uff1a\u5728\u5b50\u955c\u50cf\u5c42\u4e2d\u8fdb\u884c\u6807\u6ce8\uff0c\u6bd4\u5982\u5220\u9664\u4e86\u7236\u955c\u50cf\u5c42\u4e2d\u5b58\u5728\u7684/c.txt\uff0c\u90a3\u4e48\u5728\u5b50\u955c\u50cf\u4e2d\uff0c\u5219\u751f\u6210\u4e00\u4e2a/..c.txt\u7684\u6587\u4ef6\uff0c\u8868\u660e\u8fd9\u4e2a\u6587\u4ef6\u5df2\u7ecf\u88ab\u5220\u9664\u4e86\u3002 \u4fee\u6539\u4e86\u67d0\u6587\u4ef6\uff1a\u56e0\u4e3a\u8ddf\u7236\u955c\u50cf\u5c42\u7684\u6587\u4ef6\u4e0d\u540c\u4e86\uff0c\u540c\u589e\u52a0\u4e86\u67d0\u6587\u4ef6\uff08\u5e94\u8be5\u53ea\u662f\u4fee\u6539\u4e0d\u540c\u7684\u90e8\u5206\uff1f\uff09\u3002 \u67d0\u6587\u4ef6\u4e0d\u53d8\uff1a\u7236\u955c\u50cf\u5c42\u4e2d\u6709/a.txt\uff0c\u5b50\u955c\u50cf\u5c42\u4e2d\u5c31\u4e0d\u5fc5\u518d\u5305\u542b\u4e86\u3002 docker\u955c\u50cf\u5c42\u662f\u5728\u672c\u5730\u5206\u5c42\u5b58\u50a8\u7684\uff0c\u6839\u636e\u5177\u4f53\u9a71\u52a8\u4e0d\u540c\uff0c\u6700\u7ec8\u5b9e\u73b0\u7684\u6548\u679c\u4e5f\u4e0d\u76f8\u540c\u3002 vfs\uff0cvfs\u662f\u91c7\u7528\u5168\u91cf\u7684\u65b9\u5f0f\u6765\u5b58\u50a8\u955c\u50cf\u7684\u3002\u6bd4\u5982\u6709a\u5c42\uff0c\u90a3\u4e48\u955c\u50cfA\u5728vfs\u4e2d\u5b58\u50a8\u6709a\u5c42\u7684\u6240\u6709\u6587\u4ef6\u3002\u955c\u50cfB\u5728vfs\u4e2d\u5c06\u9996\u5148\u5c06a/b\u4e24\u5c42\u7684\u6587\u4ef6\u8fdb\u884c\u62fc\u5408\uff0c\u5f97\u5230\u62e5\u6709\u6240\u6709\u6587\u4ef6\u7684\u5b8c\u6574\u955c\u50cfB\uff0c\u7136\u540e\u5b58\u5728\u53e6\u4e00\u4e2a\u76ee\u5f55\u4e2d\u3002\u4ee5\u6b64\u7c7b\u63a8\u3002 UnionFS\uff0c\u8054\u5408\u6587\u4ef6\u7cfb\u7edf\u53ef\u4ee5\u628a\u4e0d\u540c\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u878d\u5408\u5230\u4e00\u4e2a\u76ee\u5f55\u4e0b\u3002\u6bd4\u5982\u5728\u76ee\u5f55dirA\u4e0b\u6709a.txt\uff0cdirB\u4e0b\u6709b.txt\u3002\u8054\u5408\u6587\u4ef6\u7cfb\u7edf\u53ef\u4ee5\u5bf9\u7528\u6237\u63d0\u4f9b\u4e00\u4e2adir\u6587\u4ef6\uff0c\u91cc\u9762\u5305\u542b\u4e86dirA\u548cdirB\u4e0b\u7684\u5185\u5bb9\uff0c\u90a3\u4e48\u5bf9\u4e8e\u7528\u6237\uff0c\u5c31\u53ef\u4ee5\u770b\u5230dir\u4e0b\u6709\u4e24\u4e2a\u6587\u4ef6\uff0ca.txt\u548cb.txt\u4e86\u3002\u4f8b\u5982\u955c\u50cfA\u662f\u6839\u955c\u50cf\uff0c\u955c\u50cfB\u662f\u5b50\u955c\u50cf\uff0c\u90a3\u4e48\u5b58\u50a8\u955c\u50cfA\u662f\u9700\u8981\u5b58\u50a8\u5b8c\u6574\u7684\uff0c\u4f46\u662f\u5728\u5b58\u50a8\u955c\u50cfB\u65f6\uff0c\u53ef\u4ee5\u5229\u7528a\u5c42\u548cb\u5c42\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u53ea\u9700\u8981\u5b58\u50a8\u589e\u91cf\u90e8\u5206\u7684\u5185\u5bb9\u5373\u53ef\u3002","title":"Docker\u955c\u50cf\u5c42"},{"location":"Java/\u57fa\u7840\u77e5\u8bc6/try-catch-finally\u5757\u4e2d\u7684return\u8bed\u53e5/","text":"\u5173\u4e8etry-catch-finally\u5757\u4e2d\u7684return\u8bed\u53e5 \u5728Java\u7684\u5f02\u5e38\u5904\u7406\u903b\u8f91\u4e2d\uff0ctry-catch-finally\u7684\u4ee3\u7801\u662f\u6309\u987a\u5e8f\u6267\u884c\uff0c\u5373\u5982\u679ctry\u8bed\u53e5\u5757\u4e2d\u6ca1\u6709\u51fa\u73b0\u5f02\u5e38\uff0c\u90a3\u4e48\u5c06\u6267\u884cfinally\u8bed\u53e5\u5757\uff1b\u5982\u679ctry\u8bed\u53e5\u5757\u4e2d\u51fa\u73b0\u5f02\u5e38\uff0c\u90a3\u4e48\u5c06\u6267\u884c\u5bf9\u5e94\u7684catch\u8bed\u53e5\u5757\u7684\u5185\u5bb9\uff0c\u7136\u540e\u7ee7\u7eed\u6267\u884cfinally\u8bed\u53e5\u5757\u7684\u5185\u5bb9\u3002\u5982\u679c\u5728try-catch-finally\u5757\u4e2d\u51fa\u73b0return\u8bed\u53e5\u4f1a\u5bf9\u8fd4\u56de\u7ed3\u679c\u4ea7\u751f\u600e\u6837\u7684\u5f71\u54cd\u5462\uff1f Java\u5728try-catch-finally\u5757\u4e2d\u5bf9\u4e8e\u51fd\u6570\u8fd4\u56de\u503c\u7684\u5904\u7406\u903b\u8f91\u662f\u8fd9\u6837\u7684\uff1a\u5728\u6267\u884cfinally\u8bed\u53e5\u4e4b\u524d\u4f1a\u5148\u5c06\u8fd4\u56de\u503c\u7684\u590d\u5236\u4e00\u4efd\u526f\u672c\u5230\u4e00\u4e2a\u672c\u5730\u53d8\u91cf\u8868\u4e2d\uff0c\u5f53finlly\u5757\u4e2d\u7684\u903b\u8f91\u6267\u884c\u5b8c\u6210\u4ee5\u540e\uff0c\u5c06\u526f\u672c\u8bfb\u5230\u64cd\u4f5c\u6808\u9876\uff0c\u4f5c\u4e3a\u8fd4\u56de\u503c\u8fd4\u56de\u4f7f\u7528\u3002\u8be6\u89c1\u300a\u6df1\u5165Java\u865a\u62df\u673a\uff1aJVM\u9ad8\u7ea7\u7279\u6027\u4e0e\u6700\u4f73\u5b9e\u8df5\u300b\u7b2c6\u7ae0 6.3.7\u8282 \u5f02\u5e38\u8868\u8fd0\u4f5c\u7684\u4f8b\u5b50\u3002 \u6839\u636e\u4e0a\u8ff0\u539f\u56e0\u6211\u4eec\u53ef\u4ee5\u5f88\u5bb9\u6613\u5f97\u51fa\u4e0b\u4ee3\u7801\u7684\u8f93\u51fa\u503c\u4e3a1\uff1a public static int inc() { int x; try { x = 1; return x; } finally { x = 3; } } public static void main(String[] args) { System.out.println(\"x = \" + inc()); } \u8f93\u51fa\u5982\u4e0b\uff1a x = 1 \u4f46\u662f\uff0c\u5982\u679cfinally\u6709return\u8bed\u53e5\u7ed3\u679c\u53c8\u4f1a\u5982\u4f55\u5462 public static int inc() { int x; try { x = 1; return x; } finally { x = 3; return x; } } public static void main(String[] args) { System.out.println(\"x = \" + inc()); } \u8f93\u51fa\u5982\u4e0b\uff1a x = 3 \u8fd9\u662f\u7531\u4e8e\u5728finally\u5757\u4e2d\u6709return\u8bed\u53e5\uff0cjava\u865a\u62df\u673a\u5c06\u5148\u6267\u884cfinally\u5757\u4e2d\u7684return\u8bed\u53e5\u8fd4\u56de\u4e4b\u540e\u5c31\u4e0d\u4f1a\u518d\u6267\u884ctry\u4e2d\u7684return\uff0c\u4ece\u800c\u5c06try\u5757\u4e2d\u7684return\u8986\u76d6\u4e86\u3002\u8fd9\u79cd\u5199\u6cd5\uff0c\u7f16\u8bd1\u662f\u53ef\u4ee5\u7f16\u8bd1\u901a\u8fc7\u7684\uff0c\u4f46\u662f\u7f16\u8bd1\u5668\u4f1a\u7ed9\u4e88\u8b66\u544a\uff0c\u6240\u4ee5\u4e0d\u63a8\u8350\u5728finally\u4e2d\u5199return\uff0c\u8fd9\u4f1a\u7834\u574f\u7a0b\u5e8f\u7684\u5b8c\u6574\u6027\u3002 \u90a3\u4e48\uff0c\u4e0d\u5728finally\u5757\u4e2d\u8fdb\u884creturn\u5c31\u4e00\u5b9a\u6ca1\u95ee\u9898\u5417\uff1f \u4e8b\u5b9e\u4e0a\uff0c\u5982\u679c\u5728finally\u5757\u4e2d\u64cd\u4f5c\u7684\u5bf9\u8c61\u4e0d\u662f\u503c\u7c7b\u578b\u800c\u662f\u5f15\u7528\u7c7b\u578b\uff0c\u90a3\u4e48\u5bf9\u4e8e\u5f15\u7528\u7c7b\u578b\u7684\u5bf9\u8c61\u7684\u5c5e\u6027\u8fdb\u884c\u4fee\u6539\u5219\u4f1a\u4ea7\u751f\u5f71\u54cd\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a public static IntContainer inc() { IntContainer x = new IntContainer(); try { return x; } finally { x.val++; } } public static class IntContainer { int val = 1; } public static void main(String[] args) { System.out.println(\"x.val = \" + inc().val); } \u8f93\u51fa\u5982\u4e0b\uff1a x.val = 2 \u8fd9\u662f\u7531\u4e8e\u65b9\u6cd5\u8fd4\u56de\u7684\u662f\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u5bf9\u4e8e\u5f15\u7528\u672c\u8eabfinally\u5757\u867d\u7136\u6ca1\u6709\u8fdb\u884c\u4fee\u6539\uff0c\u4f46\u662f\u5bf9\u4e8e\u5f15\u7528\u5bf9\u8c61\u5c5e\u6027\u7684\u4fee\u6539\u8fd8\u662f\u4f1a\u751f\u6548\u3002 \u603b\u7ed3 1\u3001finally\u4e2d\u7684\u4ee3\u7801\u603b\u4f1a\u88ab\u6267\u884c\u3002 2\u3001\u5f53try\u3001catch\u4e2d\u6709return\u65f6\uff0c\u4e5f\u4f1a\u6267\u884cfinally\u3002return\u7684\u65f6\u5019\uff0c\u8981\u6ce8\u610f\u8fd4\u56de\u503c\u7684\u7c7b\u578b\uff0c\u662f\u5426\u53d7\u5230finally\u4e2d\u4ee3\u7801\u7684\u5f71\u54cd\u3002 3\u3001finally\u4e2d\u6709return\u65f6\uff0c\u4f1a\u76f4\u63a5\u5728finally\u4e2d\u9000\u51fa\uff0c\u5bfc\u81f4try\u3001catch\u4e2d\u7684return\u5931\u6548\u3002","title":"\u5173\u4e8etry-catch-finally\u5757\u4e2d\u7684return\u8bed\u53e5"},{"location":"Java/\u57fa\u7840\u77e5\u8bc6/try-catch-finally\u5757\u4e2d\u7684return\u8bed\u53e5/#try-catch-finallyreturn","text":"\u5728Java\u7684\u5f02\u5e38\u5904\u7406\u903b\u8f91\u4e2d\uff0ctry-catch-finally\u7684\u4ee3\u7801\u662f\u6309\u987a\u5e8f\u6267\u884c\uff0c\u5373\u5982\u679ctry\u8bed\u53e5\u5757\u4e2d\u6ca1\u6709\u51fa\u73b0\u5f02\u5e38\uff0c\u90a3\u4e48\u5c06\u6267\u884cfinally\u8bed\u53e5\u5757\uff1b\u5982\u679ctry\u8bed\u53e5\u5757\u4e2d\u51fa\u73b0\u5f02\u5e38\uff0c\u90a3\u4e48\u5c06\u6267\u884c\u5bf9\u5e94\u7684catch\u8bed\u53e5\u5757\u7684\u5185\u5bb9\uff0c\u7136\u540e\u7ee7\u7eed\u6267\u884cfinally\u8bed\u53e5\u5757\u7684\u5185\u5bb9\u3002\u5982\u679c\u5728try-catch-finally\u5757\u4e2d\u51fa\u73b0return\u8bed\u53e5\u4f1a\u5bf9\u8fd4\u56de\u7ed3\u679c\u4ea7\u751f\u600e\u6837\u7684\u5f71\u54cd\u5462\uff1f Java\u5728try-catch-finally\u5757\u4e2d\u5bf9\u4e8e\u51fd\u6570\u8fd4\u56de\u503c\u7684\u5904\u7406\u903b\u8f91\u662f\u8fd9\u6837\u7684\uff1a\u5728\u6267\u884cfinally\u8bed\u53e5\u4e4b\u524d\u4f1a\u5148\u5c06\u8fd4\u56de\u503c\u7684\u590d\u5236\u4e00\u4efd\u526f\u672c\u5230\u4e00\u4e2a\u672c\u5730\u53d8\u91cf\u8868\u4e2d\uff0c\u5f53finlly\u5757\u4e2d\u7684\u903b\u8f91\u6267\u884c\u5b8c\u6210\u4ee5\u540e\uff0c\u5c06\u526f\u672c\u8bfb\u5230\u64cd\u4f5c\u6808\u9876\uff0c\u4f5c\u4e3a\u8fd4\u56de\u503c\u8fd4\u56de\u4f7f\u7528\u3002\u8be6\u89c1\u300a\u6df1\u5165Java\u865a\u62df\u673a\uff1aJVM\u9ad8\u7ea7\u7279\u6027\u4e0e\u6700\u4f73\u5b9e\u8df5\u300b\u7b2c6\u7ae0 6.3.7\u8282 \u5f02\u5e38\u8868\u8fd0\u4f5c\u7684\u4f8b\u5b50\u3002 \u6839\u636e\u4e0a\u8ff0\u539f\u56e0\u6211\u4eec\u53ef\u4ee5\u5f88\u5bb9\u6613\u5f97\u51fa\u4e0b\u4ee3\u7801\u7684\u8f93\u51fa\u503c\u4e3a1\uff1a public static int inc() { int x; try { x = 1; return x; } finally { x = 3; } } public static void main(String[] args) { System.out.println(\"x = \" + inc()); } \u8f93\u51fa\u5982\u4e0b\uff1a x = 1 \u4f46\u662f\uff0c\u5982\u679cfinally\u6709return\u8bed\u53e5\u7ed3\u679c\u53c8\u4f1a\u5982\u4f55\u5462 public static int inc() { int x; try { x = 1; return x; } finally { x = 3; return x; } } public static void main(String[] args) { System.out.println(\"x = \" + inc()); } \u8f93\u51fa\u5982\u4e0b\uff1a x = 3 \u8fd9\u662f\u7531\u4e8e\u5728finally\u5757\u4e2d\u6709return\u8bed\u53e5\uff0cjava\u865a\u62df\u673a\u5c06\u5148\u6267\u884cfinally\u5757\u4e2d\u7684return\u8bed\u53e5\u8fd4\u56de\u4e4b\u540e\u5c31\u4e0d\u4f1a\u518d\u6267\u884ctry\u4e2d\u7684return\uff0c\u4ece\u800c\u5c06try\u5757\u4e2d\u7684return\u8986\u76d6\u4e86\u3002\u8fd9\u79cd\u5199\u6cd5\uff0c\u7f16\u8bd1\u662f\u53ef\u4ee5\u7f16\u8bd1\u901a\u8fc7\u7684\uff0c\u4f46\u662f\u7f16\u8bd1\u5668\u4f1a\u7ed9\u4e88\u8b66\u544a\uff0c\u6240\u4ee5\u4e0d\u63a8\u8350\u5728finally\u4e2d\u5199return\uff0c\u8fd9\u4f1a\u7834\u574f\u7a0b\u5e8f\u7684\u5b8c\u6574\u6027\u3002 \u90a3\u4e48\uff0c\u4e0d\u5728finally\u5757\u4e2d\u8fdb\u884creturn\u5c31\u4e00\u5b9a\u6ca1\u95ee\u9898\u5417\uff1f \u4e8b\u5b9e\u4e0a\uff0c\u5982\u679c\u5728finally\u5757\u4e2d\u64cd\u4f5c\u7684\u5bf9\u8c61\u4e0d\u662f\u503c\u7c7b\u578b\u800c\u662f\u5f15\u7528\u7c7b\u578b\uff0c\u90a3\u4e48\u5bf9\u4e8e\u5f15\u7528\u7c7b\u578b\u7684\u5bf9\u8c61\u7684\u5c5e\u6027\u8fdb\u884c\u4fee\u6539\u5219\u4f1a\u4ea7\u751f\u5f71\u54cd\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a public static IntContainer inc() { IntContainer x = new IntContainer(); try { return x; } finally { x.val++; } } public static class IntContainer { int val = 1; } public static void main(String[] args) { System.out.println(\"x.val = \" + inc().val); } \u8f93\u51fa\u5982\u4e0b\uff1a x.val = 2 \u8fd9\u662f\u7531\u4e8e\u65b9\u6cd5\u8fd4\u56de\u7684\u662f\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u5bf9\u4e8e\u5f15\u7528\u672c\u8eabfinally\u5757\u867d\u7136\u6ca1\u6709\u8fdb\u884c\u4fee\u6539\uff0c\u4f46\u662f\u5bf9\u4e8e\u5f15\u7528\u5bf9\u8c61\u5c5e\u6027\u7684\u4fee\u6539\u8fd8\u662f\u4f1a\u751f\u6548\u3002","title":"\u5173\u4e8etry-catch-finally\u5757\u4e2d\u7684return\u8bed\u53e5"},{"location":"Java/\u57fa\u7840\u77e5\u8bc6/try-catch-finally\u5757\u4e2d\u7684return\u8bed\u53e5/#_1","text":"1\u3001finally\u4e2d\u7684\u4ee3\u7801\u603b\u4f1a\u88ab\u6267\u884c\u3002 2\u3001\u5f53try\u3001catch\u4e2d\u6709return\u65f6\uff0c\u4e5f\u4f1a\u6267\u884cfinally\u3002return\u7684\u65f6\u5019\uff0c\u8981\u6ce8\u610f\u8fd4\u56de\u503c\u7684\u7c7b\u578b\uff0c\u662f\u5426\u53d7\u5230finally\u4e2d\u4ee3\u7801\u7684\u5f71\u54cd\u3002 3\u3001finally\u4e2d\u6709return\u65f6\uff0c\u4f1a\u76f4\u63a5\u5728finally\u4e2d\u9000\u51fa\uff0c\u5bfc\u81f4try\u3001catch\u4e2d\u7684return\u5931\u6548\u3002","title":"\u603b\u7ed3"},{"location":"Java/\u96c6\u5408/ArrayList\u6e90\u7801\u5206\u6790/","text":"\u6570\u636e\u7ed3\u6784 ArrayList \u5e95\u5c42\u662f\u4f7f\u7528\u6570\u7ec4\u5b9e\u73b0\u7684\uff0c\u6570\u7ec4\u662f\u5178\u578b\u7684\u987a\u5e8f\u5b58\u50a8\u7ed3\u6784\uff0c\u5177\u6709\u4ee5\u4e0b\u7279\u70b9 \u5728\u7269\u7406\u5185\u5b58\u4e2d\u662f\u8fde\u7eed\u5b58\u50a8\u7684\uff0c\u5728\u903b\u8f91\u4e0a\u662f\u5b58\u50a8\u8fde\u7eed\u7684\u987a\u5e8f\u8868 \u6570\u7ec4\u7684\u4f18\u52bf\u662f\u67e5\u8be2\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(1)\uff0c\u53ea\u8981\u901a\u8fc7\u9996\u5730\u5740\u548c\u504f\u79fb\u91cf\u5c31\u80fd\u8bbf\u95ee\u6570\u7ec4\u4e2d\u7684\u5143\u7d20\u3002 \u6570\u7ec4\u7684\u52a3\u52bf\u662f\u63d2\u5165\u548c\u5220\u9664\u65f6\uff0c\u6700\u574f\u60c5\u51b5\u4e0b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(n)\uff0c\u5f53\u5411\u7b2c\u4e00\u4e2a\u4f4d\u7f6e\u63d2\u5165\u6216\u5220\u9664\u5143\u7d20\u65f6\uff0c\u9700\u8981\u5c06\u6570\u7ec4\u4e2d\u7684\u5176\u4ed6\u5143\u7d20\u5411\u540e\u6216\u8005\u5411\u524d\u79fb\u52a8\u4e00\u4f4d\u3002 \u6570\u7ec4\u7684\u5bb9\u91cf\u662f\u56fa\u5b9a\u7684\u3002\u5f53\u5143\u7d20\u6570\u91cf\uff0c\u4e0d\u65ad\u589e\u52a0\u65f6\u9700\u8981\u5bf9\u6570\u7ec4\u8fdb\u884c\u6269\u5bb9\u3002 \u5e38\u91cf\u4ee5\u53ca\u6210\u5458\u53d8\u91cf //\u901a\u8fc7\u65e0\u53c2\u6784\u9020\u51fd\u6570\u521b\u5efa\u65f6\uff0c\u6570\u7ec4\u7684\u9ed8\u8ba4\u5927\u5c0f private static final int DEFAULT_CAPACITY = 10; //\u5f53\u521d\u59cb\u5bb9\u91cf\u4e3a0\u65f6\uff0celementData\u6307\u5411\u7684\u6570\u7ec4 private static final Object[] EMPTY_ELEMENTDATA = {}; //\u901a\u8fc7\u65e0\u53c2\u6784\u9020\u51fd\u6570\u521b\u5efa\u65f6\uff0celementData\u6307\u5411\u7684\u6570\u7ec4 private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {}; //arrayList\u771f\u6b63\u7528\u4e8e\u5b58\u50a8\u6570\u636e\u7684\u6570\u7ec4 transient Object[] elementData; // non-private to simplify nested class access //\u6570\u7ec4\u5143\u7d20\u6570\u91cf private int size; //\u7ed3\u6784\u6027\u4fee\u6539\u7684\u6b21\u6570 protected transient int modCount = 0; \u6784\u9020\u51fd\u6570 //\u6307\u5b9a\u521d\u59cb\u5bb9\u91cf\u7684\u6784\u9020\u51fd\u6570 public ArrayList(int initialCapacity) { if (initialCapacity > 0) { //\u82e5\u521d\u59cb\u5bb9\u91cf\u5927\u4e8e0\uff0c\u521b\u5efa\u4e00\u4e2a\u5927\u5c0f\u4e3a\u521d\u59cb\u5bb9\u91cf\u7684\u6570\u7ec4 this.elementData = new Object[initialCapacity]; } else if (initialCapacity == 0) { //\u82e5\u521d\u59cb\u5bb9\u91cf\u7b49\u4e8e0\uff0c\u5c06EMPTY_ELEMENTDATA\u6570\u7ec4\u8d4b\u503c\u7ed9elementData this.elementData = EMPTY_ELEMENTDATA; } else { //\u5426\u5219\u629b\u51fa\u975e\u6cd5\u53c2\u6570\u5f02\u5e38 throw new IllegalArgumentException(\"Illegal Capacity: \"+ initialCapacity); } } //\u65e0\u53c2\u6784\u9020\u51fd\u6570 public ArrayList() { //\u5c06DEFAULTCAPACITY_EMPTY_ELEMENTDATA\u6570\u7ec4\u8d4b\u503c\u7ed9elementData this.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA; } //\u901a\u8fc7\u96c6\u5408\u6765\u521b\u5efaArrayList public ArrayList(Collection<? extends E> c) { //\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\u67d0\u4e9bcollection\u7684toArray\u65b9\u6cd5\u8fd4\u56de\u7684\u4e0d\u662fObject\u7c7b\u578b\u6570\u7ec4 elementData = c.toArray(); if ((size = elementData.length) != 0) { // c.toArray might (incorrectly) not return Object[] (see 6260652) if (elementData.getClass() != Object[].class) elementData = Arrays.copyOf(elementData, size, Object[].class); } else { // replace with empty array. this.elementData = EMPTY_ELEMENTDATA; } } \u4ece\u4e0a\u9762\u7684\u4e09\u79cd\u6784\u9020\u51fd\u6570\u53ef\u4ee5\u5f97\u51fa\u7ed3\u8bba\uff0c\u65e0\u8bba\u901a\u8fc7\u54ea\u79cd\u65b9\u5f0f\u521b\u5efa\u7684ArrayList\u5bf9\u8c61\uff0c\u5176elementData\u6570\u7ec4\u7684\u7c7b\u578b\u90fd\u662fObject[].class \u4e3b\u8981\u65b9\u6cd5 //\u5c06\u5143\u7d20\u6dfb\u52a0\u5230\u6570\u7ec4\u6700\u540e public boolean add(E e) { //\u786e\u4fdd\u6570\u7ec4\u5bb9\u91cf\u8db3\u591f\u6dfb\u52a0\u4e0b\u4e00\u4e2a\u5143\u7d20\uff0c\u5f53\u5bb9\u91cf\u4e0d\u8db3\u65f6\u4f1a\u8fdb\u884c\u6269\u5bb9 ensureCapacityInternal(size + 1); // Increments modCount!! elementData[size++] = e; return true; } //\u5c06\u5143\u7d20\u6dfb\u52a0\u5230\u6307\u5b9a\u4f4d\u7f6e public void add(int index, E element) { //\u5bf9index\u8fdb\u884c\u5224\u65ad\u662f\u5426\u8d85\u8fc7\u6570\u7ec4\u957f\u5ea6\uff0c\u8d85\u8fc7\u4f1a\u629b\u51faIndexOutOfBoundsException rangeCheckForAdd(index); //\u786e\u4fdd\u6570\u7ec4\u5bb9\u91cf\u8db3\u591f\u6dfb\u52a0\u4e0b\u4e00\u4e2a\u5143\u7d20\uff0c\u5f53\u5bb9\u91cf\u4e0d\u8db3\u65f6\u4f1a\u8fdb\u884c\u6269\u5bb9 ensureCapacityInternal(size + 1); //\u4e4b\u540e\u4f1a\u5c06\u6307\u5b9aindex\u548c\u4e4b\u540e\u7684\u5143\u7d20\u5168\u90e8\u5411\u540e\u79fb\u52a8\u4e00\u4f4d\uff0c\u518d\u5bf9\u6307\u5b9a\u4f4d\u7f6e\u8d4b\u503c System.arraycopy(elementData, index, elementData, index + 1, size - index); elementData[index] = element; size++; } public E get(int index) { //\u5224\u65adindex\u662f\u5426\u8d8a\u754c rangeCheck(index); return elementData(index); } //\u5220\u9664\u6307\u5b9a\u4f4d\u7f6e\u7684\u5143\u7d20 public E remove(int index) { //\u5224\u65adindex\u662f\u5426\u8d8a\u754c rangeCheck(index); modCount++; //\u83b7\u5f97\u8981\u5220\u9664\u4f4d\u7f6e\u7684\u5143\u7d20\uff0c\u8be5\u65b9\u6cd5\u4f1a\u8fd4\u56de\u5220\u9664\u7684\u5143\u7d20 E oldValue = elementData(index); int numMoved = size - index - 1; // \u8ba1\u7b97\u8981\u5411\u524d\u79fb\u52a8\u7684\u5143\u7d20\u6570\u91cf if (numMoved > 0) //\u5c06index\u4e4b\u540e\u7684\u5143\u7d20\u5411\u524d\u79fb\u52a8\u4e00\u4f4d System.arraycopy(elementData, index+1, elementData, index, numMoved); //\u5c06\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u7f6e\u7a7a elementData[--size] = null; // clear to let GC do its work return oldValue; } //\u6839\u636e\u5bf9\u8c61\u6765\u5220\u9664\u5143\u7d20 public boolean remove(Object o) { if (o == null) { for (int index = 0; index < size; index++) if (elementData[index] == null) { fastRemove(index); return true; } } else { for (int index = 0; index < size; index++) //\u901a\u8fc7\u5bf9\u8c61\u7684equals\u65b9\u6cd5\u6765\u5224\u65ad\u662f\u5426\u4e3a\u540c\u4e00\u4e2a\u5bf9\u8c61 //\u56e0\u4e3a\u5220\u9664\u7b2c\u4e00\u4e2a\u5bf9\u8c61\u540e\u5c31\u76f4\u63a5return\u4e86\uff0c\u6240\u4ee5\u53ea\u4f1a\u5220\u9664\u7b2c\u4e00\u4e2a\u5339\u914d\u7684\u5bf9\u8c61 if (o.equals(elementData[index])) { fastRemove(index); return true; } } return false; } private void ensureCapacityInternal(int minCapacity) { //\u5148\u901a\u8fc7calculateCapacity\u65b9\u6cd5\u8ba1\u7b97\u5bb9\u91cf\u503c ensureExplicitCapacity(calculateCapacity(elementData, minCapacity)); } //\u5224\u65ad\u662f\u5426\u662f\u901a\u8fc7\u65e0\u53c2\u6784\u9020\u51fd\u6570\u521b\u5efa\u7684\u5bf9\u8c61\u7b2c\u4e00\u6b21\u6dfb\u52a0\u5143\u7d20\uff0c\u5982\u679c\u662f\u5219\u8fd4\u56de\u9ed8\u8ba4\u5927\u5c0f10\uff0c\u5426\u5219\u8fd4\u56deminCapacity private static int calculateCapacity(Object[] elementData, int minCapacity) { if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) { return Math.max(DEFAULT_CAPACITY, minCapacity); } return minCapacity; } private void ensureExplicitCapacity(int minCapacity) { modCount++; //\u5c06modCount\u52a01 //minCapacity\u503c\u8981\u5927\u4e8e\u5f53\u524d\u6570\u7ec4\u957f\u5ea6\u624d\u8fdb\u884c\u6269\u5bb9 if (minCapacity - elementData.length > 0) grow(minCapacity); } private void grow(int minCapacity) { //\u8bb0\u5f55\u65e7\u6570\u7ec4\u7684\u5bb9\u91cf int oldCapacity = elementData.length; //\u5c06\u65b0\u6570\u7ec4\u7684\u5bb9\u91cf\u6269\u5927\u81f31.5\u500d\uff0coldCapacity >> 1\u76f8\u5f53\u4e8e\u9664\u4ee52\uff0c\u4f7f\u7528\u4f4d\u8fd0\u7b97\u7684\u539f\u56e0\u662f\u4f4d\u8fd0\u7b97\u66f4\u5feb int newCapacity = oldCapacity + (oldCapacity >> 1); if (newCapacity - minCapacity < 0) newCapacity = minCapacity; if (newCapacity - MAX_ARRAY_SIZE > 0) newCapacity = hugeCapacity(minCapacity); //\u8fdb\u884c\u4e00\u6b21\u6570\u7ec4\u62f7\u8d1d elementData = Arrays.copyOf(elementData, newCapacity); } \u6ce8\u610f\u70b9 ArrayList\u662f\u7ebf\u7a0b\u4e0d\u5b89\u5168\u7684 \u4f7f\u7528for\u5faa\u73af\u65f6\u8fdb\u884c\u5220\u9664\u5143\u7d20\u64cd\u4f5c\uff0c\u7531\u4e8e\u6bcf\u5220\u9664\u4e00\u4e2a\u5143\u7d20\u540e\u90fd\u4f1a\u6539\u53d8\u6570\u7ec4\u7ed3\u6784\uff08\u5143\u7d20\u4f4d\u7f6e\u79fb\u52a8\uff09\u6240\u4ee5\u5220\u9664\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u4f1a\u51fa\u73b0BUG\u3002\u5982\u679c\u4f7f\u7528forearch\u5faa\u73af\u65f6\u8fdb\u884c\u5143\u7d20\u5220\u9664\u64cd\u4f5c\uff0c\u4f1a\u629b\u51faConcurrentModificationException\uff0c\u539f\u56e0\u662fforeach\u5199\u6cd5\u662f\u5bf9\u5b9e\u9645\u7684Iterable\u3001hasNext\u3001next\u65b9\u6cd5\u7684\u7b80\u5199\uff0c\u8fd9\u91cc\u4f1a\u505a\u8fed\u4ee3\u5668\u5185\u90e8\u4fee\u6539\u6b21\u6570\u68c0\u67e5\uff0c\u56e0\u4e3a\u4e0a\u9762\u7684remove()\u65b9\u6cd5\u4f1a\u4fee\u6539modCount\u7684\u503c\uff0c\u6240\u4ee5\u624d\u4f1a\u62a5\u51fa\u5e76\u53d1\u4fee\u6539\u5f02\u5e38\u3002\u8981\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\u7684\u51fa\u73b0\u5219\u5728\u4f7f\u7528\u8fed\u4ee3\u5668\u8fed\u4ee3\u65f6\uff08\u663e\u793a\u6216for-each\u7684\u9690\u5f0f\uff09\u4e0d\u8981\u4f7f\u7528ArrayList\u7684remove\uff0c\u6539\u4e3a\u7528Iterator\u7684remove\u5373\u53ef\u3002 public E next() { checkForComodification(); try { E next = get(cursor); lastRet = cursor++; return next; } catch (IndexOutOfBoundsException e) { checkForComodification(); throw new NoSuchElementException(); } } final void checkForComodification() { if (modCount != expectedModCount) throw new ConcurrentModificationException(); }","title":"ArrayList\u6e90\u7801\u5206\u6790"},{"location":"Maven/MavenPOM\u7b80\u4ecb/","text":"\u6982\u8ff0 \u672c\u6587\u5c06\u5bf9 Maven \u7684\u9879\u76ee\u5bf9\u8c61\u6a21\u578b\uff08 POM \uff09\u8fdb\u884c\u7b80\u5355\u7684\u4ecb\u7ecd\u3002 \u672c\u6587\u7684\u4e3b\u8981\u662f\u7b14\u8005\u5bf9 Maven \u5b98\u65b9\u624b\u518c\u7684\u7ffb\u8bd1\u548c\u7406\u89e3\uff1a http://maven.apache.org/guides/introduction/introduction-to-the-pom.html \u53c2\u8003\u4e86W3Cschool\u7684 Maven \u6559\u7a0b\uff1a https://www.w3cschool.cn/maven/varq1ht4.html POM\u7b80\u4ecb \u4ec0\u4e48\u662fPOM\uff1f POM \u5373 Project Object Model \uff08\u9879\u76ee\u5bf9\u8c61\u6a21\u578b\uff09\u662f Maven \u7684\u57fa\u672c\u5de5\u4f5c\u5355\u5143\u3002\u5b83\u662f\u4e00\u4e2a xml \u6587\u4ef6\uff0c\u6587\u4ef6\u547d\u540d\u4e3a pom.xml \uff0c\u5176\u4e2d\u5305\u542b\u4e86\u5173\u4e8e\u9879\u76ee\u548c\u5404\u79cd\u914d\u7f6e\u7ec6\u8282\u7684\u4fe1\u606f\uff0c Maven \u4f7f\u7528\u8fd9\u4e9b\u4fe1\u606f\u6784\u5efa\u5de5\u7a0b\u3002 \u5f53\u6267\u884c\u4e00\u4e2a\u4efb\u52a1\u6216\u8005\u76ee\u6807\u65f6\uff0c Maven \u4f1a\u5bfb\u627e\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 pom.xml \u6587\u4ef6\uff0c\u4ece\u5176\u4e2d\u8bfb\u53d6\u6240\u9700\u8981\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u7136\u540e\u6267\u884c\u76ee\u6807\u3002 \uff08\u5373\uff1a\u5f53\u4f60\u5728\u547d\u4ee4\u884c\u8f93\u5165 mvn \u547d\u4ee4\u65f6\uff0c Maven \u4f1a\u5728\u6267\u884c\u547d\u4ee4\u7684\u76ee\u5f55\u4e0b\u5bfb\u627e pom.xml \u5e76\u4e14\u6839\u636e\u5176\u4e2d\u7684\u914d\u7f6e\u6267\u884c\u76f8\u5e94\u7684\u547d\u4ee4\uff09 \u53ef\u4ee5\u5728 pom \u6587\u4ef6\u4e2d\u6307\u5b9a\u7684\u4fe1\u606f\u5305\u62ec\u9879\u76ee\u4f9d\u8d56\uff08 dependencies \uff09\u3001\u63d2\u4ef6\uff08 plugins \uff09\u6216\u8005\u76ee\u6807\uff08 goals \uff09\u3001\u6784\u5efa\u914d\u7f6e\uff08 profiles \uff09\u7b49\u3002\u5176\u4ed6\u4fe1\u606f\uff0c\u4f8b\u5982\u9879\u76ee\u7248\u672c\uff08 version \uff09\u3001\u63cf\u8ff0\uff08 description \uff09\u7b49\u7b49\uff0c\u4e5f\u53ef\u4ee5\u5728 pom \u6587\u4ef6\u4e2d\u6307\u5b9a\u3002 SuperPOM \u5728 Maven \u4e2d\uff0c\u9664\u975e\u663e\u793a\u6307\u5b9a\u7236 POM \uff0c\u5426\u5219\u6240\u6709\u7684 POM \u90fd\u4f1a\u4ece Super POM \u7ee7\u627f\uff0c\u8fd9\u610f\u5473\u7740\u5728 Super POM \u8fdb\u884c\u7684\u914d\u7f6e\u90fd\u4f1a\u88ab\u672a\u663e\u793a\u6307\u5b9a\u7236 POM \u7684\u5b50 POM \u7ee7\u627f\u3002 \u4e0b\u9762\u7684\u4ee3\u7801\u6bb5\u662f Maven 2.1.x \u7684 Super POM \u914d\u7f6e\uff1a <project> <modelVersion>4.0.0</modelVersion> <name>Maven Default Project</name> <repositories> <repository> <id>central</id> <name>Maven Repository Switchboard</name> <layout>default</layout> <url>http://repo1.maven.org/maven2</url> <snapshots> <enabled>false</enabled> </snapshots> </repository> </repositories> <pluginRepositories> <pluginRepository> <id>central</id> <name>Maven Plugin Repository</name> <url>http://repo1.maven.org/maven2</url> <layout>default</layout> <snapshots> <enabled>false</enabled> </snapshots> <releases> <updatePolicy>never</updatePolicy> </releases> </pluginRepository> </pluginRepositories> <build> <directory>${project.basedir}/target</directory> <outputDirectory>${project.build.directory}/classes</outputDirectory> <finalName>${project.artifactId}-${project.version}</finalName> <testOutputDirectory>${project.build.directory}/test-classes</testOutputDirectory> <sourceDirectory>${project.basedir}/src/main/java</sourceDirectory> <!-- TODO: MNG-3731 maven-plugin-tools-api < 2.4.4 expect this to be relative... --> <scriptSourceDirectory>src/main/scripts</scriptSourceDirectory> <testSourceDirectory>${project.basedir}/src/test/java</testSourceDirectory> <resources> <resource> <directory>${project.basedir}/src/main/resources</directory> </resource> </resources> <testResources> <testResource> <directory>${project.basedir}/src/test/resources</directory> </testResource> </testResources> <pluginManagement> <plugins> <plugin> <artifactId>maven-antrun-plugin</artifactId> <version>1.3</version> </plugin> <plugin> <artifactId>maven-assembly-plugin</artifactId> <version>2.2-beta-2</version> </plugin> <plugin> <artifactId>maven-clean-plugin</artifactId> <version>2.2</version> </plugin> <plugin> <artifactId>maven-compiler-plugin</artifactId> <version>2.0.2</version> </plugin> <plugin> <artifactId>maven-dependency-plugin</artifactId> <version>2.0</version> </plugin> <plugin> <artifactId>maven-deploy-plugin</artifactId> <version>2.4</version> </plugin> <plugin> <artifactId>maven-ear-plugin</artifactId> <version>2.3.1</version> </plugin> <plugin> <artifactId>maven-ejb-plugin</artifactId> <version>2.1</version> </plugin> <plugin> <artifactId>maven-install-plugin</artifactId> <version>2.2</version> </plugin> <plugin> <artifactId>maven-jar-plugin</artifactId> <version>2.2</version> </plugin> <plugin> <artifactId>maven-javadoc-plugin</artifactId> <version>2.5</version> </plugin> <plugin> <artifactId>maven-plugin-plugin</artifactId> <version>2.4.3</version> </plugin> <plugin> <artifactId>maven-rar-plugin</artifactId> <version>2.2</version> </plugin> <plugin> <artifactId>maven-release-plugin</artifactId> <version>2.0-beta-8</version> </plugin> <plugin> <artifactId>maven-resources-plugin</artifactId> <version>2.3</version> </plugin> <plugin> <artifactId>maven-site-plugin</artifactId> <version>2.0-beta-7</version> </plugin> <plugin> <artifactId>maven-source-plugin</artifactId> <version>2.0.4</version> </plugin> <plugin> <artifactId>maven-surefire-plugin</artifactId> <version>2.4.3</version> </plugin> <plugin> <artifactId>maven-war-plugin</artifactId> <version>2.1-alpha-2</version> </plugin> </plugins> </pluginManagement> </build> <reporting> <outputDirectory>${project.build.directory}/site</outputDirectory> </reporting> <profiles> <profile> <id>release-profile</id> <activation> <property> <name>performRelease</name> <value>true</value> </property> </activation> <build> <plugins> <plugin> <inherited>true</inherited> <groupId>org.apache.maven.plugins</groupId> <artifactId>maven-source-plugin</artifactId> <executions> <execution> <id>attach-sources</id> <goals> <goal>jar</goal> </goals> </execution> </executions> </plugin> <plugin> <inherited>true</inherited> <groupId>org.apache.maven.plugins</groupId> <artifactId>maven-javadoc-plugin</artifactId> <executions> <execution> <id>attach-javadocs</id> <goals> <goal>jar</goal> </goals> </execution> </executions> </plugin> <plugin> <inherited>true</inherited> <groupId>org.apache.maven.plugins</groupId> <artifactId>maven-deploy-plugin</artifactId> <configuration> <updateReleaseInfo>true</updateReleaseInfo> </configuration> </plugin> </plugins> </build> </profile> </profiles> </project> \u7531\u4e8e Maven \u7684\u7ee7\u627f\u5173\u7cfb\u53ef\u80fd\u6bd4\u8f83\u590d\u6742\uff0c\u5982\u679c\u4f60\u60f3\u67e5\u770b\u4e00\u4e2a pom.xml \u6587\u4ef6\u5b8c\u6574\u7684\u914d\u7f6e\uff08\u7236 pom \u7684\u914d\u7f6e\u52a0\u4e0a\u81ea\u5df1\u7684\u914d\u7f6e\uff09 \uff0c\u53ef\u4ee5\u901a\u8fc7\u5728 pom.xml \u6587\u4ef6\u5bf9\u5e94\u7684\u76ee\u5f55\u4e0b\u6267\u884c help:effective-pom \u76ee\u6807\u6765\u67e5\u770b\u3002\u547d\u4ee4\u5982\u4e0b\uff1a mvn help:effective-pom POM\u6587\u4ef6\u7684\u6700\u7b80\u914d\u7f6e POM \u6587\u4ef6\u6700\u7cbe\u7b80\u7684\u914d\u7f6e\u8981\u6c42\u6709\u4ee5\u4e0b\u51e0\u4e2a\uff1a project \u6839\u5143\u7d20 modelVersion - \u5e94\u8be5\u88ab\u8bbe\u7f6e\u4e3a 4.0.0 groupId -\u9879\u76ee\u7ec4id artifactId - \u9879\u76ee\uff08\u5de5\u4ef6\uff09id version - \u7279\u5b9a\u9879\u76ee\u7ec4\u4e0b\u7684\u5de5\u4ef6\u7248\u672c \u4e0b\u9762\u662f\u6700\u7b80\u914d\u7f6e\u7684\u4f8b\u5b50\uff1a <project> <modelVersion>4.0.0</modelVersion> <groupId>com.mycompany.app</groupId> <artifactId>my-app</artifactId> <version>1</version> </project> POM \u6587\u4ef6\u5fc5\u987b\u914d\u7f6e\u5176 groupId \uff0c artifactId \uff0c version \u8fd9\u4e09\u4e2a\u5b57\u6bb5\u3002 \u8fd9\u4e09\u4e2a\u503c\u4ee5 <groupId>\uff1a<artifactId>\uff1a<version> \u7684\u5f62\u5f0f\u6784\u6210\u9879\u76ee\u7684\u5b8c\u6574\u7684\u9879\u76ee\u540d\u79f0\u3002\u4f8b\u5982\uff0c\u4e0a\u9762\u7684\u4f8b\u5b50\u5b8c\u6574\u7684\u540d\u79f0\u662f com.mycompany.app:my-app:1 \u3002 \u53e6\u5916\uff0c\u5982\u679c\u672a\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a\u5143\u7d20\u7684\u503c\uff0c Maven \u5c06\u4f7f\u7528\u5176\u9ed8\u8ba4\u503c\u3002\u4f8b\u5982\uff0c\u6bcf\u4e2a Maven \u9879\u76ee\u90fd\u6709\u4e00\u79cd\u6253\u5305\u7c7b\u578b\uff0c\u5982\u679c\u5143\u7d20 <packaging> \u672a\u5728 pom.xml \u5185\u6307\u5b9a\uff0c\u90a3\u4e48 Maven \u5c06\u4f1a\u4f7f\u7528 jar \u4f5c\u4e3a\u8be5\u9879\u76ee\u7684\u6253\u5305\u7c7b\u578b\u3002 \u5728\u4e0a\u9762\u7684 POM \u6587\u4ef6\u4e2d\u5e76\u672a\u6307\u5b9a\u4f9d\u8d56\u4ed3\u5e93\uff0c\u56e0\u4e3a\u5b83\u5c06\u7ee7\u627f\u4e86 Super POM \u4e2d\u7684\u5b58\u50a8\u5e93\u914d\u7f6e\uff0c\u5b83\u4f1a\u77e5\u9053\u8fd9\u4e9b\u4f9d\u8d56\u5173\u7cfb\u5c06\u4ece Super POM \u4e2d\u6307\u5b9a\u7684http://repo.maven.apache.org/maven2\u4ed3\u5e93\u4e2d\u4e0b\u8f7d\u3002 \u9879\u76ee\u7ee7\u627f \u5b50\u9879\u76ee\u7ee7\u627f\u7236\u9879\u76ee\u540e\uff0c\u5b50 POM \u4f1a\u5c06\u4f1a\u628a\u7236 POM \u4e2d\u7684\u4ee5\u4e0b\u51e0\u4e2a\u5143\u7d20\u8fdb\u884c\u5408\u5e76\uff1a dependencies developers and contributors plugin lists (including reports) plugin executions with matching ids plugin configuration resources \u4f60\u53ef\u4ee5\u5728 pom.xml \u6587\u4ef6\u4e2d\u914d\u7f6e <parent> \u5143\u7d20\u6765\u6307\u5b9a\u67d0\u4e2a pom.xml \u6587\u4ef6\u7684\u7236 POM \u3002 \u4f8b\u5b501 \u73b0\u5728\u6709\u53e6\u4e00\u4e2a\u540d\u79f0\u4e3a com.mycompany.app:my-module:1 \u7684\u5b50\u9879\u76ee\uff0c pom.xml \u6587\u4ef6\u5982\u4e0b\uff1a <project> <modelVersion>4.0.0</modelVersion> <groupId>com.mycompany.app</groupId> <artifactId>my-module</artifactId> <version>1</version> </project> \u9879\u76ee\u7ed3\u6784\u5982\u4e0b\uff1a . |-- my-module #\u6ce8\u610f\u8fd9\u91ccmy-module\u662f\u9879\u76ee\u4e2d\u7684\u4e00\u4e2a\u5b50\u6a21\u5757 | `-- pom.xml #com.mycompany.app:my-module:1 \u7684POM\u6587\u4ef6 `-- pom.xml #com.mycompany.app:my-app:1\u7684POM\u6587\u4ef6 \u5c06 \u6700\u7b80 pom \u6587\u4ef6 ( com.mycompany.app:my-app:1 )\u4f5c\u4e3a com.mycompany.app:my-module:1 \u9879\u76ee\u7684\u7236 POM \uff0c\u53ef\u4ee5\u5728 com.mycompany.app:my-module:1 \u7684 POM \u6dfb\u52a0 <parent> \u5143\u7d20\u5982\u4e0b\uff1a <project> <parent> <groupId>com.mycompany.app</groupId> <artifactId>my-app</artifactId> <version>1</version> </parent> <modelVersion>4.0.0</modelVersion> <groupId>com.mycompany.app</groupId> <artifactId>my-module</artifactId> <version>1</version> </project> \u901a\u8fc7\u6307\u5b9a\u7236 POM \u7684 groupId \uff0c artifactId \uff0c version \uff0c\u53ef\u4ee5\u7ee7\u627f\u7236 POM \u4e00\u4e9b\u5df2\u7ecf\u8bbe\u7f6e\u597d\u7684\u5c5e\u6027\u3002 \u5982\u679c\u6211\u4eec\u5e0c\u671b\u5b50 POM \u7684 groupid \u6216\u8005 version \u4e0e\u7236 POM \u4fdd\u6301\u4e00\u81f4\uff0c\u5219\u53ef\u4ee5\u9009\u62e9\u5220\u9664\u5b50 POM \u7684 groupid \u6216\u8005 version \u5143\u7d20\uff0c\u5982\u4e0b\uff1a <project> <parent> <groupId>com.mycompany.app</groupId> <artifactId>my-app</artifactId> <version>1</version> </parent> <modelVersion>4.0.0</modelVersion> <artifactId>my-module</artifactId> </project> \u4f8b\u5b502 \u4f8b\u5b501 \u4e2d\u5b50 POM \u7684\u914d\u7f6e\u80fd\u751f\u6548\u7684\u524d\u63d0\u662f\u7236\u9879\u76ee\u5df2\u7ecf\u5b89\u88c5\u5230\u672c\u5730\u4ed3\u5e93\u6216\u8005\u5b50 POM \u5728\u7279\u5b9a\u7684\u76ee\u5f55\u7ed3\u6784\u4e2d\uff08\u7236 pom.xml \u6587\u5728\u6240\u5728\u7684\u76ee\u5f55\u662f\u5b50\u6a21\u5757\u7684 pom.xml \u6240\u5728\u7684\u76ee\u5f55\u7684\u4e0a\u5c42\u76ee\u5f55[\u4e0a\u5c42\u76ee\u5f55\u4e3e\u4f8b\uff1a /src/main \u662f /src/main/java \u7684\u4e0a\u5c42\u76ee\u5f55]\uff09\u3002 \u6240\u4ee5\u5f53\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\u65f6\uff0c\u9700\u8981\u8fdb\u884c\u989d\u5916\u7684\u914d\u7f6e\uff1a . |-- my-module | `-- pom.xml `-- parent `-- pom.xml \u4e3a\u4e86\u5904\u7406\u8fd9\u79cd\u76ee\u5f55\u7ed3\u6784\uff0c\u6211\u4eec\u9700\u8981\u5728 <parent> \u5143\u7d20\u4e0b\u6dfb\u52a0 <relativePath> \u5143\u7d20\uff0c\u5982\u4e0b\uff1a <project> <parent> <groupId>com.mycompany.app</groupId> <artifactId>my-app</artifactId> <version>1</version> <relativePath>../parent/pom.xml</relativePath> </parent> <modelVersion>4.0.0</modelVersion> <artifactId>my-module</artifactId> </project> \u9879\u76ee\u805a\u5408 \u4e0d\u540c\u4e8e\u9879\u76ee\u7ee7\u627f\u662f\u4ece\u5b50\u6a21\u5757\u4e2d\u6307\u5b9a\u7236 POM \uff0c\u9879\u76ee\u805a\u5408\u662f\u5728\u7236 POM \u4e2d\u6307\u5b9a\u5b50\u6a21\u5757\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u7236\u9879\u76ee\u53ef\u4ee5\u77e5\u9053\u5b83\u6240\u6709\u7684\u5b50\u6a21\u5757\uff0c\u5f53 Maven \u547d\u4ee4\u5728\u7236\u9879\u76ee\u4e0a\u8c03\u7528\u65f6\uff0c\u5b83\u7684\u6240\u6709\u5b50\u6a21\u5757\u4e5f\u4f1a\u6309\u987a\u5e8f\u6267\u884c\u76f8\u540c\u7684 Maven \u547d\u4ee4\u3002\u8981\u5b9e\u73b0\u9879\u76ee\u805a\u5408\uff0c\u9700\u8981\u505a\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u628a\u7236 POM \u7684\u6253\u5305\u7c7b\u578b\uff08 <packaging> \u5143\u7d20\uff09\u4fee\u6539\u4e3a pom \u5728\u7236 POM \u4e2d\u6307\u5b9a\u5b50\u6a21\u5757\u5217\u8868\uff08\u901a\u8fc7 <modules> \u5143\u7d20\uff09 \u4f8b\u5b503 com.mycompany.app:my-app:1's POM <project> <modelVersion>4.0.0</modelVersion> <groupId>com.mycompany.app</groupId> <artifactId>my-app</artifactId> <version>1</version> </project> com.mycompany.app:my-module:1's POM <project> <modelVersion>4.0.0</modelVersion> <groupId>com.mycompany.app</groupId> <artifactId>my-module</artifactId> <version>1</version> </project> \u76ee\u5f55\u7ed3\u6784 . |-- my-module | `-- pom.xml `-- pom.xml \u5982\u679c\u6211\u4eec\u8981\u628a my-module \u9879\u76ee\u805a\u5408\u5230 my-app \u9879\u76ee\uff0c\u6211\u4eec\u53ea\u8981\u4fee\u6539 my-app \u7684 pom.xml \u6587\u4ef6\uff0c\u5982\u4e0b\uff1a <project> <modelVersion>4.0.0</modelVersion> <groupId>com.mycompany.app</groupId> <artifactId>my-app</artifactId> <version>1</version> <packaging>pom</packaging> <modules> <module>my-module</module> </modules> </project> \u6211\u4eec\u5728 pom.xml \u6587\u4ef6\u4e2d\u6dfb\u52a0\u4e86 <packaging> \u5143\u7d20\u548c <modules> \u5143\u7d20\uff0c\u5e76\u6307\u5b9a\u4e86\u76f8\u5e94\u7684\u503c\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f <module> \u5143\u7d20\u7684\u503c\u662f\u4e24\u4e2a\u9879\u76ee POM \u6587\u4ef6\u7684\u76f8\u5bf9\u8def\u5f84\uff0c\u5e76\u4e14\u5fc5\u987b\u4f7f\u7528\u9879\u76ee\u7684 <artifactId> \u4f5c\u4e3a\u9879\u76ee\u7684\u76ee\u5f55\u540d\u79f0\uff08\u8fd9\u91cc\u597d\u50cf\u662f\u4ee5\u7236 POM \u6240\u5728\u7684\u8def\u5f84\u4f5c\u4e3a\u6839\u8def\u5f84\uff09\u3002 \u9879\u76ee\u7ee7\u627fVS\u9879\u76ee\u805a\u5408 \u5982\u679c\u4f60\u7684\u9879\u76ee\u662f\u7531\u51e0\u4e2a Maven \u9879\u7ec4\u6210\uff0c\u5e76\u4e14\u4ed6\u4eec\u914d\u7f6e\u6709\u76f8\u540c\u6216\u8005\u7c7b\u4f3c\u7684\u90e8\u5206\uff0c\u8fd9\u65f6\u4f60\u53ef\u4ee5\u9009\u62e9\u521b\u5efa\u4e00\u4e2a\u7236\u9879\u76ee\u628a\u76f8\u540c\u6216\u8005\u7c7b\u4f3c\u7684\u914d\u7f6e\u5728\u7236\u9879\u76ee\u4e2d\u5b9a\u4e49\uff0c\u7136\u540e\u8ba9\u4f60\u7684\u5b50\u9879\u76ee\u7ee7\u627f\u8fd9\u4e2a\u7236\u9879\u76ee\u4ece\u800c\u8fbe\u5230\u51cf\u5c11\u91cd\u590d\u914d\u7f6e\u7684\u76ee\u7684\u3002 \u5982\u679c\u4f60\u7684\u9700\u8981\u540c\u65f6\u5904\u7406\u6216\u8005\u6784\u5efa\u4e00\u7ec4\u9879\u76ee\uff0c\u5219\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u7236\u9879\u76ee\u5e76\u4e14\u5728\u7236\u9879\u76ee\u4e2d\u58f0\u660e\u8fd9\u4e9b\u5b50\u6a21\u5757\uff0c\u8fd9\u6837\u4f60\u53ea\u8981\u6267\u884c\u4e00\u6b21\u547d\u4ee4\u5c31\u80fd\u540c\u65f6\u5904\u7406\u591a\u4e2a\u9879\u76ee\u3002 \u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u540c\u65f6\u4f7f\u7528\u7ee7\u627f\u548c\u805a\u5408\u529f\u80fd\uff0c\u5b83\u4eec\u5e76\u4e0d\u662f\u4e92\u65a5\u7684\u3002 \u9879\u76ee\u53d8\u91cf\u4ee5\u53ca\u63d2\u503c Maven \u9f13\u52b1\u7684\u505a\u6cd5\u662f\u4e0d\u8981\u91cd\u590d\u81ea\u5df1\uff0c\u4f46\u67d0\u4e00\u4e9b\u60c5\u51b5\u4e0b\u4f60\u53ef\u80fd\u9700\u8981\u5728\u51e0\u4e2a\u4e0d\u540c\u7684\u4f4d\u7f6e\u4f7f\u7528\u76f8\u540c\u7684\u503c\u3002\u4e3a\u4e86\u786e\u4fdd\u4f60\u53ea\u9700\u8981\u5728\u9879\u76ee\u4e2d\u6307\u5b9a\u4e00\u6b21\u503c\uff08\u5f53\u4f60\u9700\u8981\u4fee\u6539\u8be5\u503c\u65f6\u4e5f\u53ea\u9700\u8981\u4fee\u6539\u4e00\u6b21\uff09\uff0c Maven \u5141\u8bb8\u5728 pom.xml \u6587\u4ef6\u4e2d\u4f7f\u7528\u9884\u5b9a\u4e49\u7684\u53d8\u91cf\u548c\u81ea\u5df1\u5b9a\u4e49\u7684\u53d8\u91cf\u3002 \u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u6765\u83b7\u5f97 project.version \u7684\u503c\uff1a <version>${project.version}</version> \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u4e9b\u53d8\u91cf\u4f1a\u5728\u7ee7\u627f\u4e4b\u540e\u8fdb\u884c\u5904\u7406\uff0c\u8fd9\u610f\u5473\u7740\u5982\u679c\u7236\u9879\u76ee\u548c\u5b50\u9879\u76ee\u540c\u65f6\u5b9a\u4e49\u4e86\u76f8\u540c\u7684\u53d8\u91cf\uff0c\u5219\u5728\u5b50\u9879\u76ee\u4e2d\u5c06\u4f1a\u4ee5\u5b50\u9879\u76ee\u5b9a\u4e49\u7684\u53d8\u91cf\u4e3a\u51c6\u3002 \u53ef\u7528\u53d8\u91cf \u9879\u76ee\u6a21\u578b\u53d8\u91cf \u4f5c\u4e3a\u5355\u4e2a\u503c\u5143\u7d20\u7684\u6a21\u578b\u7684\u4efb\u4f55\u5b57\u6bb5\u90fd\u53ef\u4ee5\u4f5c\u4e3a\u53d8\u91cf\u5f15\u7528\u3002 \u4f8b\u5982\uff0c $ {project.groupId} \uff0c $ {project.version} \uff0c $ {project.build.sourceDirectory} \u7b49\u7b49\u3002 \u8fd9\u4e9b\u53d8\u91cf\u90fd\u4ee5 project. \u4f5c\u4e3a\u524d\u7f00\uff0c \u4f60\u4e5f\u53ef\u4ee5\u770b\u5230\u4ee5 pom. \u4f5c\u4e3a\u524d\u7f00\u7684\u5f15\u7528\u3002 \u8bf7\u53c2\u9605 Maven Model Builder \u4ee5\u67e5\u770b\u5b8c\u6574\u7684\u5c5e\u6027\u5217\u8868\u3002 \u81ea\u5b9a\u4e49\u53d8\u91cf \u4f60\u53ef\u4ee5\u5728 <propeties> \u5143\u7d20\u91cc\u81ea\u5b9a\u4e49\u53d8\u91cf\uff0c\u4f8b\u5982\u4f60\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u65b9\u5f0f\u58f0\u660e\u4e00\u4e2a\u63d2\u4ef6\u7248\u672c\uff1a <project> ... <properties> <maven.checkstyle.version>7.6</maven.checkstyle.version> </properties> ... </project> \u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u5728\u63d2\u4ef6\u58f0\u660e\u65f6\u4f7f\u7528\uff1a <plugin> <groupId>org.apache.maven.plugins</groupId> <artifactId>maven-checkstyle-plugin</artifactId> <version>${maven.checkstyle.version}</version> </plugin>","title":"MavenPOM\u7b80\u4ecb"},{"location":"Maven/MavenPOM\u7b80\u4ecb/#_1","text":"\u672c\u6587\u5c06\u5bf9 Maven \u7684\u9879\u76ee\u5bf9\u8c61\u6a21\u578b\uff08 POM \uff09\u8fdb\u884c\u7b80\u5355\u7684\u4ecb\u7ecd\u3002 \u672c\u6587\u7684\u4e3b\u8981\u662f\u7b14\u8005\u5bf9 Maven \u5b98\u65b9\u624b\u518c\u7684\u7ffb\u8bd1\u548c\u7406\u89e3\uff1a http://maven.apache.org/guides/introduction/introduction-to-the-pom.html \u53c2\u8003\u4e86W3Cschool\u7684 Maven \u6559\u7a0b\uff1a https://www.w3cschool.cn/maven/varq1ht4.html","title":"\u6982\u8ff0"},{"location":"Maven/MavenPOM\u7b80\u4ecb/#pom","text":"","title":"POM\u7b80\u4ecb"},{"location":"Maven/MavenPOM\u7b80\u4ecb/#pom_1","text":"POM \u5373 Project Object Model \uff08\u9879\u76ee\u5bf9\u8c61\u6a21\u578b\uff09\u662f Maven \u7684\u57fa\u672c\u5de5\u4f5c\u5355\u5143\u3002\u5b83\u662f\u4e00\u4e2a xml \u6587\u4ef6\uff0c\u6587\u4ef6\u547d\u540d\u4e3a pom.xml \uff0c\u5176\u4e2d\u5305\u542b\u4e86\u5173\u4e8e\u9879\u76ee\u548c\u5404\u79cd\u914d\u7f6e\u7ec6\u8282\u7684\u4fe1\u606f\uff0c Maven \u4f7f\u7528\u8fd9\u4e9b\u4fe1\u606f\u6784\u5efa\u5de5\u7a0b\u3002 \u5f53\u6267\u884c\u4e00\u4e2a\u4efb\u52a1\u6216\u8005\u76ee\u6807\u65f6\uff0c Maven \u4f1a\u5bfb\u627e\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 pom.xml \u6587\u4ef6\uff0c\u4ece\u5176\u4e2d\u8bfb\u53d6\u6240\u9700\u8981\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u7136\u540e\u6267\u884c\u76ee\u6807\u3002 \uff08\u5373\uff1a\u5f53\u4f60\u5728\u547d\u4ee4\u884c\u8f93\u5165 mvn \u547d\u4ee4\u65f6\uff0c Maven \u4f1a\u5728\u6267\u884c\u547d\u4ee4\u7684\u76ee\u5f55\u4e0b\u5bfb\u627e pom.xml \u5e76\u4e14\u6839\u636e\u5176\u4e2d\u7684\u914d\u7f6e\u6267\u884c\u76f8\u5e94\u7684\u547d\u4ee4\uff09 \u53ef\u4ee5\u5728 pom \u6587\u4ef6\u4e2d\u6307\u5b9a\u7684\u4fe1\u606f\u5305\u62ec\u9879\u76ee\u4f9d\u8d56\uff08 dependencies \uff09\u3001\u63d2\u4ef6\uff08 plugins \uff09\u6216\u8005\u76ee\u6807\uff08 goals \uff09\u3001\u6784\u5efa\u914d\u7f6e\uff08 profiles \uff09\u7b49\u3002\u5176\u4ed6\u4fe1\u606f\uff0c\u4f8b\u5982\u9879\u76ee\u7248\u672c\uff08 version \uff09\u3001\u63cf\u8ff0\uff08 description \uff09\u7b49\u7b49\uff0c\u4e5f\u53ef\u4ee5\u5728 pom \u6587\u4ef6\u4e2d\u6307\u5b9a\u3002","title":"\u4ec0\u4e48\u662fPOM\uff1f"},{"location":"Maven/MavenPOM\u7b80\u4ecb/#superpom","text":"\u5728 Maven \u4e2d\uff0c\u9664\u975e\u663e\u793a\u6307\u5b9a\u7236 POM \uff0c\u5426\u5219\u6240\u6709\u7684 POM \u90fd\u4f1a\u4ece Super POM \u7ee7\u627f\uff0c\u8fd9\u610f\u5473\u7740\u5728 Super POM \u8fdb\u884c\u7684\u914d\u7f6e\u90fd\u4f1a\u88ab\u672a\u663e\u793a\u6307\u5b9a\u7236 POM \u7684\u5b50 POM \u7ee7\u627f\u3002 \u4e0b\u9762\u7684\u4ee3\u7801\u6bb5\u662f Maven 2.1.x \u7684 Super POM \u914d\u7f6e\uff1a <project> <modelVersion>4.0.0</modelVersion> <name>Maven Default Project</name> <repositories> <repository> <id>central</id> <name>Maven Repository Switchboard</name> <layout>default</layout> <url>http://repo1.maven.org/maven2</url> <snapshots> <enabled>false</enabled> </snapshots> </repository> </repositories> <pluginRepositories> <pluginRepository> <id>central</id> <name>Maven Plugin Repository</name> <url>http://repo1.maven.org/maven2</url> <layout>default</layout> <snapshots> <enabled>false</enabled> </snapshots> <releases> <updatePolicy>never</updatePolicy> </releases> </pluginRepository> </pluginRepositories> <build> <directory>${project.basedir}/target</directory> <outputDirectory>${project.build.directory}/classes</outputDirectory> <finalName>${project.artifactId}-${project.version}</finalName> <testOutputDirectory>${project.build.directory}/test-classes</testOutputDirectory> <sourceDirectory>${project.basedir}/src/main/java</sourceDirectory> <!-- TODO: MNG-3731 maven-plugin-tools-api < 2.4.4 expect this to be relative... --> <scriptSourceDirectory>src/main/scripts</scriptSourceDirectory> <testSourceDirectory>${project.basedir}/src/test/java</testSourceDirectory> <resources> <resource> <directory>${project.basedir}/src/main/resources</directory> </resource> </resources> <testResources> <testResource> <directory>${project.basedir}/src/test/resources</directory> </testResource> </testResources> <pluginManagement> <plugins> <plugin> <artifactId>maven-antrun-plugin</artifactId> <version>1.3</version> </plugin> <plugin> <artifactId>maven-assembly-plugin</artifactId> <version>2.2-beta-2</version> </plugin> <plugin> <artifactId>maven-clean-plugin</artifactId> <version>2.2</version> </plugin> <plugin> <artifactId>maven-compiler-plugin</artifactId> <version>2.0.2</version> </plugin> <plugin> <artifactId>maven-dependency-plugin</artifactId> <version>2.0</version> </plugin> <plugin> <artifactId>maven-deploy-plugin</artifactId> <version>2.4</version> </plugin> <plugin> <artifactId>maven-ear-plugin</artifactId> <version>2.3.1</version> </plugin> <plugin> <artifactId>maven-ejb-plugin</artifactId> <version>2.1</version> </plugin> <plugin> <artifactId>maven-install-plugin</artifactId> <version>2.2</version> </plugin> <plugin> <artifactId>maven-jar-plugin</artifactId> <version>2.2</version> </plugin> <plugin> <artifactId>maven-javadoc-plugin</artifactId> <version>2.5</version> </plugin> <plugin> <artifactId>maven-plugin-plugin</artifactId> <version>2.4.3</version> </plugin> <plugin> <artifactId>maven-rar-plugin</artifactId> <version>2.2</version> </plugin> <plugin> <artifactId>maven-release-plugin</artifactId> <version>2.0-beta-8</version> </plugin> <plugin> <artifactId>maven-resources-plugin</artifactId> <version>2.3</version> </plugin> <plugin> <artifactId>maven-site-plugin</artifactId> <version>2.0-beta-7</version> </plugin> <plugin> <artifactId>maven-source-plugin</artifactId> <version>2.0.4</version> </plugin> <plugin> <artifactId>maven-surefire-plugin</artifactId> <version>2.4.3</version> </plugin> <plugin> <artifactId>maven-war-plugin</artifactId> <version>2.1-alpha-2</version> </plugin> </plugins> </pluginManagement> </build> <reporting> <outputDirectory>${project.build.directory}/site</outputDirectory> </reporting> <profiles> <profile> <id>release-profile</id> <activation> <property> <name>performRelease</name> <value>true</value> </property> </activation> <build> <plugins> <plugin> <inherited>true</inherited> <groupId>org.apache.maven.plugins</groupId> <artifactId>maven-source-plugin</artifactId> <executions> <execution> <id>attach-sources</id> <goals> <goal>jar</goal> </goals> </execution> </executions> </plugin> <plugin> <inherited>true</inherited> <groupId>org.apache.maven.plugins</groupId> <artifactId>maven-javadoc-plugin</artifactId> <executions> <execution> <id>attach-javadocs</id> <goals> <goal>jar</goal> </goals> </execution> </executions> </plugin> <plugin> <inherited>true</inherited> <groupId>org.apache.maven.plugins</groupId> <artifactId>maven-deploy-plugin</artifactId> <configuration> <updateReleaseInfo>true</updateReleaseInfo> </configuration> </plugin> </plugins> </build> </profile> </profiles> </project> \u7531\u4e8e Maven \u7684\u7ee7\u627f\u5173\u7cfb\u53ef\u80fd\u6bd4\u8f83\u590d\u6742\uff0c\u5982\u679c\u4f60\u60f3\u67e5\u770b\u4e00\u4e2a pom.xml \u6587\u4ef6\u5b8c\u6574\u7684\u914d\u7f6e\uff08\u7236 pom \u7684\u914d\u7f6e\u52a0\u4e0a\u81ea\u5df1\u7684\u914d\u7f6e\uff09 \uff0c\u53ef\u4ee5\u901a\u8fc7\u5728 pom.xml \u6587\u4ef6\u5bf9\u5e94\u7684\u76ee\u5f55\u4e0b\u6267\u884c help:effective-pom \u76ee\u6807\u6765\u67e5\u770b\u3002\u547d\u4ee4\u5982\u4e0b\uff1a mvn help:effective-pom","title":"SuperPOM"},{"location":"Maven/MavenPOM\u7b80\u4ecb/#pom_2","text":"POM \u6587\u4ef6\u6700\u7cbe\u7b80\u7684\u914d\u7f6e\u8981\u6c42\u6709\u4ee5\u4e0b\u51e0\u4e2a\uff1a project \u6839\u5143\u7d20 modelVersion - \u5e94\u8be5\u88ab\u8bbe\u7f6e\u4e3a 4.0.0 groupId -\u9879\u76ee\u7ec4id artifactId - \u9879\u76ee\uff08\u5de5\u4ef6\uff09id version - \u7279\u5b9a\u9879\u76ee\u7ec4\u4e0b\u7684\u5de5\u4ef6\u7248\u672c \u4e0b\u9762\u662f\u6700\u7b80\u914d\u7f6e\u7684\u4f8b\u5b50\uff1a <project> <modelVersion>4.0.0</modelVersion> <groupId>com.mycompany.app</groupId> <artifactId>my-app</artifactId> <version>1</version> </project> POM \u6587\u4ef6\u5fc5\u987b\u914d\u7f6e\u5176 groupId \uff0c artifactId \uff0c version \u8fd9\u4e09\u4e2a\u5b57\u6bb5\u3002 \u8fd9\u4e09\u4e2a\u503c\u4ee5 <groupId>\uff1a<artifactId>\uff1a<version> \u7684\u5f62\u5f0f\u6784\u6210\u9879\u76ee\u7684\u5b8c\u6574\u7684\u9879\u76ee\u540d\u79f0\u3002\u4f8b\u5982\uff0c\u4e0a\u9762\u7684\u4f8b\u5b50\u5b8c\u6574\u7684\u540d\u79f0\u662f com.mycompany.app:my-app:1 \u3002 \u53e6\u5916\uff0c\u5982\u679c\u672a\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a\u5143\u7d20\u7684\u503c\uff0c Maven \u5c06\u4f7f\u7528\u5176\u9ed8\u8ba4\u503c\u3002\u4f8b\u5982\uff0c\u6bcf\u4e2a Maven \u9879\u76ee\u90fd\u6709\u4e00\u79cd\u6253\u5305\u7c7b\u578b\uff0c\u5982\u679c\u5143\u7d20 <packaging> \u672a\u5728 pom.xml \u5185\u6307\u5b9a\uff0c\u90a3\u4e48 Maven \u5c06\u4f1a\u4f7f\u7528 jar \u4f5c\u4e3a\u8be5\u9879\u76ee\u7684\u6253\u5305\u7c7b\u578b\u3002 \u5728\u4e0a\u9762\u7684 POM \u6587\u4ef6\u4e2d\u5e76\u672a\u6307\u5b9a\u4f9d\u8d56\u4ed3\u5e93\uff0c\u56e0\u4e3a\u5b83\u5c06\u7ee7\u627f\u4e86 Super POM \u4e2d\u7684\u5b58\u50a8\u5e93\u914d\u7f6e\uff0c\u5b83\u4f1a\u77e5\u9053\u8fd9\u4e9b\u4f9d\u8d56\u5173\u7cfb\u5c06\u4ece Super POM \u4e2d\u6307\u5b9a\u7684http://repo.maven.apache.org/maven2\u4ed3\u5e93\u4e2d\u4e0b\u8f7d\u3002","title":"POM\u6587\u4ef6\u7684\u6700\u7b80\u914d\u7f6e"},{"location":"Maven/MavenPOM\u7b80\u4ecb/#_2","text":"\u5b50\u9879\u76ee\u7ee7\u627f\u7236\u9879\u76ee\u540e\uff0c\u5b50 POM \u4f1a\u5c06\u4f1a\u628a\u7236 POM \u4e2d\u7684\u4ee5\u4e0b\u51e0\u4e2a\u5143\u7d20\u8fdb\u884c\u5408\u5e76\uff1a dependencies developers and contributors plugin lists (including reports) plugin executions with matching ids plugin configuration resources \u4f60\u53ef\u4ee5\u5728 pom.xml \u6587\u4ef6\u4e2d\u914d\u7f6e <parent> \u5143\u7d20\u6765\u6307\u5b9a\u67d0\u4e2a pom.xml \u6587\u4ef6\u7684\u7236 POM \u3002","title":"\u9879\u76ee\u7ee7\u627f"},{"location":"Maven/MavenPOM\u7b80\u4ecb/#1","text":"\u73b0\u5728\u6709\u53e6\u4e00\u4e2a\u540d\u79f0\u4e3a com.mycompany.app:my-module:1 \u7684\u5b50\u9879\u76ee\uff0c pom.xml \u6587\u4ef6\u5982\u4e0b\uff1a <project> <modelVersion>4.0.0</modelVersion> <groupId>com.mycompany.app</groupId> <artifactId>my-module</artifactId> <version>1</version> </project> \u9879\u76ee\u7ed3\u6784\u5982\u4e0b\uff1a . |-- my-module #\u6ce8\u610f\u8fd9\u91ccmy-module\u662f\u9879\u76ee\u4e2d\u7684\u4e00\u4e2a\u5b50\u6a21\u5757 | `-- pom.xml #com.mycompany.app:my-module:1 \u7684POM\u6587\u4ef6 `-- pom.xml #com.mycompany.app:my-app:1\u7684POM\u6587\u4ef6 \u5c06 \u6700\u7b80 pom \u6587\u4ef6 ( com.mycompany.app:my-app:1 )\u4f5c\u4e3a com.mycompany.app:my-module:1 \u9879\u76ee\u7684\u7236 POM \uff0c\u53ef\u4ee5\u5728 com.mycompany.app:my-module:1 \u7684 POM \u6dfb\u52a0 <parent> \u5143\u7d20\u5982\u4e0b\uff1a <project> <parent> <groupId>com.mycompany.app</groupId> <artifactId>my-app</artifactId> <version>1</version> </parent> <modelVersion>4.0.0</modelVersion> <groupId>com.mycompany.app</groupId> <artifactId>my-module</artifactId> <version>1</version> </project> \u901a\u8fc7\u6307\u5b9a\u7236 POM \u7684 groupId \uff0c artifactId \uff0c version \uff0c\u53ef\u4ee5\u7ee7\u627f\u7236 POM \u4e00\u4e9b\u5df2\u7ecf\u8bbe\u7f6e\u597d\u7684\u5c5e\u6027\u3002 \u5982\u679c\u6211\u4eec\u5e0c\u671b\u5b50 POM \u7684 groupid \u6216\u8005 version \u4e0e\u7236 POM \u4fdd\u6301\u4e00\u81f4\uff0c\u5219\u53ef\u4ee5\u9009\u62e9\u5220\u9664\u5b50 POM \u7684 groupid \u6216\u8005 version \u5143\u7d20\uff0c\u5982\u4e0b\uff1a <project> <parent> <groupId>com.mycompany.app</groupId> <artifactId>my-app</artifactId> <version>1</version> </parent> <modelVersion>4.0.0</modelVersion> <artifactId>my-module</artifactId> </project>","title":"\u4f8b\u5b501"},{"location":"Maven/MavenPOM\u7b80\u4ecb/#2","text":"\u4f8b\u5b501 \u4e2d\u5b50 POM \u7684\u914d\u7f6e\u80fd\u751f\u6548\u7684\u524d\u63d0\u662f\u7236\u9879\u76ee\u5df2\u7ecf\u5b89\u88c5\u5230\u672c\u5730\u4ed3\u5e93\u6216\u8005\u5b50 POM \u5728\u7279\u5b9a\u7684\u76ee\u5f55\u7ed3\u6784\u4e2d\uff08\u7236 pom.xml \u6587\u5728\u6240\u5728\u7684\u76ee\u5f55\u662f\u5b50\u6a21\u5757\u7684 pom.xml \u6240\u5728\u7684\u76ee\u5f55\u7684\u4e0a\u5c42\u76ee\u5f55[\u4e0a\u5c42\u76ee\u5f55\u4e3e\u4f8b\uff1a /src/main \u662f /src/main/java \u7684\u4e0a\u5c42\u76ee\u5f55]\uff09\u3002 \u6240\u4ee5\u5f53\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\u65f6\uff0c\u9700\u8981\u8fdb\u884c\u989d\u5916\u7684\u914d\u7f6e\uff1a . |-- my-module | `-- pom.xml `-- parent `-- pom.xml \u4e3a\u4e86\u5904\u7406\u8fd9\u79cd\u76ee\u5f55\u7ed3\u6784\uff0c\u6211\u4eec\u9700\u8981\u5728 <parent> \u5143\u7d20\u4e0b\u6dfb\u52a0 <relativePath> \u5143\u7d20\uff0c\u5982\u4e0b\uff1a <project> <parent> <groupId>com.mycompany.app</groupId> <artifactId>my-app</artifactId> <version>1</version> <relativePath>../parent/pom.xml</relativePath> </parent> <modelVersion>4.0.0</modelVersion> <artifactId>my-module</artifactId> </project>","title":"\u4f8b\u5b502"},{"location":"Maven/MavenPOM\u7b80\u4ecb/#_3","text":"\u4e0d\u540c\u4e8e\u9879\u76ee\u7ee7\u627f\u662f\u4ece\u5b50\u6a21\u5757\u4e2d\u6307\u5b9a\u7236 POM \uff0c\u9879\u76ee\u805a\u5408\u662f\u5728\u7236 POM \u4e2d\u6307\u5b9a\u5b50\u6a21\u5757\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u7236\u9879\u76ee\u53ef\u4ee5\u77e5\u9053\u5b83\u6240\u6709\u7684\u5b50\u6a21\u5757\uff0c\u5f53 Maven \u547d\u4ee4\u5728\u7236\u9879\u76ee\u4e0a\u8c03\u7528\u65f6\uff0c\u5b83\u7684\u6240\u6709\u5b50\u6a21\u5757\u4e5f\u4f1a\u6309\u987a\u5e8f\u6267\u884c\u76f8\u540c\u7684 Maven \u547d\u4ee4\u3002\u8981\u5b9e\u73b0\u9879\u76ee\u805a\u5408\uff0c\u9700\u8981\u505a\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u628a\u7236 POM \u7684\u6253\u5305\u7c7b\u578b\uff08 <packaging> \u5143\u7d20\uff09\u4fee\u6539\u4e3a pom \u5728\u7236 POM \u4e2d\u6307\u5b9a\u5b50\u6a21\u5757\u5217\u8868\uff08\u901a\u8fc7 <modules> \u5143\u7d20\uff09","title":"\u9879\u76ee\u805a\u5408"},{"location":"Maven/MavenPOM\u7b80\u4ecb/#3","text":"com.mycompany.app:my-app:1's POM <project> <modelVersion>4.0.0</modelVersion> <groupId>com.mycompany.app</groupId> <artifactId>my-app</artifactId> <version>1</version> </project> com.mycompany.app:my-module:1's POM <project> <modelVersion>4.0.0</modelVersion> <groupId>com.mycompany.app</groupId> <artifactId>my-module</artifactId> <version>1</version> </project> \u76ee\u5f55\u7ed3\u6784 . |-- my-module | `-- pom.xml `-- pom.xml \u5982\u679c\u6211\u4eec\u8981\u628a my-module \u9879\u76ee\u805a\u5408\u5230 my-app \u9879\u76ee\uff0c\u6211\u4eec\u53ea\u8981\u4fee\u6539 my-app \u7684 pom.xml \u6587\u4ef6\uff0c\u5982\u4e0b\uff1a <project> <modelVersion>4.0.0</modelVersion> <groupId>com.mycompany.app</groupId> <artifactId>my-app</artifactId> <version>1</version> <packaging>pom</packaging> <modules> <module>my-module</module> </modules> </project> \u6211\u4eec\u5728 pom.xml \u6587\u4ef6\u4e2d\u6dfb\u52a0\u4e86 <packaging> \u5143\u7d20\u548c <modules> \u5143\u7d20\uff0c\u5e76\u6307\u5b9a\u4e86\u76f8\u5e94\u7684\u503c\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f <module> \u5143\u7d20\u7684\u503c\u662f\u4e24\u4e2a\u9879\u76ee POM \u6587\u4ef6\u7684\u76f8\u5bf9\u8def\u5f84\uff0c\u5e76\u4e14\u5fc5\u987b\u4f7f\u7528\u9879\u76ee\u7684 <artifactId> \u4f5c\u4e3a\u9879\u76ee\u7684\u76ee\u5f55\u540d\u79f0\uff08\u8fd9\u91cc\u597d\u50cf\u662f\u4ee5\u7236 POM \u6240\u5728\u7684\u8def\u5f84\u4f5c\u4e3a\u6839\u8def\u5f84\uff09\u3002","title":"\u4f8b\u5b503"},{"location":"Maven/MavenPOM\u7b80\u4ecb/#vs","text":"\u5982\u679c\u4f60\u7684\u9879\u76ee\u662f\u7531\u51e0\u4e2a Maven \u9879\u7ec4\u6210\uff0c\u5e76\u4e14\u4ed6\u4eec\u914d\u7f6e\u6709\u76f8\u540c\u6216\u8005\u7c7b\u4f3c\u7684\u90e8\u5206\uff0c\u8fd9\u65f6\u4f60\u53ef\u4ee5\u9009\u62e9\u521b\u5efa\u4e00\u4e2a\u7236\u9879\u76ee\u628a\u76f8\u540c\u6216\u8005\u7c7b\u4f3c\u7684\u914d\u7f6e\u5728\u7236\u9879\u76ee\u4e2d\u5b9a\u4e49\uff0c\u7136\u540e\u8ba9\u4f60\u7684\u5b50\u9879\u76ee\u7ee7\u627f\u8fd9\u4e2a\u7236\u9879\u76ee\u4ece\u800c\u8fbe\u5230\u51cf\u5c11\u91cd\u590d\u914d\u7f6e\u7684\u76ee\u7684\u3002 \u5982\u679c\u4f60\u7684\u9700\u8981\u540c\u65f6\u5904\u7406\u6216\u8005\u6784\u5efa\u4e00\u7ec4\u9879\u76ee\uff0c\u5219\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u7236\u9879\u76ee\u5e76\u4e14\u5728\u7236\u9879\u76ee\u4e2d\u58f0\u660e\u8fd9\u4e9b\u5b50\u6a21\u5757\uff0c\u8fd9\u6837\u4f60\u53ea\u8981\u6267\u884c\u4e00\u6b21\u547d\u4ee4\u5c31\u80fd\u540c\u65f6\u5904\u7406\u591a\u4e2a\u9879\u76ee\u3002 \u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u540c\u65f6\u4f7f\u7528\u7ee7\u627f\u548c\u805a\u5408\u529f\u80fd\uff0c\u5b83\u4eec\u5e76\u4e0d\u662f\u4e92\u65a5\u7684\u3002","title":"\u9879\u76ee\u7ee7\u627fVS\u9879\u76ee\u805a\u5408"},{"location":"Maven/MavenPOM\u7b80\u4ecb/#_4","text":"Maven \u9f13\u52b1\u7684\u505a\u6cd5\u662f\u4e0d\u8981\u91cd\u590d\u81ea\u5df1\uff0c\u4f46\u67d0\u4e00\u4e9b\u60c5\u51b5\u4e0b\u4f60\u53ef\u80fd\u9700\u8981\u5728\u51e0\u4e2a\u4e0d\u540c\u7684\u4f4d\u7f6e\u4f7f\u7528\u76f8\u540c\u7684\u503c\u3002\u4e3a\u4e86\u786e\u4fdd\u4f60\u53ea\u9700\u8981\u5728\u9879\u76ee\u4e2d\u6307\u5b9a\u4e00\u6b21\u503c\uff08\u5f53\u4f60\u9700\u8981\u4fee\u6539\u8be5\u503c\u65f6\u4e5f\u53ea\u9700\u8981\u4fee\u6539\u4e00\u6b21\uff09\uff0c Maven \u5141\u8bb8\u5728 pom.xml \u6587\u4ef6\u4e2d\u4f7f\u7528\u9884\u5b9a\u4e49\u7684\u53d8\u91cf\u548c\u81ea\u5df1\u5b9a\u4e49\u7684\u53d8\u91cf\u3002 \u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u6765\u83b7\u5f97 project.version \u7684\u503c\uff1a <version>${project.version}</version> \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u4e9b\u53d8\u91cf\u4f1a\u5728\u7ee7\u627f\u4e4b\u540e\u8fdb\u884c\u5904\u7406\uff0c\u8fd9\u610f\u5473\u7740\u5982\u679c\u7236\u9879\u76ee\u548c\u5b50\u9879\u76ee\u540c\u65f6\u5b9a\u4e49\u4e86\u76f8\u540c\u7684\u53d8\u91cf\uff0c\u5219\u5728\u5b50\u9879\u76ee\u4e2d\u5c06\u4f1a\u4ee5\u5b50\u9879\u76ee\u5b9a\u4e49\u7684\u53d8\u91cf\u4e3a\u51c6\u3002","title":"\u9879\u76ee\u53d8\u91cf\u4ee5\u53ca\u63d2\u503c"},{"location":"Maven/MavenPOM\u7b80\u4ecb/#_5","text":"\u9879\u76ee\u6a21\u578b\u53d8\u91cf \u4f5c\u4e3a\u5355\u4e2a\u503c\u5143\u7d20\u7684\u6a21\u578b\u7684\u4efb\u4f55\u5b57\u6bb5\u90fd\u53ef\u4ee5\u4f5c\u4e3a\u53d8\u91cf\u5f15\u7528\u3002 \u4f8b\u5982\uff0c $ {project.groupId} \uff0c $ {project.version} \uff0c $ {project.build.sourceDirectory} \u7b49\u7b49\u3002 \u8fd9\u4e9b\u53d8\u91cf\u90fd\u4ee5 project. \u4f5c\u4e3a\u524d\u7f00\uff0c \u4f60\u4e5f\u53ef\u4ee5\u770b\u5230\u4ee5 pom. \u4f5c\u4e3a\u524d\u7f00\u7684\u5f15\u7528\u3002 \u8bf7\u53c2\u9605 Maven Model Builder \u4ee5\u67e5\u770b\u5b8c\u6574\u7684\u5c5e\u6027\u5217\u8868\u3002 \u81ea\u5b9a\u4e49\u53d8\u91cf \u4f60\u53ef\u4ee5\u5728 <propeties> \u5143\u7d20\u91cc\u81ea\u5b9a\u4e49\u53d8\u91cf\uff0c\u4f8b\u5982\u4f60\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u65b9\u5f0f\u58f0\u660e\u4e00\u4e2a\u63d2\u4ef6\u7248\u672c\uff1a <project> ... <properties> <maven.checkstyle.version>7.6</maven.checkstyle.version> </properties> ... </project> \u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u5728\u63d2\u4ef6\u58f0\u660e\u65f6\u4f7f\u7528\uff1a <plugin> <groupId>org.apache.maven.plugins</groupId> <artifactId>maven-checkstyle-plugin</artifactId> <version>${maven.checkstyle.version}</version> </plugin>","title":"\u53ef\u7528\u53d8\u91cf"},{"location":"Maven/MavenProfile\u7b80\u4ecb/","text":"\u6982\u8ff0 \u672c\u6587\u4e3b\u8981\u662f\u5bf9 Maven \u7684\u6784\u5efa\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u7b80\u5355\u7684\u4ecb\u7ecd\u3002 \u672c\u6587\u7684\u4e3b\u8981\u662f\u7b14\u8005\u5bf9 Maven \u5b98\u65b9\u624b\u518c\u7684\u7ffb\u8bd1\u548c\u7406\u89e3\uff1a http://maven.apache.org/guides/introduction/introduction-to-profiles.html \u53c2\u8003\u4e86W3Cschool\u7684 Maven \u6559\u7a0b\uff1a https://www.w3cschool.cn/maven/tchv1ht8.html \u6784\u5efa\u914d\u7f6e\u6587\u4ef6\uff08Profiles\uff09\u7b80\u4ecb \u4e3a\u4ec0\u4e48\u8981\u6709\u6784\u5efa\u914d\u7f6e\u6587\u4ef6 Maven \u7684\u5b97\u65e8\u662f\u5c3d\u53ef\u80fd\u786e\u4fdd\u6784\u5efa\u7684\u53ef\u79fb\u690d\u6027\uff0c\u4f46\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u53ef\u79fb\u690d\u5e76\u4e0d\u662f\u5b8c\u5168\u53ef\u80fd\u7684\u3002\u4f8b\u5982\uff0c\u53ef\u80fd\u9700\u8981\u4f7f\u7528\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u73af\u5883\u53d8\u91cf\u6765\u914d\u7f6e\u63d2\u4ef6\uff0c\u6216\u8005\u6839\u636e\u6784\u5efa\u73af\u5883\u7684\u4e0d\u540c\u6765\u9009\u62e9\u4f7f\u7528\u4e0d\u540c\u7684\u63d2\u4ef6\u7b49\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\uff0c Maven \u5f15\u5165\u4e86\u6784\u5efa\u914d\u7f6e\u6587\u4ef6\u7684\u6982\u5ff5\uff0c\u901a\u8fc7\u5728 <profiles> \u5143\u7d20\u4e2d\u989d\u5916\u6216\u8005\u518d\u6b21\u914d\u7f6e POM \u4e2d\u67d0\u4e9b\u5143\u7d20\uff0c\u5e76\u901a\u8fc7\u5404\u79cd\u6761\u4ef6\u6765\u89e6\u53d1 <profile> \u7684\u914d\u7f6e\u3002 <profile> \u4f1a\u6839\u636e\u89e6\u53d1\u6761\u4ef6\u5728\u6784\u5efa\u65f6\u4fee\u6539 POM \uff0c\u8fd9\u610f\u5473\u7740 <profiles> \u4f5c\u4e3a\u8865\u5145\u96c6\u5408\u5728\u6784\u5efa\u65f6\u4f1a\u6839\u636e\u4e0d\u540c\u7684\u76ee\u6807\u73af\u5883\u63d0\u4f9b\u7b49\u4ef7\u4f46\u4e0d\u540c\u7684\u53c2\u6570 \u3002\u8fd9\u6837\uff0c\u9879\u76ee\u4ecd\u7136\u80fd\u591f\u4fdd\u6301\u53ef\u79fb\u690d\u6027\uff0c\u6839\u636e\u4e0d\u540c\u7684\u6784\u5efa\u9700\u6c42\u751f\u6210\u4e0d\u540c\u7684\u6784\u5efa\u7ed3\u679c\u3002 Profile\u7684\u7c7b\u578b\u4ee5\u53ca\u53ef\u4ee5\u5b9a\u4e49\u7684\u4f4d\u7f6e \u7c7b\u578b \u5b9a\u4e49\u7684\u4f4d\u7f6e \u9879\u76ee\uff08 Per Project \uff09 \u5728 pom.xml \u4e2d\u5b9a\u4e49 \u7528\u6237\uff08 Per User \uff09 \u5728 Maven \u8bbe\u7f6e\u4e2d\u5b9a\u4e49\uff08 %USER_HOME%/.m2/settings.xml \uff09 \u5168\u5c40\uff08 Global \uff09 \u5728 Maven \u5168\u5c40\u8bbe\u7f6e\u4e2d\u5b9a\u4e49\uff08 ${maven.home}/conf/settings.xml \uff09 Profile\u7684\u89e6\u53d1\u65b9\u5f0f Profile \u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\u89e6\u53d1/\u6fc0\u6d3b\uff1a \u76f4\u63a5\u901a\u8fc7\u547d\u4ee4\u884c\u89e6\u53d1 \u901a\u8fc7 Maven \u914d\u7f6e\u6765\u8bbe\u7f6e \u53d6\u51b3\u4e8e\u73af\u5883\u53c2\u6570 \u64cd\u4f5c\u7cfb\u7edf\u8bbe\u7f6e \u5b58\u5728/\u7f3a\u5c11\u6587\u4ef6 Profile\u7684\u89e6\u53d1\u7ec6\u8282 1.\u547d\u4ee4\u884c Profiles \u53ef\u4ee5\u901a\u8fc7\u76f4\u63a5\u6307\u5b9a\u547d\u4ee4\u884c\u9009\u9879 -P \u6765\u6fc0\u6d3b\u3002\u8fd9\u4e2a\u547d\u4ee4\u884c\u9009\u9879\u63a5\u53d7\u4e00\u4e2a\u88ab\u9017\u53f7\uff08 , \uff09\u5206\u5272\u7684 profile id \u5217\u8868\uff08\u6ce8\uff1a\u6bcf\u4e2aprofile\u90fd\u53ef\u4ee5\u8bbe\u7f6e id \u8fd9\u4e2a\u6807\u7b7e\uff09\uff0c\u5728 -P \u7684\u53c2\u6570\u4e2d\u6307\u5b9a\u7684 profile \u5c06\u4f1a\u5728\u6784\u5efa\u65f6\u88ab\u6fc0\u6d3b\uff0c\u6b64\u5916\u4efb\u4f55\u7b26\u5408\u5176 <activation> \u6761\u4ef6\uff08 profile \u4e00\u822c\u5728\u5b83\u7684\u5b50\u5143\u7d20 <activation> \u4e2d\u5b9a\u4e49\u89e6\u53d1\u6761\u4ef6\uff09\u6216\u8005\u5728 settings.xml \u6587\u4ef6\u4e2d\u7684 <activeProfiles> \u90e8\u5206\u5b9a\u4e49\u7684 profile \u4e5f\u4f1a\u88ab\u6fc0\u6d3b\u3002 mvn groupId:artifactId:goal -P profile-1,profile-2 2. Maven \u914d\u7f6e Profiles \u53ef\u4ee5\u901a\u8fc7 Maven \u914d\u7f6e\u6765\u8bbe\u7f6e\u6fc0\u6d3b\uff0c\u5373\u901a\u8fc7\u4e0a\u6587\u63d0\u5230\u7684 <activeProfiles> \u90e8\u5206\u8fdb\u884c\u914d\u7f6e\uff0c\u8be5\u90e8\u5206\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u4ee5 profile id \u4f5c\u4e3a\u53c2\u6570\u7684 <activeProfile> \u5143\u7d20\u3002\u5982\u679c\u5728\u9879\u76ee\u4e2d\u4f7f\u7528\u4e86 <activeProfiles> \uff0c\u90a3\u4e48\u5728\u5176\u4e2d\u6307\u5b9a\u7684 profile \u5217\u8868\u5728\u6bcf\u6b21\u90fd\u4f1a\u88ab\u6fc0\u6d3b\u3002 <settings> ... <activeProfiles> <activeProfile>profile-1</activeProfile> </activeProfiles> ... </settings> 3.\u5176\u4ed6 \u53ef\u4ee5\u57fa\u4e8e\u81ea\u52a8\u68c0\u6d4b\u6784\u5efa\u73af\u5883\u72b6\u6001\u6765\u89e6\u53d1 Profiles \uff0c\u8fd9\u4e9b\u89e6\u53d1\u5668\u901a\u8fc7 Profile \u81ea\u8eab\u7684\u5b50\u5143\u7d20 <activation> \u6765\u6307\u5b9a\u3002\u76ee\u524d\u89e6\u53d1\u5668\u53ea\u80fd\u68c0\u6d4b JDK \u7684\u5927\u7248\u672c\u3001\u7cfb\u7edf\u5c5e\u6027\u5b58\u5728\u4e0e\u5426\u4ee5\u53ca\u7cfb\u7edf\u5c5e\u6027\u7684\u503c\uff08\u8fd9\u91cc\u7684\u7cfb\u7edf\u5c5e\u6027\u6307\u7684\u662f\u547d\u4ee4\u884c\u53c2\u6570\u4e2d\u7684\u5c5e\u6027\u6216\u8005\u662f settings.xml \u6587\u4ef6\u7684\u5c5e\u6027\uff0c\u8be6\u89c1\u4e0b\u9762\u7684\u51e0\u4e2a\u4f8b\u5b50\uff09\u3002 \u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u4ee5 JDK \u5927\u7248\u672c\u4e3a 1.4 (\u4f8b\u5982\uff0c 1.4.0_08 , 1.4.2_07 )\u7684\u60c5\u51b5\u4e0b\u4f1a\u89e6\u53d1\u8be5 Profile <profiles> <profile> <activation> <jdk>1.4</jdk> </activation> ... </profile> </profiles> \u4f60\u4e5f\u53ef\u4ee5\u4ee5\u8303\u56f4\u7684\u5f62\u5f0f\u6765\u8bbe\u7f6e JDK \u7248\u672c\uff0c\u4e0b\u9762\u7684\u914d\u7f6e\u5c06\u4f1a\u5728 1.3, 1.4, 1.5 \u7248\u672c\u8d77\u4f5c\u7528 <profiles> <profile> <activation> <jdk>[1.3,1.6)</jdk> </activation> ... </profile> </profiles> Profile \u4e5f\u53ef\u4ee5\u901a\u8fc7\u64cd\u4f5c\u7cfb\u7edf\u53c2\u6570\u89e6\u53d1\uff0c\u5982\u4e0b <profiles> <profile> <activation> <os> <name>Windows XP</name> <family>Windows</family> <arch>x86</arch> <version>5.1.2600</version> </os> </activation> ... </profile> </profiles> \u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c Profile \u4f1a\u5728\u5c5e\u6027 debug \u672a\u5b9a\u4e49\u6216\u8005\u5b9a\u4e49\u4e3a\u975e true \u503c\u65f6\u88ab\u6fc0\u6d3b <profiles> <profile> <activation> <property> <name>debug</name> <value>!true</value> </property> </activation> ... </profile> </profiles> \u6fc0\u6d3b\u4e0a\u9762\u7684\u4f8b\u5b50\u53ef\u4ee5\u901a\u8fc7\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\u4e2d\u7684\u4e00\u4e2a mvn groupId:artifactId:goal mvn groupId:artifactId:goal -Ddebug=false \u4e0b\u9762\u7684\u4f8b\u5b50\u4f1a\u5728\u5c5e\u6027 environment \u7684\u503c\u88ab\u6307\u5b9a\u4e3a test \u65f6\u89e6\u53d1 <profiles> <profile> <activation> <property> <name>environment</name> <value>test</value> </property> </activation> ... </profile> </profiles> \u8981\u89e6\u53d1\u4e0a\u9762\u7684\u4f8b\u5b50\uff0c\u4f60\u53ef\u4ee5\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4 mvn groupId:artifactId:goal -Denvironment=test \u4e0b\u9762\u7684\u4f8b\u5b50\u4f1a\u5728\u6587\u4ef6 target/generated-sources/axistools/wsdl2java/org/apache/maven \u7f3a\u5931\u7684\u60c5\u51b5\u4e0b\u89e6\u53d1 Profile <profiles> <profile> <activation> <file> <missing>target/generated-sources/axistools/wsdl2java/org/apache/maven</missing> </file> </activation> ... </profile> </profiles> <exists> \u548c <missing> \u6807\u7b7e\u652f\u6301\u4ee5\u63d2\u503c\u7684\u5f62\u5f0f\u8d4b\u503c\uff0c\u4f46\u4ec5\u652f\u6301\u7cfb\u7edf\u5c5e\u6027(\u5982 ${user.home} )\u548c\u73af\u5883\u53d8\u91cf\uff08\u5982 ${env.HOME} \uff09\uff0c\u5e76\u4e0d\u652f\u6301\u7528\u6237\u5728 pom.xml \u81ea\u5b9a\u4e49\u7684\u5c5e\u6027\uff08 <properties> \u4e2d\u5b9a\u4e49\u7684\u5c5e\u6027\uff09\u3002 Profile \u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u6fc0\u6d3b\uff0c\u5982\u4e0b\uff1a <profiles> <profile> <id>profile-1</id> <activation> <activeByDefault>true</activeByDefault> </activation> ... </profile> </profiles> \u4f60\u4e5f\u53ef\u4ee5\u5728\u547d\u4ee4\u884c\u6267\u884c\u5728 Profile id \u524d\u6dfb\u52a0 \uff01 \u6216\u8005 - \u5b57\u7b26\u6765\u53d6\u6d88\u6fc0\u6d3b Profile \uff0c\u5982\u4e0b\uff1a mvn groupId:artifactId:goal -P !profile-1,!profile-2 \u5728Profile\u4e2d\u80fd\u591f\u6307\u5b9a\u7684\u5185\u5bb9 \u4f60\u80fd\u591f\u5728 Profile \u4e2d\u6307\u5b9a\u7684\u5185\u5bb9\u53d6\u51b3\u4e8e\u4f60\u9009\u62e9\u5728\u4ec0\u4e48\u4f4d\u7f6e\u914d\u7f6e\u4f60\u7684 Profile \uff0c\u5f53\u914d\u7f6e\u4f4d\u7f6e\u4e0d\u540c\u65f6\u4f60\u80fd\u591f\u6307\u5b9a\u7684\u5185\u5bb9\u4e5f\u4e0d\u4e00\u6837\u3002 \u5728\u5916\u90e8\u6587\u4ef6\u4e2d\u914d\u7f6e Profile \u5728\u5916\u90e8\u6587\u4ef6\u4e2d\u914d\u7f6e Profile \uff08\u5373 settings.xml \u6216 profiles.xml \uff09\u5728\u4e25\u683c\u610f\u4e49\u4e0a\u662f\u4e0d\u53ef\u79fb\u690d\u7684\uff0c\u6240\u4ee5\u80fd\u591f\u5927\u6982\u7387\u6539\u53d8\u6784\u5efa\u7ed3\u6784\u7684\u5185\u5bb9\u53ea\u80fd\u5728 POM \u4e2d\u8fdb\u884c\u914d\u7f6e\u3002\u56e0\u6b64\uff0c\u4f60\u53ea\u80fd\u5728\u5916\u90e8\u6587\u4ef6\u4e2d\u4fee\u6539 <repositories>\u3001<pluginRepositories> \u4ee5\u53ca <properties> \u90e8\u5206\u3002 \u5728 POM \u4e2d\u914d\u7f6e Profile \u5982\u679c\u4f60\u53ef\u4ee5\u5728 POM \u4e2d\u5408\u7406\u5730\u914d\u7f6e Profile \uff0c\u90a3\u4f60\u5c06\u4f1a\u6709\u66f4\u591a\u7684\u914d\u7f6e\u9009\u9879\u3002\u8fd9\u6837\u4f60\u53ef\u4ee5\u4fdd\u7559\u66f4\u591a\u7684\u53ef\u79fb\u690d\u6027\uff0c\u5373\u53ef\u4ee5\u6dfb\u52a0\u66f4\u591a\u7684\u4fe1\u606f\u800c\u4e0d\u4f1a\u6709\u5176\u4ed6\u7528\u6237\u83b7\u5f97\u4e0d\u5230\u4fe1\u606f\u7684\u98ce\u9669\u3002\u5728 POM \u4e2d Profile \u53ef\u4ee5\u4fee\u6539\u4ee5\u4e0b\u5143\u7d20\uff1a <repositories> <pluginRepositories> <dependencies> <plugins> <properties> <modules> <reporting> <dependencyManagement> <distributionManagement> <build> \u5143\u7d20\u7684\u5b50\u96c6\uff0c\u7531\u4ee5\u4e0b\u5143\u7d20\u7ec4\u6210\uff1a <defaultGoal> <resources> <testResources> <finalName>","title":"MavenProfile\u7b80\u4ecb"},{"location":"Maven/MavenProfile\u7b80\u4ecb/#_1","text":"\u672c\u6587\u4e3b\u8981\u662f\u5bf9 Maven \u7684\u6784\u5efa\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u7b80\u5355\u7684\u4ecb\u7ecd\u3002 \u672c\u6587\u7684\u4e3b\u8981\u662f\u7b14\u8005\u5bf9 Maven \u5b98\u65b9\u624b\u518c\u7684\u7ffb\u8bd1\u548c\u7406\u89e3\uff1a http://maven.apache.org/guides/introduction/introduction-to-profiles.html \u53c2\u8003\u4e86W3Cschool\u7684 Maven \u6559\u7a0b\uff1a https://www.w3cschool.cn/maven/tchv1ht8.html","title":"\u6982\u8ff0"},{"location":"Maven/MavenProfile\u7b80\u4ecb/#profiles","text":"","title":"\u6784\u5efa\u914d\u7f6e\u6587\u4ef6\uff08Profiles\uff09\u7b80\u4ecb"},{"location":"Maven/MavenProfile\u7b80\u4ecb/#_2","text":"Maven \u7684\u5b97\u65e8\u662f\u5c3d\u53ef\u80fd\u786e\u4fdd\u6784\u5efa\u7684\u53ef\u79fb\u690d\u6027\uff0c\u4f46\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u53ef\u79fb\u690d\u5e76\u4e0d\u662f\u5b8c\u5168\u53ef\u80fd\u7684\u3002\u4f8b\u5982\uff0c\u53ef\u80fd\u9700\u8981\u4f7f\u7528\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u73af\u5883\u53d8\u91cf\u6765\u914d\u7f6e\u63d2\u4ef6\uff0c\u6216\u8005\u6839\u636e\u6784\u5efa\u73af\u5883\u7684\u4e0d\u540c\u6765\u9009\u62e9\u4f7f\u7528\u4e0d\u540c\u7684\u63d2\u4ef6\u7b49\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\uff0c Maven \u5f15\u5165\u4e86\u6784\u5efa\u914d\u7f6e\u6587\u4ef6\u7684\u6982\u5ff5\uff0c\u901a\u8fc7\u5728 <profiles> \u5143\u7d20\u4e2d\u989d\u5916\u6216\u8005\u518d\u6b21\u914d\u7f6e POM \u4e2d\u67d0\u4e9b\u5143\u7d20\uff0c\u5e76\u901a\u8fc7\u5404\u79cd\u6761\u4ef6\u6765\u89e6\u53d1 <profile> \u7684\u914d\u7f6e\u3002 <profile> \u4f1a\u6839\u636e\u89e6\u53d1\u6761\u4ef6\u5728\u6784\u5efa\u65f6\u4fee\u6539 POM \uff0c\u8fd9\u610f\u5473\u7740 <profiles> \u4f5c\u4e3a\u8865\u5145\u96c6\u5408\u5728\u6784\u5efa\u65f6\u4f1a\u6839\u636e\u4e0d\u540c\u7684\u76ee\u6807\u73af\u5883\u63d0\u4f9b\u7b49\u4ef7\u4f46\u4e0d\u540c\u7684\u53c2\u6570 \u3002\u8fd9\u6837\uff0c\u9879\u76ee\u4ecd\u7136\u80fd\u591f\u4fdd\u6301\u53ef\u79fb\u690d\u6027\uff0c\u6839\u636e\u4e0d\u540c\u7684\u6784\u5efa\u9700\u6c42\u751f\u6210\u4e0d\u540c\u7684\u6784\u5efa\u7ed3\u679c\u3002","title":"\u4e3a\u4ec0\u4e48\u8981\u6709\u6784\u5efa\u914d\u7f6e\u6587\u4ef6"},{"location":"Maven/MavenProfile\u7b80\u4ecb/#profile","text":"\u7c7b\u578b \u5b9a\u4e49\u7684\u4f4d\u7f6e \u9879\u76ee\uff08 Per Project \uff09 \u5728 pom.xml \u4e2d\u5b9a\u4e49 \u7528\u6237\uff08 Per User \uff09 \u5728 Maven \u8bbe\u7f6e\u4e2d\u5b9a\u4e49\uff08 %USER_HOME%/.m2/settings.xml \uff09 \u5168\u5c40\uff08 Global \uff09 \u5728 Maven \u5168\u5c40\u8bbe\u7f6e\u4e2d\u5b9a\u4e49\uff08 ${maven.home}/conf/settings.xml \uff09","title":"Profile\u7684\u7c7b\u578b\u4ee5\u53ca\u53ef\u4ee5\u5b9a\u4e49\u7684\u4f4d\u7f6e"},{"location":"Maven/MavenProfile\u7b80\u4ecb/#profile_1","text":"Profile \u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\u89e6\u53d1/\u6fc0\u6d3b\uff1a \u76f4\u63a5\u901a\u8fc7\u547d\u4ee4\u884c\u89e6\u53d1 \u901a\u8fc7 Maven \u914d\u7f6e\u6765\u8bbe\u7f6e \u53d6\u51b3\u4e8e\u73af\u5883\u53c2\u6570 \u64cd\u4f5c\u7cfb\u7edf\u8bbe\u7f6e \u5b58\u5728/\u7f3a\u5c11\u6587\u4ef6","title":"Profile\u7684\u89e6\u53d1\u65b9\u5f0f"},{"location":"Maven/MavenProfile\u7b80\u4ecb/#profile_2","text":"1.\u547d\u4ee4\u884c Profiles \u53ef\u4ee5\u901a\u8fc7\u76f4\u63a5\u6307\u5b9a\u547d\u4ee4\u884c\u9009\u9879 -P \u6765\u6fc0\u6d3b\u3002\u8fd9\u4e2a\u547d\u4ee4\u884c\u9009\u9879\u63a5\u53d7\u4e00\u4e2a\u88ab\u9017\u53f7\uff08 , \uff09\u5206\u5272\u7684 profile id \u5217\u8868\uff08\u6ce8\uff1a\u6bcf\u4e2aprofile\u90fd\u53ef\u4ee5\u8bbe\u7f6e id \u8fd9\u4e2a\u6807\u7b7e\uff09\uff0c\u5728 -P \u7684\u53c2\u6570\u4e2d\u6307\u5b9a\u7684 profile \u5c06\u4f1a\u5728\u6784\u5efa\u65f6\u88ab\u6fc0\u6d3b\uff0c\u6b64\u5916\u4efb\u4f55\u7b26\u5408\u5176 <activation> \u6761\u4ef6\uff08 profile \u4e00\u822c\u5728\u5b83\u7684\u5b50\u5143\u7d20 <activation> \u4e2d\u5b9a\u4e49\u89e6\u53d1\u6761\u4ef6\uff09\u6216\u8005\u5728 settings.xml \u6587\u4ef6\u4e2d\u7684 <activeProfiles> \u90e8\u5206\u5b9a\u4e49\u7684 profile \u4e5f\u4f1a\u88ab\u6fc0\u6d3b\u3002 mvn groupId:artifactId:goal -P profile-1,profile-2 2. Maven \u914d\u7f6e Profiles \u53ef\u4ee5\u901a\u8fc7 Maven \u914d\u7f6e\u6765\u8bbe\u7f6e\u6fc0\u6d3b\uff0c\u5373\u901a\u8fc7\u4e0a\u6587\u63d0\u5230\u7684 <activeProfiles> \u90e8\u5206\u8fdb\u884c\u914d\u7f6e\uff0c\u8be5\u90e8\u5206\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u4ee5 profile id \u4f5c\u4e3a\u53c2\u6570\u7684 <activeProfile> \u5143\u7d20\u3002\u5982\u679c\u5728\u9879\u76ee\u4e2d\u4f7f\u7528\u4e86 <activeProfiles> \uff0c\u90a3\u4e48\u5728\u5176\u4e2d\u6307\u5b9a\u7684 profile \u5217\u8868\u5728\u6bcf\u6b21\u90fd\u4f1a\u88ab\u6fc0\u6d3b\u3002 <settings> ... <activeProfiles> <activeProfile>profile-1</activeProfile> </activeProfiles> ... </settings> 3.\u5176\u4ed6 \u53ef\u4ee5\u57fa\u4e8e\u81ea\u52a8\u68c0\u6d4b\u6784\u5efa\u73af\u5883\u72b6\u6001\u6765\u89e6\u53d1 Profiles \uff0c\u8fd9\u4e9b\u89e6\u53d1\u5668\u901a\u8fc7 Profile \u81ea\u8eab\u7684\u5b50\u5143\u7d20 <activation> \u6765\u6307\u5b9a\u3002\u76ee\u524d\u89e6\u53d1\u5668\u53ea\u80fd\u68c0\u6d4b JDK \u7684\u5927\u7248\u672c\u3001\u7cfb\u7edf\u5c5e\u6027\u5b58\u5728\u4e0e\u5426\u4ee5\u53ca\u7cfb\u7edf\u5c5e\u6027\u7684\u503c\uff08\u8fd9\u91cc\u7684\u7cfb\u7edf\u5c5e\u6027\u6307\u7684\u662f\u547d\u4ee4\u884c\u53c2\u6570\u4e2d\u7684\u5c5e\u6027\u6216\u8005\u662f settings.xml \u6587\u4ef6\u7684\u5c5e\u6027\uff0c\u8be6\u89c1\u4e0b\u9762\u7684\u51e0\u4e2a\u4f8b\u5b50\uff09\u3002 \u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u4ee5 JDK \u5927\u7248\u672c\u4e3a 1.4 (\u4f8b\u5982\uff0c 1.4.0_08 , 1.4.2_07 )\u7684\u60c5\u51b5\u4e0b\u4f1a\u89e6\u53d1\u8be5 Profile <profiles> <profile> <activation> <jdk>1.4</jdk> </activation> ... </profile> </profiles> \u4f60\u4e5f\u53ef\u4ee5\u4ee5\u8303\u56f4\u7684\u5f62\u5f0f\u6765\u8bbe\u7f6e JDK \u7248\u672c\uff0c\u4e0b\u9762\u7684\u914d\u7f6e\u5c06\u4f1a\u5728 1.3, 1.4, 1.5 \u7248\u672c\u8d77\u4f5c\u7528 <profiles> <profile> <activation> <jdk>[1.3,1.6)</jdk> </activation> ... </profile> </profiles> Profile \u4e5f\u53ef\u4ee5\u901a\u8fc7\u64cd\u4f5c\u7cfb\u7edf\u53c2\u6570\u89e6\u53d1\uff0c\u5982\u4e0b <profiles> <profile> <activation> <os> <name>Windows XP</name> <family>Windows</family> <arch>x86</arch> <version>5.1.2600</version> </os> </activation> ... </profile> </profiles> \u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c Profile \u4f1a\u5728\u5c5e\u6027 debug \u672a\u5b9a\u4e49\u6216\u8005\u5b9a\u4e49\u4e3a\u975e true \u503c\u65f6\u88ab\u6fc0\u6d3b <profiles> <profile> <activation> <property> <name>debug</name> <value>!true</value> </property> </activation> ... </profile> </profiles> \u6fc0\u6d3b\u4e0a\u9762\u7684\u4f8b\u5b50\u53ef\u4ee5\u901a\u8fc7\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\u4e2d\u7684\u4e00\u4e2a mvn groupId:artifactId:goal mvn groupId:artifactId:goal -Ddebug=false \u4e0b\u9762\u7684\u4f8b\u5b50\u4f1a\u5728\u5c5e\u6027 environment \u7684\u503c\u88ab\u6307\u5b9a\u4e3a test \u65f6\u89e6\u53d1 <profiles> <profile> <activation> <property> <name>environment</name> <value>test</value> </property> </activation> ... </profile> </profiles> \u8981\u89e6\u53d1\u4e0a\u9762\u7684\u4f8b\u5b50\uff0c\u4f60\u53ef\u4ee5\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4 mvn groupId:artifactId:goal -Denvironment=test \u4e0b\u9762\u7684\u4f8b\u5b50\u4f1a\u5728\u6587\u4ef6 target/generated-sources/axistools/wsdl2java/org/apache/maven \u7f3a\u5931\u7684\u60c5\u51b5\u4e0b\u89e6\u53d1 Profile <profiles> <profile> <activation> <file> <missing>target/generated-sources/axistools/wsdl2java/org/apache/maven</missing> </file> </activation> ... </profile> </profiles> <exists> \u548c <missing> \u6807\u7b7e\u652f\u6301\u4ee5\u63d2\u503c\u7684\u5f62\u5f0f\u8d4b\u503c\uff0c\u4f46\u4ec5\u652f\u6301\u7cfb\u7edf\u5c5e\u6027(\u5982 ${user.home} )\u548c\u73af\u5883\u53d8\u91cf\uff08\u5982 ${env.HOME} \uff09\uff0c\u5e76\u4e0d\u652f\u6301\u7528\u6237\u5728 pom.xml \u81ea\u5b9a\u4e49\u7684\u5c5e\u6027\uff08 <properties> \u4e2d\u5b9a\u4e49\u7684\u5c5e\u6027\uff09\u3002 Profile \u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u6fc0\u6d3b\uff0c\u5982\u4e0b\uff1a <profiles> <profile> <id>profile-1</id> <activation> <activeByDefault>true</activeByDefault> </activation> ... </profile> </profiles> \u4f60\u4e5f\u53ef\u4ee5\u5728\u547d\u4ee4\u884c\u6267\u884c\u5728 Profile id \u524d\u6dfb\u52a0 \uff01 \u6216\u8005 - \u5b57\u7b26\u6765\u53d6\u6d88\u6fc0\u6d3b Profile \uff0c\u5982\u4e0b\uff1a mvn groupId:artifactId:goal -P !profile-1,!profile-2","title":"Profile\u7684\u89e6\u53d1\u7ec6\u8282"},{"location":"Maven/MavenProfile\u7b80\u4ecb/#profile_3","text":"\u4f60\u80fd\u591f\u5728 Profile \u4e2d\u6307\u5b9a\u7684\u5185\u5bb9\u53d6\u51b3\u4e8e\u4f60\u9009\u62e9\u5728\u4ec0\u4e48\u4f4d\u7f6e\u914d\u7f6e\u4f60\u7684 Profile \uff0c\u5f53\u914d\u7f6e\u4f4d\u7f6e\u4e0d\u540c\u65f6\u4f60\u80fd\u591f\u6307\u5b9a\u7684\u5185\u5bb9\u4e5f\u4e0d\u4e00\u6837\u3002 \u5728\u5916\u90e8\u6587\u4ef6\u4e2d\u914d\u7f6e Profile \u5728\u5916\u90e8\u6587\u4ef6\u4e2d\u914d\u7f6e Profile \uff08\u5373 settings.xml \u6216 profiles.xml \uff09\u5728\u4e25\u683c\u610f\u4e49\u4e0a\u662f\u4e0d\u53ef\u79fb\u690d\u7684\uff0c\u6240\u4ee5\u80fd\u591f\u5927\u6982\u7387\u6539\u53d8\u6784\u5efa\u7ed3\u6784\u7684\u5185\u5bb9\u53ea\u80fd\u5728 POM \u4e2d\u8fdb\u884c\u914d\u7f6e\u3002\u56e0\u6b64\uff0c\u4f60\u53ea\u80fd\u5728\u5916\u90e8\u6587\u4ef6\u4e2d\u4fee\u6539 <repositories>\u3001<pluginRepositories> \u4ee5\u53ca <properties> \u90e8\u5206\u3002 \u5728 POM \u4e2d\u914d\u7f6e Profile \u5982\u679c\u4f60\u53ef\u4ee5\u5728 POM \u4e2d\u5408\u7406\u5730\u914d\u7f6e Profile \uff0c\u90a3\u4f60\u5c06\u4f1a\u6709\u66f4\u591a\u7684\u914d\u7f6e\u9009\u9879\u3002\u8fd9\u6837\u4f60\u53ef\u4ee5\u4fdd\u7559\u66f4\u591a\u7684\u53ef\u79fb\u690d\u6027\uff0c\u5373\u53ef\u4ee5\u6dfb\u52a0\u66f4\u591a\u7684\u4fe1\u606f\u800c\u4e0d\u4f1a\u6709\u5176\u4ed6\u7528\u6237\u83b7\u5f97\u4e0d\u5230\u4fe1\u606f\u7684\u98ce\u9669\u3002\u5728 POM \u4e2d Profile \u53ef\u4ee5\u4fee\u6539\u4ee5\u4e0b\u5143\u7d20\uff1a <repositories> <pluginRepositories> <dependencies> <plugins> <properties> <modules> <reporting> <dependencyManagement> <distributionManagement> <build> \u5143\u7d20\u7684\u5b50\u96c6\uff0c\u7531\u4ee5\u4e0b\u5143\u7d20\u7ec4\u6210\uff1a <defaultGoal> <resources> <testResources> <finalName>","title":"\u5728Profile\u4e2d\u80fd\u591f\u6307\u5b9a\u7684\u5185\u5bb9"},{"location":"Maven/Maven\u6784\u5efa\u751f\u547d\u5468\u671f/","text":"\u6982\u8ff0 \u672c\u6587\u4e3b\u8981\u662f\u5bf9 Maven \u7684\u6784\u5efa\u751f\u547d\u5468\u671f\u8fdb\u884c\u7b80\u5355\u7684\u4ecb\u7ecd\u3002 \u672c\u6587\u7684\u4e3b\u8981\u662f\u7b14\u8005\u5bf9 Maven \u5b98\u65b9\u624b\u518c\u7684\u7ffb\u8bd1\u548c\u7406\u89e3\uff1a http://maven.apache.org/guides/introduction/introduction-to-the-pom.html \u53c2\u8003\u4e86W3Cschool\u7684 Maven \u6559\u7a0b\uff1a https://www.w3cschool.cn/maven/tkhr1ht6.html Maven\u7684\u6784\u5efa\u751f\u547d\u5468\u671f Maven\u7684\u6784\u5efa\u751f\u547d\u5468\u671f\u4e00\u5171\u6709\u4e09\u4e2a\uff1a\u5206\u522b\u662f default(build) \u3001 site \u548c clean \u3002 \u751f\u547d\u5468\u671f \u63cf\u8ff0 default(build) \u7528\u4e8e\u5904\u7406\u9879\u76ee\u90e8\u7f72 site \u7528\u4e8e\u521b\u5efa\u9879\u76ee\u7ad9\u70b9\u6587\u6863 clean \u7528\u4e8e\u6e05\u7406\u5176\u4ed6\u751f\u547d\u5468\u671f\u751f\u6210\u7684\u6587\u4ef6 Maven\u6784\u5efa\u751f\u547d\u5468\u671f\u662f\u7531\u591a\u4e2a\u6784\u5efa\u9636\u6bb5\u7ec4\u6210\u7684 \u4ee5default\u6784\u5efa\u751f\u547d\u5468\u671f\u4e3a\u4f8b\uff0c\u5b83\u7531\u4ee5\u4e0b\u51e0\u4e2a\u6784\u5efa\u9636\u6bb5\u7ec4\u6210 validate - \u68c0\u67e5\u5de5\u7a0b\u914d\u7f6e\u662f\u5426\u6b63\u786e\uff0c\u5b8c\u6210\u6784\u5efa\u8fc7\u7a0b\u7684\u6240\u6709\u5fc5\u8981\u4fe1\u606f\u662f\u5426\u80fd\u591f\u83b7\u53d6\u5230 compile - \u7f16\u8bd1\u5de5\u7a0b\u6e90\u7801 test - \u4f7f\u7528\u9002\u5f53\u7684\u5355\u5143\u6d4b\u8bd5\u6846\u67b6\uff08\u4f8b\u5982JUnit\uff09\u8fd0\u884c\u6d4b\u8bd5 package - \u83b7\u53d6\u7f16\u8bd1\u540e\u7684\u4ee3\u7801\uff0c\u5e76\u6309\u7167\u53ef\u53d1\u5e03\u7684\u683c\u5f0f\u8fdb\u884c\u6253\u5305\uff0c\u4f8b\u5982 JAR \u3001 WAR \u6216\u8005 EAR \u6587\u4ef6 verify - \u8fd0\u884c\u68c0\u67e5\u64cd\u4f5c\u6765\u9a8c\u8bc1\u5de5\u7a0b\u5305\u662f\u6709\u6548\u7684\uff0c\u5e76\u6ee1\u8db3\u8d28\u91cf\u8981\u6c42 install - \u5b89\u88c5\u5de5\u7a0b\u5305\u5230\u672c\u5730\u4ed3\u5e93\u4e2d\uff0c\u8be5\u4ed3\u5e93\u53ef\u4ee5\u4f5c\u4e3a\u672c\u5730\u5176\u4ed6\u5de5\u7a0b\u7684\u4f9d\u8d56 deploy - \u62f7\u8d1d\u6700\u7ec8\u7684\u5de5\u7a0b\u5305\u5230\u8fdc\u7a0b\u4ed3\u5e93\u4e2d\uff0c\u4ee5\u5171\u4eab\u7ed9\u5176\u4ed6\u5f00\u53d1\u4eba\u5458\u548c\u5de5\u7a0b \u8fd9\u4e9b\u751f\u547d\u5468\u671f\u9636\u6bb5\uff08\u4ee5\u53ca\u6b64\u5904\u672a\u663e\u793a\u7684\u5176\u4ed6\u751f\u547d\u5468\u671f\u9636\u6bb5\uff09\u5c06\u6309\u987a\u5e8f\u6267\u884c\uff0c\u4ee5\u5b8c\u6210\u9ed8\u8ba4\u751f\u547d\u5468\u671f\u3002 \u9274\u4e8e\u4e0a\u9762\u7684\u751f\u547d\u5468\u671f\u9636\u6bb5\uff0c\u8fd9\u610f\u5473\u7740\u5f53\u4f7f\u7528\u9ed8\u8ba4\u751f\u547d\u5468\u671f\u65f6\uff0c Maven \u5c06\u9996\u5148\u9a8c\u8bc1\u9879\u76ee\uff0c\u7136\u540e\u5c06\u5c1d\u8bd5\u7f16\u8bd1\u6e90\u4ee3\u7801\uff0c\u9488\u5bf9\u6d4b\u8bd5\u8fd0\u884c\uff0c\u6253\u5305\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u4f8b\u5982 jar \uff09\uff0c\u5bf9\u5176\u8fd0\u884c\u96c6\u6210\u6d4b\u8bd5\u5305\uff0c\u9a8c\u8bc1\u96c6\u6210\u6d4b\u8bd5\uff0c\u5c06\u7ecf\u8fc7\u9a8c\u8bc1\u7684\u8f6f\u4ef6\u5305\u5b89\u88c5\u5230\u672c\u5730\u5b58\u50a8\u5e93\uff0c\u7136\u540e\u5c06\u5df2\u5b89\u88c5\u7684\u8f6f\u4ef6\u5305\u90e8\u7f72\u5230\u8fdc\u7a0b\u5b58\u50a8\u5e93\u3002 \u6784\u5efa\u9636\u6bb5\u7531\u591a\u4e2a\u63d2\u4ef6\u76ee\u6807\u7ec4\u6210 \u63d2\u4ef6\u76ee\u6807\uff08goal\uff09\u8868\u793a\u7279\u5b9a\u4efb\u52a1\uff08\u6bd4\u6784\u5efa\u9636\u6bb5\u66f4\u7cbe\u7ec6\uff09\uff0c\u8fd9\u6709\u52a9\u4e8e\u6784\u5efa\u548c\u7ba1\u7406\u9879\u76ee\u3002 \u5b83\u53ef\u80fd\u7ed1\u5b9a\u5230\u96f6\u4e2a\u6216\u591a\u4e2a\u6784\u5efa\u9636\u6bb5\u3002\u6ca1\u6709\u7ed1\u5b9a\u4efb\u4f55\u6784\u5efa\u9636\u6bb5\u7684\u76ee\u6807\u53ef\u4ee5\u5728\u6784\u5efa\u751f\u547d\u5468\u671f\u4e4b\u5916\u88ab\u76f4\u63a5\u8c03\u7528\u6267\u884c\u3002\u6267\u884c\u987a\u5e8f\u53d6\u51b3\u4e8e\u8c03\u7528\u76ee\u6807\u548c\u6784\u5efa\u9636\u6bb5\u7684\u987a\u5e8f\u3002\u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u547d\u4ee4\u4e2d clean \u548c package \u53c2\u6570\u662f\u6784\u5efa\u9636\u6bb5\uff0c\u800c dependency:copy-dependencies \u662f\uff08\u63d2\u4ef6\u7684\uff09\u76ee\u6807\u3002 mvn clean dependency:copy-dependencies package \u8fd9\u91cc\u7684 clean \u9636\u6bb5\u5c06\u4f1a\u88ab\u9996\u5148\u6267\u884c\uff0c\u7136\u540e dependency:copy-dependencies \u76ee\u6807\u4f1a\u88ab\u6267\u884c\uff0c\u6700\u7ec8 package \u9636\u6bb5\u88ab\u6267\u884c\u3002 \u751f\u547d\u5468\u671f\u53c2\u8003 \u6709\u4e00\u4e9b\u4e0e Maven \u751f\u547d\u5468\u671f\u76f8\u5173\u7684\u91cd\u8981\u6982\u5ff5\u9700\u8981\u8bf4\u660e\uff1a\u5f53\u4e00\u4e2a\u9636\u6bb5\u901a\u8fc7 Maven \u547d\u4ee4\u8c03\u7528\u65f6\uff0c\u4f8b\u5982 mvn package \uff0c \u8be5\u9636\u6bb5\u4e4b\u524d\u4ee5\u53ca\u5305\u62ec\u8be5\u9636\u6bb5\u5728\u5185\u7684\u6240\u6709\u9636\u6bb5\u4f1a\u88ab\u6267\u884c \u3002\u4e0d\u540c\u7684 maven \u76ee\u6807\u5c06\u6839\u636e package \u7684\u7c7b\u578b\uff08 JAR / WAR / EAR/ POM \uff09\uff0c\u88ab\u7ed1\u5b9a\u5230\u4e0d\u540c\u7684 Maven \u751f\u547d\u5468\u671f\u9636\u6bb5\u3002 Clean\u751f\u547d\u5468\u671f \u751f\u547d\u5468\u671f\u9636\u6bb5 \u63cf\u8ff0 pre-clean \u5728\u5b9e\u9645\u9879\u76ee\u6e05\u7406\u4e4b\u524d\u6267\u884c\u6240\u9700\u7684\u8fc7\u7a0b clean \u5220\u9664\u4e4b\u524d\u6784\u5efa\u8fc7\u7a0b\u4e2d\u751f\u6210\u7684\u6240\u6709\u6587\u4ef6 post-clean \u6267\u884c\u5b8c\u6210\u9879\u76ee\u6e05\u7406\u6240\u9700\u7684\u8fc7\u7a0b Default\u751f\u547d\u5468\u671f \u751f\u547d\u5468\u671f\u9636\u6bb5 \u63cf\u8ff0 validate \u68c0\u67e5\u5de5\u7a0b\u914d\u7f6e\u662f\u5426\u6b63\u786e\uff0c\u5b8c\u6210\u6784\u5efa\u8fc7\u7a0b\u7684\u6240\u6709\u5fc5\u8981\u4fe1\u606f\u662f\u5426\u80fd\u591f\u83b7\u53d6\u5230\u3002 initialize \u521d\u59cb\u5316\u6784\u5efa\u72b6\u6001\uff0c\u4f8b\u5982\u8bbe\u7f6e\u5c5e\u6027\u3002 generate-sources \u751f\u6210\u7f16\u8bd1\u9636\u6bb5\u9700\u8981\u5305\u542b\u7684\u4efb\u4f55\u6e90\u7801\u6587\u4ef6\u3002 process-sources \u5904\u7406\u6e90\u4ee3\u7801\uff0c\u4f8b\u5982\uff0c\u8fc7\u6ee4\u4efb\u4f55\u503c\uff08filter any value\uff09\u3002 generate-resources \u751f\u6210\u5de5\u7a0b\u5305\u4e2d\u9700\u8981\u5305\u542b\u7684\u8d44\u6e90\u6587\u4ef6\u3002 process-resources \u62f7\u8d1d\u548c\u5904\u7406\u8d44\u6e90\u6587\u4ef6\u5230\u76ee\u7684\u76ee\u5f55\u4e2d\uff0c\u4e3a\u6253\u5305\u9636\u6bb5\u505a\u51c6\u5907\u3002 compile \u7f16\u8bd1\u5de5\u7a0b\u6e90\u7801\u3002 process-classes \u5904\u7406\u7f16\u8bd1\u751f\u6210\u7684\u6587\u4ef6\uff0c\u4f8b\u5982 Java Class \u5b57\u8282\u7801\u7684\u52a0\u5f3a\u548c\u4f18\u5316\u3002 generate-test-sources \u751f\u6210\u7f16\u8bd1\u9636\u6bb5\u9700\u8981\u5305\u542b\u7684\u4efb\u4f55\u6d4b\u8bd5\u6e90\u4ee3\u7801\u3002 process-test-sources \u5904\u7406\u6d4b\u8bd5\u6e90\u4ee3\u7801\uff0c\u4f8b\u5982\uff0c\u8fc7\u6ee4\u4efb\u4f55\u503c\uff08filter any values)\u3002 test-compile \u7f16\u8bd1\u6d4b\u8bd5\u6e90\u4ee3\u7801\u5230\u6d4b\u8bd5\u76ee\u7684\u76ee\u5f55\u3002 process-test-classes \u5904\u7406\u6d4b\u8bd5\u4ee3\u7801\u6587\u4ef6\u7f16\u8bd1\u540e\u751f\u6210\u7684\u6587\u4ef6\u3002 test \u4f7f\u7528\u9002\u5f53\u7684\u5355\u5143\u6d4b\u8bd5\u6846\u67b6\uff08\u4f8b\u5982JUnit\uff09\u8fd0\u884c\u6d4b\u8bd5\u3002 prepare-package \u5728\u771f\u6b63\u6253\u5305\u4e4b\u524d\uff0c\u4e3a\u51c6\u5907\u6253\u5305\u6267\u884c\u4efb\u4f55\u5fc5\u8981\u7684\u64cd\u4f5c\u3002 package \u83b7\u53d6\u7f16\u8bd1\u540e\u7684\u4ee3\u7801\uff0c\u5e76\u6309\u7167\u53ef\u53d1\u5e03\u7684\u683c\u5f0f\u8fdb\u884c\u6253\u5305\uff0c\u4f8b\u5982 JAR\u3001WAR \u6216\u8005 EAR \u6587\u4ef6\u3002 pre-integration-test \u5728\u96c6\u6210\u6d4b\u8bd5\u6267\u884c\u4e4b\u524d\uff0c\u6267\u884c\u6240\u9700\u7684\u64cd\u4f5c\u3002\u4f8b\u5982\uff0c\u8bbe\u7f6e\u6240\u9700\u7684\u73af\u5883\u53d8\u91cf\u3002 integration-test \u5904\u7406\u548c\u90e8\u7f72\u5fc5\u987b\u7684\u5de5\u7a0b\u5305\u5230\u96c6\u6210\u6d4b\u8bd5\u80fd\u591f\u8fd0\u884c\u7684\u73af\u5883\u4e2d\u3002 post-integration-test \u5728\u96c6\u6210\u6d4b\u8bd5\u88ab\u6267\u884c\u540e\u6267\u884c\u5fc5\u8981\u7684\u64cd\u4f5c\u3002\u4f8b\u5982\uff0c\u6e05\u7406\u73af\u5883\u3002 verify \u8fd0\u884c\u68c0\u67e5\u64cd\u4f5c\u6765\u9a8c\u8bc1\u5de5\u7a0b\u5305\u662f\u6709\u6548\u7684\uff0c\u5e76\u6ee1\u8db3\u8d28\u91cf\u8981\u6c42\u3002 install \u5b89\u88c5\u5de5\u7a0b\u5305\u5230\u672c\u5730\u4ed3\u5e93\u4e2d\uff0c\u8be5\u4ed3\u5e93\u53ef\u4ee5\u4f5c\u4e3a\u672c\u5730\u5176\u4ed6\u5de5\u7a0b\u7684\u4f9d\u8d56\u3002 deploy \u62f7\u8d1d\u6700\u7ec8\u7684\u5de5\u7a0b\u5305\u5230\u8fdc\u7a0b\u4ed3\u5e93\u4e2d\uff0c\u4ee5\u5171\u4eab\u7ed9\u5176\u4ed6\u5f00\u53d1\u4eba\u5458\u548c\u5de5\u7a0b\u3002 Site\u751f\u547d\u5468\u671f \u751f\u547d\u5468\u671f\u9636\u6bb5 \u63cf\u8ff0 pre-site \u5728\u5b9e\u9645\u9879\u76ee\u7ad9\u70b9\u751f\u6210\u4e4b\u524d\u6267\u884c\u6240\u9700\u7684\u8fc7\u7a0b site \u751f\u6210\u9879\u76ee\u7684\u7ad9\u70b9\u6587\u6863 post-site \u6267\u884c\u5b8c\u6210\u7ad9\u70b9\u751f\u6210\u6240\u9700\u7684\u6d41\u7a0b\uff0c\u5e76\u51c6\u5907\u7ad9\u70b9\u90e8\u7f72 site-deploy \u5c06\u751f\u6210\u7684\u7ad9\u70b9\u6587\u6863\u90e8\u7f72\u5230\u6307\u5b9a\u7684Web\u670d\u52a1\u5668 \u901a\u8fc7\u914d\u7f6e\u9879\u76ee\u6765\u4f7f\u7528\u6784\u5efa\u751f\u547d\u5468\u671f 1.Packaging \u6700\u5e38\u89c1\u7684\u65b9\u6cd5\u662f\u901a\u8fc7\u6307\u5b9a pom \u5143\u7d20 <packaging> \u7684\u7c7b\u578b\u6765\u7ed1\u5b9a\u5404\u6784\u5efa\u9636\u6bb5\u53ca\u5176\u5bf9\u5e94\u7684\u63d2\u4ef6\u76ee\u6807\u3002\u53ef\u7528\u7684\u6253\u5305\u7c7b\u578b\u4e3b\u8981\u6709 jar , war , ear \u548c pom \uff0c\u5982\u679c\u672a\u5728 pom.xml \u6587\u4ef6\u4e2d\u6307\u5b9a\u6253\u5305\u7c7b\u578b\uff0c\u5219\u4f1a\u88ab\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u503c jar \u3002 \u6bcf\u79cd\u6253\u5305\u7c7b\u578b\u5305\u542b\u4e00\u7cfb\u5217\u88ab\u7ed1\u5b9a\u5230\u7279\u5b9a\u6784\u5efa\u9636\u6bb5\u7684\u63d2\u4ef6\u76ee\u6807\u3002\u4f8b\u5982\uff0c jar \u7c7b\u578b\u5c06\u7ed1\u5b9a\u5982\u4e0b\u76ee\u6807\u4ee5\u6784\u5efa\u9ed8\u8ba4\u751f\u547d\u5468\u671f\u7684\u9636\u6bb5\u3002 Phase plugin:goal process-resources resources:resources compile compiler:compile process-test-resources resources:testResources test-compile compiler:testCompile test surefire:test package jar:jar install install:install deploy deploy:deploy \u5927\u90e8\u5206\u6253\u5305\u7c7b\u578b\u7684\u7ed1\u5b9a\u96c6\u76f8\u5dee\u4e0d\u5927\uff0c\u4f46\u662f\u6709\u4e00\u4e9b\u6253\u5305\u7c7b\u578b\u5374\u6bd4\u8f83\u7279\u6b8a\u3002\u4f8b\u5982\uff0c\u5f53\u6253\u5305\u7c7b\u578b\u4e3a pom \u7684\u9879\u76ee\u4ec5\u5c06\u76ee\u6807\u7ed1\u5b9a\u5230install\u548cdeploy\u9636\u6bb5\uff08\u6709\u5173\u67d0\u4e9b\u6253\u5305\u7c7b\u578b\u7684\u76ee\u6807\u5230\u6784\u5efa\u9636\u6bb5\u7ed1\u5b9a\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u9605 standard set of bindings \uff09\u3002 2.Plugins \u53e6\u4e00\u79cd\u6dfb\u52a0\u76ee\u6807\u5230\u6307\u5b9a\u9636\u6bb5\u7684\u65b9\u5f0f\u662f\u5728\u9879\u76ee\u4e2d\u914d\u7f6e\u63d2\u4ef6\u3002\u63d2\u4ef6\u5177\u6709\u4e00\u4e2a\u6216\u591a\u4e2a\u76ee\u6807\uff0c\u5176\u4e2d\u6bcf\u4e2a\u76ee\u6807\u8868\u793a\u8be5\u63d2\u4ef6\u7684\u80fd\u529b\u3002 \u4f8b\u5982\uff0c Compiler \u63d2\u4ef6\u6709\u4e24\u4e2a\u76ee\u6807\uff1a compile \u548c testCompile \u3002\u524d\u8005\u7f16\u8bd1\u4e3b\u4ee3\u7801\u7684\u6e90\u4ee3\u7801\uff0c\u540e\u8005\u7f16\u8bd1\u6d4b\u8bd5\u4ee3\u7801\u7684\u6e90\u4ee3\u7801\u3002 \u63d2\u4ef6\u53ef\u4ee5\u5305\u542b\u5c06\u76ee\u6807\u7ed1\u5b9a\u5230\u54ea\u4e2a\u751f\u547d\u5468\u671f\u9636\u6bb5\u7684\u4fe1\u606f\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u4ec5\u4ec5\u6307\u5b9a\u63d2\u4ef6\u672c\u8eab\u662f\u4e0d\u591f\u7684\uff0c\u5fc5\u987b\u8fd8\u8981\u6307\u660e\u5728\u6784\u5efa\u8fc7\u7a0b\u4e2d\u8981\u8fd0\u884c\u7684\u63d2\u4ef6\u76ee\u6807\u3002 \u76ee\u6807\u7684\u914d\u7f6e\u4f1a\u5e94\u7528\u5230\u5df2\u7ecf\u88ab\u7ed1\u5b9a\u5230\u6307\u5b9a\u6253\u5305\u7c7b\u578b\u7684\u76ee\u6807\u4e0a\u3002\u5982\u679c\u6709\u591a\u4e2a\u76ee\u6807\u7ed1\u5b9a\u4e00\u4e2a\u7279\u5b9a\u6784\u5efa\u9636\u6bb5\uff0c\u5219\u76ee\u6807\u7684\u8fd0\u884c\u987a\u5e8f\u662f\u5148\u6267\u884c\u7ed1\u5b9a\u5230\u6253\u5305\u7c7b\u578b\u4e0a\u7684\u76ee\u6807\uff0c\u7136\u540e\u518d\u6267\u884c pom \u6587\u4ef6\u4e2d\u914d\u7f6e\u7684\u76ee\u6807\u3002\u8fd9\u4e9b\u914d\u7f6e\u53ef\u4ee5\u4f7f\u7528 <executions> \u5143\u7d20\u6765\u8fdb\u884c\u8be6\u7ec6\u7684\u63a7\u5236\u3002 \u4f8b\u5b50 \u4f8b\u5982\uff0c Modello \u63d2\u4ef6\u7684\u76ee\u6807 modello:java \u88ab\u9ed8\u8ba4\u7ed1\u5b9a\u5230\u4e86 generate-sources \u9636\u6bb5\uff08\u6ce8\uff1a maven \u4e2d\u7684\u63d2\u4ef6\u76ee\u6807\u4e00\u822c\u4f1a\u6709\u9ed8\u8ba4\u7ed1\u5b9a\u7684\u9636\u6bb5\uff0c\u6240\u4ee5\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u7ed1\u5b9a\u9636\u6bb5\u5219\u76ee\u6807\u4f1a\u5728\u9ed8\u8ba4\u9636\u6bb5\u6267\u884c\uff0c \u8be6\u7ec6\u5185\u5bb9\u53ef\u89c1maven\u624b\u518c \u3002\u56e0\u6b64\uff0c\u8981\u4f7f\u7528 Modello \u63d2\u4ef6\u5e76\u5728\u6784\u5efa\u8fc7\u7a0b\u4e2d\u6267\u884c java \u76ee\u6807\uff0c\u53ef\u4ee5\u901a\u8fc7\u5728 pom \u6587\u4ef6\u4e2d\u7684 <build> \u7684\u5143\u7d20\u7684\u5b50\u5143\u7d20 <plugins> \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a <plugin> <groupId>org.codehaus.modello</groupId> <artifactId>modello-maven-plugin</artifactId> <version>1.8.1</version> <executions> <execution> <configuration> <models> <model>src/main/mdo/maven.mdo</model> </models> <version>4.0.0</version> </configuration> <goals> <goal>java</goal> </goals> </execution> </executions> </plugin> \u8bf7\u6ce8\u610f\uff0c\u5728 <executions> \u5143\u7d20\u4e2d <goal> \u5143\u7d20\u662f\u4e00\u5b9a\u8981\u6307\u5b9a\u7684\u3002\u5f53\u6709\u591a\u4e2a <execution> \u6307\u5b9a\u5230\u7279\u5b9a\u7684\u9636\u6bb5\u65f6\uff0c\u5b83\u4eec\u5c06\u6309\u7167 pom \u6587\u4ef6\u4e2d\u6307\u5b9a\u7684\u987a\u5e8f\u6267\u884c\uff0c\u5e76\u4e14\u5148\u6267\u884c\u5b50\u7c7b\u7684 <execution> \u3002 \u5bf9\u4e8e\u4e0a\u9762\u7684\u4f8b\u5b50\uff0c modello:java \u53ea\u4f1a\u5728\u5b83\u7684\u9ed8\u8ba4\u9636\u6bb5 generate-sources \u6267\u884c\uff0c\u4f46\u4f60\u53ef\u80fd\u4f1a\u6709\u81ea\u5df1\u6307\u5b9a\u9636\u6bb5\u7684\u9700\u6c42\u3002\u4f8b\u5982\uff0c\u5047\u8bbe\u76ee\u6807 display:time \u53ef\u4ee5\u8f93\u51fa\u5f53\u524d\u65f6\u95f4\u5230\u547d\u4ee4\u884c\uff0c\u5e76\u4e14\u4f60\u5e0c\u671b\u5b83\u5728 process-test-resources \u9636\u6bb5\u8fd0\u884c\u4ee5\u663e\u793a\u6d4b\u8bd5\u5f00\u59cb\u7684\u65f6\u95f4\u3002\u4f60\u53ef\u4ee5\u8fdb\u884c\u5982\u4e0b\u914d\u7f6e\uff1a <plugin> <groupId>com.mycompany.example</groupId> <artifactId>display-maven-plugin</artifactId> <version>1.0</version> <executions> <execution> <phase>process-test-resources</phase> <goals> <goal>time</goal> </goals> </execution> </executions> </plugin>","title":"Maven\u6784\u5efa\u751f\u547d\u5468\u671f"},{"location":"Maven/Maven\u6784\u5efa\u751f\u547d\u5468\u671f/#_1","text":"\u672c\u6587\u4e3b\u8981\u662f\u5bf9 Maven \u7684\u6784\u5efa\u751f\u547d\u5468\u671f\u8fdb\u884c\u7b80\u5355\u7684\u4ecb\u7ecd\u3002 \u672c\u6587\u7684\u4e3b\u8981\u662f\u7b14\u8005\u5bf9 Maven \u5b98\u65b9\u624b\u518c\u7684\u7ffb\u8bd1\u548c\u7406\u89e3\uff1a http://maven.apache.org/guides/introduction/introduction-to-the-pom.html \u53c2\u8003\u4e86W3Cschool\u7684 Maven \u6559\u7a0b\uff1a https://www.w3cschool.cn/maven/tkhr1ht6.html","title":"\u6982\u8ff0"},{"location":"Maven/Maven\u6784\u5efa\u751f\u547d\u5468\u671f/#maven","text":"Maven\u7684\u6784\u5efa\u751f\u547d\u5468\u671f\u4e00\u5171\u6709\u4e09\u4e2a\uff1a\u5206\u522b\u662f default(build) \u3001 site \u548c clean \u3002 \u751f\u547d\u5468\u671f \u63cf\u8ff0 default(build) \u7528\u4e8e\u5904\u7406\u9879\u76ee\u90e8\u7f72 site \u7528\u4e8e\u521b\u5efa\u9879\u76ee\u7ad9\u70b9\u6587\u6863 clean \u7528\u4e8e\u6e05\u7406\u5176\u4ed6\u751f\u547d\u5468\u671f\u751f\u6210\u7684\u6587\u4ef6","title":"Maven\u7684\u6784\u5efa\u751f\u547d\u5468\u671f"},{"location":"Maven/Maven\u6784\u5efa\u751f\u547d\u5468\u671f/#maven_1","text":"\u4ee5default\u6784\u5efa\u751f\u547d\u5468\u671f\u4e3a\u4f8b\uff0c\u5b83\u7531\u4ee5\u4e0b\u51e0\u4e2a\u6784\u5efa\u9636\u6bb5\u7ec4\u6210 validate - \u68c0\u67e5\u5de5\u7a0b\u914d\u7f6e\u662f\u5426\u6b63\u786e\uff0c\u5b8c\u6210\u6784\u5efa\u8fc7\u7a0b\u7684\u6240\u6709\u5fc5\u8981\u4fe1\u606f\u662f\u5426\u80fd\u591f\u83b7\u53d6\u5230 compile - \u7f16\u8bd1\u5de5\u7a0b\u6e90\u7801 test - \u4f7f\u7528\u9002\u5f53\u7684\u5355\u5143\u6d4b\u8bd5\u6846\u67b6\uff08\u4f8b\u5982JUnit\uff09\u8fd0\u884c\u6d4b\u8bd5 package - \u83b7\u53d6\u7f16\u8bd1\u540e\u7684\u4ee3\u7801\uff0c\u5e76\u6309\u7167\u53ef\u53d1\u5e03\u7684\u683c\u5f0f\u8fdb\u884c\u6253\u5305\uff0c\u4f8b\u5982 JAR \u3001 WAR \u6216\u8005 EAR \u6587\u4ef6 verify - \u8fd0\u884c\u68c0\u67e5\u64cd\u4f5c\u6765\u9a8c\u8bc1\u5de5\u7a0b\u5305\u662f\u6709\u6548\u7684\uff0c\u5e76\u6ee1\u8db3\u8d28\u91cf\u8981\u6c42 install - \u5b89\u88c5\u5de5\u7a0b\u5305\u5230\u672c\u5730\u4ed3\u5e93\u4e2d\uff0c\u8be5\u4ed3\u5e93\u53ef\u4ee5\u4f5c\u4e3a\u672c\u5730\u5176\u4ed6\u5de5\u7a0b\u7684\u4f9d\u8d56 deploy - \u62f7\u8d1d\u6700\u7ec8\u7684\u5de5\u7a0b\u5305\u5230\u8fdc\u7a0b\u4ed3\u5e93\u4e2d\uff0c\u4ee5\u5171\u4eab\u7ed9\u5176\u4ed6\u5f00\u53d1\u4eba\u5458\u548c\u5de5\u7a0b \u8fd9\u4e9b\u751f\u547d\u5468\u671f\u9636\u6bb5\uff08\u4ee5\u53ca\u6b64\u5904\u672a\u663e\u793a\u7684\u5176\u4ed6\u751f\u547d\u5468\u671f\u9636\u6bb5\uff09\u5c06\u6309\u987a\u5e8f\u6267\u884c\uff0c\u4ee5\u5b8c\u6210\u9ed8\u8ba4\u751f\u547d\u5468\u671f\u3002 \u9274\u4e8e\u4e0a\u9762\u7684\u751f\u547d\u5468\u671f\u9636\u6bb5\uff0c\u8fd9\u610f\u5473\u7740\u5f53\u4f7f\u7528\u9ed8\u8ba4\u751f\u547d\u5468\u671f\u65f6\uff0c Maven \u5c06\u9996\u5148\u9a8c\u8bc1\u9879\u76ee\uff0c\u7136\u540e\u5c06\u5c1d\u8bd5\u7f16\u8bd1\u6e90\u4ee3\u7801\uff0c\u9488\u5bf9\u6d4b\u8bd5\u8fd0\u884c\uff0c\u6253\u5305\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u4f8b\u5982 jar \uff09\uff0c\u5bf9\u5176\u8fd0\u884c\u96c6\u6210\u6d4b\u8bd5\u5305\uff0c\u9a8c\u8bc1\u96c6\u6210\u6d4b\u8bd5\uff0c\u5c06\u7ecf\u8fc7\u9a8c\u8bc1\u7684\u8f6f\u4ef6\u5305\u5b89\u88c5\u5230\u672c\u5730\u5b58\u50a8\u5e93\uff0c\u7136\u540e\u5c06\u5df2\u5b89\u88c5\u7684\u8f6f\u4ef6\u5305\u90e8\u7f72\u5230\u8fdc\u7a0b\u5b58\u50a8\u5e93\u3002","title":"Maven\u6784\u5efa\u751f\u547d\u5468\u671f\u662f\u7531\u591a\u4e2a\u6784\u5efa\u9636\u6bb5\u7ec4\u6210\u7684"},{"location":"Maven/Maven\u6784\u5efa\u751f\u547d\u5468\u671f/#_2","text":"\u63d2\u4ef6\u76ee\u6807\uff08goal\uff09\u8868\u793a\u7279\u5b9a\u4efb\u52a1\uff08\u6bd4\u6784\u5efa\u9636\u6bb5\u66f4\u7cbe\u7ec6\uff09\uff0c\u8fd9\u6709\u52a9\u4e8e\u6784\u5efa\u548c\u7ba1\u7406\u9879\u76ee\u3002 \u5b83\u53ef\u80fd\u7ed1\u5b9a\u5230\u96f6\u4e2a\u6216\u591a\u4e2a\u6784\u5efa\u9636\u6bb5\u3002\u6ca1\u6709\u7ed1\u5b9a\u4efb\u4f55\u6784\u5efa\u9636\u6bb5\u7684\u76ee\u6807\u53ef\u4ee5\u5728\u6784\u5efa\u751f\u547d\u5468\u671f\u4e4b\u5916\u88ab\u76f4\u63a5\u8c03\u7528\u6267\u884c\u3002\u6267\u884c\u987a\u5e8f\u53d6\u51b3\u4e8e\u8c03\u7528\u76ee\u6807\u548c\u6784\u5efa\u9636\u6bb5\u7684\u987a\u5e8f\u3002\u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u547d\u4ee4\u4e2d clean \u548c package \u53c2\u6570\u662f\u6784\u5efa\u9636\u6bb5\uff0c\u800c dependency:copy-dependencies \u662f\uff08\u63d2\u4ef6\u7684\uff09\u76ee\u6807\u3002 mvn clean dependency:copy-dependencies package \u8fd9\u91cc\u7684 clean \u9636\u6bb5\u5c06\u4f1a\u88ab\u9996\u5148\u6267\u884c\uff0c\u7136\u540e dependency:copy-dependencies \u76ee\u6807\u4f1a\u88ab\u6267\u884c\uff0c\u6700\u7ec8 package \u9636\u6bb5\u88ab\u6267\u884c\u3002","title":"\u6784\u5efa\u9636\u6bb5\u7531\u591a\u4e2a\u63d2\u4ef6\u76ee\u6807\u7ec4\u6210"},{"location":"Maven/Maven\u6784\u5efa\u751f\u547d\u5468\u671f/#_3","text":"\u6709\u4e00\u4e9b\u4e0e Maven \u751f\u547d\u5468\u671f\u76f8\u5173\u7684\u91cd\u8981\u6982\u5ff5\u9700\u8981\u8bf4\u660e\uff1a\u5f53\u4e00\u4e2a\u9636\u6bb5\u901a\u8fc7 Maven \u547d\u4ee4\u8c03\u7528\u65f6\uff0c\u4f8b\u5982 mvn package \uff0c \u8be5\u9636\u6bb5\u4e4b\u524d\u4ee5\u53ca\u5305\u62ec\u8be5\u9636\u6bb5\u5728\u5185\u7684\u6240\u6709\u9636\u6bb5\u4f1a\u88ab\u6267\u884c \u3002\u4e0d\u540c\u7684 maven \u76ee\u6807\u5c06\u6839\u636e package \u7684\u7c7b\u578b\uff08 JAR / WAR / EAR/ POM \uff09\uff0c\u88ab\u7ed1\u5b9a\u5230\u4e0d\u540c\u7684 Maven \u751f\u547d\u5468\u671f\u9636\u6bb5\u3002","title":"\u751f\u547d\u5468\u671f\u53c2\u8003"},{"location":"Maven/Maven\u6784\u5efa\u751f\u547d\u5468\u671f/#clean","text":"\u751f\u547d\u5468\u671f\u9636\u6bb5 \u63cf\u8ff0 pre-clean \u5728\u5b9e\u9645\u9879\u76ee\u6e05\u7406\u4e4b\u524d\u6267\u884c\u6240\u9700\u7684\u8fc7\u7a0b clean \u5220\u9664\u4e4b\u524d\u6784\u5efa\u8fc7\u7a0b\u4e2d\u751f\u6210\u7684\u6240\u6709\u6587\u4ef6 post-clean \u6267\u884c\u5b8c\u6210\u9879\u76ee\u6e05\u7406\u6240\u9700\u7684\u8fc7\u7a0b","title":"Clean\u751f\u547d\u5468\u671f"},{"location":"Maven/Maven\u6784\u5efa\u751f\u547d\u5468\u671f/#default","text":"\u751f\u547d\u5468\u671f\u9636\u6bb5 \u63cf\u8ff0 validate \u68c0\u67e5\u5de5\u7a0b\u914d\u7f6e\u662f\u5426\u6b63\u786e\uff0c\u5b8c\u6210\u6784\u5efa\u8fc7\u7a0b\u7684\u6240\u6709\u5fc5\u8981\u4fe1\u606f\u662f\u5426\u80fd\u591f\u83b7\u53d6\u5230\u3002 initialize \u521d\u59cb\u5316\u6784\u5efa\u72b6\u6001\uff0c\u4f8b\u5982\u8bbe\u7f6e\u5c5e\u6027\u3002 generate-sources \u751f\u6210\u7f16\u8bd1\u9636\u6bb5\u9700\u8981\u5305\u542b\u7684\u4efb\u4f55\u6e90\u7801\u6587\u4ef6\u3002 process-sources \u5904\u7406\u6e90\u4ee3\u7801\uff0c\u4f8b\u5982\uff0c\u8fc7\u6ee4\u4efb\u4f55\u503c\uff08filter any value\uff09\u3002 generate-resources \u751f\u6210\u5de5\u7a0b\u5305\u4e2d\u9700\u8981\u5305\u542b\u7684\u8d44\u6e90\u6587\u4ef6\u3002 process-resources \u62f7\u8d1d\u548c\u5904\u7406\u8d44\u6e90\u6587\u4ef6\u5230\u76ee\u7684\u76ee\u5f55\u4e2d\uff0c\u4e3a\u6253\u5305\u9636\u6bb5\u505a\u51c6\u5907\u3002 compile \u7f16\u8bd1\u5de5\u7a0b\u6e90\u7801\u3002 process-classes \u5904\u7406\u7f16\u8bd1\u751f\u6210\u7684\u6587\u4ef6\uff0c\u4f8b\u5982 Java Class \u5b57\u8282\u7801\u7684\u52a0\u5f3a\u548c\u4f18\u5316\u3002 generate-test-sources \u751f\u6210\u7f16\u8bd1\u9636\u6bb5\u9700\u8981\u5305\u542b\u7684\u4efb\u4f55\u6d4b\u8bd5\u6e90\u4ee3\u7801\u3002 process-test-sources \u5904\u7406\u6d4b\u8bd5\u6e90\u4ee3\u7801\uff0c\u4f8b\u5982\uff0c\u8fc7\u6ee4\u4efb\u4f55\u503c\uff08filter any values)\u3002 test-compile \u7f16\u8bd1\u6d4b\u8bd5\u6e90\u4ee3\u7801\u5230\u6d4b\u8bd5\u76ee\u7684\u76ee\u5f55\u3002 process-test-classes \u5904\u7406\u6d4b\u8bd5\u4ee3\u7801\u6587\u4ef6\u7f16\u8bd1\u540e\u751f\u6210\u7684\u6587\u4ef6\u3002 test \u4f7f\u7528\u9002\u5f53\u7684\u5355\u5143\u6d4b\u8bd5\u6846\u67b6\uff08\u4f8b\u5982JUnit\uff09\u8fd0\u884c\u6d4b\u8bd5\u3002 prepare-package \u5728\u771f\u6b63\u6253\u5305\u4e4b\u524d\uff0c\u4e3a\u51c6\u5907\u6253\u5305\u6267\u884c\u4efb\u4f55\u5fc5\u8981\u7684\u64cd\u4f5c\u3002 package \u83b7\u53d6\u7f16\u8bd1\u540e\u7684\u4ee3\u7801\uff0c\u5e76\u6309\u7167\u53ef\u53d1\u5e03\u7684\u683c\u5f0f\u8fdb\u884c\u6253\u5305\uff0c\u4f8b\u5982 JAR\u3001WAR \u6216\u8005 EAR \u6587\u4ef6\u3002 pre-integration-test \u5728\u96c6\u6210\u6d4b\u8bd5\u6267\u884c\u4e4b\u524d\uff0c\u6267\u884c\u6240\u9700\u7684\u64cd\u4f5c\u3002\u4f8b\u5982\uff0c\u8bbe\u7f6e\u6240\u9700\u7684\u73af\u5883\u53d8\u91cf\u3002 integration-test \u5904\u7406\u548c\u90e8\u7f72\u5fc5\u987b\u7684\u5de5\u7a0b\u5305\u5230\u96c6\u6210\u6d4b\u8bd5\u80fd\u591f\u8fd0\u884c\u7684\u73af\u5883\u4e2d\u3002 post-integration-test \u5728\u96c6\u6210\u6d4b\u8bd5\u88ab\u6267\u884c\u540e\u6267\u884c\u5fc5\u8981\u7684\u64cd\u4f5c\u3002\u4f8b\u5982\uff0c\u6e05\u7406\u73af\u5883\u3002 verify \u8fd0\u884c\u68c0\u67e5\u64cd\u4f5c\u6765\u9a8c\u8bc1\u5de5\u7a0b\u5305\u662f\u6709\u6548\u7684\uff0c\u5e76\u6ee1\u8db3\u8d28\u91cf\u8981\u6c42\u3002 install \u5b89\u88c5\u5de5\u7a0b\u5305\u5230\u672c\u5730\u4ed3\u5e93\u4e2d\uff0c\u8be5\u4ed3\u5e93\u53ef\u4ee5\u4f5c\u4e3a\u672c\u5730\u5176\u4ed6\u5de5\u7a0b\u7684\u4f9d\u8d56\u3002 deploy \u62f7\u8d1d\u6700\u7ec8\u7684\u5de5\u7a0b\u5305\u5230\u8fdc\u7a0b\u4ed3\u5e93\u4e2d\uff0c\u4ee5\u5171\u4eab\u7ed9\u5176\u4ed6\u5f00\u53d1\u4eba\u5458\u548c\u5de5\u7a0b\u3002","title":"Default\u751f\u547d\u5468\u671f"},{"location":"Maven/Maven\u6784\u5efa\u751f\u547d\u5468\u671f/#site","text":"\u751f\u547d\u5468\u671f\u9636\u6bb5 \u63cf\u8ff0 pre-site \u5728\u5b9e\u9645\u9879\u76ee\u7ad9\u70b9\u751f\u6210\u4e4b\u524d\u6267\u884c\u6240\u9700\u7684\u8fc7\u7a0b site \u751f\u6210\u9879\u76ee\u7684\u7ad9\u70b9\u6587\u6863 post-site \u6267\u884c\u5b8c\u6210\u7ad9\u70b9\u751f\u6210\u6240\u9700\u7684\u6d41\u7a0b\uff0c\u5e76\u51c6\u5907\u7ad9\u70b9\u90e8\u7f72 site-deploy \u5c06\u751f\u6210\u7684\u7ad9\u70b9\u6587\u6863\u90e8\u7f72\u5230\u6307\u5b9a\u7684Web\u670d\u52a1\u5668","title":"Site\u751f\u547d\u5468\u671f"},{"location":"Maven/Maven\u6784\u5efa\u751f\u547d\u5468\u671f/#_4","text":"","title":"\u901a\u8fc7\u914d\u7f6e\u9879\u76ee\u6765\u4f7f\u7528\u6784\u5efa\u751f\u547d\u5468\u671f"},{"location":"Maven/Maven\u6784\u5efa\u751f\u547d\u5468\u671f/#1packaging","text":"\u6700\u5e38\u89c1\u7684\u65b9\u6cd5\u662f\u901a\u8fc7\u6307\u5b9a pom \u5143\u7d20 <packaging> \u7684\u7c7b\u578b\u6765\u7ed1\u5b9a\u5404\u6784\u5efa\u9636\u6bb5\u53ca\u5176\u5bf9\u5e94\u7684\u63d2\u4ef6\u76ee\u6807\u3002\u53ef\u7528\u7684\u6253\u5305\u7c7b\u578b\u4e3b\u8981\u6709 jar , war , ear \u548c pom \uff0c\u5982\u679c\u672a\u5728 pom.xml \u6587\u4ef6\u4e2d\u6307\u5b9a\u6253\u5305\u7c7b\u578b\uff0c\u5219\u4f1a\u88ab\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u503c jar \u3002 \u6bcf\u79cd\u6253\u5305\u7c7b\u578b\u5305\u542b\u4e00\u7cfb\u5217\u88ab\u7ed1\u5b9a\u5230\u7279\u5b9a\u6784\u5efa\u9636\u6bb5\u7684\u63d2\u4ef6\u76ee\u6807\u3002\u4f8b\u5982\uff0c jar \u7c7b\u578b\u5c06\u7ed1\u5b9a\u5982\u4e0b\u76ee\u6807\u4ee5\u6784\u5efa\u9ed8\u8ba4\u751f\u547d\u5468\u671f\u7684\u9636\u6bb5\u3002 Phase plugin:goal process-resources resources:resources compile compiler:compile process-test-resources resources:testResources test-compile compiler:testCompile test surefire:test package jar:jar install install:install deploy deploy:deploy \u5927\u90e8\u5206\u6253\u5305\u7c7b\u578b\u7684\u7ed1\u5b9a\u96c6\u76f8\u5dee\u4e0d\u5927\uff0c\u4f46\u662f\u6709\u4e00\u4e9b\u6253\u5305\u7c7b\u578b\u5374\u6bd4\u8f83\u7279\u6b8a\u3002\u4f8b\u5982\uff0c\u5f53\u6253\u5305\u7c7b\u578b\u4e3a pom \u7684\u9879\u76ee\u4ec5\u5c06\u76ee\u6807\u7ed1\u5b9a\u5230install\u548cdeploy\u9636\u6bb5\uff08\u6709\u5173\u67d0\u4e9b\u6253\u5305\u7c7b\u578b\u7684\u76ee\u6807\u5230\u6784\u5efa\u9636\u6bb5\u7ed1\u5b9a\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u9605 standard set of bindings \uff09\u3002","title":"1.Packaging"},{"location":"Maven/Maven\u6784\u5efa\u751f\u547d\u5468\u671f/#2plugins","text":"\u53e6\u4e00\u79cd\u6dfb\u52a0\u76ee\u6807\u5230\u6307\u5b9a\u9636\u6bb5\u7684\u65b9\u5f0f\u662f\u5728\u9879\u76ee\u4e2d\u914d\u7f6e\u63d2\u4ef6\u3002\u63d2\u4ef6\u5177\u6709\u4e00\u4e2a\u6216\u591a\u4e2a\u76ee\u6807\uff0c\u5176\u4e2d\u6bcf\u4e2a\u76ee\u6807\u8868\u793a\u8be5\u63d2\u4ef6\u7684\u80fd\u529b\u3002 \u4f8b\u5982\uff0c Compiler \u63d2\u4ef6\u6709\u4e24\u4e2a\u76ee\u6807\uff1a compile \u548c testCompile \u3002\u524d\u8005\u7f16\u8bd1\u4e3b\u4ee3\u7801\u7684\u6e90\u4ee3\u7801\uff0c\u540e\u8005\u7f16\u8bd1\u6d4b\u8bd5\u4ee3\u7801\u7684\u6e90\u4ee3\u7801\u3002 \u63d2\u4ef6\u53ef\u4ee5\u5305\u542b\u5c06\u76ee\u6807\u7ed1\u5b9a\u5230\u54ea\u4e2a\u751f\u547d\u5468\u671f\u9636\u6bb5\u7684\u4fe1\u606f\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u4ec5\u4ec5\u6307\u5b9a\u63d2\u4ef6\u672c\u8eab\u662f\u4e0d\u591f\u7684\uff0c\u5fc5\u987b\u8fd8\u8981\u6307\u660e\u5728\u6784\u5efa\u8fc7\u7a0b\u4e2d\u8981\u8fd0\u884c\u7684\u63d2\u4ef6\u76ee\u6807\u3002 \u76ee\u6807\u7684\u914d\u7f6e\u4f1a\u5e94\u7528\u5230\u5df2\u7ecf\u88ab\u7ed1\u5b9a\u5230\u6307\u5b9a\u6253\u5305\u7c7b\u578b\u7684\u76ee\u6807\u4e0a\u3002\u5982\u679c\u6709\u591a\u4e2a\u76ee\u6807\u7ed1\u5b9a\u4e00\u4e2a\u7279\u5b9a\u6784\u5efa\u9636\u6bb5\uff0c\u5219\u76ee\u6807\u7684\u8fd0\u884c\u987a\u5e8f\u662f\u5148\u6267\u884c\u7ed1\u5b9a\u5230\u6253\u5305\u7c7b\u578b\u4e0a\u7684\u76ee\u6807\uff0c\u7136\u540e\u518d\u6267\u884c pom \u6587\u4ef6\u4e2d\u914d\u7f6e\u7684\u76ee\u6807\u3002\u8fd9\u4e9b\u914d\u7f6e\u53ef\u4ee5\u4f7f\u7528 <executions> \u5143\u7d20\u6765\u8fdb\u884c\u8be6\u7ec6\u7684\u63a7\u5236\u3002","title":"2.Plugins"},{"location":"Maven/Maven\u6784\u5efa\u751f\u547d\u5468\u671f/#_5","text":"\u4f8b\u5982\uff0c Modello \u63d2\u4ef6\u7684\u76ee\u6807 modello:java \u88ab\u9ed8\u8ba4\u7ed1\u5b9a\u5230\u4e86 generate-sources \u9636\u6bb5\uff08\u6ce8\uff1a maven \u4e2d\u7684\u63d2\u4ef6\u76ee\u6807\u4e00\u822c\u4f1a\u6709\u9ed8\u8ba4\u7ed1\u5b9a\u7684\u9636\u6bb5\uff0c\u6240\u4ee5\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u7ed1\u5b9a\u9636\u6bb5\u5219\u76ee\u6807\u4f1a\u5728\u9ed8\u8ba4\u9636\u6bb5\u6267\u884c\uff0c \u8be6\u7ec6\u5185\u5bb9\u53ef\u89c1maven\u624b\u518c \u3002\u56e0\u6b64\uff0c\u8981\u4f7f\u7528 Modello \u63d2\u4ef6\u5e76\u5728\u6784\u5efa\u8fc7\u7a0b\u4e2d\u6267\u884c java \u76ee\u6807\uff0c\u53ef\u4ee5\u901a\u8fc7\u5728 pom \u6587\u4ef6\u4e2d\u7684 <build> \u7684\u5143\u7d20\u7684\u5b50\u5143\u7d20 <plugins> \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a <plugin> <groupId>org.codehaus.modello</groupId> <artifactId>modello-maven-plugin</artifactId> <version>1.8.1</version> <executions> <execution> <configuration> <models> <model>src/main/mdo/maven.mdo</model> </models> <version>4.0.0</version> </configuration> <goals> <goal>java</goal> </goals> </execution> </executions> </plugin> \u8bf7\u6ce8\u610f\uff0c\u5728 <executions> \u5143\u7d20\u4e2d <goal> \u5143\u7d20\u662f\u4e00\u5b9a\u8981\u6307\u5b9a\u7684\u3002\u5f53\u6709\u591a\u4e2a <execution> \u6307\u5b9a\u5230\u7279\u5b9a\u7684\u9636\u6bb5\u65f6\uff0c\u5b83\u4eec\u5c06\u6309\u7167 pom \u6587\u4ef6\u4e2d\u6307\u5b9a\u7684\u987a\u5e8f\u6267\u884c\uff0c\u5e76\u4e14\u5148\u6267\u884c\u5b50\u7c7b\u7684 <execution> \u3002 \u5bf9\u4e8e\u4e0a\u9762\u7684\u4f8b\u5b50\uff0c modello:java \u53ea\u4f1a\u5728\u5b83\u7684\u9ed8\u8ba4\u9636\u6bb5 generate-sources \u6267\u884c\uff0c\u4f46\u4f60\u53ef\u80fd\u4f1a\u6709\u81ea\u5df1\u6307\u5b9a\u9636\u6bb5\u7684\u9700\u6c42\u3002\u4f8b\u5982\uff0c\u5047\u8bbe\u76ee\u6807 display:time \u53ef\u4ee5\u8f93\u51fa\u5f53\u524d\u65f6\u95f4\u5230\u547d\u4ee4\u884c\uff0c\u5e76\u4e14\u4f60\u5e0c\u671b\u5b83\u5728 process-test-resources \u9636\u6bb5\u8fd0\u884c\u4ee5\u663e\u793a\u6d4b\u8bd5\u5f00\u59cb\u7684\u65f6\u95f4\u3002\u4f60\u53ef\u4ee5\u8fdb\u884c\u5982\u4e0b\u914d\u7f6e\uff1a <plugin> <groupId>com.mycompany.example</groupId> <artifactId>display-maven-plugin</artifactId> <version>1.0</version> <executions> <execution> <phase>process-test-resources</phase> <goals> <goal>time</goal> </goals> </execution> </executions> </plugin>","title":"\u4f8b\u5b50"},{"location":"Maven/Maven\u6982\u8ff0/","text":"\u6982\u8ff0 \u672c\u6587\u5c06\u4ee5\u4e3e\u4f8b\u7684\u65b9\u5f0f\u5bf9 Maven \u5e38\u7528\u90e8\u5206\u8fdb\u884c\u8bf4\u660e\u3002 \u672c\u6587\u7684\u4e3b\u8981\u662f\u7b14\u8005\u5bf9 Maven \u5b98\u65b9\u624b\u518c\u7684\u7ffb\u8bd1\u548c\u7406\u89e3\uff1a http://maven.apache.org/guides/getting-started/index.html \u53c2\u8003\u4e86W3Cschool\u7684 Maven \u6559\u7a0b\uff1a https://www.w3cschool.cn/maven/u7oe1ht0.html \u5982\u4f55\u521b\u5efa\u4e00\u4e2aMaven\u9879\u76ee \u73b0\u5728\u4e00\u822c\u90fd\u662f\u4f7f\u7528 IDE \u4ee5\u66f4\u4eba\u6027\u5316\u7684\u65b9\u5f0f\u521b\u5efa Maven \u9879\u76ee\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528 Maven \u7684 \u539f\u578b\uff08archetype\uff09 \u63d2\u4ef6\u6765\u521b\u5efa\u9879\u76ee\uff0c\u5728\u547d\u4ee4\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a mvn archetype:generate -DgroupId=com.mycompany.app \\ -DartifactId=my-app \\ -DarchetypeArtifactId=maven-archetype-quickstart \\ -DinteractiveMode=false \u6267\u884c\u8be5\u547d\u4ee4\u540e\uff0c\u5728\u6267\u884c\u8be5\u547d\u4ee4\u7684\u6587\u4ef6\u5939\u4e0b\u4f1a\u751f\u6210\u4e00\u4e2a\u540d\u4e3a my-app \u7684\u9879\u76ee\uff0c\u5e76\u4e14 my-app \u6587\u4ef6\u5939\u4e0b\u5305\u542b\u4e86\u4e00\u4e2a pom.xml \u6587\u4ef6\uff0c\u8be5\u6587\u4ef6\u7684\u5185\u5bb9\u7c7b\u4f3c\u4e8e\uff1a <project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"> <modelVersion>4.0.0</modelVersion> <groupId>com.mycompany.app</groupId> <artifactId>my-app</artifactId> <packaging>jar</packaging> <version>1.0-SNAPSHOT</version> <name>Maven Quick Start Archetype</name> <url>http://maven.apache.org</url> <dependencies> <dependency> <groupId>junit</groupId> <artifactId>junit</artifactId> <version>4.11</version> <scope>test</scope> </dependency> </dependencies> </project> pom.xml \u5305\u542b\u4e86\u6b64\u9879\u76ee\u7684\u9879\u76ee\u5bf9\u8c61\u6a21\u578b\uff08 Project Object Model \uff09\uff0c POM \u662f Maven \u7684\u57fa\u672c\u5de5\u4f5c\u5355\u5143\uff0c\u7b80\u800c\u8a00\u4e4b\u5c31\u662f pom.xml \u4e2d\u5305\u542b\u4e86\u4f60\u9879\u76ee\u6240\u6709\u91cd\u8981\u7684\u4fe1\u606f\uff0c\u80fd\u591f\u67e5\u627e\u9879\u76ee\u7684\u4e00\u5207\u76f8\u5173\u5185\u5bb9\u3002\u5173\u4e8e POM \u7684\u4ecb\u7ecd\uff0c\u53ef\u4ee5\u67e5\u770b POM \u7b80\u4ecb \u3002 \u4e0b\u9762\u6211\u4eec\u5c06\u9010\u4e00\u4ecb\u7ecd\u8fd9\u4e2a\u7b80\u5355\u7684 POM \u51e0\u4e2a\u5173\u952e\u5143\u7d20\uff1a project \u8fd9\u662f\u6240\u6709 Maven pom.xml \u6587\u4ef6\u4e2d\u7684\u6839\u5143\u7d20 modelVersion \u6b64\u5143\u7d20\u8868\u793a POM \u4f7f\u7528\u7684\u5bf9\u8c61\u6a21\u578b\u7248\u672c\uff0c\u5bf9\u8c61\u6a21\u578b\u7248\u672c\u5f88\u5c11\u53d1\u751f\u53d8\u5316\u3002 groupId \u6b64\u5143\u7d20\u8868\u793a\u521b\u5efa\u9879\u76ee\u7684\u7ec4\u7ec7\u7684\u552f\u4e00\u6807\u8bc6\u7b26\uff0c groupId \u662f\u9879\u76ee\u7684\u5173\u952e\u6807\u8bc6\u7b26\u4e4b\u4e00\uff0c\u901a\u5e38\u57fa\u4e8e\u7ec4\u7ec7\u7684\u5b8c\u5168\u9650\u5b9a\u57df\u540d artifactId \u6b64\u5143\u7d20\u8868\u793a\u8be5\u9879\u76ee\u751f\u6210\u7684\u5de5\u4ef6\u552f\u4e00\u57fa\u672c\u540d\u79f0\uff0c\u9879\u76ee\u751f\u6210\u7684\u5de5\u4ef6\u901a\u5e38\u662f JAR \u6587\u4ef6\u3002\u7531 Maven \u751f\u6210\u7684\u5178\u578b\u5de5\u4ef6\u5177\u6709 <artifactId>-<version>.<extension> \u5f62\u5f0f\uff08\u4f8b\u5982\uff0c myapp-1.0.jar \uff09\u3002 packaging \u6b64\u5143\u7d20\u8868\u793a\u5de5\u4ef6\u7684\u6253\u5305\u7c7b\u578b\uff08\u4f8b\u5982 JAR , WAR , EAR \u7b49\uff09\u3002\u8fd9\u4e0d\u4ec5\u610f\u5473\u7740\u751f\u6210\u7684\u5de5\u65f6 JAR , WAR \u6216\u662f EAR \uff0c\u800c\u4e14\u8fd8\u5c06\u8868\u660e\u7279\u5b9a\u7684\u751f\u547d\u5468\u671f\u5c06\u4f1a\u88ab\u7ed1\u5b9a\u6784\u5efa\u8fc7\u7a0b\u4e2d\u3002\uff08\u8be6\u89c1 Maven\u7684\u6784\u5efa\u751f\u547d\u5468\u671f \uff09 version \u6b64\u5143\u7d20\u8868\u793a\u9879\u76ee\u751f\u6210\u7684\u5de5\u4ef6\u7684\u7248\u672c\u3002 name \u6b64\u5143\u7d20\u8868\u660e\u9879\u76ee\u7684\u663e\u793a\u540d\u79f0\uff0c\u5e38\u7528\u4e8e Maven \u6587\u6863\u7684\u751f\u6210\u3002 url \u6b64\u5143\u7d20\u8868\u660e\u9879\u76ee\u7684\u7ad9\u70b9\u7f51\u5740\uff0c\u5e38\u7528\u4e8e Maven \u6587\u6863\u7684\u751f\u6210\u3002 description \u6b64\u5143\u7d20\u63d0\u4f9b\u9879\u76ee\u7684\u57fa\u672c\u63cf\u8ff0\uff0c\u5e38\u7528\u4e8e Maven \u6587\u6863\u7684\u751f\u6210\u3002 \u6709\u5173 POM \u4e2d\u80fd\u591f\u4f7f\u7528\u7684\u5143\u7d20\u66f4\u52a0\u5b8c\u6574\u7684\u53c2\u8003\uff0c\u8bf7\u53c2\u9605\u5b98\u65b9\u7684 POM Reference \u3002 \u4f7f\u7528 archetype \u63d2\u4ef6\u751f\u6210\u9879\u76ee\u540e\uff0c\u4f60\u53ef\u4ee5\u770b\u5230\u5982\u4e0b\u7684\u76ee\u5f55\u7ed3\u6784\u88ab\u521b\u5efa\uff1a my-app |-- pom.xml `-- src |-- main | `-- java | `-- com | `-- mycompany | `-- app | `-- App.java `-- test `-- java `-- com `-- mycompany `-- app `-- AppTest.java \u5982\u4f60\u6240\u89c1\uff0c\u9664\u4e86 pom.xml \u6587\u4ef6\u5916\uff0c\u8fd8\u751f\u6210\u4e86\u5e94\u7528\u7a0b\u5e8f\u8d44\u6e90\u548c\u6d4b\u8bd5\u8d44\u6e90\u4e24\u9897\u8d44\u6e90\u6811\u3002\u8fd9\u662f Maven \u9879\u76ee\u7684\u6807\u51c6\u5e03\u5c40\uff0c\u5e94\u7528\u7a0b\u5e8f\u8d44\u6e90\u4f4d\u4e8e ${basedir}/src/main/java \u800c\u6d4b\u8bd5\u8d44\u6e90\u4f4d\u4e8e ${basedir}/src/test/java \uff08 ${basedir} \u4ee3\u8868\u5305\u542b pom.xml \u6587\u4ef6\u7684\u76ee\u5f55\uff09\uff0c\u8fd9\u4e5f\u662f Maven \u63a8\u8350\u7684\u5e03\u5c40\u683c\u5f0f\u6216\u8005\u8bf4\u662f Maven \u9879\u76ee\u7684\u7ea6\u5b9a\uff0c\u66f4\u591a\u5173\u4e8e Maven \u7684\u6587\u4ef6\u5e03\u5c40\u8bf7\u53c2\u9605 Introduction to the Standard Directory Layout \u3002 \u5982\u4f55\u7f16\u8bd1\u6e90\u7801 \u5728 pom.xml \u6587\u4ef6\u6240\u5728\u7684\u8def\u5f84\u4e0b\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff08\u6267\u884c Maven \u547d\u4ee4\u9700\u8981\u4ece pom.xml \u4e2d\u83b7\u53d6\u914d\u7f6e\u4fe1\u606f\uff09\uff1a mvn compile \u901a\u8fc7\u6267\u884c\u4e0a\u9762\u7684\u547d\u4ee4\uff0c\u4f60\u53ef\u4ee5\u5728\u63a7\u5236\u53f0\u770b\u5230\u7c7b\u4f3c\u7684\u8f93\u51fa\uff1a [INFO] ------------------------------------------------------------------- [INFO] Building Maven Quick Start Archetype [INFO] task-segment: [compile] [INFO] ------------------------------------------------------------------- [INFO] artifact org.apache.maven.plugins:maven-resources-plugin: \\ checking for updates from central ... [INFO] artifact org.apache.maven.plugins:maven-compiler-plugin: \\ checking for updates from central ... [INFO] [resources:resources] ... [INFO] [compiler:compile] Compiling 1 source file to <dir>/my-app/target/classes [INFO] ------------------------------------------------------------------- [INFO] BUILD SUCCESSFUL [INFO] ------------------------------------------------------------------- [INFO] Total time: 3 minutes 54 seconds [INFO] Finished at: Fri Sep 23 15:48:34 GMT-05:00 2005 [INFO] Final Memory: 2M/6M [INFO] ------------------------------------------------------------------- \u5f53\u7b2c\u4e00\u6b21\u6267\u884c\u547d\u4ee4\u65f6\uff08\u4efb\u4f55 Maven \u547d\u4ee4\uff09\uff0c Maven \u9700\u8981\u4ece\u4ed3\u5e93\u4e0b\u8f7d\u5b8c\u6210\u8be5\u547d\u4ee4\u6240\u9700\u8981\u7684\u63d2\u4ef6\u548c\u4f9d\u8d56\u3002\u8fd9\u53ef\u80fd\u4f1a\u82b1\u8d39\u4e00\u4e9b\u65f6\u95f4\uff0c\u4f46\u4e4b\u540e\u5982\u679c\u518d\u6267\u884c\u76f8\u540c\u7684\u547d\u4ee4\u5c31\u5f88\u5feb\u4e86\u3002 \u4ece\u8f93\u51fa\u4e2d\u53ef\u4ee5\u770b\u5230\uff0c\u7f16\u8bd1\u751f\u6210\u7684\u6587\u4ef6\u88ab\u653e\u5230\u4e86 ${basedir}/target/classes \u76ee\u5f55\u4e0b\uff0c\u8fd9\u4e5f\u662f Maven \u7684\u4e00\u4e2a\u6807\u51c6\u7ea6\u5b9a\u3002 \u5982\u4f55\u7f16\u8bd1\u6d4b\u8bd5\u6e90\u7801\u5e76\u4e14\u8fd0\u884c\u5355\u5143\u6d4b\u8bd5 \u53ea\u8981\u6267\u884c\u4ee5\u4e0b\u4e00\u6761\u547d\u4ee4\u5373\u53ef\u5b8c\u6210\uff1a mvn test \u901a\u8fc7\u6267\u884c\u4e0a\u9762\u7684\u547d\u4ee4\uff0c\u4f60\u53ef\u4ee5\u5728\u63a7\u5236\u53f0\u770b\u5230\u7c7b\u4f3c\u7684\u8f93\u51fa\uff1a [INFO] ------------------------------------------------------------------- [INFO] Building Maven Quick Start Archetype [INFO] task-segment: [test] [INFO] ------------------------------------------------------------------- [INFO] artifact org.apache.maven.plugins:maven-surefire-plugin: \\ checking for updates from central ... [INFO] [resources:resources] [INFO] [compiler:compile] [INFO] Nothing to compile - all classes are up to date [INFO] [resources:testResources] [INFO] [compiler:testCompile] Compiling 1 source file to C:\\Test\\Maven2\\test\\my-app\\target\\test-classes ... [INFO] [surefire:test] [INFO] Setting reports dir: C:\\Test\\Maven2\\test\\my-app\\target/surefire-reports ------------------------------------------------------- T E S T S ------------------------------------------------------- [surefire] Running com.mycompany.app.AppTest [surefire] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0 sec Results : [surefire] Tests run: 1, Failures: 0, Errors: 0 [INFO] ------------------------------------------------------------------- [INFO] BUILD SUCCESSFUL [INFO] ------------------------------------------------------------------- [INFO] Total time: 15 seconds [INFO] Finished at: Thu Oct 06 08:12:17 MDT 2005 [INFO] Final Memory: 2M/8M [INFO] ------------------------------------------------------------------- \u9700\u8981\u989d\u5916\u7684\u6ce8\u610f\u7684\u662f surefire \u63d2\u4ef6\uff08\u5b83\u4f1a\u8fd0\u884c\u6d4b\u8bd5\u7528\u4f8b\uff09\u4f1a\u5bfb\u627e ${basedir}/src/test/java \u4e0b\u5177\u6709\u7279\u5b9a\u547d\u540d\u89c4\u5219\u7684\u6d4b\u8bd5\u6587\u4ef6\u6267\u884c\u6d4b\u8bd5\uff0c\u4f8b\u5982\uff1a **/*Test.java **/Test*.java **/*TestCase.java \u4f46\u4f1a\u6392\u9664\u5177\u6709\u4ee5\u4e0b\u547d\u540d\u89c4\u5219\u7684\u6587\u4ef6\uff1a **/Abstract*Test.java **/Abstract*TestCase.java \u4ece\u4e0a\u9762\u7684\u8f93\u51fa\u53ef\u4ee5\u770b\u51fa\uff0c\u6784\u5efa\u8fc7\u7a0b\u6267\u884c\u4e86\u6e90\u7801\u7f16\u8bd1\u3001\u6d4b\u8bd5\u6e90\u7801\u7f16\u8bd1\u5e76\u4e14\u8fd0\u884c\u4e86\u5355\u5143\u6d4b\u8bd5\uff0c\u4f60\u53ef\u80fd\u4f1a\u89c9\u5f97\u5947\u602a\u4e3a\u4ec0\u4e48 test \u547d\u4ee4\u80fd\u6267\u884c\u8fd9\u4e48\u591a\u64cd\u4f5c\uff0c\u8fd9\u662f\u56e0\u4e3a test \u4f1a\u6267\u884c test \u9636\u6bb5\u4e4b\u524d\u6240\u6709\u7684\u9636\u6bb5\uff0c\u8be6\u89c1 Maven \u7684\u6784\u5efa\u751f\u547d\u5468\u671f \u3002 \u5982\u679c\u4f60\u53ea\u60f3\u7f16\u8bd1\u6d4b\u8bd5\u6e90\u7801\u4f46\u4e0d\u8fd0\u884c\u5355\u5143\u6d4b\u8bd5\uff0c\u4f60\u53ef\u4ee5\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a mvn test-compile \u5982\u4f55\u751f\u6210\u4e00\u4e2aJAR\u5305\u5e76\u5b89\u88c5\u5230\u672c\u5730\u4ed3\u5e93 \u8981\u751f\u6210 JAR \u6587\u4ef6\uff0c\u9996\u5148\u4f60\u9700\u8981\u5728 POM \u4e2d\u6307\u5b9a <packaging> \u503c\u4e3a jar \uff08\u6216\u8005\u4e0d\u8fdb\u884c\u6307\u5b9a\uff0c\u9ed8\u8ba4\u503c\u4e3a jar \uff09\uff0c\u8fd9\u5c06\u8ba9 Maven \u77e5\u9053\u8981\u751f\u6210\u4e00\u4e2a jar \u6587\u4ef6\uff0c\u7136\u540e\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a mvn package \u5f53\u547d\u4ee4\u6267\u884c\u5b8c\u6210\u540e\uff0c\u4f60\u53ef\u4ee5\u5728 ${basedir}/target \u76ee\u5f55\u4e0b\u770b\u5230\u751f\u6210\u7684 JAR \u6587\u4ef6\u3002 \u5982\u679c\u4f60\u60f3\u5b89\u88c5\u4f60\u7684\u751f\u6210\u7684\u5de5\u4ef6\uff08\u8fd9\u91cc\u662f JAR \u6587\u4ef6\uff09\u5230\u4f60\u7684\u672c\u5730\u4ed3\u5e93\uff08 ${user.home}/.m2/repository \u662f\u9ed8\u8ba4\u7684\u4ed3\u5e93\u4f4d\u7f6e\uff09\u3002\u4f60\u53ef\u4ee5\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff1a mvn install \u901a\u8fc7\u6267\u884c\u4e0a\u9762\u7684\u547d\u4ee4\uff0c\u4f60\u53ef\u4ee5\u5728\u63a7\u5236\u53f0\u770b\u5230\u7c7b\u4f3c\u7684\u8f93\u51fa\uff1a [INFO] ------------------------------------------------------------------- [INFO] Building Maven Quick Start Archetype [INFO] task-segment: [install] [INFO] ------------------------------------------------------------------- [INFO] [resources:resources] [INFO] [compiler:compile] Compiling 1 source file to <dir>/my-app/target/classes [INFO] [resources:testResources] [INFO] [compiler:testCompile] Compiling 1 source file to <dir>/my-app/target/test-classes [INFO] [surefire:test] [INFO] Setting reports dir: <dir>/my-app/target/surefire-reports ------------------------------------------------------- T E S T S ------------------------------------------------------- [surefire] Running com.mycompany.app.AppTest [surefire] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.001 sec Results : [surefire] Tests run: 1, Failures: 0, Errors: 0 [INFO] [jar:jar] [INFO] Building jar: <dir>/my-app/target/my-app-1.0-SNAPSHOT.jar [INFO] [install:install] [INFO] Installing <dir>/my-app/target/my-app-1.0-SNAPSHOT.jar to \\ <local-repository>/com/mycompany/app/my-app/1.0-SNAPSHOT/my-app-1.0-SNAPSHOT.jar [INFO] ------------------------------------------------------------------- [INFO] BUILD SUCCESSFUL [INFO] ------------------------------------------------------------------- [INFO] Total time: 5 seconds [INFO] Finished at: Tue Oct 04 13:20:32 GMT-05:00 2005 [INFO] Final Memory: 3M/8M [INFO] ------------------------------------------------------------------- \u5982\u4f55\u4f7f\u7528\u63d2\u4ef6 \u5f53\u4f60\u60f3\u8981\u81ea\u5b9a\u4e49 Maven \u9879\u76ee\u7684\u6784\u5efa\u65f6\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u6dfb\u52a0\u6216\u91cd\u65b0\u914d\u7f6e\u63d2\u4ef6\u6765\u5b9e\u73b0\u3002\u4e0b\u9762\u7684\u4f8b\u5b50\u6211\u4eec\u901a\u8fc7\u914d\u7f6e\u4f7f Java \u7f16\u8bd1\u5668\u5141\u8bb8 JDK 5.0 \u7684\u6e90\uff0c\u4f60\u53ef\u4ee5\u7b80\u5355\u5730\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a ... <build> <plugins> <plugin> <groupId>org.apache.maven.plugins</groupId> <artifactId>maven-compiler-plugin</artifactId> <version>3.3</version> <configuration> <source>1.5</source> <target>1.5</target> </configuration> </plugin> </plugins> </build> ... Maven \u4f1a\u81ea\u52a8\u4e0b\u8f7d\u548c\u4f7f\u7528\u4f60\u6307\u5b9a\u7248\u672c\u7684\u63d2\u4ef6\uff08\u5982\u679c\u4f60\u6ca1\u6709\u6307\u5b9a\u63d2\u4ef6\u7248\u672c\uff0c\u5219\u9ed8\u8ba4\u4f7f\u7528\u6700\u65b0\u7248\u672c\uff09\u3002 \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c configuration \u5143\u7d20\u4f1a\u88ab\u5e94\u7528\u5230 compiler \u63d2\u4ef6\u7684\u6240\u6709\u76ee\u6807\uff08goal\uff09\u4e0a\uff08\u6ce8\uff1a\u4f60\u4e5f\u53ef\u4ee5\u5728 <plugin> \u7684\u5b50\u5143\u7d20 <execution> \u4e2d\u5c06 configuration \u5e94\u7528\u7684\u67d0\u4e00\u4e2a\u76ee\u6807\u4e0a\uff09\uff0c\u5b9e\u9645\u4e0a compiler \u63d2\u4ef6\u5df2\u7ecf\u5728\u6784\u5efa\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u4e86\uff0c\u4e0a\u9762\u7684\u4f8b\u5b50\u53ea\u662f\u4fee\u6539\u4e86\u90e8\u5206\u914d\u7f6e\u4fe1\u606f\u3002\u4f60\u4e5f\u53ef\u4ee5\u4e3a\u6784\u5efa\u8fc7\u7a0b\u6dfb\u52a0\u65b0\u7684\u63d2\u4ef6\u76ee\u6807\uff0c\u66f4\u591a\u4fe1\u606f\u53ef\u4ee5\u67e5\u770b Maven \u7684\u6784\u5efa\u751f\u547d\u5468\u671f \u3002 \u4f60\u53ef\u4ee5\u5728 Maven \u5b98\u65b9\u6587\u6863\u4e2d\u67e5\u770b\u66f4\u591a\u53ef\u7528\u7684\u63d2\u4ef6\uff0c\u8be6\u89c1 Plugins List \u3002\u5b98\u65b9\u6587\u6863\u540c\u65f6\u4e5f\u5bf9 Maven \u63d2\u4ef6\u7684\u914d\u7f6e\u548c\u8fdb\u884c\u4e86\u6bd4\u8f83\u8be6\u7ec6\u7684\u4ecb\u7ecd\uff0c\u8be6\u89c1 Guide to Configuring Plugins \u3002 \u5982\u4f55\u5f80JAR\u6587\u4ef6\u4e2d\u6dfb\u52a0\u8d44\u6e90\u6587\u4ef6 \u5728 JAR \u5305\u4e2d\u6dfb\u52a0\u8d44\u6e90\u6587\u4ef6\u662f\u4e00\u4e2a\u5e38\u89c1\u7684\u9700\u6c42\uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u9700\u6c42 Maven \u4ecd\u7136\u4f9d\u8d56\u4e8e\u7684\u4ed6\u7684\u6807\u51c6\u6587\u4ef6\u5e03\u5c40\uff08 Standard Directory Layout \uff09\uff0c\u8fd9\u610f\u5473\u7740\u53ea\u8981\u9075\u5b88 Maven \u7684\u6807\u51c6\u7ea6\u5b9a\uff0c\u4f60\u5c31\u53ef\u4ee5\u901a\u8fc7\u7b80\u5355\u5730\u5c06\u8fd9\u4e9b\u8d44\u6e90\u6587\u4ef6\u653e\u5728\u6807\u51c6\u7684\u76ee\u5f55\u7ed3\u6784\u4e0b\u5b9e\u73b0\u5728 JAR \u5305\u4e2d\u5c01\u88c5\u8d44\u6e90\u3002 \u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u6dfb\u52a0\u4e86 ${basedir}/src/main/resources \u76ee\u5f55\u5e76\u628a\u60f3\u8981\u88ab\u6253\u5305\u8fdb JAR \u5305\u7684\u8d44\u6e90\u90fd\u653e\u5728\u8be5\u76ee\u5f55\u4e0b\u3002 Maven \u91c7\u7528\u7684\u89c4\u5219\u662f\uff1a\u653e\u5728 ${basedir}/src/main/resources \u76ee\u5f55\u4e0b\u7684\u4efb\u4f55\u6587\u4ef6\u6216\u8005\u6587\u4ef6\u5939\u90fd\u4f1a\u88ab\u6253\u5305\u8fdb\u884c JAR \u5305\u4e2d\uff0c\u5e76\u4e14\u8fd9\u4e9b\u8d44\u6e90\u7684\u6587\u4ef6\u7ed3\u6784\u5c06\u5728 JAR \u5305\u5185\u4e0e\u539f\u6765\u4e00\u81f4\u3002 my-app |-- pom.xml `-- src |-- main | |-- java | | `-- com | | `-- mycompany | | `-- app | | `-- App.java | `-- resources | `-- META-INF | `-- application.properties `-- test `-- java `-- com `-- mycompany `-- app `-- AppTest.java \u5982\u4f60\u6240\u89c1\uff0c\u6211\u4eec\u5728 resource \u6587\u4ef6\u4e0b\u521b\u5efa\u4e86\u4e00\u4e2a META-INF \u6587\u4ef6\u5939\u5e76\u65b0\u5efa\u4e86\u4e00\u4e2a application.properties \u6587\u4ef6\u3002\u5982\u679c\u4f60\u89e3\u538b\u4e86\u7531\u4e0a\u9762\u7684\u9879\u76ee\u751f\u6210\u7684 JAR \u5305\uff0c\u4f60\u53ef\u4ee5\u770b\u5230\u5982\u4e0b\u7ed3\u6784\uff1a |-- META-INF | |-- MANIFEST.MF | |-- application.properties | `-- maven | `-- com.mycompany.app | `-- my-app | |-- pom.properties | `-- pom.xml `-- com `-- mycompany `-- app `-- App.class \u53ef\u4ee5\u770b\u5230\u5728 resources \u6587\u4ef6\u4e2d\u6dfb\u52a0\u7684\u5185\u5bb9\u90fd\u4ee5\u76f8\u540c\u7684\u7ed3\u6784\u51fa\u73b0\u5728 JAR \u5305\u4e2d\u4e86\uff0c\u4f46\u4f60\u53ef\u80fd\u6ce8\u610f\u5230\u4e86\u51e0\u4e2a\u989d\u5916\u7684\u6587\u4ef6\uff08 MANIFEST.MF, pom.xml, pom.properties \uff09\u548c\u76ee\u5f55\uff0c\u5176\u5b9e\u8fd9\u4e9b\u90fd\u662f Maven \u751f\u6210 JAR \u5305\u7684\u6807\u51c6\u4ea7\u51fa\u7269\uff08\u6ce8\uff1a\u5176\u5b9e META-INF \u5c31\u662f\u6807\u51c6\u4ea7\u51fa\u7684\u4e00\u90e8\u5206\uff0c\u53ea\u662f\u7531\u4e8e\u5728 resources \u4e2d\u53d6\u4e86\u76f8\u540c\u7684\u540d\u5b57\u6240\u4ee5 application.properties \u4f1a\u51fa\u73b0\u5728\u8fd9\u4e2a\u4f4d\u7f6e\uff09\uff0c\u8fd9\u4e9b\u6587\u4ef6\u5b58\u5728\u76ee\u7684\u662f\u8ba9 Maven \u751f\u6210\u7684\u5de5\u4ef6\u80fd\u591f\u5b9e\u73b0\u81ea\u8ff0\uff08 self-describing \uff09\u3002 \u5982\u4f55\u66ff\u6362\u8d44\u6e90\u6587\u4ef6\u4e2d\u7684\u5f15\u7528\u503c \u6709\u65f6\u8d44\u6e90\u6587\u4ef6\u9700\u8981\u5305\u542b\u4e00\u4e9b\u53ea\u80fd\u5728\u6784\u5efa\u9636\u6bb5\u624d\u63d0\u4f9b\u7684\u503c\uff0c\u8981\u5728 Maven \u4e2d\u5b8c\u6210\u6b64\u64cd\u4f5c\uff0c\u53ef\u4ee5\u4f7f\u7528\u8bed\u6cd5 $ {<property name>} \u5c06\u5305\u542b\u503c\u7684\u5c5e\u6027\u5f15\u7528\u5230\u8d44\u6e90\u6587\u4ef6\u4e2d\u3002\u8be5\u5c5e\u6027\u53ef\u4ee5\u662f pom.xml \u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\u4e00\u4e2a\u503c\uff0c\u5728\u67d0\u7528\u6237\u7684 setting.xml \u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\u503c\uff0c\u4e00\u4e2a\u5916\u90e8\u7684properties \u6587\u4ef6\u4e2d\u7684\u5c5e\u6027\u6216\u8005\u662f\u7cfb\u7edf\u5c5e\u6027\u3002 \u4e3a\u4e86\u5728\u8d44\u6e90\u51c6\u5907\u9636\u6bb5\uff08 process-resources phase \uff09\u5c06\u8bed\u6cd5 $ {<property name>} \u66ff\u6362\uff08 filter \uff09\u4e3a\u7279\u5b9a\u7684\u503c\uff0c\u53ea\u8981\u7b80\u5355\u5730\u5c06 pom.xml \u6587\u4ef6\u4e2d\u7684 <filtering> \u8bbe\u7f6e\u4e3a true \u5373\u53ef\uff1a <project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"> <modelVersion>4.0.0</modelVersion> <groupId>com.mycompany.app</groupId> <artifactId>my-app</artifactId> <version>1.0-SNAPSHOT</version> <packaging>jar</packaging> <name>Maven Quick Start Archetype</name> <url>http://maven.apache.org</url> <dependencies> <dependency> <groupId>junit</groupId> <artifactId>junit</artifactId> <version>4.11</version> <scope>test</scope> </dependency> </dependencies> <build> <resources> <resource> <directory>src/main/resources</directory> <filtering>true</filtering> </resource> </resources> </build> </project> \u5982\u4e0a\u6240\u793a\uff0c\u6211\u4eec\u6dfb\u52a0\u4e86 <build>\u3001<resources> \u4ee5\u53ca <resource> \u5143\u7d20\uff0c\u800c\u4e14\u8fd8\u660e\u786e\u58f0\u660e\u4e86 src/main/resources \u4e3a\u8d44\u6e90\u6587\u4ef6\u6240\u5728\u7684\u4f4d\u7f6e\u3002\u8fd9\u4e9b\u4fe1\u606f\u5728\u672a\u58f0\u660e\u524d\u90fd\u662f\u4ee5\u9ed8\u8ba4\u503c\u7684\u5f62\u5f0f\u63d0\u4f9b\uff0c\u4f46\u7531\u4e8e <filtering> \u7684\u9ed8\u8ba4\u503c\u4e3a false \uff0c\u6240\u4ee5\u6211\u4eec\u5fc5\u987b\u663e\u793a\u5730\u58f0\u660e\u5b83\u5e76\u4e14\u8bbe\u7f6e\u4e3a true \u3002 \u4e0b\u9762\u8ba9\u6211\u4eec\u5728 application.properties \u6587\u4ef6\u4e2d\u6dfb\u52a0\u4e24\u4e2a\u5c5e\u6027\uff0c\u5b83\u4eec\u4f1a\u5728\u6784\u5efa\u9636\u6bb5\u88ab\u66ff\u6362\u4e3a\u7279\u5b9a\u7684\u503c\uff1a # application.properties application.name=${project.name} application.version=${project.version} \u5176\u4e2d ${project.name} \u548c ${project.version} \u4e3a Maven \u7684\u9879\u76ee\u53d8\u91cf\uff0c\u5206\u522b\u4ee3\u8868\u5f53\u524d\u9879\u76ee\u7684\u540d\u5b57\u548c\u7248\u672c\uff0c\u8be6\u89c1 \u9879\u76ee\u53d8\u91cf\u4ee5\u53ca\u63d2\u503c \u90e8\u5206\u3002\u4e4b\u540e\uff0c\u4f60\u53ef\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff08 process-resources \u662f\u6784\u5efa\u751f\u547d\u5468\u671f\u7684\u4e00\u4e2a\u9636\u6bb5\uff0c\u6267\u884c\u8d44\u6e90\u6587\u4ef6\u7684\u590d\u5236\u548c\u66ff\u6362\uff09\uff1a mvn process-resources \u7136\u540e\uff0c\u4f60\u4f1a\u5728 target/classes \u76ee\u5f55\u4e0b\u770b\u5230\u66ff\u6362\u4e4b\u540e\u7684 application.properties \u5982\u4e0b\uff1a # application.properties application.name=Maven Quick Start Archetype application.version=1.0-SNAPSHOT \u5982\u679c\u4f60\u8981\u5f15\u7528\u5916\u90e8 properties \u6587\u4ef6\uff08\u6307\u7684\u5e94\u8be5\u662f\u975e\u7cfb\u7edf\u5c5e\u6027\u548c pom.xml \u4e2d\u5b9a\u4e49\u7684\u5c5e\u6027\uff0c\u5373\u4f7f properties \u6587\u4ef6\u5728 resources \u76ee\u5f55\u4e0b\uff09\u7684\u67d0\u4e00\u4e2a\u5c5e\u6027\uff0c\u4f60\u9700\u8981\u5728 pom.xml \u4e2d\u6dfb\u52a0\u5bf9\u8fd9\u4e2a\u5916\u90e8\u6587\u4ef6\u7684\u5f15\u7528\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u5916\u90e8 properties \u6587\u4ef6\uff0c\u5b83\u7684\u5b8c\u6574\u8def\u5f84\u4e3a src/main/filters/filter.properties \uff0c\u5185\u5bb9\u5982\u4e0b\uff1a # filter.properties my.filter.value=hello! \u73b0\u5728\uff0c\u6211\u4eec\u9700\u8981\u5728 pom.xml \u4e2d\u6dfb\u52a0\u65b0\u7684\u5f15\u7528\uff1a ... <build> <filters> <filter>src/main/filters/filter.properties</filter> </filters> <resources> <resource> <directory>src/main/resources</directory> <filtering>true</filtering> </resource> </resources> </build> ... \u63a5\u7740\uff0c\u5c31\u53ef\u4ee5\u5728 application.properties \u6587\u4ef6\u4e2d\u5f15\u7528\u8fd9\u4e2a\u5c5e\u6027\u4e86\uff1a # application.properties application.name=${project.name} application.version=${project.version} message=${my.filter.value} \u5728\u5916\u90e8\u6587\u4ef6\u4e2d\u5b9a\u4e49my.filter.value\u5c5e\u6027\u7684\u66ff\u4ee3\u65b9\u6848\u662f\u5728 pom.xml \u7684 <properties> \u5143\u7d20\u4e2d\u5b9a\u4e49\u5b83\u5e76\u83b7\u5f97\u76f8\u540c\u7684\u6548\u679c\uff08\u6ce8\u610f\uff0c\u8fd9\u91cc\u6ca1\u6709\u6dfb\u52a0 filters \u5143\u7d20\uff09\uff1a ... <build> <resources> <resource> <directory>src/main/resources</directory> <filtering>true</filtering> </resource> </resources> </build> <properties> <my.filter.value>hello</my.filter.value> </properties> ... \u66ff\u6362\u503c\u4e5f\u53ef\u4ee5\u4ece\u7cfb\u7edf\u5c5e\u6027\u4e2d\u83b7\u53d6\uff0c\u5305\u62ec Java \u5185\u7f6e\u7684\u7cfb\u7edf\u5c5e\u6027\uff08\u5982 java.version, user.home \uff09\u6216\u8005\u4f7f\u7528 Java -D \u53c2\u6570\u5728\u547d\u4ee4\u884c\u4e0a\u5b9a\u4e49\u7684\u5c5e\u6027\u3002 \u4f8b\u5982\uff0c application.properties \u7684\u5185\u5bb9\u5982\u4e0b\uff1a # application.properties java.version=${java.version} command.line.prop=${command.line.prop} \u6211\u4eec\u5c06\u5728\u547d\u4ee4\u884c\u4e0a\u5b9a\u4e49 command.line.prop \u5c5e\u6027\u7684\u503c\uff0c\u5982\u4e0b\uff1a mvn process-resources \"-Dcommand.line.prop=hello again\" \u5982\u4f55\u4f7f\u7528\u5916\u90e8\u4f9d\u8d56 \u5916\u90e8\u4f9d\u8d56\u5373 POM \u4e2d\u7684 <dependencies> \u90e8\u5206\u5b9a\u4e49\u7684\u5185\u5bb9\uff08\u4f8b\u5982\u4e4b\u524d\u4f8b\u5b50\u4e2d\u7684 junit jar \u5305\uff09\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u4e86\u89e3\u5b83\u662f\u5982\u4f55\u5de5\u4f5c\u7684\u3002\u66f4\u52a0\u5168\u9762\u7684\u4ecb\u7ecd\uff0c\u8bf7\u53c2\u8003\u5b98\u65b9\u6587\u6863\u5bf9\u4f9d\u8d56\u673a\u5236\u7684\u4ecb\u7ecd\uff08 Introduction to Dependency Mechanism \uff09\u3002 \u8ba9\u6211\u4eec\u4ee5\u4e4b\u524d\u7684\u9879\u76ee\u4e3a\u4f8b\u5b50\uff1a <project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"> <modelVersion>4.0.0</modelVersion> <groupId>com.mycompany.app</groupId> <artifactId>my-app</artifactId> <version>1.0-SNAPSHOT</version> <packaging>jar</packaging> <name>Maven Quick Start Archetype</name> <url>http://maven.apache.org</url> <dependencies> <dependency> <groupId>junit</groupId> <artifactId>junit</artifactId> <version>4.11</version> <scope>test</scope> </dependency> </dependencies> </project> \u5bf9\u4e8e\u5916\u90e8\u4f9d\u8d56\uff0c\u4f60\u9700\u8981\u81f3\u5c11\u5b9a\u4e494\u4e2a\u5c5e\u6027\uff1a groupId, artifactId, version \u548c scope \u3002\u5176\u4e2d groupId, artifactId, version \u5c31\u662f\u4f60\u9700\u8981\u5f15\u7528\u7684\u9879\u76ee\u7684 pom.xml \u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\uff0c\u800c scope \u8868\u793a\u4f60\u8981\u5728\u54ea\u4e2a\u8303\u56f4\u5185\u4f7f\u7528\u8fd9\u4e2a\u4f9d\u8d56\uff0c\u4e0b\u8868\u4e3a scope \u53ef\u7528\u7684\u503c\uff1a Scope \u63cf\u8ff0 compile compile \u4e3a scope \u7684\u9ed8\u8ba4\u503c\uff0c\u5982\u679c\u672a\u6307\u5b9a scope \u5219 scope \u7684\u503c\u4e3a compile \u3002\u6b64\u8303\u56f4\u7684\u4f9d\u8d56\u9879\uff08 dependencie \uff09\u5728\u9879\u76ee\u7684\u6240\u6709\u7c7b\u8def\u5f84\uff08 classpath \uff09\u4e0b\u90fd\u53ef\u4ee5\u4f7f\u7528\uff0c\u5e76\u4e14\u5982\u679c\u5176\u4ed6\u9879\u76ee\u4f9d\u8d56\u8be5\u9879\u76ee\uff0c\u4f9d\u8d56\u4e86\u8be5\u9879\u76ee\u7684\u9879\u76ee\u4e5f\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u4f9d\u8d56\u9879\u3002 provided \u7c7b\u4f3c\u4e8e compile \uff0c\u4f46 provided \u8868\u793a\u4f9d\u8d56\u9879\u5728\u8fd0\u884c\u65f6\u7531 JDK \u6216\u5bb9\u5668\u63d0\u4f9b\u3002\u4f8b\u5982\uff0c\u5728\u6784\u5efa JaveEE WEB \u9879\u76ee\u65f6\uff0c\u4f60\u5e94\u8be5\u628a Servlet API \u548c Java EE APIs \u4f9d\u8d56\u9879\u7684\u8303\u56f4\u8bbe\u7f6e\u4e3a provided, \u56e0\u4e3a WEB \u5bb9\u5668\u7684 classpaths \u4f1a\u63d0\u4f9b\u8fd9\u4e9b\u7c7b\u3002\u6b64\u8303\u56f4\u7684\u4f9d\u8d56\u9879\u53ea\u80fd\u5728\u7f16\u8bd1\u548c\u6d4b\u8bd5\u7c7b\u8def\u5f84\u4e2d\u4f7f\u7528\uff0c\u4e14\u4e0d\u5177\u6709\u4f20\u9012\u6027\u3002 runtime \u6b64\u8303\u56f4\u8868\u660e\uff0c\u5728\u8fd0\u884c\u65f6\u9700\u8981\u8be5\u4f9d\u8d56\u9879\u4f46\u7f16\u8bd1\u65f6\u4e0d\u9700\u8981\u3002\u5b83\u4f4d\u4e8e\u8fd0\u884c\u65f6\u548c\u6d4b\u8bd5\u7c7b\u8def\u5f84\u4e0b\u3002 test \u6b64\u8303\u56f4\u8868\u660e\uff0c\u8be5\u4f9d\u8d56\u9879\u53ea\u5728\u6d4b\u8bd5\u90e8\u5206\u7684\u7f16\u8bd1\u548c\u8fd0\u884c\u9636\u6bb5\u4f7f\u7528\uff0c\u5e76\u4e14\u4e0d\u5177\u6709\u4f20\u9012\u6027\u3002 system \u7c7b\u4f3c\u4e8e provided \uff0c\u4f46\u5fc5\u987b\u63d0\u4f9b\u660e\u786e\u5305\u542b\u4e86\u4f9d\u8d56\u9879\u7684 jar \u5305\u3002 \u901a\u8fc7\u8fd9\u4e9b\u4f9d\u8d56\u4fe1\u606f\uff0c Maven \u80fd\u591f\u5728\u6784\u5efa\u9879\u76ee\u65f6\u901a\u8fc7\u8fd9\u4e9b\u4fe1\u606f\u627e\u5230\u8fd9\u4e9b\u4f9d\u8d56\u9879\u3002 Maven \u4f1a\u5728\u672c\u5730\u4ed3\u5e93\uff08\u9ed8\u8ba4\u4f4d\u7f6e\u4e3a ${user.home}/.m2/repository \uff09\u67e5\u627e\u4f9d\u8d56\uff0c\u5728 \u5982\u4f55\u751f\u6210\u4e00\u4e2aJAR\u5305\u5e76\u5b89\u88c5\u5230\u672c\u5730\u4ed3\u5e93 \u4e2d\u6211\u5c06 my-app-1.0-SNAPSHOT.jar \u5b89\u88c5\u5230\u4e86\u672c\u5730\u4ed3\u5e93\u4e2d\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5728\u5176\u4ed6\u9879\u76ee\u7684 pom.xml \u6587\u4ef6\u4e2d\u6dfb\u52a0\u4f9d\u8d56\u4fe1\u606f\u6765\u5f15\u7528\u8fd9\u4e2a jar \u5305\uff1a <project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"> <groupId>com.mycompany.app</groupId> <artifactId>my-other-app</artifactId> ... <dependencies> ... <dependency> <groupId>com.mycompany.app</groupId> <artifactId>my-app</artifactId> <version>1.0-SNAPSHOT</version> <scope>compile</scope> </dependency> </dependencies> </project> \u5982\u679c\u9879\u76ee\u5f15\u7528\u4e86\u672c\u5730\u4ed3\u5e93\u4e2d\u4e0d\u5b58\u5728\u7684\u4f9d\u8d56\u9879\uff0c Maven \u4f1a\u5c06\u8be5\u4f9d\u8d56\u4ece\u8fdc\u7a0b\u4ed3\u5e93\u4e0b\u8f7d\u5230\u672c\u5730\u4ed3\u5e93\u4e2d\u3002 Maven \u9ed8\u8ba4\u4f7f\u7528\u7684\u8fdc\u7a0b\u4ed3\u5e93\u4e3a http://repo.maven.apache.org/maven2/ \uff0c\u4f60\u4e5f\u53ef\u4ee5\u914d\u7f6e\u81ea\u5df1\u7684\u8fdc\u7a0b\u4ed3\u5e93\uff08\u56fd\u5185\u53ef\u4ee5\u4f7f\u7528\u963f\u91cc\u7684\u8fdc\u7a0b\u4ed3\u5e93 http://maven.aliyun.com/nexus/content/groups/public \uff09\u6765\u66ff\u4ee3\u6216\u505a\u4e3a\u9ed8\u8ba4\u4ed3\u5e93\u7684\u8865\u5145\u3002\u66f4\u591a\u5173\u4e8e\u4ed3\u5e93\u7684\u7684\u8d44\u6599\u53ef\u4ee5\u53c2\u8003\u5b98\u65b9\u6587\u6863 Introduction to Repositories \u3002","title":"Maven\u6982\u8ff0"},{"location":"Maven/Maven\u6982\u8ff0/#_1","text":"\u672c\u6587\u5c06\u4ee5\u4e3e\u4f8b\u7684\u65b9\u5f0f\u5bf9 Maven \u5e38\u7528\u90e8\u5206\u8fdb\u884c\u8bf4\u660e\u3002 \u672c\u6587\u7684\u4e3b\u8981\u662f\u7b14\u8005\u5bf9 Maven \u5b98\u65b9\u624b\u518c\u7684\u7ffb\u8bd1\u548c\u7406\u89e3\uff1a http://maven.apache.org/guides/getting-started/index.html \u53c2\u8003\u4e86W3Cschool\u7684 Maven \u6559\u7a0b\uff1a https://www.w3cschool.cn/maven/u7oe1ht0.html","title":"\u6982\u8ff0"},{"location":"Maven/Maven\u6982\u8ff0/#maven","text":"\u73b0\u5728\u4e00\u822c\u90fd\u662f\u4f7f\u7528 IDE \u4ee5\u66f4\u4eba\u6027\u5316\u7684\u65b9\u5f0f\u521b\u5efa Maven \u9879\u76ee\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528 Maven \u7684 \u539f\u578b\uff08archetype\uff09 \u63d2\u4ef6\u6765\u521b\u5efa\u9879\u76ee\uff0c\u5728\u547d\u4ee4\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a mvn archetype:generate -DgroupId=com.mycompany.app \\ -DartifactId=my-app \\ -DarchetypeArtifactId=maven-archetype-quickstart \\ -DinteractiveMode=false \u6267\u884c\u8be5\u547d\u4ee4\u540e\uff0c\u5728\u6267\u884c\u8be5\u547d\u4ee4\u7684\u6587\u4ef6\u5939\u4e0b\u4f1a\u751f\u6210\u4e00\u4e2a\u540d\u4e3a my-app \u7684\u9879\u76ee\uff0c\u5e76\u4e14 my-app \u6587\u4ef6\u5939\u4e0b\u5305\u542b\u4e86\u4e00\u4e2a pom.xml \u6587\u4ef6\uff0c\u8be5\u6587\u4ef6\u7684\u5185\u5bb9\u7c7b\u4f3c\u4e8e\uff1a <project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"> <modelVersion>4.0.0</modelVersion> <groupId>com.mycompany.app</groupId> <artifactId>my-app</artifactId> <packaging>jar</packaging> <version>1.0-SNAPSHOT</version> <name>Maven Quick Start Archetype</name> <url>http://maven.apache.org</url> <dependencies> <dependency> <groupId>junit</groupId> <artifactId>junit</artifactId> <version>4.11</version> <scope>test</scope> </dependency> </dependencies> </project> pom.xml \u5305\u542b\u4e86\u6b64\u9879\u76ee\u7684\u9879\u76ee\u5bf9\u8c61\u6a21\u578b\uff08 Project Object Model \uff09\uff0c POM \u662f Maven \u7684\u57fa\u672c\u5de5\u4f5c\u5355\u5143\uff0c\u7b80\u800c\u8a00\u4e4b\u5c31\u662f pom.xml \u4e2d\u5305\u542b\u4e86\u4f60\u9879\u76ee\u6240\u6709\u91cd\u8981\u7684\u4fe1\u606f\uff0c\u80fd\u591f\u67e5\u627e\u9879\u76ee\u7684\u4e00\u5207\u76f8\u5173\u5185\u5bb9\u3002\u5173\u4e8e POM \u7684\u4ecb\u7ecd\uff0c\u53ef\u4ee5\u67e5\u770b POM \u7b80\u4ecb \u3002 \u4e0b\u9762\u6211\u4eec\u5c06\u9010\u4e00\u4ecb\u7ecd\u8fd9\u4e2a\u7b80\u5355\u7684 POM \u51e0\u4e2a\u5173\u952e\u5143\u7d20\uff1a project \u8fd9\u662f\u6240\u6709 Maven pom.xml \u6587\u4ef6\u4e2d\u7684\u6839\u5143\u7d20 modelVersion \u6b64\u5143\u7d20\u8868\u793a POM \u4f7f\u7528\u7684\u5bf9\u8c61\u6a21\u578b\u7248\u672c\uff0c\u5bf9\u8c61\u6a21\u578b\u7248\u672c\u5f88\u5c11\u53d1\u751f\u53d8\u5316\u3002 groupId \u6b64\u5143\u7d20\u8868\u793a\u521b\u5efa\u9879\u76ee\u7684\u7ec4\u7ec7\u7684\u552f\u4e00\u6807\u8bc6\u7b26\uff0c groupId \u662f\u9879\u76ee\u7684\u5173\u952e\u6807\u8bc6\u7b26\u4e4b\u4e00\uff0c\u901a\u5e38\u57fa\u4e8e\u7ec4\u7ec7\u7684\u5b8c\u5168\u9650\u5b9a\u57df\u540d artifactId \u6b64\u5143\u7d20\u8868\u793a\u8be5\u9879\u76ee\u751f\u6210\u7684\u5de5\u4ef6\u552f\u4e00\u57fa\u672c\u540d\u79f0\uff0c\u9879\u76ee\u751f\u6210\u7684\u5de5\u4ef6\u901a\u5e38\u662f JAR \u6587\u4ef6\u3002\u7531 Maven \u751f\u6210\u7684\u5178\u578b\u5de5\u4ef6\u5177\u6709 <artifactId>-<version>.<extension> \u5f62\u5f0f\uff08\u4f8b\u5982\uff0c myapp-1.0.jar \uff09\u3002 packaging \u6b64\u5143\u7d20\u8868\u793a\u5de5\u4ef6\u7684\u6253\u5305\u7c7b\u578b\uff08\u4f8b\u5982 JAR , WAR , EAR \u7b49\uff09\u3002\u8fd9\u4e0d\u4ec5\u610f\u5473\u7740\u751f\u6210\u7684\u5de5\u65f6 JAR , WAR \u6216\u662f EAR \uff0c\u800c\u4e14\u8fd8\u5c06\u8868\u660e\u7279\u5b9a\u7684\u751f\u547d\u5468\u671f\u5c06\u4f1a\u88ab\u7ed1\u5b9a\u6784\u5efa\u8fc7\u7a0b\u4e2d\u3002\uff08\u8be6\u89c1 Maven\u7684\u6784\u5efa\u751f\u547d\u5468\u671f \uff09 version \u6b64\u5143\u7d20\u8868\u793a\u9879\u76ee\u751f\u6210\u7684\u5de5\u4ef6\u7684\u7248\u672c\u3002 name \u6b64\u5143\u7d20\u8868\u660e\u9879\u76ee\u7684\u663e\u793a\u540d\u79f0\uff0c\u5e38\u7528\u4e8e Maven \u6587\u6863\u7684\u751f\u6210\u3002 url \u6b64\u5143\u7d20\u8868\u660e\u9879\u76ee\u7684\u7ad9\u70b9\u7f51\u5740\uff0c\u5e38\u7528\u4e8e Maven \u6587\u6863\u7684\u751f\u6210\u3002 description \u6b64\u5143\u7d20\u63d0\u4f9b\u9879\u76ee\u7684\u57fa\u672c\u63cf\u8ff0\uff0c\u5e38\u7528\u4e8e Maven \u6587\u6863\u7684\u751f\u6210\u3002 \u6709\u5173 POM \u4e2d\u80fd\u591f\u4f7f\u7528\u7684\u5143\u7d20\u66f4\u52a0\u5b8c\u6574\u7684\u53c2\u8003\uff0c\u8bf7\u53c2\u9605\u5b98\u65b9\u7684 POM Reference \u3002 \u4f7f\u7528 archetype \u63d2\u4ef6\u751f\u6210\u9879\u76ee\u540e\uff0c\u4f60\u53ef\u4ee5\u770b\u5230\u5982\u4e0b\u7684\u76ee\u5f55\u7ed3\u6784\u88ab\u521b\u5efa\uff1a my-app |-- pom.xml `-- src |-- main | `-- java | `-- com | `-- mycompany | `-- app | `-- App.java `-- test `-- java `-- com `-- mycompany `-- app `-- AppTest.java \u5982\u4f60\u6240\u89c1\uff0c\u9664\u4e86 pom.xml \u6587\u4ef6\u5916\uff0c\u8fd8\u751f\u6210\u4e86\u5e94\u7528\u7a0b\u5e8f\u8d44\u6e90\u548c\u6d4b\u8bd5\u8d44\u6e90\u4e24\u9897\u8d44\u6e90\u6811\u3002\u8fd9\u662f Maven \u9879\u76ee\u7684\u6807\u51c6\u5e03\u5c40\uff0c\u5e94\u7528\u7a0b\u5e8f\u8d44\u6e90\u4f4d\u4e8e ${basedir}/src/main/java \u800c\u6d4b\u8bd5\u8d44\u6e90\u4f4d\u4e8e ${basedir}/src/test/java \uff08 ${basedir} \u4ee3\u8868\u5305\u542b pom.xml \u6587\u4ef6\u7684\u76ee\u5f55\uff09\uff0c\u8fd9\u4e5f\u662f Maven \u63a8\u8350\u7684\u5e03\u5c40\u683c\u5f0f\u6216\u8005\u8bf4\u662f Maven \u9879\u76ee\u7684\u7ea6\u5b9a\uff0c\u66f4\u591a\u5173\u4e8e Maven \u7684\u6587\u4ef6\u5e03\u5c40\u8bf7\u53c2\u9605 Introduction to the Standard Directory Layout \u3002","title":"\u5982\u4f55\u521b\u5efa\u4e00\u4e2aMaven\u9879\u76ee"},{"location":"Maven/Maven\u6982\u8ff0/#_2","text":"\u5728 pom.xml \u6587\u4ef6\u6240\u5728\u7684\u8def\u5f84\u4e0b\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff08\u6267\u884c Maven \u547d\u4ee4\u9700\u8981\u4ece pom.xml \u4e2d\u83b7\u53d6\u914d\u7f6e\u4fe1\u606f\uff09\uff1a mvn compile \u901a\u8fc7\u6267\u884c\u4e0a\u9762\u7684\u547d\u4ee4\uff0c\u4f60\u53ef\u4ee5\u5728\u63a7\u5236\u53f0\u770b\u5230\u7c7b\u4f3c\u7684\u8f93\u51fa\uff1a [INFO] ------------------------------------------------------------------- [INFO] Building Maven Quick Start Archetype [INFO] task-segment: [compile] [INFO] ------------------------------------------------------------------- [INFO] artifact org.apache.maven.plugins:maven-resources-plugin: \\ checking for updates from central ... [INFO] artifact org.apache.maven.plugins:maven-compiler-plugin: \\ checking for updates from central ... [INFO] [resources:resources] ... [INFO] [compiler:compile] Compiling 1 source file to <dir>/my-app/target/classes [INFO] ------------------------------------------------------------------- [INFO] BUILD SUCCESSFUL [INFO] ------------------------------------------------------------------- [INFO] Total time: 3 minutes 54 seconds [INFO] Finished at: Fri Sep 23 15:48:34 GMT-05:00 2005 [INFO] Final Memory: 2M/6M [INFO] ------------------------------------------------------------------- \u5f53\u7b2c\u4e00\u6b21\u6267\u884c\u547d\u4ee4\u65f6\uff08\u4efb\u4f55 Maven \u547d\u4ee4\uff09\uff0c Maven \u9700\u8981\u4ece\u4ed3\u5e93\u4e0b\u8f7d\u5b8c\u6210\u8be5\u547d\u4ee4\u6240\u9700\u8981\u7684\u63d2\u4ef6\u548c\u4f9d\u8d56\u3002\u8fd9\u53ef\u80fd\u4f1a\u82b1\u8d39\u4e00\u4e9b\u65f6\u95f4\uff0c\u4f46\u4e4b\u540e\u5982\u679c\u518d\u6267\u884c\u76f8\u540c\u7684\u547d\u4ee4\u5c31\u5f88\u5feb\u4e86\u3002 \u4ece\u8f93\u51fa\u4e2d\u53ef\u4ee5\u770b\u5230\uff0c\u7f16\u8bd1\u751f\u6210\u7684\u6587\u4ef6\u88ab\u653e\u5230\u4e86 ${basedir}/target/classes \u76ee\u5f55\u4e0b\uff0c\u8fd9\u4e5f\u662f Maven \u7684\u4e00\u4e2a\u6807\u51c6\u7ea6\u5b9a\u3002","title":"\u5982\u4f55\u7f16\u8bd1\u6e90\u7801"},{"location":"Maven/Maven\u6982\u8ff0/#_3","text":"\u53ea\u8981\u6267\u884c\u4ee5\u4e0b\u4e00\u6761\u547d\u4ee4\u5373\u53ef\u5b8c\u6210\uff1a mvn test \u901a\u8fc7\u6267\u884c\u4e0a\u9762\u7684\u547d\u4ee4\uff0c\u4f60\u53ef\u4ee5\u5728\u63a7\u5236\u53f0\u770b\u5230\u7c7b\u4f3c\u7684\u8f93\u51fa\uff1a [INFO] ------------------------------------------------------------------- [INFO] Building Maven Quick Start Archetype [INFO] task-segment: [test] [INFO] ------------------------------------------------------------------- [INFO] artifact org.apache.maven.plugins:maven-surefire-plugin: \\ checking for updates from central ... [INFO] [resources:resources] [INFO] [compiler:compile] [INFO] Nothing to compile - all classes are up to date [INFO] [resources:testResources] [INFO] [compiler:testCompile] Compiling 1 source file to C:\\Test\\Maven2\\test\\my-app\\target\\test-classes ... [INFO] [surefire:test] [INFO] Setting reports dir: C:\\Test\\Maven2\\test\\my-app\\target/surefire-reports ------------------------------------------------------- T E S T S ------------------------------------------------------- [surefire] Running com.mycompany.app.AppTest [surefire] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0 sec Results : [surefire] Tests run: 1, Failures: 0, Errors: 0 [INFO] ------------------------------------------------------------------- [INFO] BUILD SUCCESSFUL [INFO] ------------------------------------------------------------------- [INFO] Total time: 15 seconds [INFO] Finished at: Thu Oct 06 08:12:17 MDT 2005 [INFO] Final Memory: 2M/8M [INFO] ------------------------------------------------------------------- \u9700\u8981\u989d\u5916\u7684\u6ce8\u610f\u7684\u662f surefire \u63d2\u4ef6\uff08\u5b83\u4f1a\u8fd0\u884c\u6d4b\u8bd5\u7528\u4f8b\uff09\u4f1a\u5bfb\u627e ${basedir}/src/test/java \u4e0b\u5177\u6709\u7279\u5b9a\u547d\u540d\u89c4\u5219\u7684\u6d4b\u8bd5\u6587\u4ef6\u6267\u884c\u6d4b\u8bd5\uff0c\u4f8b\u5982\uff1a **/*Test.java **/Test*.java **/*TestCase.java \u4f46\u4f1a\u6392\u9664\u5177\u6709\u4ee5\u4e0b\u547d\u540d\u89c4\u5219\u7684\u6587\u4ef6\uff1a **/Abstract*Test.java **/Abstract*TestCase.java \u4ece\u4e0a\u9762\u7684\u8f93\u51fa\u53ef\u4ee5\u770b\u51fa\uff0c\u6784\u5efa\u8fc7\u7a0b\u6267\u884c\u4e86\u6e90\u7801\u7f16\u8bd1\u3001\u6d4b\u8bd5\u6e90\u7801\u7f16\u8bd1\u5e76\u4e14\u8fd0\u884c\u4e86\u5355\u5143\u6d4b\u8bd5\uff0c\u4f60\u53ef\u80fd\u4f1a\u89c9\u5f97\u5947\u602a\u4e3a\u4ec0\u4e48 test \u547d\u4ee4\u80fd\u6267\u884c\u8fd9\u4e48\u591a\u64cd\u4f5c\uff0c\u8fd9\u662f\u56e0\u4e3a test \u4f1a\u6267\u884c test \u9636\u6bb5\u4e4b\u524d\u6240\u6709\u7684\u9636\u6bb5\uff0c\u8be6\u89c1 Maven \u7684\u6784\u5efa\u751f\u547d\u5468\u671f \u3002 \u5982\u679c\u4f60\u53ea\u60f3\u7f16\u8bd1\u6d4b\u8bd5\u6e90\u7801\u4f46\u4e0d\u8fd0\u884c\u5355\u5143\u6d4b\u8bd5\uff0c\u4f60\u53ef\u4ee5\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a mvn test-compile","title":"\u5982\u4f55\u7f16\u8bd1\u6d4b\u8bd5\u6e90\u7801\u5e76\u4e14\u8fd0\u884c\u5355\u5143\u6d4b\u8bd5"},{"location":"Maven/Maven\u6982\u8ff0/#jar","text":"\u8981\u751f\u6210 JAR \u6587\u4ef6\uff0c\u9996\u5148\u4f60\u9700\u8981\u5728 POM \u4e2d\u6307\u5b9a <packaging> \u503c\u4e3a jar \uff08\u6216\u8005\u4e0d\u8fdb\u884c\u6307\u5b9a\uff0c\u9ed8\u8ba4\u503c\u4e3a jar \uff09\uff0c\u8fd9\u5c06\u8ba9 Maven \u77e5\u9053\u8981\u751f\u6210\u4e00\u4e2a jar \u6587\u4ef6\uff0c\u7136\u540e\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a mvn package \u5f53\u547d\u4ee4\u6267\u884c\u5b8c\u6210\u540e\uff0c\u4f60\u53ef\u4ee5\u5728 ${basedir}/target \u76ee\u5f55\u4e0b\u770b\u5230\u751f\u6210\u7684 JAR \u6587\u4ef6\u3002 \u5982\u679c\u4f60\u60f3\u5b89\u88c5\u4f60\u7684\u751f\u6210\u7684\u5de5\u4ef6\uff08\u8fd9\u91cc\u662f JAR \u6587\u4ef6\uff09\u5230\u4f60\u7684\u672c\u5730\u4ed3\u5e93\uff08 ${user.home}/.m2/repository \u662f\u9ed8\u8ba4\u7684\u4ed3\u5e93\u4f4d\u7f6e\uff09\u3002\u4f60\u53ef\u4ee5\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff1a mvn install \u901a\u8fc7\u6267\u884c\u4e0a\u9762\u7684\u547d\u4ee4\uff0c\u4f60\u53ef\u4ee5\u5728\u63a7\u5236\u53f0\u770b\u5230\u7c7b\u4f3c\u7684\u8f93\u51fa\uff1a [INFO] ------------------------------------------------------------------- [INFO] Building Maven Quick Start Archetype [INFO] task-segment: [install] [INFO] ------------------------------------------------------------------- [INFO] [resources:resources] [INFO] [compiler:compile] Compiling 1 source file to <dir>/my-app/target/classes [INFO] [resources:testResources] [INFO] [compiler:testCompile] Compiling 1 source file to <dir>/my-app/target/test-classes [INFO] [surefire:test] [INFO] Setting reports dir: <dir>/my-app/target/surefire-reports ------------------------------------------------------- T E S T S ------------------------------------------------------- [surefire] Running com.mycompany.app.AppTest [surefire] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.001 sec Results : [surefire] Tests run: 1, Failures: 0, Errors: 0 [INFO] [jar:jar] [INFO] Building jar: <dir>/my-app/target/my-app-1.0-SNAPSHOT.jar [INFO] [install:install] [INFO] Installing <dir>/my-app/target/my-app-1.0-SNAPSHOT.jar to \\ <local-repository>/com/mycompany/app/my-app/1.0-SNAPSHOT/my-app-1.0-SNAPSHOT.jar [INFO] ------------------------------------------------------------------- [INFO] BUILD SUCCESSFUL [INFO] ------------------------------------------------------------------- [INFO] Total time: 5 seconds [INFO] Finished at: Tue Oct 04 13:20:32 GMT-05:00 2005 [INFO] Final Memory: 3M/8M [INFO] -------------------------------------------------------------------","title":"\u5982\u4f55\u751f\u6210\u4e00\u4e2aJAR\u5305\u5e76\u5b89\u88c5\u5230\u672c\u5730\u4ed3\u5e93"},{"location":"Maven/Maven\u6982\u8ff0/#_4","text":"\u5f53\u4f60\u60f3\u8981\u81ea\u5b9a\u4e49 Maven \u9879\u76ee\u7684\u6784\u5efa\u65f6\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u6dfb\u52a0\u6216\u91cd\u65b0\u914d\u7f6e\u63d2\u4ef6\u6765\u5b9e\u73b0\u3002\u4e0b\u9762\u7684\u4f8b\u5b50\u6211\u4eec\u901a\u8fc7\u914d\u7f6e\u4f7f Java \u7f16\u8bd1\u5668\u5141\u8bb8 JDK 5.0 \u7684\u6e90\uff0c\u4f60\u53ef\u4ee5\u7b80\u5355\u5730\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a ... <build> <plugins> <plugin> <groupId>org.apache.maven.plugins</groupId> <artifactId>maven-compiler-plugin</artifactId> <version>3.3</version> <configuration> <source>1.5</source> <target>1.5</target> </configuration> </plugin> </plugins> </build> ... Maven \u4f1a\u81ea\u52a8\u4e0b\u8f7d\u548c\u4f7f\u7528\u4f60\u6307\u5b9a\u7248\u672c\u7684\u63d2\u4ef6\uff08\u5982\u679c\u4f60\u6ca1\u6709\u6307\u5b9a\u63d2\u4ef6\u7248\u672c\uff0c\u5219\u9ed8\u8ba4\u4f7f\u7528\u6700\u65b0\u7248\u672c\uff09\u3002 \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c configuration \u5143\u7d20\u4f1a\u88ab\u5e94\u7528\u5230 compiler \u63d2\u4ef6\u7684\u6240\u6709\u76ee\u6807\uff08goal\uff09\u4e0a\uff08\u6ce8\uff1a\u4f60\u4e5f\u53ef\u4ee5\u5728 <plugin> \u7684\u5b50\u5143\u7d20 <execution> \u4e2d\u5c06 configuration \u5e94\u7528\u7684\u67d0\u4e00\u4e2a\u76ee\u6807\u4e0a\uff09\uff0c\u5b9e\u9645\u4e0a compiler \u63d2\u4ef6\u5df2\u7ecf\u5728\u6784\u5efa\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u4e86\uff0c\u4e0a\u9762\u7684\u4f8b\u5b50\u53ea\u662f\u4fee\u6539\u4e86\u90e8\u5206\u914d\u7f6e\u4fe1\u606f\u3002\u4f60\u4e5f\u53ef\u4ee5\u4e3a\u6784\u5efa\u8fc7\u7a0b\u6dfb\u52a0\u65b0\u7684\u63d2\u4ef6\u76ee\u6807\uff0c\u66f4\u591a\u4fe1\u606f\u53ef\u4ee5\u67e5\u770b Maven \u7684\u6784\u5efa\u751f\u547d\u5468\u671f \u3002 \u4f60\u53ef\u4ee5\u5728 Maven \u5b98\u65b9\u6587\u6863\u4e2d\u67e5\u770b\u66f4\u591a\u53ef\u7528\u7684\u63d2\u4ef6\uff0c\u8be6\u89c1 Plugins List \u3002\u5b98\u65b9\u6587\u6863\u540c\u65f6\u4e5f\u5bf9 Maven \u63d2\u4ef6\u7684\u914d\u7f6e\u548c\u8fdb\u884c\u4e86\u6bd4\u8f83\u8be6\u7ec6\u7684\u4ecb\u7ecd\uff0c\u8be6\u89c1 Guide to Configuring Plugins \u3002","title":"\u5982\u4f55\u4f7f\u7528\u63d2\u4ef6"},{"location":"Maven/Maven\u6982\u8ff0/#jar_1","text":"\u5728 JAR \u5305\u4e2d\u6dfb\u52a0\u8d44\u6e90\u6587\u4ef6\u662f\u4e00\u4e2a\u5e38\u89c1\u7684\u9700\u6c42\uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u9700\u6c42 Maven \u4ecd\u7136\u4f9d\u8d56\u4e8e\u7684\u4ed6\u7684\u6807\u51c6\u6587\u4ef6\u5e03\u5c40\uff08 Standard Directory Layout \uff09\uff0c\u8fd9\u610f\u5473\u7740\u53ea\u8981\u9075\u5b88 Maven \u7684\u6807\u51c6\u7ea6\u5b9a\uff0c\u4f60\u5c31\u53ef\u4ee5\u901a\u8fc7\u7b80\u5355\u5730\u5c06\u8fd9\u4e9b\u8d44\u6e90\u6587\u4ef6\u653e\u5728\u6807\u51c6\u7684\u76ee\u5f55\u7ed3\u6784\u4e0b\u5b9e\u73b0\u5728 JAR \u5305\u4e2d\u5c01\u88c5\u8d44\u6e90\u3002 \u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u6dfb\u52a0\u4e86 ${basedir}/src/main/resources \u76ee\u5f55\u5e76\u628a\u60f3\u8981\u88ab\u6253\u5305\u8fdb JAR \u5305\u7684\u8d44\u6e90\u90fd\u653e\u5728\u8be5\u76ee\u5f55\u4e0b\u3002 Maven \u91c7\u7528\u7684\u89c4\u5219\u662f\uff1a\u653e\u5728 ${basedir}/src/main/resources \u76ee\u5f55\u4e0b\u7684\u4efb\u4f55\u6587\u4ef6\u6216\u8005\u6587\u4ef6\u5939\u90fd\u4f1a\u88ab\u6253\u5305\u8fdb\u884c JAR \u5305\u4e2d\uff0c\u5e76\u4e14\u8fd9\u4e9b\u8d44\u6e90\u7684\u6587\u4ef6\u7ed3\u6784\u5c06\u5728 JAR \u5305\u5185\u4e0e\u539f\u6765\u4e00\u81f4\u3002 my-app |-- pom.xml `-- src |-- main | |-- java | | `-- com | | `-- mycompany | | `-- app | | `-- App.java | `-- resources | `-- META-INF | `-- application.properties `-- test `-- java `-- com `-- mycompany `-- app `-- AppTest.java \u5982\u4f60\u6240\u89c1\uff0c\u6211\u4eec\u5728 resource \u6587\u4ef6\u4e0b\u521b\u5efa\u4e86\u4e00\u4e2a META-INF \u6587\u4ef6\u5939\u5e76\u65b0\u5efa\u4e86\u4e00\u4e2a application.properties \u6587\u4ef6\u3002\u5982\u679c\u4f60\u89e3\u538b\u4e86\u7531\u4e0a\u9762\u7684\u9879\u76ee\u751f\u6210\u7684 JAR \u5305\uff0c\u4f60\u53ef\u4ee5\u770b\u5230\u5982\u4e0b\u7ed3\u6784\uff1a |-- META-INF | |-- MANIFEST.MF | |-- application.properties | `-- maven | `-- com.mycompany.app | `-- my-app | |-- pom.properties | `-- pom.xml `-- com `-- mycompany `-- app `-- App.class \u53ef\u4ee5\u770b\u5230\u5728 resources \u6587\u4ef6\u4e2d\u6dfb\u52a0\u7684\u5185\u5bb9\u90fd\u4ee5\u76f8\u540c\u7684\u7ed3\u6784\u51fa\u73b0\u5728 JAR \u5305\u4e2d\u4e86\uff0c\u4f46\u4f60\u53ef\u80fd\u6ce8\u610f\u5230\u4e86\u51e0\u4e2a\u989d\u5916\u7684\u6587\u4ef6\uff08 MANIFEST.MF, pom.xml, pom.properties \uff09\u548c\u76ee\u5f55\uff0c\u5176\u5b9e\u8fd9\u4e9b\u90fd\u662f Maven \u751f\u6210 JAR \u5305\u7684\u6807\u51c6\u4ea7\u51fa\u7269\uff08\u6ce8\uff1a\u5176\u5b9e META-INF \u5c31\u662f\u6807\u51c6\u4ea7\u51fa\u7684\u4e00\u90e8\u5206\uff0c\u53ea\u662f\u7531\u4e8e\u5728 resources \u4e2d\u53d6\u4e86\u76f8\u540c\u7684\u540d\u5b57\u6240\u4ee5 application.properties \u4f1a\u51fa\u73b0\u5728\u8fd9\u4e2a\u4f4d\u7f6e\uff09\uff0c\u8fd9\u4e9b\u6587\u4ef6\u5b58\u5728\u76ee\u7684\u662f\u8ba9 Maven \u751f\u6210\u7684\u5de5\u4ef6\u80fd\u591f\u5b9e\u73b0\u81ea\u8ff0\uff08 self-describing \uff09\u3002","title":"\u5982\u4f55\u5f80JAR\u6587\u4ef6\u4e2d\u6dfb\u52a0\u8d44\u6e90\u6587\u4ef6"},{"location":"Maven/Maven\u6982\u8ff0/#_5","text":"\u6709\u65f6\u8d44\u6e90\u6587\u4ef6\u9700\u8981\u5305\u542b\u4e00\u4e9b\u53ea\u80fd\u5728\u6784\u5efa\u9636\u6bb5\u624d\u63d0\u4f9b\u7684\u503c\uff0c\u8981\u5728 Maven \u4e2d\u5b8c\u6210\u6b64\u64cd\u4f5c\uff0c\u53ef\u4ee5\u4f7f\u7528\u8bed\u6cd5 $ {<property name>} \u5c06\u5305\u542b\u503c\u7684\u5c5e\u6027\u5f15\u7528\u5230\u8d44\u6e90\u6587\u4ef6\u4e2d\u3002\u8be5\u5c5e\u6027\u53ef\u4ee5\u662f pom.xml \u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\u4e00\u4e2a\u503c\uff0c\u5728\u67d0\u7528\u6237\u7684 setting.xml \u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\u503c\uff0c\u4e00\u4e2a\u5916\u90e8\u7684properties \u6587\u4ef6\u4e2d\u7684\u5c5e\u6027\u6216\u8005\u662f\u7cfb\u7edf\u5c5e\u6027\u3002 \u4e3a\u4e86\u5728\u8d44\u6e90\u51c6\u5907\u9636\u6bb5\uff08 process-resources phase \uff09\u5c06\u8bed\u6cd5 $ {<property name>} \u66ff\u6362\uff08 filter \uff09\u4e3a\u7279\u5b9a\u7684\u503c\uff0c\u53ea\u8981\u7b80\u5355\u5730\u5c06 pom.xml \u6587\u4ef6\u4e2d\u7684 <filtering> \u8bbe\u7f6e\u4e3a true \u5373\u53ef\uff1a <project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"> <modelVersion>4.0.0</modelVersion> <groupId>com.mycompany.app</groupId> <artifactId>my-app</artifactId> <version>1.0-SNAPSHOT</version> <packaging>jar</packaging> <name>Maven Quick Start Archetype</name> <url>http://maven.apache.org</url> <dependencies> <dependency> <groupId>junit</groupId> <artifactId>junit</artifactId> <version>4.11</version> <scope>test</scope> </dependency> </dependencies> <build> <resources> <resource> <directory>src/main/resources</directory> <filtering>true</filtering> </resource> </resources> </build> </project> \u5982\u4e0a\u6240\u793a\uff0c\u6211\u4eec\u6dfb\u52a0\u4e86 <build>\u3001<resources> \u4ee5\u53ca <resource> \u5143\u7d20\uff0c\u800c\u4e14\u8fd8\u660e\u786e\u58f0\u660e\u4e86 src/main/resources \u4e3a\u8d44\u6e90\u6587\u4ef6\u6240\u5728\u7684\u4f4d\u7f6e\u3002\u8fd9\u4e9b\u4fe1\u606f\u5728\u672a\u58f0\u660e\u524d\u90fd\u662f\u4ee5\u9ed8\u8ba4\u503c\u7684\u5f62\u5f0f\u63d0\u4f9b\uff0c\u4f46\u7531\u4e8e <filtering> \u7684\u9ed8\u8ba4\u503c\u4e3a false \uff0c\u6240\u4ee5\u6211\u4eec\u5fc5\u987b\u663e\u793a\u5730\u58f0\u660e\u5b83\u5e76\u4e14\u8bbe\u7f6e\u4e3a true \u3002 \u4e0b\u9762\u8ba9\u6211\u4eec\u5728 application.properties \u6587\u4ef6\u4e2d\u6dfb\u52a0\u4e24\u4e2a\u5c5e\u6027\uff0c\u5b83\u4eec\u4f1a\u5728\u6784\u5efa\u9636\u6bb5\u88ab\u66ff\u6362\u4e3a\u7279\u5b9a\u7684\u503c\uff1a # application.properties application.name=${project.name} application.version=${project.version} \u5176\u4e2d ${project.name} \u548c ${project.version} \u4e3a Maven \u7684\u9879\u76ee\u53d8\u91cf\uff0c\u5206\u522b\u4ee3\u8868\u5f53\u524d\u9879\u76ee\u7684\u540d\u5b57\u548c\u7248\u672c\uff0c\u8be6\u89c1 \u9879\u76ee\u53d8\u91cf\u4ee5\u53ca\u63d2\u503c \u90e8\u5206\u3002\u4e4b\u540e\uff0c\u4f60\u53ef\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff08 process-resources \u662f\u6784\u5efa\u751f\u547d\u5468\u671f\u7684\u4e00\u4e2a\u9636\u6bb5\uff0c\u6267\u884c\u8d44\u6e90\u6587\u4ef6\u7684\u590d\u5236\u548c\u66ff\u6362\uff09\uff1a mvn process-resources \u7136\u540e\uff0c\u4f60\u4f1a\u5728 target/classes \u76ee\u5f55\u4e0b\u770b\u5230\u66ff\u6362\u4e4b\u540e\u7684 application.properties \u5982\u4e0b\uff1a # application.properties application.name=Maven Quick Start Archetype application.version=1.0-SNAPSHOT \u5982\u679c\u4f60\u8981\u5f15\u7528\u5916\u90e8 properties \u6587\u4ef6\uff08\u6307\u7684\u5e94\u8be5\u662f\u975e\u7cfb\u7edf\u5c5e\u6027\u548c pom.xml \u4e2d\u5b9a\u4e49\u7684\u5c5e\u6027\uff0c\u5373\u4f7f properties \u6587\u4ef6\u5728 resources \u76ee\u5f55\u4e0b\uff09\u7684\u67d0\u4e00\u4e2a\u5c5e\u6027\uff0c\u4f60\u9700\u8981\u5728 pom.xml \u4e2d\u6dfb\u52a0\u5bf9\u8fd9\u4e2a\u5916\u90e8\u6587\u4ef6\u7684\u5f15\u7528\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u5916\u90e8 properties \u6587\u4ef6\uff0c\u5b83\u7684\u5b8c\u6574\u8def\u5f84\u4e3a src/main/filters/filter.properties \uff0c\u5185\u5bb9\u5982\u4e0b\uff1a # filter.properties my.filter.value=hello! \u73b0\u5728\uff0c\u6211\u4eec\u9700\u8981\u5728 pom.xml \u4e2d\u6dfb\u52a0\u65b0\u7684\u5f15\u7528\uff1a ... <build> <filters> <filter>src/main/filters/filter.properties</filter> </filters> <resources> <resource> <directory>src/main/resources</directory> <filtering>true</filtering> </resource> </resources> </build> ... \u63a5\u7740\uff0c\u5c31\u53ef\u4ee5\u5728 application.properties \u6587\u4ef6\u4e2d\u5f15\u7528\u8fd9\u4e2a\u5c5e\u6027\u4e86\uff1a # application.properties application.name=${project.name} application.version=${project.version} message=${my.filter.value} \u5728\u5916\u90e8\u6587\u4ef6\u4e2d\u5b9a\u4e49my.filter.value\u5c5e\u6027\u7684\u66ff\u4ee3\u65b9\u6848\u662f\u5728 pom.xml \u7684 <properties> \u5143\u7d20\u4e2d\u5b9a\u4e49\u5b83\u5e76\u83b7\u5f97\u76f8\u540c\u7684\u6548\u679c\uff08\u6ce8\u610f\uff0c\u8fd9\u91cc\u6ca1\u6709\u6dfb\u52a0 filters \u5143\u7d20\uff09\uff1a ... <build> <resources> <resource> <directory>src/main/resources</directory> <filtering>true</filtering> </resource> </resources> </build> <properties> <my.filter.value>hello</my.filter.value> </properties> ... \u66ff\u6362\u503c\u4e5f\u53ef\u4ee5\u4ece\u7cfb\u7edf\u5c5e\u6027\u4e2d\u83b7\u53d6\uff0c\u5305\u62ec Java \u5185\u7f6e\u7684\u7cfb\u7edf\u5c5e\u6027\uff08\u5982 java.version, user.home \uff09\u6216\u8005\u4f7f\u7528 Java -D \u53c2\u6570\u5728\u547d\u4ee4\u884c\u4e0a\u5b9a\u4e49\u7684\u5c5e\u6027\u3002 \u4f8b\u5982\uff0c application.properties \u7684\u5185\u5bb9\u5982\u4e0b\uff1a # application.properties java.version=${java.version} command.line.prop=${command.line.prop} \u6211\u4eec\u5c06\u5728\u547d\u4ee4\u884c\u4e0a\u5b9a\u4e49 command.line.prop \u5c5e\u6027\u7684\u503c\uff0c\u5982\u4e0b\uff1a mvn process-resources \"-Dcommand.line.prop=hello again\"","title":"\u5982\u4f55\u66ff\u6362\u8d44\u6e90\u6587\u4ef6\u4e2d\u7684\u5f15\u7528\u503c"},{"location":"Maven/Maven\u6982\u8ff0/#_6","text":"\u5916\u90e8\u4f9d\u8d56\u5373 POM \u4e2d\u7684 <dependencies> \u90e8\u5206\u5b9a\u4e49\u7684\u5185\u5bb9\uff08\u4f8b\u5982\u4e4b\u524d\u4f8b\u5b50\u4e2d\u7684 junit jar \u5305\uff09\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u4e86\u89e3\u5b83\u662f\u5982\u4f55\u5de5\u4f5c\u7684\u3002\u66f4\u52a0\u5168\u9762\u7684\u4ecb\u7ecd\uff0c\u8bf7\u53c2\u8003\u5b98\u65b9\u6587\u6863\u5bf9\u4f9d\u8d56\u673a\u5236\u7684\u4ecb\u7ecd\uff08 Introduction to Dependency Mechanism \uff09\u3002 \u8ba9\u6211\u4eec\u4ee5\u4e4b\u524d\u7684\u9879\u76ee\u4e3a\u4f8b\u5b50\uff1a <project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"> <modelVersion>4.0.0</modelVersion> <groupId>com.mycompany.app</groupId> <artifactId>my-app</artifactId> <version>1.0-SNAPSHOT</version> <packaging>jar</packaging> <name>Maven Quick Start Archetype</name> <url>http://maven.apache.org</url> <dependencies> <dependency> <groupId>junit</groupId> <artifactId>junit</artifactId> <version>4.11</version> <scope>test</scope> </dependency> </dependencies> </project> \u5bf9\u4e8e\u5916\u90e8\u4f9d\u8d56\uff0c\u4f60\u9700\u8981\u81f3\u5c11\u5b9a\u4e494\u4e2a\u5c5e\u6027\uff1a groupId, artifactId, version \u548c scope \u3002\u5176\u4e2d groupId, artifactId, version \u5c31\u662f\u4f60\u9700\u8981\u5f15\u7528\u7684\u9879\u76ee\u7684 pom.xml \u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\uff0c\u800c scope \u8868\u793a\u4f60\u8981\u5728\u54ea\u4e2a\u8303\u56f4\u5185\u4f7f\u7528\u8fd9\u4e2a\u4f9d\u8d56\uff0c\u4e0b\u8868\u4e3a scope \u53ef\u7528\u7684\u503c\uff1a Scope \u63cf\u8ff0 compile compile \u4e3a scope \u7684\u9ed8\u8ba4\u503c\uff0c\u5982\u679c\u672a\u6307\u5b9a scope \u5219 scope \u7684\u503c\u4e3a compile \u3002\u6b64\u8303\u56f4\u7684\u4f9d\u8d56\u9879\uff08 dependencie \uff09\u5728\u9879\u76ee\u7684\u6240\u6709\u7c7b\u8def\u5f84\uff08 classpath \uff09\u4e0b\u90fd\u53ef\u4ee5\u4f7f\u7528\uff0c\u5e76\u4e14\u5982\u679c\u5176\u4ed6\u9879\u76ee\u4f9d\u8d56\u8be5\u9879\u76ee\uff0c\u4f9d\u8d56\u4e86\u8be5\u9879\u76ee\u7684\u9879\u76ee\u4e5f\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u4f9d\u8d56\u9879\u3002 provided \u7c7b\u4f3c\u4e8e compile \uff0c\u4f46 provided \u8868\u793a\u4f9d\u8d56\u9879\u5728\u8fd0\u884c\u65f6\u7531 JDK \u6216\u5bb9\u5668\u63d0\u4f9b\u3002\u4f8b\u5982\uff0c\u5728\u6784\u5efa JaveEE WEB \u9879\u76ee\u65f6\uff0c\u4f60\u5e94\u8be5\u628a Servlet API \u548c Java EE APIs \u4f9d\u8d56\u9879\u7684\u8303\u56f4\u8bbe\u7f6e\u4e3a provided, \u56e0\u4e3a WEB \u5bb9\u5668\u7684 classpaths \u4f1a\u63d0\u4f9b\u8fd9\u4e9b\u7c7b\u3002\u6b64\u8303\u56f4\u7684\u4f9d\u8d56\u9879\u53ea\u80fd\u5728\u7f16\u8bd1\u548c\u6d4b\u8bd5\u7c7b\u8def\u5f84\u4e2d\u4f7f\u7528\uff0c\u4e14\u4e0d\u5177\u6709\u4f20\u9012\u6027\u3002 runtime \u6b64\u8303\u56f4\u8868\u660e\uff0c\u5728\u8fd0\u884c\u65f6\u9700\u8981\u8be5\u4f9d\u8d56\u9879\u4f46\u7f16\u8bd1\u65f6\u4e0d\u9700\u8981\u3002\u5b83\u4f4d\u4e8e\u8fd0\u884c\u65f6\u548c\u6d4b\u8bd5\u7c7b\u8def\u5f84\u4e0b\u3002 test \u6b64\u8303\u56f4\u8868\u660e\uff0c\u8be5\u4f9d\u8d56\u9879\u53ea\u5728\u6d4b\u8bd5\u90e8\u5206\u7684\u7f16\u8bd1\u548c\u8fd0\u884c\u9636\u6bb5\u4f7f\u7528\uff0c\u5e76\u4e14\u4e0d\u5177\u6709\u4f20\u9012\u6027\u3002 system \u7c7b\u4f3c\u4e8e provided \uff0c\u4f46\u5fc5\u987b\u63d0\u4f9b\u660e\u786e\u5305\u542b\u4e86\u4f9d\u8d56\u9879\u7684 jar \u5305\u3002 \u901a\u8fc7\u8fd9\u4e9b\u4f9d\u8d56\u4fe1\u606f\uff0c Maven \u80fd\u591f\u5728\u6784\u5efa\u9879\u76ee\u65f6\u901a\u8fc7\u8fd9\u4e9b\u4fe1\u606f\u627e\u5230\u8fd9\u4e9b\u4f9d\u8d56\u9879\u3002 Maven \u4f1a\u5728\u672c\u5730\u4ed3\u5e93\uff08\u9ed8\u8ba4\u4f4d\u7f6e\u4e3a ${user.home}/.m2/repository \uff09\u67e5\u627e\u4f9d\u8d56\uff0c\u5728 \u5982\u4f55\u751f\u6210\u4e00\u4e2aJAR\u5305\u5e76\u5b89\u88c5\u5230\u672c\u5730\u4ed3\u5e93 \u4e2d\u6211\u5c06 my-app-1.0-SNAPSHOT.jar \u5b89\u88c5\u5230\u4e86\u672c\u5730\u4ed3\u5e93\u4e2d\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5728\u5176\u4ed6\u9879\u76ee\u7684 pom.xml \u6587\u4ef6\u4e2d\u6dfb\u52a0\u4f9d\u8d56\u4fe1\u606f\u6765\u5f15\u7528\u8fd9\u4e2a jar \u5305\uff1a <project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"> <groupId>com.mycompany.app</groupId> <artifactId>my-other-app</artifactId> ... <dependencies> ... <dependency> <groupId>com.mycompany.app</groupId> <artifactId>my-app</artifactId> <version>1.0-SNAPSHOT</version> <scope>compile</scope> </dependency> </dependencies> </project> \u5982\u679c\u9879\u76ee\u5f15\u7528\u4e86\u672c\u5730\u4ed3\u5e93\u4e2d\u4e0d\u5b58\u5728\u7684\u4f9d\u8d56\u9879\uff0c Maven \u4f1a\u5c06\u8be5\u4f9d\u8d56\u4ece\u8fdc\u7a0b\u4ed3\u5e93\u4e0b\u8f7d\u5230\u672c\u5730\u4ed3\u5e93\u4e2d\u3002 Maven \u9ed8\u8ba4\u4f7f\u7528\u7684\u8fdc\u7a0b\u4ed3\u5e93\u4e3a http://repo.maven.apache.org/maven2/ \uff0c\u4f60\u4e5f\u53ef\u4ee5\u914d\u7f6e\u81ea\u5df1\u7684\u8fdc\u7a0b\u4ed3\u5e93\uff08\u56fd\u5185\u53ef\u4ee5\u4f7f\u7528\u963f\u91cc\u7684\u8fdc\u7a0b\u4ed3\u5e93 http://maven.aliyun.com/nexus/content/groups/public \uff09\u6765\u66ff\u4ee3\u6216\u505a\u4e3a\u9ed8\u8ba4\u4ed3\u5e93\u7684\u8865\u5145\u3002\u66f4\u591a\u5173\u4e8e\u4ed3\u5e93\u7684\u7684\u8d44\u6599\u53ef\u4ee5\u53c2\u8003\u5b98\u65b9\u6587\u6863 Introduction to Repositories \u3002","title":"\u5982\u4f55\u4f7f\u7528\u5916\u90e8\u4f9d\u8d56"},{"location":"Others/Netty NIO\u7b14\u8bb0/","text":"Netty NIO\u7b14\u8bb0 Netty\u67b6\u6784 Netty NIO\u5bf9 Java NIO \u8fdb\u884c\u4e86\u5c01\u88c5\uff0c\u7b80\u5316\u4e86 Java NIO \u7f16\u7801\u5de5\u4f5c\u548c\u5b58\u5728\u7684BUG\u3002 Reactor\u7ebf\u7a0b\u6a21\u578b \u5728\u4ecb\u7ecdNetty\u7ebf\u7a0b\u6a21\u578b\u4e4b\u524d\uff0c\u5148\u7b80\u5355\u4ecb\u7ecdReactor\u7ebf\u7a0b\u6a21\u578b\uff0cReactor\u662f\u57fa\u4e8e\u4e8b\u4ef6\u9a71\u52a8\u7684\u6a21\u578b\uff0c\u5206\u4e3a\u4e09\u4e2a\u89d2\u8272\uff1a Acceptor\uff1a\u8d1f\u8d23\u63a5\u6536Accept\u4e8b\u4ef6\uff0c\u7136\u540e\u5c06\u8fde\u63a5\u6ce8\u518c\u6210\u8bfb\u4e8b\u4ef6\uff0c\u4f20\u9012\u7ed9dispatch; Dispatch\uff1a\u8d1f\u8d23\u5206\u53d1\u4e8b\u4ef6\uff0c\u5982\u679c\u662f\u63a5\u6536\u5230Accept\u4e8b\u4ef6,\u5219\u5206\u53d1\u7ed9Acceptor\u3002\u5982\u679c\u662fRead\u4e8b\u4ef6\uff0c\u5c06\u8bf7\u6c42\u4ea4\u7ed9ReadHandler\u5904\u7406\uff1b Handler\uff1a\u8d1f\u8d23\u5904\u7406\u5177\u4f53\u4e8b\u4ef6\uff1b Reactor\u7ebf\u7a0b\u6a21\u578b\u5173\u6ce8\u7684\u662f\uff1a\u4efb\u52a1\u63a5\u53d7\u4e4b\u540e\uff0c\u5bf9\u5904\u7406\u8fc7\u7a0b\u7ee7\u7eed\u8fdb\u884c\u5207\u5206\uff0c\u5212\u5206\u4e3a\u591a\u4e2a\u4e0d\u540c\u7684\u6b65\u9aa4\uff0c\u6bcf\u4e2a\u6b65\u9aa4\u7528\u4e0d\u540c\u7684\u7ebf\u7a0b\u6765\u5904\u7406\uff0c\u4e5f\u5c31\u662f\u539f\u672c\u7531\u4e00\u4e2a\u7ebf\u7a0b\u5904\u7406\u7684\u4efb\u52a1\u73b0\u5728\u7531\u591a\u4e2a\u7ebf\u7a0b\u6765\u5904\u7406\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u5728\u5904\u7406\u5b8c\u81ea\u5df1\u7684\u6b65\u9aa4\u4e4b\u540e\uff0c\u8fd8\u9700\u8981\u5c06\u4efb\u52a1\u8f6c\u53d1\u5230\u4e0b\u9636\u6bb5\u7ebf\u7a0b\u7ee7\u7eed\u8fdb\u884c\u5904\u7406\u3002 Netty\u4e2d\u7684Reactor\u6a21\u578b\u5982\u4e0b\uff1a \u5176\u4e2dmainReactor\u7ebf\u7a0b\u6c60\u8d1f\u8d23\u5904\u7406\u8fde\u63a5\u8bf7\u6c42\uff1b\u5f53acceptor\u63a5\u53d7\u8fde\u63a5\u540e\u4f1a\u5c06\u8fde\u63a5\u6ce8\u518c\u5230subReactor\u7684\u7ebf\u7a0b\u4e0a\uff1b\u7531subReactor\u6765\u5904\u7406IO\u8bf7\u6c42\uff1b\u800cThreadPool\u53ef\u4ee5\u7528\u6765\u5904\u7406\u8017\u65f6\u7684\u4e1a\u52a1\u903b\u8f91\u3002\u867d\u7136 Netty \u7684\u7ebf\u7a0b\u6a21\u578b\u57fa\u4e8e\u4e3b\u4ece Reactor \u591a\u7ebf\u7a0b\u6a21\u578b\uff0c\u4f46\u662f\u505a\u4e86\u90e8\u5206\u8c03\u6574\u548c\u4fee\u6539\uff0c\u5c06acceptor\u53d8\u6210\u4e86mainReactor\u4e2d\u7684\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u5e76\u4e14\u9ed8\u8ba4\u4f7f\u7528subReactor\u7ebf\u7a0b\u6c60\u4e2d\u7684\u7ebf\u7a0b\u6765\u5904\u7406compute\u5de5\u4f5c\uff0c\u540c\u65f6\u4e5f\u652f\u6301\u4f7f\u7528\u72ec\u7acb\u7684\u7ebf\u7a0b\u6c60\u5904\u7406compute\u5de5\u4f5c\uff0c\u8fd9\u9700\u8981\u8fdb\u884c\u624b\u52a8\u914d\u7f6e\u3002 Netty\u7ebf\u7a0b\u6a21\u578b Netty\u7ec4\u4ef6 NioEventLoop\u548cNioEventLoopGroup NioEventLoopGroup\u5b9e\u9645\u4e0a\u5c31\u662f\u4e00\u4e2a\u7ebf\u7a0b\u6c60\uff0c\u7ebf\u7a0b\u6c60\u4e2d\u6709\u591a\u4e2aNioEventLoop\u5de5\u4f5c\u7ebf\u7a0b\uff0c\u5982\u679c\u4e0d\u8fdb\u884c\u624b\u52a8\u8bbe\u7f6e\u9ed8\u8ba4\u5de5\u4f5c\u7ebf\u7a0b\u6570\u91cf\u4e3a\u7269\u7406\u673acpu\u6838\u5fc3\u6570\u91cf\u76842\u500d\u3002 \u6bcf\u4e2aNioEventLoop\u90fd\u7ed1\u5b9a\u4e86\u4e00\u4e2aSelector\u7528\u4e8e\u76d1\u542c\u6ce8\u518c\u5230Selector\u7684Channel\u7684IO\u4e8b\u4ef6\uff0cNioEventLoop\u7684\u5de5\u4f5c\u5305\u62ecIO\u4e8b\u4ef6\u76d1\u542c\u3001IO\u4e8b\u4ef6\u5904\u7406\u3001\u4ee5\u53ca\u4ea4\u7ed9NioEventLoop\u7684\u5176\u4ed6\u4efb\u52a1\u4e09\u4e2a\u90e8\u5206\u3002\u7531\u4e8eNetty\u6a21\u578b\u4e2d\u6709\u591a\u4e2aNioEventLoop\uff0c\u6240\u4ee5\u5b58\u5728\u591a\u7ec4Selector\u5728\u76d1\u542cIO\u5c31\u7eea\u4e8b\u4ef6\u3002 \u4e00\u4e2aNioEventLoop\u7684Selector\u53ef\u4ee5\u88ab\u591a\u4e2aChannel\u6ce8\u518c\uff0c\u4e5f\u5c31\u662f\u8bf4\u591a\u4e2aChannel\u5171\u4eab\u4e00\u4e2aEventLoop\u3002EventLoop\u7684Selecctor\u5bf9\u6240\u4ee5\u7ed1\u5b9a\u5230NioEventLoop\u7684Channel\u7684IO\u4e8b\u4ef6\u8fdb\u884c\u76d1\u542c\u3002\u4f46\u4e00\u4e2aChannel\u53ea\u80fd\u7ed1\u5b9a\u5230\u4e00\u4e2aNioEventLoop\u76f8\u5f53\u4e8e\u4e00\u4e2a\u8fde\u63a5\u7ed1\u5b9a\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u8fd9\u4e2a\u8fde\u63a5\u6240\u6709\u7684ChannelHandler\u90fd\u662f\u5728\u4e00\u4e2a\u7ebf\u7a0b\u4e2d\u6267\u884c\u7684\uff0c\u907f\u514d\u4e86\u591a\u7ebf\u7a0b\u5e72\u6270\u3002\u66f4\u91cd\u8981\u7684\u662fChannelPipline\u94fe\u8868\u5fc5\u987b\u4e25\u683c\u6309\u7167\u987a\u5e8f\u6267\u884c\u7684\u3002\u5355\u7ebf\u7a0b\u7684\u8bbe\u8ba1\u80fd\u591f\u4fdd\u8bc1ChannelHandler\u7684\u987a\u5e8f\u6267\u884c\u3002 \u5728\u76d1\u542c\u4e00\u4e2a\u7aef\u53e3\u7684\u60c5\u51b5\u4e0b\uff0c\u4e00\u4e2aNioEventLoop\u901a\u8fc7\u4e00\u4e2aNioServerSocketChannel\u76d1\u542c\u7aef\u53e3\uff0c\u5904\u7406TCP\u8fde\u63a5\u8bf7\u6c42\u3002\u540e\u7aef\u591a\u4e2aNioEventLoop\u5de5\u4f5c\u7ebf\u7a0b\u5904\u7406IO\u4e8b\u4ef6\u3002\u6bcf\u4e2aChannel\u7ed1\u5b9a\u4e00\u4e2aNioEventLoop\u7ebf\u7a0b\uff0c\u4e00\u4e2aNioEventLoop\u7ebf\u7a0b\u5173\u8054\u4e00\u4e2aSelector\u6765\u4e3a\u591a\u4e2a\u6ce8\u518c\u5230\u5b83\u7684Channel\u76d1\u542cIO\u5c31\u7eea\u4e8b\u4ef6\u3002NioEventLoop\u662f\u5355\u7ebf\u7a0b\u6267\u884c\uff0c\u4fdd\u8bc1ChannelPipline\u5728\u5355\u7ebf\u7a0b\u4e2d\u6267\u884c\uff0c\u4fdd\u8bc1\u4e86ChannelHandler\u7684\u6267\u884c\u987a\u5e8f\u3002 Channel Netty\u4e2d\u7684\u901a\u9053\u662f\u5bf9Java\u539f\u751f\u7f51\u7edcAPI\u7684\u5c01\u88c5\uff0c\u5176\u9876\u5c42\u63a5\u53e3\u4e3aChannel\u3002 \u4ee5TCP\u7f16\u7a0b\u4e3a\u4f8b \uff0c\u5728Java\u4e2d\uff0c\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a \u57fa\u4e8eBIO\uff0cJDK1.4\u4e4b\u524d\uff0c\u6211\u4eec\u901a\u5e38\u4f7f\u7528java.net\u5305\u4e2d\u7684ServerSocket\u548cSocket\u6765\u4ee3\u8868\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u3002 \u57fa\u4e8eNIO\uff0cJdk1.4\u5f15\u5165nio\u7f16\u7a0b\u4e4b\u540e\uff0c\u6211\u4eec\u4f7f\u7528java.nio.channels\u5305\u4e2d\u7684ServerSocketChannel\u548cSocketChannel\u6765\u4ee3\u8868\u670d\u52a1\u7aef\u4e0e\u5ba2\u6237\u7aef\u3002 \u5728Netty\u4e2d\uff0c\u5bf9java\u4e2d\u7684BIO\u3001NIO\u7f16\u7a0bapi\u90fd\u8fdb\u884c\u4e86\u5c01\u88c5\uff0c\u5206\u522b\u4e3a\uff1a \u4f7f\u7528\u4e86OioServerSocketChannel\uff0cOioSocketChannel\u5bf9java.net\u5305\u4e2d\u7684ServerSocket\u4e0eSocket\u8fdb\u884c\u4e86\u5c01\u88c5 \u4f7f\u7528NioServerSocketChannel\u548cNioSocketChannel\u5bf9java.nio.channels\u5305\u4e2d\u7684ServerSocketChannel\u548cSocketChannel\u8fdb\u884c\u4e86\u5c01\u88c5\u3002 \u7531\u4e8e\u672c\u6587\u53ea\u5bf9NIO\u8fdb\u884c\u8bf4\u660e\uff0c\u6240\u4ee5\u5c31\u4e0d\u5bf9BIO\u76f8\u5173\u7684\u5185\u5bb9\u8fdb\u884c\u6df1\u5165\uff0cNetty\u4e2dNIO\u76f8\u5173\u7684Channel\u7c7b\u5173\u7cfb\u56fe\u5982\u4e0b\uff1a NioServerSocketChannel\u548cNioSocketChannel\u4e2d\u90fd\u6301\u6709\u5bf9\u5e94\u7684Java NIO Channel\u7684\u5f15\u7528\uff0c\u6240\u4ee5NioServerSocketChannel\u6ce8\u518c\u5230NioEventLoop\uff0c\u5b9e\u9645\u4e0a\u5c31\u662fJava NIO Channel\u6ce8\u518c\u5230\u7ed1\u5b9a\u5728NioEventLoop\u4e0a\u7684Selector\u3002\u4e8c\u8005\u90fd\u7ee7\u627f\u81eaAbstractNioChannel\uff0c\u5176\u7ef4\u62a4\u4e86Netty\u4e2d\u7684Channel\u4e0eJava NIO\u4e2dChannel\u7684\u5bf9\u5e94\u5173\u7cfb\uff0c\u5e76\u63d0\u4f9b\u4e86 javaChannel() \u65b9\u6cd5\u83b7\u53d6\u5bf9\u5e94\u7684Java Channel\u3002 public abstract class AbstractNioChannel extends AbstractChannel { ... private final SelectableChannel ch; ... // \u83b7\u53d6\u5bf9\u5e94\u7684java channel protected SelectableChannel javaChannel() { return ch; } } SelectableChannel\u662fJava NIO\u4e2d\u7684\u7c7b\uff0c\u6211\u4eec\u524d\u9762\u63d0\u5230nio\u5305\u4e2d\u7684SocketChannel\u3001ServerSocketChannel\u90fd\u662f\u5176\u5b50\u7c7b\uff0cNioSocketChannel\u548cNioServerSocketChannel\u5bf9AbstractNioChannel\u7684 javaChannel() \u8fdb\u884c\u4e86\u91cd\u5199\uff0c\u5c06SelectableChannel\u5f3a\u8f6c\u4e3a\u5bf9\u5e94Java Channel\uff0c\u5982\u4e0b\uff1a io.netty.channel.socket.nio.NioServerSocketChannel#javaChannel @Override // \u8fd4\u56dejava.nio.channels.ServerSocketChannel protected ServerSocketChannel javaChannel() { return (ServerSocketChannel) super.javaChannel(); } io.netty.channel.socket.nio.NioSocketChannel#javaChannel @Override // \u8fd4\u56dejava.nio.channels.SocketChannel protected SocketChannel javaChannel() { return (SocketChannel) super.javaChannel(); } \u5728\u521b\u5efaNioServerSocketChannel\u548cNioSocketChannel\u5bf9\u8c61\u65f6\uff0c\u4f1a\u5728\u6784\u9020\u51fd\u6570\u4e2d\u4e3a\u5176\u6307\u5b9a\u5bf9\u5e94\u7684ServerSocket\u548cSocket\u5b9e\u4f8b\uff0c\u4ee5NioServerSocketChannel\u4e3a\u4f8b\uff1a public class NioServerSocketChannel extends AbstractNioMessageChannel implements io.netty.channel.socket.ServerSocketChannel { private static final SelectorProvider DEFAULT_SELECTOR_PROVIDER = SelectorProvider.provider(); private static ServerSocketChannel newSocket(SelectorProvider provider) { try { // \u751f\u6210\u4e00\u4e2a\u65b0\u7684ServerSocketChannel\u5bf9\u8c61 return provider.openServerSocketChannel(); } catch (IOException e) { throw new ChannelException( \"Failed to open a server socket.\", e); } } public NioServerSocketChannel() { this(newSocket(DEFAULT_SELECTOR_PROVIDER)); } public NioServerSocketChannel(SelectorProvider provider) { this(newSocket(provider)); } public NioServerSocketChannel(ServerSocketChannel channel) { super(null, channel, SelectionKey.OP_ACCEPT); config = new NioServerSocketChannelConfig(this, javaChannel().socket()); } ... } ChannelHandler \u5728NIO\u7f16\u7a0b\u4e2d\uff0c\u6211\u4eec\u7ecf\u5e38\u9700\u8981\u5bf9Channel\u7684\u8f93\u5165\u548c\u8f93\u51fa\u4e8b\u4ef6\u8fdb\u884c\u5904\u7406\uff0cNetty\u62bd\u8c61\u51fa\u4e00\u4e2aChannelHandler\u6982\u5ff5\uff0c\u4e13\u95e8\u7528\u4e8e\u5904\u7406\u6b64\u7c7b\u4e8b\u4ef6\uff0c\u56e0\u6b64\u7f16\u5199Handler\u662f\u6211\u4eec\u8fdb\u884cNetty\u6846\u67b6\u7f16\u7a0b\u65f6\u4e3b\u8981\u7f16\u7801\u5de5\u4f5c\u3002IO\u4e8b\u4ef6\u5206\u4e3a\u51fa\u7ad9\u548c\u5165\u7ad9\uff0c\u56e0\u6b64ChannelHandler\u53c8\u5177\u4f53\u7684\u5206\u4e3aChannelInboundHandler\u548cChannelOutboundHandler \uff0c\u5206\u522b\u7528\u4e8e\u51fa\u7ad9\u548c\u5165\u7ad9\u65f6\u67d0\u4e2a\u9636\u6bb5\u4e8b\u4ef6\u7684\u5904\u7406\u3002 ChannelHanler\u7684\u7c7b\u5173\u7cfb\u56fe\u5982\u4e0b\uff1a ChannelHandlerAdapter\u3001ChannelInboundHandlerAdapter \u3001ChannelOutboundHandlerAdapter\u662fNetty\u63d0\u4f9b\u7684Handler\u9aa8\u67b6\u7c7b\u5df2\u7ecf\u5b9e\u73b0\u4e86\u5927\u90e8\u5206\u9aa8\u67b6\u65b9\u6cd5\uff0c\u5bf9\u4e8e\u4e0d\u540c\u7684\u9700\u6c42\u4f60\u53ea\u8981\u76f8\u5e94\u7684Handler\u5e76\u91cd\u5199\u81ea\u5df1\u611f\u5174\u8da3\u7684\u65b9\u6cd5\u5373\u53ef\u3002\u8fd9\u91cc\u518d\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0bSimpleChannelInboundHandler\u548cChannelInitializer\u8fd9\u4e24\u4e2a\u7c7b\uff1a SimpleChannelInboundHandler SimpleChannelInboundHandler\u7ee7\u627f\u81eaChannelInboundHandlerAdapter\u7528\u4e8e\u5904\u7406\u5165\u7ad9\u4fe1\u606f\uff0c\u9700\u8981\u6307\u5b9a\u6cdb\u578b\u5373\u8be5Handler\u9700\u8981\u5904\u7406\u7684\u5bf9\u8c61\u7c7b\u578b\uff0c\u5f53\u4f20\u5165\u5bf9\u8c61\u7c7b\u578b\u4e0d\u6b63\u786e\u65f6\u4e0d\u8fdb\u884c\u6570\u636e\u5904\u7406\u3002\u4f7f\u7528\u65f6\u53ea\u9700\u8981\u5b9e\u73b0 channelRead0 \u65b9\u6cd5\u8fdb\u884c\u6570\u636e\u5904\u7406\u5373\u53ef\uff0c\u4f7f\u7528\u8be5\u7c7b\u597d\u5904\u5728\u4e8eSimpleChannelInboundHandler\u4f1a\u81ea\u52a8\u4e3a\u4f60\u91ca\u653eReferenceCounted\u7c7b\u578b\u5bf9\u8c61\uff08\u4f8b\u5982ByteBuf\uff09. ChannelInitializer ChannelInitializer\u7c7b\u7684 initChannel \u65b9\u6cd5\u4f1a\u5728Channel\u521d\u59cb\u5316\u88ab\u8c03\u7528\uff0c\u6240\u4ee5\u4e00\u822c\u901a\u8fc7\u91cd\u5199 initChannel \u65b9\u6cd5\u914d\u7f6epipline\u4e2d\u7684ChannelHandler\u94fe\u3002 \u5728\u5904\u7406Channel\u7684IO\u4e8b\u4ef6\u65f6\uff0c\u4e3a\u4e86\u4f7f\u903b\u8f91\u66f4\u6e05\u6670\u548c\u4ee3\u7801\u7684\u7b80\u6d01\u6027\u901a\u5e38\u4f1a\u5c06\u6570\u636e\u5904\u7406\u8fc7\u7a0b\u5206\u4e3a\u51e0\u4e2a\u9636\u6bb5\u3002\u4ee5\u5165\u7ad9\u4fe1\u606f\u4e3a\u4f8b\uff0c\u901a\u5e38\u7684\u5904\u7406\u903b\u8f91\u5982\u4e0b\uff1a \u5904\u7406\u534a\u5305\u6216\u8005\u7c98\u5305\u95ee\u9898-->\u6570\u636e\u7684\u89e3\u7801(\u6216\u8005\u8bf4\u662f\u53cd\u5e8f\u5217\u5316)-->\u6570\u636e\u7684\u4e1a\u52a1\u5904\u7406 \u53ef\u4ee5\u770b\u5230\u4e0d\u540c\u7684\u9636\u6bb5\u8981\u6267\u884c\u4e0d\u540c\u7684\u529f\u80fd\uff0c\u56e0\u6b64\u901a\u5e38\u6211\u4eec\u4f1a\u7f16\u5199\u591a\u4e2aChannelHandler\uff0c\u6765\u5b9e\u73b0\u4e0d\u540c\u7684\u529f\u80fd\u3002\u800c\u4e14\u591a\u4e2aChannelHandler\u4e4b\u95f4\u7684\u987a\u5e8f\u4e0d\u80fd\u98a0\u5012\uff0c\u4f8b\u5982\u6211\u4eec\u5fc5\u987b\u5148\u5904\u7406\u7c98\u5305\u89e3\u5305\u95ee\u9898\uff0c\u4e4b\u540e\u624d\u80fd\u8fdb\u884c\u6570\u636e\u7684\u4e1a\u52a1\u5904\u7406\u3002 ChannelPipline Netty\u901a\u8fc7ChannelPipline\u6765\u4fdd\u8bc1\u591a\u4e2aChannelHandler\u4e4b\u95f4\u7684\u987a\u5e8f\u8c03\u7528\uff0c\u5177\u4f53\u662f\u901a\u8fc7\u4e00\u4e2a\u53cc\u5411\u94fe\u8868\u5b9e\u73b0\u7684\uff0c\u4e0b\u6587\u5c06\u4f1a\u8fdb\u884c\u4ecb\u7ecd\u3002\u5728\u6bcf\u4e2aChannel\u88ab\u521b\u5efa\u65f6\uff0c\u90fd\u4f1a\u81ea\u52a8\u521b\u5efa\u4e00\u4e2aChannelPipeline\u5bf9\u8c61\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7io.netty.channel.Channel\u5bf9\u8c61\u7684pipeline()\u65b9\u6cd5\u83b7\u53d6\u8fd9\u4e2a\u5bf9\u8c61\u5b9e\u4f8b\u3002 ChannelPipeline\u521b\u5efa\u662f\u5728AbstractChannel\u7c7b\u7684\u6784\u9020\u65b9\u6cd5\u4e2d\uff0c\u6240\u4ee5Netty\u4e2d\u6bcf\u4e2aChannel\u90fd\u4f1a\u62e5\u6709\u548c\u7ef4\u62a4\u4e00\u4e2a\u552f\u4e00\u7684ChannelPipeline\uff0c\u5982\u4e0b\uff1a public abstract class AbstractChannel extends DefaultAttributeMap implements Channel { .... private final DefaultChannelPipeline pipeline; .... protected AbstractChannel(Channel parent) { this.parent = parent; id = newId(); unsafe = newUnsafe(); // \u521d\u59cb\u5316pipline pipeline = newChannelPipeline(); } .... // \u521b\u5efa\u4e00\u4e2aDefaultChannelPipeline\u5e76\u628aChannel\u81ea\u8eab\u4f5c\u4e3a\u5f15\u7528\u4f20\u5165 protected DefaultChannelPipeline newChannelPipeline() { return new DefaultChannelPipeline(this); } .... @Override // \u8fd4\u56depipeline\u5b9e\u4f8b public ChannelPipeline pipeline() { return pipeline; } } \u4ece\u4e0a\u8ff0\u4ee3\u7801\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230ChannelPipleLine\u7684\u5177\u4f53\u521b\u5efa\u8fc7\u7a0b\u5b9e\u9645\u4e0a\u662f\u901a\u8fc7return new DefaultChannelPipeline(this)\u5b9e\u73b0\u7684\u3002DefaultChannelPipeline\u662fChannelPipeline\u7684\u9ed8\u8ba4\u5b9e\u73b0\u7c7b\u3002 \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7ChannelPipeline\u7684 addXX \u65b9\u6cd5\u5411pipline\u7684\u53cc\u5411\u94fe\u8868\u4e2d\u6dfb\u52a0Handler\u6765\u7ef4\u62a4Handler\u4e4b\u95f4\u7684\u8c03\u7528\u5173\u7cfb\uff0c\u5e38\u7528\u7684\u6dfb\u52a0\u65b9\u6cd5\u6709 addBefore, addAfter, addLast \u7b49\u3002 1\u3001\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4e00\u4e2aChannelPipeline\u5b9e\u4f8b\u4e2d\uff0c\u540c\u4e00\u4e2a\u7c7b\u578bChannelHandler\u53ea\u80fd\u88ab\u6dfb\u52a0\u4e00\u6b21\uff0c\u5982\u679c\u6dfb\u52a0\u591a\u6b21\uff0c\u5219\u4f1a\u629b\u51fa\u5f02\u5e38\uff0c\u5177\u4f53\u53c2\u89c1io.netty.channel.DefaultChannelPipeline#checkMultiplicity\u3002\u5982\u679c\u9700\u8981\u591a\u6b21\u6dfb\u52a0\u540c\u4e00\u4e2a\u7c7b\u578b\u7684ChannelHandler\u7684\u8bdd\uff0c\u5219\u9700\u8981\u5728\u8be5ChannelHandler\u5b9e\u73b0\u7c7b\u4e0a\u6dfb\u52a0@Sharable\u6ce8\u89e3\u3002 2\u3001\u5728ChannelPipeline\u4e2d\uff0c\u6bcf\u4e00\u4e2aChannelHandler\u90fd\u662f\u6709\u4e00\u4e2a\u540d\u5b57\u7684\uff0c\u800c\u4e14\u540d\u5b57\u5fc5\u987b\u7684\u662f\u552f\u4e00\u7684\uff0c\u5982\u679c\u540d\u5b57\u91cd\u590d\u4e86\uff0c\u5219\u4f1a\u629b\u51fa\u5f02\u5e38\uff0c\u53c2\u89c1io.netty.channel.DefaultChannelPipeline#checkDuplicateName\u3002 3\u3001\u5982\u679c\u6dfb\u52a0ChannelHanler\u7684\u65f6\u5019\u6ca1\u6709\u663e\u793a\u7684\u6307\u5b9a\u540d\u5b57\uff0c\u5219\u4f1a\u6309\u7167\u89c4\u5219\u5176\u8d77\u4e00\u4e2a\u9ed8\u8ba4\u7684\u540d\u5b57\u3002\u5177\u4f53\u89c4\u5219\u5982\u4e0b\uff0c\u5982\u679cChannelPipeline\u4e2d\u53ea\u6709\u67d0\u79cd\u7c7b\u578b\u7684handler\u5b9e\u4f8b\u53ea\u6709\u4e00\u4e2a\uff0c\u5982XXXHandler,YYYHandler\uff0c\u5219\u5176\u540d\u5b57\u5206\u522b\u4e3aXXXHandler#0\uff0cYYYHandler#0\uff0c\u5982\u679c\u540c\u4e00\u7c7b\u578b\u7684Handler\u6709\u591a\u4e2a\u5b9e\u4f8b\uff0c\u5219\u6bcf\u6b21\u4e4b\u540e\u7684\u7f16\u53f7\u52a01\u3002\u5177\u4f53\u53ef\u53c2\u89c1io.netty.channel.DefaultChannelPipeline#generateName\u65b9\u6cd5\u3002 ChannelHandlerContext \u524d\u9762\u63d0\u5230\u53ef\u4ee5\u901a\u8fc7ChannelPipeline\u7684\u6dfb\u52a0\u65b9\u6cd5\uff0c\u6309\u7167\u987a\u5e8f\u6dfb\u52a0ChannelHandler\uff0c\u5e76\u5728\u4e4b\u540e\u6309\u7167\u987a\u5e8f\u8fdb\u884c\u8c03\u7528\u3002\u4e8b\u5b9e\u4e0a\uff0c\u6bcf\u4e2aChannelHandler\u4f1a\u88ab\u5148\u5c01\u88c5\u6210ChannelHandlerContext\uff0c\u4e4b\u540e\u518d\u5c01\u88c5\u8fdbChannelPipeline\u4e2d\uff0c\u6240\u4ee5ChannelPipline\u7ef4\u62a4\u7684\u53cc\u5411\u94fe\u8868\u5b9e\u9645\u4e0a\u662fChannelHandlerContext\u6784\u6210\u7684\u94fe\u8868\u3002\u4ee5DefaultChannelPipeline\u7684addLast\u65b9\u6cd5\u4e3a\u4f8b\uff1a @Override public ChannelPipeline addLast(EventExecutorGroup group, final String name, ChannelHandler handler) { synchronized (this) { // \u68c0\u67e5\u8fd9\u79cd\u7c7b\u578b\u7684handler\u5b9e\u4f8b\u662f\u5426\u5141\u8bb8\u88ab\u6dfb\u52a0\u591a\u6b21 checkDuplicateName(name); // \u5c06handler\u5305\u88c5\u6210\u4e00\u4e2aDefaultChannelHandlerContext\u7c7b AbstractChannelHandlerContext newCtx = new DefaultChannelHandlerContext(this, group, name, handler); // \u7ef4\u62a4AbstractChannelHandlerContext\u7684\u5148\u540e\u5173\u7cfb addLast0(name, newCtx); } return this; } \u53ef\u4ee5\u770b\u5230\u7684\u786e\u662f\u5148\u5c06ChannelHandler\u5f53\u505a\u53c2\u6570\u6784\u5efa\u6210\u4e00\u4e2aDefaultChannelHandlerContext\u5b9e\u4f8b\u4e4b\u540e\uff0c\u518d\u8c03\u7528addLast0\u65b9\u6cd5\u7ef4\u62a4ChannelHandlerContext\u7684\u5148\u540e\u5173\u7cfb\uff0c\u4ece\u800c\u786e\u5b9a\u4e86ChannelHandler\u7684\u5148\u540e\u5173\u7cfb\u3002\u53ef\u4ee5\u6ce8\u610f\u5230ChannelHandlerContext\u5bf9\u8c61\u6301\u6709ChannelPipeline\u3001EventExecutorGroup\u3001ChannelHandler\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u56e0\u6b64ChannelHandlerContext\u53ef\u4ee5\u65b9\u4fbf\u5f97\u83b7\u5f97\u548c\u4f7f\u7528\u8fd9\u4e9b\u5bf9\u8c61\uff0c\u5f53\u6709\u65b9\u6cd5\u7684\u53c2\u6570\u4e3aChannelHandlerContext\u65f6\u5c31\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u4f7f\u7528\u5176\u5f15\u7528\u7684\u5bf9\u8c61\uff0c\u6211\u89c9\u5f97\u8fd9\u5e94\u8be5\u662f\u5c06Handler\u5c01\u88c5\u4e3aChannelHandlerContext\u7684\u4e3b\u8981\u539f\u56e0\u3002 DefaultChannelPipeline\u5185\u90e8\u662f\u901a\u8fc7\u4e00\u4e2a\u53cc\u5411\u94fe\u8868\u8bb0\u5f55ChannelHandler\u7684\u5148\u540e\u5173\u7cfb\uff0c\u5185\u90e8\u901a\u8fc7\u4e24\u4e2a\u54e8\u5175\u8282\u70b9HeadContext\u548cTailContext\u4f5c\u4e3a\u94fe\u8868\u7684\u5f00\u59cb\u548c\u7ed3\u675f\uff0c\u53cc\u5411\u94fe\u8868\u7684\u8282\u70b9\u662fAbstractChannelHandlerContext\u7c7b\u3002\u4ee5\u4e0b\u662fAbstractChannelHandlerContext\u7c7b\u7684\u90e8\u5206\u6e90\u7801(\u53cc\u5411\u94fe\u8868\u8282\u70b9)\uff1a public class DefaultChannelPipeline implements ChannelPipeline { ... private static final String HEAD_NAME = generateName0(HeadContext.class); private static final String TAIL_NAME = generateName0(TailContext.class); ... final AbstractChannelHandlerContext head; final AbstractChannelHandlerContext tail; private final Channel channel; .... protected DefaultChannelPipeline(Channel channel) { this.channel = ObjectUtil.checkNotNull(channel, \"channel\"); .... // \u521b\u5efa\u53cc\u5411\u94fe\u8868\u5934\u90e8\u5143\u7d20\u5b9e\u4f8b tail = new TailContext(this); head = new HeadContext(this); // \u521b\u5efa\u53cc\u5411\u94fe\u8868\u7684\u5c3e\u90e8\u5143\u7d20\u5b9e\u4f8b head.next = tail; tail.prev = head; } .... .... private void addLast0(AbstractChannelHandlerContext newCtx) { // \u8bbe\u7f6eChannelHandler\u7684\u5148\u540e\u987a\u5e8f\u5173\u7cfb AbstractChannelHandlerContext prev = tail.prev; newCtx.prev = prev; newCtx.next = tail; prev.next = newCtx; tail.prev = newCtx; } } } \u5934\u5c3e\u4e24\u4e2a\u8282\u70b9\u4e0e\u5176\u4ed6Handler\u4e0d\u540c\u70b9\u5728\u4e8e\uff0c\u5b83\u4eec\u6301\u6709\u4e86Unsafe\u5bf9\u8c61\uff0c\u4ece\u800c\u80fd\u901a\u8fc7Unsafe\u5bf9\u8c61\u5bf9Java NIO\u7ec4\u4ef6\u8fdb\u884c\u64cd\u4f5c\u3002 Netty\u6e90\u7801\u5206\u6790 \u4ece\u670d\u52a1\u7aef\u7684\u521d\u59cb\u5316\u8bf4\u8d77 \u8ba9\u6211\u4eec\u4ee5\u4e00\u4e2a\u7b80\u5355\u7684EchoServer\u4e3a\u4f8b\u5b50\u8fdb\u884c\u8bf4\u660e\uff1a public class EchoServer { private final int port; public EchoServer(int port) { this.port = port; } public void start() throws Exception { // boss\u7ebf\u7a0b\u6c60\uff0c\u7528\u4e8e\u63a5\u53d7\u8fde\u63a5\u8bf7\u6c42 EventLoopGroup boss = new NioEventLoopGroup(1); // workers\u7ebf\u7a0b\u6c60\uff0c\u7528\u4e8e\u6267\u884cIO\u8bf7\u6c42 EventLoopGroup workers = new NioEventLoopGroup(); try { // \u542f\u52a8\u7c7b\uff0c\u7528\u4e8e\u914d\u7f6e\u5e76\u8f85\u52a9\u542f\u52a8\u670d\u52a1 ServerBootstrap b = new ServerBootstrap(); // \u914d\u7f6e\u7ebf\u7a0b\u6c60 b.group(boss, workers) // \u8bbe\u7f6e\u8981\u542f\u52a8\u7684Channel\u7c7b\u578b .channel(NioServerSocketChannel.class) // \u914d\u7f6eNioServerSocketChannel\u7684\u53c2\u6570 .option(ChannelOption.SO_BACKLOG, 128) // \u914d\u7f6e\u5b50Channel\u7684Handler\u94fe .childHandler(new EchoServerInitializer()); // \u7ebf\u7a0b\u7ed1\u5b9a\u76d1\u542c\u7aef\u53e3\uff0c\u542f\u52a8Netty\u670d\u52a1\u7aef ChannelFuture f = b.bind(port).sync(); f.channel().closeFuture().sync(); } finally { boss.shutdownGracefully(); workers.shutdownGracefully(); } } } \u53ef\u4ee5\u770b\u51fa\u5728Netty\u670d\u52a1\u542f\u52a8\u4e4b\u524d\uff0c\u4e3b\u8981\u8fdb\u884c\u4e86Netty\u670d\u52a1\u53c2\u6570\u914d\u7f6e\uff0c\u5176\u542b\u4e49\u6211\u4eec\u5148\u6309\u4e0b\u4e0d\u8868\uff0c\u771f\u6b63\u7684\u5f00\u542f\u670d\u52a1\u7684\u65b9\u6cd5\u5f88\u663e\u7136\u662fServerBootstrap\u7684 bind \u65b9\u6cd5\uff0cbind\u65b9\u6cd5\u7684\u8c03\u7528\u94fe\u5982\u4e0b\uff1a public ChannelFuture bind(int inetPort) { // \u4f7f\u7528\u7aef\u53e3\u53f7\u521b\u5efaInetSocketAddress\u4f5c\u4e3a\u53c2\u6570 return bind(new InetSocketAddress(inetPort)); } public ChannelFuture bind(SocketAddress localAddress) { // \u6821\u9a8c\u5de5\u4f5c validate(); if (localAddress == null) { throw new NullPointerException(\"localAddress\"); } return doBind(localAddress); } // \u6838\u5fc3\u65b9\u6cd5 private ChannelFuture doBind(final SocketAddress localAddress) { // \u521b\u5efa\u63a5\u53d7\u8fde\u63a5\u8bf7\u6c42\u7684Channel\u5e76\u6ce8\u518c\u5230NioEventLoop\u7684Selector final ChannelFuture regFuture = initAndRegister(); final Channel channel = regFuture.channel(); if (regFuture.cause() != null) { return regFuture; } // \u5224\u65ad\u64cd\u4f5c\u662f\u5426\u5b8c\u6210 if (regFuture.isDone()) { ChannelPromise promise = channel.newPromise(); // \u5982\u679c\u64cd\u4f5c\u5b8c\u6210\u8c03\u7528doBind0\u65b9\u6cd5 doBind0(regFuture, channel, localAddress, promise); return promise; } else { final PendingRegistrationPromise promise = new PendingRegistrationPromise(channel); // \u5982\u679c\u64cd\u4f5c\u8fd8\u672a\u5b8c\u6210\u5219\u6dfb\u52a0\u76d1\u542c\u5668\uff0c\u5728\u5b8c\u6210\u540e\u5224\u65ad\u64cd\u4f5c\u662f\u5426\u5931\u8d25\uff0c\u5982\u679c\u672a\u5931\u8d25\u5219\u7ee7\u7eed\u8c03\u7528doBind0\u65b9\u6cd5 regFuture.addListener(new ChannelFutureListener() { @Override public void operationComplete(ChannelFuture future) throws Exception { Throwable cause = future.cause(); if (cause != null) { promise.setFailure(cause); } else { promise.registered(); doBind0(regFuture, channel, localAddress, promise); } } }); return promise; } } \u901a\u8fc7bind\u65b9\u6cd5\u7684\u8c03\u7528\u94fe\uff0c\u6700\u7ec8\u5c06\u8c03\u7528ServerBootstrap\u7684doBind\u65b9\u6cd5\uff0cdoBind\u4e3b\u8981\u6709\u4e24\u4e2a\u6b65\u9aa4\u4e00\u662f\u901a\u8fc7 initAndRegister \u65b9\u6cd5\u521b\u5efaChannel\u5e76\u6ce8\u518c\u6ce8\u518c\u5230NioEventLoop\u7684Selector\u4e0a\u7528\u4e8e\u63a5\u53d7\u8fde\u63a5\u8bf7\u6c42\uff1b\u4e8c\u662f\u901a\u8fc7 doBind0 \u65b9\u6cd5\u5c06Java\u7ba1\u9053\u7ed1\u5b9a\u5230\u8981\u76d1\u542c\u7684\u7aef\u53e3\u3002 \u73b0\u5728\u6211\u4eec\u4f9d\u6b21\u5206\u6790\u8fd9\u4e24\u4e2a\u65b9\u6cd5\uff0c\u9996\u5148\u6765\u770b initAndRegister \u65b9\u6cd5 final ChannelFuture initAndRegister() { Channel channel = null; try { // \u4f7f\u7528channelFactory\u521b\u5efaNioSocketChannelServer channel = channelFactory.newChannel(); // \u521d\u59cb\u5316\u7ba1\u9053 init(channel); } // \u5982\u679c\u521b\u5efa\u6216\u521d\u59cb\u5316\u7ba1\u9053\u5931\u8d25\u4e86\uff0c\u8fd4\u56de\u5305\u542b\u9519\u8bef\u539f\u56e0\u7684ChannelFuture catch (Throwable t) { if (channel != null) { channel.unsafe().closeForcibly(); return new DefaultChannelPromise(channel, GlobalEventExecutor.INSTANCE).setFailure(t); } return new DefaultChannelPromise(new FailedChannel(), GlobalEventExecutor.INSTANCE).setFailure(t); } // \u5c06\u7ba1\u9053\u6ce8\u518c\u5230NioEventLoop\u7684Selector\u4e0a ChannelFuture regFuture = config().group().register(channel); if (regFuture.cause() != null) { if (channel.isRegistered()) { channel.close(); } else { channel.unsafe().closeForcibly(); } } return regFuture; } \u6211\u4eec\u53ef\u4ee5\u5c06 initAndRegister \u65b9\u6cd5\u7684\u903b\u8f91\u62c6\u5206\u6210\u4e09\u4e2a\u90e8\u5206\uff1a \u901a\u8fc7channelFactory.newChannel()\uff0c\u521b\u5efaChannel(\u5b9e\u9645\u4e0a\u662fNioServerSocketChannel) \u521d\u59cb\u5316\u521b\u5efa\u7684\u7ba1\u9053 \u901a\u8fc7config().group().register(channel)\uff0c\u5c06\u7ba1\u9053\u6ce8\u518c\u5230NioEventLoop\u7684Selector\u4e0a \u4f7f\u7528ChannelFactory\u521b\u5efaChannel ChannelFactory\u662f\u600e\u4e48\u6765\u7684\u5462\uff0c\u8ba9\u6211\u4eec\u56de\u5230\u8c03\u7528EchoServe\u7c7b\u8c03\u7528bind\u65b9\u6cd5\u542f\u52a8\u4e4b\u524d\u7684\u914d\u7f6e\u903b\u8f91\u4e0a\u6765\uff1a // \u914d\u7f6e\u7ebf\u7a0b\u6c60 b.group(boss, workers) // \u8bbe\u7f6e\u8981\u542f\u52a8\u7684Channel\u7c7b\u578b .channel(NioServerSocketChannel.class) // \u914d\u7f6e\u5b50Channel\u7684Handler\u94fe .childHandler(new EchoServerInitializer()); \u5176\u4e2dchannel\u65b9\u6cd5\u914d\u7f6e\u4e86\u7ba1\u9053\u7c7b\u578b\u4e3aNioServerSocketChannel.class\uff0c\u8ba9\u6211\u4eec\u8fdb\u5165\u8be5\u65b9\u6cd5\u7684\u8c03\u7528\u94fe\uff1a public B channel(Class<? extends C> channelClass) { if (channelClass == null) { throw new NullPointerException(\"channelClass\"); } // \u4ee5channelClass\u4e3a\u53c2\u6570\uff0c\u8fd9\u91cc\u662fNioServerSocketChannel.class\uff0c\u521b\u5efaReflectiveChannelFactory return channelFactory(new ReflectiveChannelFactory<C>(channelClass)); } public B channelFactory(io.netty.channel.ChannelFactory<? extends C> channelFactory) { return channelFactory((ChannelFactory<C>) channelFactory); } public B channelFactory(ChannelFactory<? extends C> channelFactory) { if (channelFactory == null) { throw new NullPointerException(\"channelFactory\"); } if (this.channelFactory != null) { throw new IllegalStateException(\"channelFactory set already\"); } // \u5c06ServerBootstrap\u7684channelFactory\u8bbe\u7f6e\u4e3aReflectiveChannelFactory this.channelFactory = channelFactory; return self(); } \u53ef\u4ee5\u770b\u5230 channel \u4e3aServerBootstrap\u521b\u5efa\u4e86ReflectiveChannelFactory\u5bf9\u8c61\uff0c\u5e76\u7528\u5b83\u521d\u59cb\u5316\u4e86ServerBootstrap\u7684channelFactory\u57df\u3002 \u73b0\u5728\u8ba9\u6211\u4eec\u56de\u5230 channelFactory.newChannel() \u903b\u8f91\uff0c\u8fdb\u5165newChannel\u65b9\u6cd5\uff0c\u5982\u4e0b\uff1a public T newChannel() { try { return constructor.newInstance(); } catch (Throwable t) { throw new ChannelException(\"Unable to create Channel from class \" + constructor.getDeclaringClass(), t); } } newChannel\u65b9\u6cd5\u901a\u8fc7\u53cd\u5c04\u8c03\u7528\u521b\u5efa\u4e86Channel\u5bf9\u8c61\uff0c\u4ece\u4e0a\u9762\u7684\u5206\u6790\u53ef\u4ee5\u77e5\u9053\u8fd9\u91cc\u7684Channel\u7c7b\u4e3aNioServerSocketChannel \u6240\u4ee5\u8ba9\u6211\u4eec\u8fdb\u5165NioServerSocketChannel\u7684\u65e0\u53c2\u6784\u6210\u51fd\u6570\u7684\u8c03\u7528\u94fe\uff0c\u5982\u4e0b\uff1a public NioServerSocketChannel() { // \u521b\u5efaServerSocketChannel\u4f5c\u4e3a\u6784\u9020\u51fd\u6570\u53c2\u6570 this(newSocket(DEFAULT_SELECTOR_PROVIDER)); } private static ServerSocketChannel newSocket(SelectorProvider provider) { try { // \u901a\u8fc7Java NIO\u7684SelectorProvider\u6765\u6784\u5efaJava Channel return provider.openServerSocketChannel(); } catch (IOException e) { throw new ChannelException( \"Failed to open a server socket.\", e); } } public NioServerSocketChannel(ServerSocketChannel channel) { // \u8bbe\u7f6ereadInterestOp\u7684\u503c\u4e3aSelectionKey.OP_ACCEPT\uff0c\u5373\u76d1\u542c\u8fde\u63a5\u8bf7\u6c42 super(null, channel, SelectionKey.OP_ACCEPT); // \u521d\u59cb\u5316NettyNio\u914d\u7f6e\u5bf9\u8c61\uff0c\u7528\u4e8e\u5feb\u901f\u83b7\u5f97channel\u53c2\u6570\u4fe1\u606f config = new NioServerSocketChannelConfig(this, javaChannel().socket()); } // \u4e2d\u95f4\u5bf9\u8c61AbstractNioMessageChannel protected AbstractNioMessageChannel(Channel parent, SelectableChannel ch, int readInterestOp) { super(parent, ch, readInterestOp); } protected AbstractNioChannel(Channel parent, SelectableChannel ch, int readInterestOp) { super(parent); // \u8bbe\u7f6eNetty NioChannel\u6301\u6709\u7684Java Channel\u5f15\u7528 this.ch = ch; // \u8bbe\u7f6eChannel\u76d1\u542c\u7684\u64cd\u4f5c\u7c7b\u578b this.readInterestOp = readInterestOp; try { // \u8bbe\u7f6eJava Channel\u4e3a\u975e\u963b\u585e\u7684 ch.configureBlocking(false); } catch (IOException e) { try { ch.close(); } catch (IOException e2) { if (logger.isWarnEnabled()) { logger.warn( \"Failed to close a partially initialized socket.\", e2); } } throw new ChannelException(\"Failed to enter non-blocking mode.\", e); } } protected AbstractChannel(Channel parent) { this.parent = parent; // \u751f\u6210Channel\u7684\u5168\u5c40Id id = newId(); // \u521d\u59cb\u5316Unsafe\u5bf9\u8c61 unsafe = newUnsafe(); // \u521d\u59cb\u5316ChannelPipeline pipeline = newChannelPipeline(); } \u4eceNioServerSocketChannel\u6784\u9020\u51fd\u6570\u7684\u8c03\u7528\u94fe\u53ef\u4ee5\u770b\u51fa\uff0c\u5728\u521b\u5efaNetty NioChannel\u65f6\u4f1a\u521d\u59cb\u5bf9\u5e94\u7684Java Channel\u5e76\u4e14\u5c06Java Channel\u914d\u7f6e\u4e3a\u975e\u963b\u585e\u7684\u3002\u4e4b\u540e\u8fdb\u5165AbstractChannel\u7684\u903b\u8f91\uff0c\u521d\u59cb\u5316Netty NioChannel\u7684\u76f8\u5173\u5c5e\u6027\uff1a \u8c03\u7528newId()\uff0c\u751f\u6210\u4e00\u4e2aChannel\u7684\u5168\u5c40Id \u8c03\u7528newUnsafe()\uff0c\u751f\u6210Unsafe\u5bf9\u8c61\uff0cUnsafe\u80fd\u591f\u5904\u7406Java NIO\u76f8\u5173\u7684\u903b\u8f91\uff0c\u4f8b\u5982\u5728NioEventLoop\u7684Selector\u4e0a\u6ce8\u518cJava Channel\uff0c\u6216\u8005Java Channel\u7ed1\u5b9a\u5230\u5bf9\u5e94\u7684\u7aef\u53e3\u3002 \u8c03\u7528newChannelPipeline()\uff0c\u751f\u6210DefaultChannelPipeline\u5bf9\u8c61\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u5728 Netty\u7ec4\u4ef6 \u4e2d\u4ecb\u7ecd\u8fc7\uff0c\u662f\u7528\u6765\u7ef4\u62a4Netty Handler\u5904\u7406\u94fe\u7684\u3002 Netty\u7ec4\u4ef6 \u4e2d\u5bf9DefaultChannelPipeline\u5bf9\u8c61\u7684\u5206\u6790\u53ef\u4ee5\u77e5\u9053\uff0c\u5728DefaultChannelPipeline\u521d\u59cb\u5316\u5b8c\u6210\u65f6\uff0cpipeline\u4e2d\u53ea\u6709\u5934\u8282\u70b9\uff08head\uff09\u548c\u5c3e\u8282\u70b9\uff08tail\uff09\u4e24\u4e2a\u8282\u70b9\uff0c\u5176\u4e2d\u5934\u7ed3\u70b9\u540c\u65f6\u5b9e\u73b0\u4e86 ChannelOutboundHandler \u548c ChannelInboundHandler \u8fd9\u8868\u793a\u5934\u7ed3\u70b9\u5373\u53ef\u4ee5\u5904\u7406\u5165\u7ad9\u4fe1\u606f\u4e5f\u53ef\u4ee5\u5904\u7406\u51fa\u7ad9\u4fe1\u606f\uff1b\u800c\u5c3e\u8282\u70b9\u53ea\u5b9e\u73b0\u4e86 ChannelInboundHandler \u6240\u4ee5\u53ea\u80fd\u5904\u7406\u5165\u7ad9\u4fe1\u606f\uff0c\u5982\u4e0b\uff1a // \u5934\u7ed3\u70b9\u5b9e\u73b0\u7684\u63a5\u53e3 final class HeadContext extends AbstractChannelHandlerContext implements ChannelOutboundHandler, ChannelInboundHandler { private final Unsafe unsafe; HeadContext(DefaultChannelPipeline pipeline) { super(pipeline, null, HEAD_NAME, true, true); unsafe = pipeline.channel().unsafe(); setAddComplete(); } ... } // \u5c3e\u8282\u70b9\u5b9e\u73b0\u7684\u63a5\u53e3 final class TailContext extends AbstractChannelHandlerContext implements ChannelInboundHandler { TailContext(DefaultChannelPipeline pipeline) { super(pipeline, null, TAIL_NAME, true, false); setAddComplete(); } } \u6b64\u65f6pipeline\u7684\u94fe\u8868\u7ed3\u6784\u5982\u4e0b\uff1a \u81f3\u6b64\uff0c\u6574\u4e2aNioServerSocketChannel\u7684\u521b\u5efa\u5de5\u4f5c\u5c31\u5b8c\u6210\u4e86\uff0c\u63a5\u4e0b\u5c06\u8fdb\u884cNioServerSocketChannel\u521d\u59cb\u5316\u5de5\u4f5c\u3002 \u521d\u59cb\u5316NioServerSocketChannel \u5b8c\u6210\u7ba1\u9053\u7684\u521b\u5efa\u5de5\u4f5c\u540e\uff0c\u7ee7\u7eed\u4eceServerBootstrap\u7684 initAndRegister \u65b9\u6cd5\u5f80\u4e0b\u8d70\uff0c\u63a5\u4e0b\u6765\u5c06\u8c03\u7528 init \u65b9\u6cd5\u6765\u8fdb\u884c\u7ba1\u9053\u7684\u521d\u59cb\u5316\u5de5\u4f5c\uff0c init \u65b9\u6cd5\u5982\u4e0b\uff1a void init(Channel channel) throws Exception { // \u83b7\u5f97\u901a\u8fc7Bootstrap\u5bf9\u8c61\u7684option\u65b9\u6cd5\u914d\u7f6e\u7684\u53c2\u6570 final Map<ChannelOption<?>, Object> options = options0(); synchronized (options) { // \u5c06\u914d\u7f6e\u5e94\u7528\u5230\u76f8\u5e94\u7684\u5bf9\u8c61\u4e0a\uff0c\u5982java channel\u6216java socket setChannelOptions(channel, options, logger); } // \u83b7\u5f97\u901a\u8fc7Bootstrap\u5bf9\u8c61\u7684attr\u65b9\u6cd5\u914d\u7f6e\u7684\u5c5e\u6027 final Map<AttributeKey<?>, Object> attrs = attrs0(); synchronized (attrs) { // \u4f7f\u7528for\u5faa\u73af\u4fee\u6539\u5c5e\u6027\u5bf9\u5e94\u7684\u503c for (Entry<AttributeKey<?>, Object> e: attrs.entrySet()) { @SuppressWarnings(\"unchecked\") AttributeKey<Object> key = (AttributeKey<Object>) e.getKey(); channel.attr(key).set(e.getValue()); } } // \u83b7\u5f97NioServerSocketChannel\u7684pipline\u5bf9\u8c61 ChannelPipeline p = channel.pipeline(); // \u83b7\u5f97\u5b50Channel\u53c2\u6570\u4fe1\u606f\uff0c\u7528\u4e8e\u521b\u5efaServerBootstrapAcceptor // ServerBootstrapAcceptor\u662f\u4e00\u4e2a\u5904\u7406\u8fde\u63a5\u8bf7\u6c42\u7684Handler\uff0c\u4f1a\u4e3a\u8fde\u63a5\u8bf7\u6c42\u521b\u5efa\u5bf9\u5e94\u7684Channel final EventLoopGroup currentChildGroup = childGroup; final ChannelHandler currentChildHandler = childHandler; final Entry<ChannelOption<?>, Object>[] currentChildOptions; final Entry<AttributeKey<?>, Object>[] currentChildAttrs; synchronized (childOptions) { currentChildOptions = childOptions.entrySet().toArray(newOptionArray(0)); } synchronized (childAttrs) { currentChildAttrs = childAttrs.entrySet().toArray(newAttrArray(0)); } // \u5728pipline\u4e2d\u6dfb\u52a0\u4e00\u4e2aChannelInitializer // \u5f53ChannelInitializer\u7684initChannel\u88ab\u8c03\u7528\u65f6\uff0c\u53ef\u4ee5\u5bf9\u7ba1\u9053\u8fdb\u884c\u64cd\u4f5c p.addLast(new ChannelInitializer<Channel>() { @Override public void initChannel(final Channel ch) throws Exception { final ChannelPipeline pipeline = ch.pipeline(); // \u5728pipline\u4e2d\u6dfb\u52a0\u901a\u8fc7Bootstrap\u5bf9\u8c61\u7684handler\u914d\u7f6e\u7684Handler ChannelHandler handler = config.handler(); if (handler != null) { pipeline.addLast(handler); } // \u5411EventLoop\u7ebf\u7a0b\u7684\u4efb\u52a1\u961f\u5217\u63d0\u4ea4\u521b\u5efaServerBootstrapAcceptor\u5bf9\u8c61\u7684\u4efb\u52a1 ch.eventLoop().execute(new Runnable() { @Override public void run() { pipeline.addLast(new ServerBootstrapAcceptor( ch, currentChildGroup, currentChildHandler, currentChildOptions, currentChildAttrs)); } }); } }); } \u53ef\u4ee5\u770b\u51fa\uff0c init \u65b9\u6cd5\u4e3b\u8981\u505a\u4e86\u4ee5\u4e0b\u5de5\u4f5c\uff1a \u5c06Bootstrap\u5bf9\u8c61\u7684option\u65b9\u6cd5\u914d\u7f6e\u7684\u53c2\u6570\u914d\u7f6e\u5230Config\u5bf9\u8c61\u4e0a \u5c06Bootstrap\u5bf9\u8c61\u7684attr\u65b9\u6cd5\u914d\u7f6e\u7684\u5c5e\u6027\u5e94\u7528\u5230channel\u5bf9\u5e94\u7684attr\u4e0a \u8c03\u7528addLast\u65b9\u6cd5\u5728NioServerSocketChannel\u7684pipline\u5c3e\u90e8\u6dfb\u52a0\u4e86\u4e00\u4e2aChannelInitializer\uff08ChannelInboundHandlerAdapter\u7684\u4e00\u4e2a\u5b50\u7c7b\uff09\uff0cChannelInitialize\u7684initChannel\u65b9\u6cd5\u4f1a\u5728\u540e\u7eed\u7684\u7ba1\u9053\u521d\u59cb\u5316\u8fc7\u7a0b\u4e2d\u88ab\u8c03\u7528\uff0c\u6240\u4ee5\u8fd9\u91cc\u5148\u4e0d\u5bf9initChannel\u65b9\u6cd5\u8fdb\u884c\u6df1\u5165 \u8ba9\u6211\u4eec\u8fdb\u5165pipline\u7684 addLast \u65b9\u6cd5\u7684\u8c03\u7528\u94fe\uff0c\u770b\u770b\u505a\u4e86\u54ea\u4e9b\u64cd\u4f5c\uff1a public final ChannelPipeline addLast(ChannelHandler... handlers) { // \u8fd9\u91cc\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3aEventExecutorGroup\uff0c\u4f5c\u7528\u662f\u6307\u5b9a\u7684\u6267\u884cHandler\u903b\u8f91\u7684\u7ebf\u7a0b\u6c60 // \u8bbe\u4e3anull\u5219\u8868\u793a\u4f7f\u7528BootStrap\u4e2d\u914d\u7f6e\u7684NioEeventLoopGroup\u7ebf\u7a0b\u6c60 return addLast(null, handlers); } public final ChannelPipeline addLast(EventExecutorGroup executor, ChannelHandler... handlers) { if (handlers == null) { throw new NullPointerException(\"handlers\"); } // \u901a\u8fc7for\u5faa\u73af\u4e2d\u7684addLast\u65b9\u6cd5\u5c06\u53ef\u53d8\u53c2\u6570\u4e2d\u7684handler\u52a0\u5165pipline for (ChannelHandler h: handlers) { if (h == null) { break; } addLast(executor, null, h); } return this; } public final ChannelPipeline addLast(EventExecutorGroup group, String name, ChannelHandler handler) { final AbstractChannelHandlerContext newCtx; synchronized (this) { // \u6821\u9a8chandler\u4fe1\u606f checkMultiplicity(handler); // \u6784\u5efaHandlerContext\u5bf9\u8c61\uff0c\u5e76\u4e14\u6839\u636ename\u662f\u5426\u4e3a\u7a7a\u6821\u9a8c\u6216\u8005\u751f\u6210handler\u540d\u5b57 newCtx = newContext(group, filterName(name, handler), handler); // \u5c06HandlerContext\u5bf9\u8c61\u6dfb\u52a0\u5230pipeline\u672b\u5c3e addLast0(newCtx); // \u5224\u65ad\u7ba1\u9053\u662f\u5426\u6ce8\u518c\u5230EventLoop if (!registered) { // \u5c06handler\u7684\u9636\u6bb5\u4eceINIT\u8bbe\u7f6e\u4e3aPENDING newCtx.setAddPending(); // \u521b\u5efa\u4e00\u4e2a\u7a0d\u540e\u6267\u884c\u7684callHandlerAdded0\u65b9\u6cd5\u7684\u56de\u8c03\u4efb\u52a1 callHandlerCallbackLater(newCtx, true); return this; } // \u5982\u679c\u7ba1\u9053\u5df2\u6ce8\u518c\u5230EventLoop // \u56e0\u4e3actx\u4e2dexecutor\u5bf9\u8c61\u4e3a\u7a7a\uff0c\u6240\u4ee5\u8fd9\u91cc\u7684exector\u662fChannel\u6301\u6709\u7684EventLoop\u5bf9\u8c61 EventExecutor executor = newCtx.executor(); // \u5982\u679c\u5f53\u524d\u7ebf\u7a0b\u4e0d\u662fEventLoop\u7684\u5de5\u4f5c\u7ebf\u7a0b if (!executor.inEventLoop()) { // \u5c06callHandlerAdded0\u7684\u8c03\u7528\u5c01\u88c5\u4e3atask\u63d0\u4ea4\u5230\u6307\u5b9a\u7684\u5de5\u4f5c\u7ebf\u7a0b\u6c60 callHandlerAddedInEventLoop(newCtx, executor); return this; } } // \u5982\u679c\u5f53\u524d\u7ebf\u7a0b\u662fEventLoop\u7684\u5de5\u4f5c\u7ebf\u7a0b // \u5219\u7acb\u523b\u6267\u884ccallHandlerAdded0\u65b9\u6cd5 callHandlerAdded0(newCtx); return this; } \u53ef\u4ee5\u770b\u5230addLast\u5bf9handler\u4e3b\u8981\u505a\u4e86\u4ee5\u4e0b\u5de5\u4f5c\uff1a \u5bf9handler\u4fe1\u606f\u8fdb\u884c\u6821\u9a8c private static void checkMultiplicity(ChannelHandler handler) { // \u5982\u679chandler\u662fChannelHandlerAdapter\u7684\u5b50\u7c7b if (handler instanceof ChannelHandlerAdapter) { ChannelHandlerAdapter h = (ChannelHandlerAdapter) handler; // \u5224\u65adhandler\u662f\u4e0d\u662f\u5df2\u7ecf\u88ab\u6dfb\u52a0\u5230\u7ba1\u9053\u4e86 // \u5982\u679c\u5df2\u7ecf\u6dfb\u52a0\u5230\u7ba1\u9053\u5e76\u4e14handler\u6ca1\u6709\u88ab@shareable\u6ce8\u89e3\u6807\u8bc6\uff0c\u629b\u51fa\u5f02\u5e38 if (!h.isSharable() && h.added) { throw new ChannelPipelineException( h.getClass().getName() + \" is not a @Sharable handler, so can't be added or removed multiple times.\"); } // \u5c06handler\u5df2\u7ecf\u88ab\u6dfb\u52a0\u5230\u7ba1\u9053\u7684\u6807\u5fd7\u8bbe\u7f6e\u4e3atrue h.added = true; } } \u8c03\u7528newContext\u65b9\u6cd5\uff0c\u5c06handler\u5305\u88c5\u6210AbstractChannelHandlerContext\u5bf9\u8c61 \u8c03\u7528addLast0\u5c06\u6784\u5efa\u7684AbstractChannelHandlerContext\u52a0\u5165pipline\u53cc\u5411\u94fe\u8868\u5c3e\u90e8 private void addLast0(AbstractChannelHandlerContext newCtx) { AbstractChannelHandlerContext prev = tail.prev; newCtx.prev = prev; newCtx.next = tail; prev.next = newCtx; tail.prev = newCtx; } \u63a5\u4e0b\u6765\u5c31\u662f\u5206\u60c5\u51b5\u8fdb\u884ccallHandlerAdded0\u65b9\u6cd5\u7684\u8c03\u7528\uff0c\u5982\u679cNioServerSocketChannel\u672a\u6ce8\u518c\u5230EventLoop\u5219\u8c03\u7528callHandlerCallbackLater\u65b9\u6cd5\u521b\u5efa\u4e00\u4e2a\u7a0d\u540e\u88ab\u6267\u884c\u7684Task\uff1b\u5982\u679cNioServerSocketChannel\u5df2\u7ecf\u6ce8\u518c\u5230EventLoop\uff0c\u5e76\u4e14\u5982\u679c\u5f53\u524d\u7ebf\u7a0b\u4e0d\u662fEventLoop\u7684\u5de5\u4f5c\u7ebf\u7a0b\uff0c\u5219callHandlerAdded0\u65b9\u6cd5\u4f1a\u63d0\u4ea4\u5230\u7ebf\u7a0b\u6c60\u4e2d\u88ab\u6267\u884c\uff1b\u5982\u679cNioServerSocketChannel\u5df2\u7ecf\u6ce8\u518c\u5230EventLoop\u5e76\u4e14\u5f53\u524d\u7ebf\u7a0b\u662fEventLoop\u7684\u5de5\u4f5c\u7ebf\u7a0b\uff0c\u5219\u4f7f\u7528\u5f53\u524d\u7ebf\u7a0b\u6267\u884ccallHandlerAdded0\u65b9\u6cd5\u3002\u663e\u7136\u8fd9\u65f6\u5019NioServerSocketChannel\u8fd8\u672a\u6ce8\u518c\u5230EventLoop\uff0c\u6240\u4ee5\u8ba9\u6211\u4eec\u63a5\u7740\u8fdb\u5165callHandlerCallbackLater\u65b9\u6cd5\u3002 private void callHandlerCallbackLater(AbstractChannelHandlerContext ctx, boolean added) { assert !registered; // \u6839\u636e\u8c03\u7528\u4f20\u5165\u7684\u53c2\u6570\uff0c\u8fd9\u91cc\u663e\u7136\u662f\u65b0\u5efa\u4e00\u4e2aPendingHandlerAddedTask\u5bf9\u8c61 PendingHandlerCallback task = added ? new PendingHandlerAddedTask(ctx) : new PendingHandlerRemovedTask(ctx); // \u83b7\u5f97PendingHandlerCallback\u94fe\u8868\u7684\u5934\u7ed3\u70b9\uff0cPendingHandlerCallback\u94fe\u8868\u662f\u4e00\u4e2a\u5355\u5411\u94fe\u8868 PendingHandlerCallback pending = pendingHandlerCallbackHead; // \u5982\u679c\u94fe\u8868\u4e3a\u7a7a\u5219\u5c06\u65b0\u7684Task\u4f5c\u4e3a\u94fe\u8868\u5934\uff0c\u5426\u5219\u5c06Task\u63d2\u5165\u94fe\u8868\u5c3e\u90e8 if (pending == null) { pendingHandlerCallbackHead = task; } else { // Find the tail of the linked-list. while (pending.next != null) { pending = pending.next; } pending.next = task; } } // PendingHandlerAddedTask\u5b9e\u73b0\u4e86Runnable\u548cPendingHandlerCallback\u7c7b\u7684execute\u62bd\u8c61\u65b9\u6cd5 // \u4e24\u4e2a\u65b9\u6cd5\u7684\u76ee\u7684\u90fd\u662f\u6267\u884ccallHandlerAdded0\u65b9\u6cd5 private final class PendingHandlerAddedTask extends PendingHandlerCallback { PendingHandlerAddedTask(AbstractChannelHandlerContext ctx) { super(ctx); } @Override public void run() { callHandlerAdded0(ctx); } @Override void execute() { EventExecutor executor = ctx.executor(); if (executor.inEventLoop()) { callHandlerAdded0(ctx); } else { try { executor.execute(this); } catch (RejectedExecutionException e) { ... } } } } \u8be5\u65b9\u6cd5\u53ea\u662f\u5728PendingHandlerCallback\u94fe\u8868\u4e2d\u52a0\u5165\u4e86\u4e00\u4e2a\u65b0\u7684PendingHandlerAddedTask\u800c\u6ca1\u6709\u6267\u884ccallHandlerAdded0\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u8c03\u7528\u7684\u65f6\u673a\u4f1a\u5728\u4e0b\u6587\u9610\u8ff0\u3002 \u81ea\u6b64addLast\u65b9\u6cd5\u7684\u8c03\u7528\u94fe\u5206\u6790\u5b8c\u6210\uff0c\u8fd9\u65f6\u5019NioServerSocketChannel\u7684pipline\u7684\u94fe\u8868\u7ed3\u6784\u5e94\u8be5\u5982\u4e0b\uff1a \u5c06NioServerSocketChannel\u6ce8\u518c\u5230EventLoop \u521d\u59cb\u5316\u7ba1\u9053\u7684\u5de5\u4f5c\u5b8c\u6210\u540e\uff0c\u63a5\u4e0b\u6765\u5c31\u662f\u8c03\u7528 config().group().register(channel) \u8fdb\u884cChannel\u7684\u6ce8\u518c\u5de5\u4f5c\u4e86\u3002\u8fd9\u91cc\u7684group\u65b9\u6cd5\u8fd4\u56de\u7684\u662fMultithreadEventLoopGroup\u5bf9\u8c61\uff0c\u8be5\u5bf9\u8c61\u7684register\u65b9\u6cd5\u5982\u4e0b\uff1a public ChannelFuture register(Channel channel) { return next().register(channel); } MultithreadEventLoopGroup\u5bf9\u8c61\u7684register\u53ef\u4ee5\u88ab\u5206\u4e3a\u4e24\u4e2a\u90e8\u5206\uff1a \u8c03\u7528next\u65b9\u6cd5\u4f1a\u4f7f\u7528\u9009\u62e9\u5668\u8fd4\u56de\u4e00\u4e2aEventLoop\u5bf9\u8c61 // MultithreadEventLoopGroup.java public EventLoop next() { return (EventLoop) super.next(); } // MultithreadEventExecutorGroup.java public EventExecutor next() { return chooser.next(); } // GenericEventExecutorChooser public EventExecutor next() { // \u4f7f\u7528idx\u5bf9\u7ebf\u7a0b\u6c60\u957f\u5ea6\u8fdb\u884c\u53d6\u6a21\uff0c\u8fd9\u6837Channel\u88ab\u5e73\u5747\u5206\u914d\u5230\u7ebf\u7a0b\u6c60\u7684\u7ebf\u7a0b\u4e0a return executors[Math.abs(idx.getAndIncrement() % executors.length)]; } \u8c03\u7528SingleThreadEventLoop\u7684register\u65b9\u6cd5\u6765\u6ce8\u518cChannel public ChannelFuture register(Channel channel) { return register(new DefaultChannelPromise(channel, this)); } public ChannelFuture register(final ChannelPromise promise) { ObjectUtil.checkNotNull(promise, \"promise\"); // \u8c03\u7528Channel\u7684AbstractUnsafe\u5bf9\u8c61\u7684register\u65b9\u6cd5\u6765\u6ce8\u518c\u7ba1\u9053 promise.channel().unsafe().register(this, promise); return promise; } \u53ef\u4ee5\u770b\u51faSingleThreadEventLoop\u7684register\u65b9\u6cd5\u6700\u6784\u5efa\u4e00\u4e2aDefaultChannelPromise\u5bf9\u8c61\uff0cDefaultChannelPromise\u5bf9\u8c61\u662f\u4e00\u4e2a\u7528\u6765\u5b58\u50a8\u5f02\u6b65\u4efb\u52a1\u7ed3\u679c\u5e76\u4f5c\u4e3a\u5f02\u6b65\u4efb\u52a1\u89c2\u5bdf\u8005\u7684\u5b9e\u4f8b\uff1b\u7ec8\u4f1a\u8c03\u7528Channel\u7684Unsafe\u5bf9\u8c61\u7684register\u65b9\u6cd5\u6765\u6ce8\u518c\u7ba1\u9053\uff0c\u6240\u4ee5\u8ba9\u6211\u4eec\u7ee7\u7eed\u8fdb\u5165AbstractUnsafe\u5bf9\u8c61\u7684register\u65b9\u6cd5\uff1a public final void register(EventLoop eventLoop, final ChannelPromise promise) { // \u4e00\u4e9b\u6821\u9a8c\u5de5\u4f5c ... // AbstractUnsafe\u662fAbstractChannel\u7684\u4e00\u4e2a\u5185\u90e8\u7c7b // \u6240\u4ee5\u7528AbstractChannel.this.eventLoop\u6765\u6307\u5b9a\u5f53\u524d\u7684eventLoop AbstractChannel.this.eventLoop = eventLoop; // \u5224\u65ad\u5f53\u524d\u7ebf\u7a0b\u662f\u4e0d\u662f\u4f20\u5165\u7684EventLoop\u5bf9\u8c61\u7684\u5de5\u4f5c\u7ebf\u7a0b if (eventLoop.inEventLoop()) { // \u5982\u679c\u662f\u5c31\u76f4\u63a5\u6267\u884cregister0 register0(promise); } else { try { // \u5982\u679c\u4e0d\u662f\u5219\u5c06register0\u4f5c\u4e3a\u4e00\u4e2aTask\u653e\u5165eventLoop\u7684\u4efb\u52a1\u961f\u5217 eventLoop.execute(new Runnable() { @Override public void run() { register0(promise); } }); } catch (Throwable t) { logger.warn( \"Force-closing a channel whose registration task was not accepted by an event loop: {}\", AbstractChannel.this, t); closeForcibly(); closeFuture.setClosed(); safeSetFailure(promise, t); } } } \u53ef\u4ee5\u770b\u5230register\u65b9\u6cd5\u4e3b\u8981\u505a\u4e86\u4e24\u4ef6\u4e8b\uff0c\u9996\u5148\u8bbe\u7f6e\u5f53\u524dChannel\u7684EventLoop\uff0c\u7136\u540e\u6839\u636e\u5f53\u524d\u7ebf\u7a0b\u662f\u5426\u662fEventLoop\u4e2d\u7684\u5de5\u4f5c\u7ebf\u7a0b\u6765\u51b3\u5b9a\u5982\u4f55\u6267\u884cregister0\u65b9\u6cd5\uff0c\u6bcb\u5eb8\u7f6e\u7591\u5728\u6574\u4e2aService\u670d\u52a1\u8d77\u6765\u7684\u8fc7\u7a0b\u4e2d\u6267\u884c\u7ebf\u7a0b\u662f\u4e3b\u7ebf\u7a0b\uff0c\u6240\u4ee5\u8fd9\u91cc\u7684register0\u65b9\u6cd5\u4f1a\u5728EventLoop\u7684\u5de5\u4f5c\u961f\u5217\u4e2d\u7b49\u5f85\u6267\u884c\uff0c\u4e5f\u5c31\u662f\u8bf4register0\u65b9\u6cd5\u4e2d\u6240\u6709\u7684\u903b\u8f91\u90fd\u662f\u7531EventLoop\u7684\u5de5\u4f5c\u7ebf\u7a0b\u6765\u5b8c\u6210\u7684\u3002\u4efb\u52a1\u5728\u4f55\u65f6\u5f00\u59cb\u6267\u884c\u4e0eNetty\u7ebf\u7a0b\u6a21\u578b\u6709\u5173\uff0c\u8fd9\u91cc\u6211\u4eec\u6682\u65f6\u4e0d\u8fdb\u884c\u6df1\u5165\uff0c\u5148\u8fdb\u5165\u5f02\u6b65\u6267\u884c\u7684register0\u65b9\u6cd5\uff1a private void register0(ChannelPromise promise) { try { if (!promise.setUncancellable() || !ensureOpen(promise)) { return; } boolean firstRegistration = neverRegistered; // \u5c06Java Channel\u6ce8\u518c\u5230Selector doRegister(); // \u5c06\u4ece\u672a\u6ce8\u518c\u5b57\u6bb5\u8bbe\u7f6e\u4e3afalse neverRegistered = false; // \u5c06\u5df2\u7ecf\u6ce8\u518c\u53d8\u91cf\u8bbe\u7f6e\u4e3atrue registered = true; // \u5728\u901a\u77e5\u76d1\u542c\u5668\u4e4b\u524d\u6267\u884cPendingHandlerCallback\u94fe\u4e2dcallback\u7684\u903b\u8f91 pipeline.invokeHandlerAddedIfNeeded(); // \u5c06Promise\u7684\u4e2d\u6267\u884c\u7ed3\u679c\u6807\u8bb0\u4e3aSUCCESS\uff0c\u5e76\u901a\u77e5\u6240\u6709\u7684\u76d1\u542c\u5668\u6267\u884c\u4efb\u52a1 safeSetSuccess(promise); // \u8c03\u7528pipline\u7684fireChannelRegistered\uff0c\u6267\u884c\u7ba1\u9053\u6ce8\u518c\u5b8c\u6210\u7684\u903b\u8f91 pipeline.fireChannelRegistered(); // \u5982\u679cJava Channel\u5904\u4e8e\u7ed1\u5b9a\u72b6\u6001 if (isActive()) { // \u5982\u679c\u662f\u7b2c\u4e00\u6b21\u8fdb\u884c\u6ce8\u518c if (firstRegistration) { // \u8c03\u7528pipline\u7684fireChannelActive\uff0c\u6267\u884c\u7ba1\u9053\u6fc0\u6d3b\u5b8c\u6210\u7684\u5b8c\u6210\u7684\u903b\u8f91 pipeline.fireChannelActive(); } else if (config().isAutoRead()) { beginRead(); } } } catch (Throwable t) { // Close the channel directly to avoid FD leak. closeForcibly(); closeFuture.setClosed(); safeSetFailure(promise, t); } } register0\u65b9\u6cd5\u662fNetty\u521d\u59cb\u8fc7\u7a0b\u4e2d\u6bd4\u8f83\u6838\u5fc3\u7684\u4ee3\u7801\uff0c\u4e3b\u8981\u53ef\u4ee5\u5206\u6210\u4ee5\u4e0b\u51e0\u5757\u903b\u8f91\uff1a \u8c03\u7528doRegister\u5c06Java Channel\u6ce8\u518c\u5230Selector protected void doRegister() throws Exception { boolean selected = false; for (;;) { try { selectionKey = javaChannel().register(eventLoop().unwrappedSelector(), 0, this); return; } catch (CancelledKeyException e) { if (!selected) { eventLoop().selectNow(); selected = true; } else { throw e; } } } } \u5c06doRegister\u65b9\u6cd5\u4e2d\u5c06Java Channel\uff08\u8fd9\u91cc\u662fServerSocketChannel\uff09\u6ce8\u518c\u5230\u4e86EventLoop\u7684Selector\u4e0a\uff0c\u53ef\u4ee5\u6ce8\u610f\u5230\u8fd9\u91cc\u6ce8\u518c\u7684\u4e8b\u4ef6\u662f0\uff0c\u5373\u4e0d\u76d1\u542c\u4efb\u4f55\u4e8b\u4ef6\uff0c\u76d1\u542c\u7684\u4e8b\u4ef6\u5c06\u5728\u540e\u7eed\u8fdb\u884c\u6ce8\u518c\uff0c\u4e0b\u6587\u5c06\u4f1a\u63d0\u5230\uff1b\u4e3a\u4ec0\u4e48\u8981\u7528\u6b7b\u5faa\u73af\u7684\u539f\u56e0\u76ee\u524d\u6211\u5e76\u4e0d\u592a\u660e\u767d\u3002\u3002\u3002 \u5c06registered\u6807\u8bb0\u5b57\u6bb5\u8bbe\u7f6e\u4e3atrue\uff0c\u8868\u660e\u8be5Channel\u5df2\u7ecf\u5b8c\u6210\u4e86\u6ce8\u518c \u8c03\u7528 pipeline.invokeHandlerAddedIfNeeded() \uff0c\u8be5\u65b9\u6cd5\u4f1a\u6267\u884c\u4e4b\u524d\u5728pipline\u7684addLast\u65b9\u6cd5\u4e2d\u8fdb\u884c\u8fc7\u8bf4\u660e\u7684PendingHandlerCallback\u94fe\u4e2d\u6240\u6709\u7684Task\u7684execute\u65b9\u6cd5\uff0c\u4e5f\u5c31\u662f\u8bf4callHandlerAdded0\u65b9\u6cd5\u5c06\u5728\u8fd9\u91cc\u8fdb\u884c\u8c03\u7528\u3002 final void invokeHandlerAddedIfNeeded() { // \u7531\u4e8eregister0\u65b9\u6cd5\u662f\u7531EventLoop\u4e2d\u7684\u5de5\u4f5c\u7ebf\u7a0b\u6267\u884c\u7684 // \u6240\u4ee5\u5f53\u524d\u7ebf\u7a0b\u5fc5\u987b\u662fEventLoop\u4e2d\u7684\u5de5\u4f5c\u7ebf\u7a0b\uff0c\u8fd9\u91cc\u8fdb\u884c\u4e00\u6b21\u5224\u65ad\u6821\u9a8c assert channel.eventLoop().inEventLoop(); if (firstRegistration) { // firstRegistration\u5c5e\u6027\u7684\u503c\u4fee\u6539\u4e3afalse firstRegistration = false; // \u6267\u884c\u56de\u8c03\u903b\u8f91 callHandlerAddedForAllHandlers(); } } private void callHandlerAddedForAllHandlers() { final PendingHandlerCallback pendingHandlerCallbackHead; synchronized (this) { assert !registered; // \u4fee\u6539pipline\u7684registered\u5c5e\u6027\u7684\u503c\u4e3atrue registered = true; // \u83b7\u5f97\u94fe\u8868\u7684\u5934\u7ed3\u70b9 pendingHandlerCallbackHead = this.pendingHandlerCallbackHead; this.pendingHandlerCallbackHead = null; } // \u4ece\u5934\u7ed3\u70b9\u5f00\u59cb\u6cbf\u7740\u56de\u8c03\u94fe\u6267\u884c\u56de\u8c03\u7684execute\u65b9\u6cd5 PendingHandlerCallback task = pendingHandlerCallbackHead; while (task != null) { task.execute(); task = task.next; } } \u7531\u4e0a\u8ff0\u6d41\u7a0b\u53ef\u4ee5\u77e5\u9053invokeHandlerAddedIfNeeded\u6700\u7ec8\u5c06\u4f1a\u6267\u884cPendingHandlerCallback\u94fe\u4e2d\u6240\u6709\u7684task\u7684execute\u65b9\u6cd5\uff0c\u6240\u4ee5\u4e4b\u524d\u901a\u8fc7pipline\u7684addLast\u65b9\u6cd5\u6700\u7ec8\u6dfb\u52a0\u5230\u94fe\u4e2d\u7684PendingHandlerAddedTask\u5bf9\u8c61\u7684execute\u65b9\u6cd5\u4e5f\u5728\u6b64\u65f6\u88ab\u6267\u884c\uff0c\u8ba9\u6211\u4eec\u56de\u5230PendingHandlerAddedTask\u7684execute\u65b9\u6cd5\uff1a void execute() { // \u56e0\u4e3actx\u4e2dexecutor\u5bf9\u8c61\u4e3a\u7a7a\uff0c\u6240\u4ee5\u8fd9\u91cc\u7684exector\u662fChannel\u6301\u6709\u7684EventLoop\u5bf9\u8c61 EventExecutor executor = ctx.executor(); // \u5224\u65ad\u5f53\u524d\u7ebf\u7a0b\u662f\u4e0d\u662fexecutor\u7684\u5de5\u4f5c\u7ebf\u7a0b if (executor.inEventLoop()) { // \u76f4\u63a5\u6267\u884ccallHandlerAdded0\u65b9\u6cd5 callHandlerAdded0(ctx); } else { try { // \u628a\u81ea\u5df1\u4f5c\u4e3atask\u63d0\u4ea4\uff0c\u4e5f\u5c31\u662f\u4f1a\u5728\u7a0d\u540e\u6267\u884c\u81ea\u8eab\u7684run\u65b9\u6cd5 // run\u65b9\u6cd5\u4e2d\u4e5f\u662f\u6267\u884c\u7684callHandlerAdded0\u65b9\u6cd5 executor.execute(this); } catch (RejectedExecutionException e) { if (logger.isWarnEnabled()) { logger.warn( \"Can't invoke handlerAdded() as the EventExecutor {} rejected it, removing handler {}.\", executor, ctx.name(), e); } remove0(ctx); ctx.setRemoved(); } } } public void run() { callHandlerAdded0(ctx); } \u7531\u4e4b\u524d\u5bf9AbstractUnsafe\u5bf9\u8c61\u7684register\u65b9\u6cd5\u5206\u6790\u53ef\u77e5\uff0cAbstractUnsafe\u5bf9\u8c61\u7684register0\u65b9\u6cd5\u662f\u7531EventLoop\u4e2d\u7684\u5de5\u4f5c\u7ebf\u7a0b\u53bb\u6267\u884c\u7684\uff0c\u6240\u4ee5register0\u4e2d\u6240\u6709\u7684\u903b\u8f91\u90fd\u7531EventLoop\u4e2d\u7684\u5de5\u4f5c\u7ebf\u7a0b\u6765\u5b8c\u6210\uff0c\u56e0\u6b64 executor.inEventLoop() \u5f97\u5230\u7684\u7ed3\u679c\u4e3atrue\uff0c\u6240\u4ee5\u63a5\u4e0b\u5c06\u76f4\u63a5\u6267\u884cDefaultChannelPipline\u7684callHandlerAdded0\u65b9\u6cd5\uff1a private void callHandlerAdded0(final AbstractChannelHandlerContext ctx) { try { ctx.callHandlerAdded(); } catch (Throwable t) { // \u9519\u8bef\u5904\u7406\u903b\u8f91 ... } } \u76ee\u524d\u6211\u4eec\u53ea\u5728ServerBootstrap\u7684 init \u65b9\u6cd5\u4e2d\u5728\u94fe\u8868\u672b\u5c3e\u6dfb\u52a0\u4e86\u4e00\u4e2a\u6dfb\u52a0\u4e86\u4e00\u4e2aChannelInitializer\uff0c\u6240\u4ee5\u8fd9\u91cc\u7684HandlerContext\u5c31\u662f\u5c01\u88c5ChannelInitializer\u7684HandlerContext\u3002\u63a5\u7740\u8fdb\u5165HandlerContext\u7684callHandlerAdded\u65b9\u6cd5\uff1a final void callHandlerAdded() throws Exception { // \u5c06Handler\u7684\u72b6\u6001\u4fee\u6539\u4e3aADD_COMPLETE if (setAddComplete()) { // \u901a\u8fc7handler\u65b9\u6cd5\u83b7\u5f97context\u4e2d\u7684handler\uff0c\u5e76\u4e14\u8c03\u7528handler\u7684handlerAdded\u65b9\u6cd5 handler().handlerAdded(this); } } \u5f88\u663e\u7136\u8fd9\u91cc\u7684handler\u65b9\u6cd5\u83b7\u5f97\u7684\u5c31\u662fChannelInitializer\u5bf9\u8c61\uff0c\u63a5\u7740\u8fdb\u5165ChannelInitializer\u7684handlerAdded\u65b9\u6cd5\uff1a public void handlerAdded(ChannelHandlerContext ctx) throws Exception { // \u5982\u679c\u7ba1\u9053\u5df2\u7ecf\u5b8c\u6210\u6ce8\u518c\uff0c\u5373registered\u6807\u8bb0\u4e3atrue if (ctx.channel().isRegistered()) { if (initChannel(ctx)) { // \u505a\u4e00\u4e9b\u540e\u7eed\u7684\u5904\u7406 removeState(ctx); } } } private boolean initChannel(ChannelHandlerContext ctx) throws Exception { // \u4fdd\u8bc1\u4e00\u4e2acontext\u53ea\u4f1a\u88ab\u6267\u884c\u4e00\u6b21 if (initMap.add(ctx)) { try { // \u6267\u884c\u7531\u5b50\u7c7b\u5b9e\u73b0\u7684initChannel\u65b9\u6cd5 initChannel((C) ctx.channel()); } catch (Throwable cause) { // \u8c03\u7528Handler\u7684\u5f02\u5e38\u5904\u7406\u65b9\u6cd5 exceptionCaught(ctx, cause); } finally { // \u6700\u540e\u5c06ChannelInitializer\u4ecepipline\u4e2d\u5220\u9664 ChannelPipeline pipeline = ctx.pipeline(); if (pipeline.context(this) != null) { pipeline.remove(this); } } return true; } return false; } \u6700\u7ec8handlerAdded\u4f1a\u8c03\u7528\u5b50\u7c7b\u5b9e\u73b0\u7684initChannel\u65b9\u6cd5\uff0c\u73b0\u5728\u6211\u4eec\u56de\u8fc7\u5934\u6765\u770b\u88ab\u6dfb\u52a0\u5230pipeline\u7684ChannelInitializer\u5b9e\u73b0\u7684initChannel\u65b9\u6cd5\uff1a p.addLast(new ChannelInitializer<Channel>() { @Override public void initChannel(final Channel ch) throws Exception { final ChannelPipeline pipeline = ch.pipeline(); // \u5728pipline\u4e2d\u6dfb\u52a0\u901a\u8fc7Bootstrap\u5bf9\u8c61\u7684handler\u914d\u7f6e\u7684Handler ChannelHandler handler = config.handler(); if (handler != null) { pipeline.addLast(handler); } // \u5411EventLoop\u7ebf\u7a0b\u7684\u4efb\u52a1\u961f\u5217\u63d0\u4ea4\u521b\u5efaServerBootstrapAcceptor\u5bf9\u8c61\u7684\u4efb\u52a1 ch.eventLoop().execute(new Runnable() { @Override public void run() { pipeline.addLast(new ServerBootstrapAcceptor( ch, currentChildGroup, currentChildHandler, currentChildOptions, currentChildAttrs)); } }); } }); initChannel\u65b9\u6cd5\u53ea\u505a\u4e86\u4e24\u4ef6\u4e8b\uff0c\u4e00\u662f\u5c06\u5728Bootstrap\u5bf9\u8c61\u7684handler\u65b9\u6cd5\u4e2d\u914d\u7f6e\u7684Handler\u52a0\u5165\u5230pipeline\u4e2d\uff0c\u7531\u4e8e\u6211\u4eec\u5e76\u6ca1\u6709\u914d\u7f6eHandler\u6240\u4ee5\u8fd9\u4e00\u6b65\u6ca1\u6709\u6dfb\u52a0Handler\uff1b\u4e8c\u662f\u5c06\u6dfb\u52a0ServerBootstrapAcceptor\u5bf9\u8c61\u5230pipeline\u7684\u5de5\u4f5c\u4ea4\u7ed9Channel\u7684EventLoop\u6765\u5904\u7406\u3002\u8fd9\u91cc\u8fd9\u4e48\u505a\u7684\u539f\u56e0\u662f\uff0c\u8981\u4fdd\u8bc1\u5982\u679cconfig\u4e2dHandler\u4e5f\u662fChannelInitializer\u65f6\uff0cChannelInitializer\u914d\u7f6e\u7684Handler\u4f1a\u5728ServerBootstrapAcceptor\u4e4b\u524d\uff0c\u90a3\u4e3a\u4ec0\u4e48\u80fd\u4fdd\u8bc1\u5462\uff1f \u6211\u662f\u8fd9\u6837\u8ba4\u4e3a\u7684\uff0c\u4e4b\u524d\u5728addLast\u65b9\u6cd5\u4e2d\u5206\u6790\u8fc7\uff0caddLast\u6267\u884ccallHandlerAdded0\u65b9\u6cd5\uff0c\u5c31\u662f\u6700\u7ec8\u6267\u884cChannelInitializer\u7684initChannel\u65b9\u6cd5\u7684\u53ef\u80fd\u6027\u6709\u4e09\u79cd\uff0c\u5176\u4e2d\u4e00\u79cd\u7684\u6761\u4ef6\u662fpipeline\u7684register\u5c5e\u6027\u4e3afalse\uff0c\u6b64\u65f6register\u5df2\u7ecf\u88ab\u8bbe\u7f6e\u4e3atrue\u6240\u4ee5\u4e0d\u8003\u8651\u8fd9\u79cd\u53ef\u80fd\u6027\uff1b\u4f46\u662f\u5b58\u5728\u5f53\u524d\u7ebf\u7a0b\u4e0eEventLoop\u7684\u5de5\u4f5c\u7ebf\u7a0b\u4e0d\u662f\u540c\u4e00\u4e2a\u7ebf\u7a0b\u7684\u60c5\u51b5\uff0ccallHandlerAdded0\u65b9\u6cd5\u53ef\u80fd\u88ab\u76f4\u63a5\u6267\u884c\uff0c\u8fd9\u79cd\u60c5\u51b5\u662f\u53ef\u4ee5\u4fdd\u8bc1\u5148\u540e\u987a\u5e8f\u7684\uff0c\u4f46\u4e5f\u53ef\u80fd\u88ab\u653e\u5165EventLoop\u7684\u4efb\u52a1\u961f\u5217\u4e2d\u53bb\u6267\u884c\uff0c\u6240\u4ee5\u4e3a\u4e86\u4fdd\u8bc1ServerBootstrapAcceptor\u5728pipeline\u7684\u672b\u5c3e\uff0c\u9700\u8981\u5c06\u6dfb\u52a0ServerBootstrapAcceptor\u5de5\u4f5c\u52a0\u5165\u5230\u4efb\u52a1\u961f\u5217\u4e2d\u53bb\u3002 \u8fd9\u91cc\u5bf9ServerBootstrapAcceptor\u8fdb\u884c\u4e00\u4e2a\u7b80\u5355\u7684\u8bf4\u660e\uff0cServerBootstrapAcceptor\u5b9e\u73b0\u4e86ChannelInboundHandlerAdapter\u63a5\u53e3\u8d1f\u8d23\u76d1\u542c\u8fde\u63a5\u8bf7\u6c42\uff0c\u5728\u5b8c\u6210\u8fde\u63a5\u4ee5\u540e\u4f1a\u521b\u5efa\u4e00\u4e2aNioSocketChannel\u6765\u8868\u793a\u5ba2\u6237\u7aef\u8fde\u63a5\uff0cNioSocketChanne\u4f1a\u88abl\u6ce8\u518c\u5230workerGroup\uff0c\u7528\u4e8e\u76d1\u542cIO\u8bfb\u5199\u8bf7\u6c42\u3002 \u5728\u8c03\u7528\u5b8c\u5b50\u7c7b\u7684initChannel\u65b9\u6cd5\u4e4b\u540e\uff0c\u5728finally\u5757\u4e2d\u6700\u540e\u4f1a\u4ecepiplien\u4e2d\u5c06ChannelInitializer\u79fb\u9664\uff0c\u81f3\u6b64invokeHandlerAddedIfNeeded()\u65b9\u6cd5\u7684\u6574\u4e2a\u8c03\u7528\u6d41\u7a0b\u5c31\u7ed3\u675f\u4e86\uff0cpipeline\u94fe\u8868\u7684\u7ed3\u6784\u5982\u4e0b\uff1a \u8c03\u7528safeSetSuccess\u65b9\u6cd5\uff0c\u8c03\u7528\u94fe\u5982\u4e0b\uff1a protected final void safeSetSuccess(ChannelPromise promise) { if (!(promise instanceof VoidChannelPromise) && !promise.trySuccess()) { logger.warn(\"Failed to mark a promise as success because it is done already: {}\", promise); } } public boolean trySuccess() { return trySuccess(null); } public boolean trySuccess(V result) { if (setSuccess0(result)) { notifyListeners(); return true; } return false; } \u8be5\u65b9\u6cd5\u7684\u4e3b\u8981\u903b\u8f91\u5c31\u662f\u5c06DefaultPromise\u5bf9\u8c61\u7684\u7ed3\u679c\u8bbe\u7f6e\u4e3aSUCCESS\u5e76\u4e14\u901a\u77e5\u6240\u6709\u7684\u76d1\u542c\u5668\u6267\u884coperationComplete\u65b9\u6cd5\uff0c\u8fd9\u91cc\u5c31\u4e0d\u6df1\u5165\u5177\u4f53\u7684\u903b\u8f91\u4e86\u3002 pipeline\u7684fireChannelRegistered\u65b9\u6cd5\u4f1a\u4f9d\u6b21\u8c03\u7528pipleline\u4e2d\u7684\u53cc\u5411\u94fe\u8868\u4e2d\u7684InboundHandler\u7684channelRegistered()\u65b9\u6cd5\uff0c\u6267\u884c\u7ba1\u9053\u6ce8\u518c\u5b8c\u6210\u7684\u903b\u8f91\uff0c\u8fd9\u91cc\u4e5f\u4e0d\u7ee7\u7eed\u8fdb\u884c\u5c55\u5f00\u3002 \u6700\u540e\uff0c\u5982\u679cJava Channel\u5904\u4e8e\u7ed1\u5b9a\u72b6\u6001\uff0c\u901a\u8fc7pipeline.fireChannelActive()\u65b9\u6cd5\u4f9d\u6b21\u8c03\u7528pipleline\u4e2d\u7684\u53cc\u5411\u94fe\u8868\u4e2d\u7684InboundHandler\u7684channelActive()\u65b9\u6cd5\uff0c\u6267\u884c\u7ba1\u9053\u6fc0\u6d3b\u5b8c\u6210\u7684\u903b\u8f91\uff0c\u4f46\u662f\u8fd9\u65f6\u5019\u7ba1\u9053\u8fd8\u672a\u7ed1\u5b9a\u6240\u4ee5\u4e0d\u4f1a\u6267\u884c\u8fd9\u91cc\u7684\u903b\u8f91\u3002 \u8fd9\u6837register0\u65b9\u6cd5\u7684\u8c03\u7528\u5c31\u7ed3\u675f\u4e86\uff0c\u7136\u800c\u56e0\u4e3aregister0\u662f\u4e00\u4e2a\u5f02\u6b65\u8c03\u7528\u8fc7\u7a0b\u6240\u4ee5\u5b9e\u9645\u4e0a\u8c03\u7528register0\u7684register\u65b9\u6cd5\u65e9\u5c31\u8fd4\u56de\u4e86\uff0c\u968f\u7740register\u65b9\u6cd5\u65e9\u5c31\u8fd4\u56deinitAndRegister\u65b9\u6cd5\u7684\u8c03\u7528\u4e5f\u7ed3\u675f\u4e86\u5e76\u4e14\u8fd4\u56de\u4e86\u5b58\u653eregister0\u8fd9\u4e2a\u5f02\u6b65\u8c03\u7528\u7ed3\u679c\u7684DefaultPromise\u5bf9\u8c61\uff0c\u8ba9\u6211\u4eec\u56de\u5230ServerBootstrap\u7684doBind\u65b9\u6cd5\u4e2d\uff1a private ChannelFuture doBind(final SocketAddress localAddress) { // \u521b\u5efa\u63a5\u53d7\u8fde\u63a5\u8bf7\u6c42\u7684Channel\u5e76\u6ce8\u518c\u5230NioEventLoop\u7684Selector final ChannelFuture regFuture = initAndRegister(); final Channel channel = regFuture.channel(); if (regFuture.cause() != null) { return regFuture; } // \u5224\u65ad\u64cd\u4f5c\u662f\u5426\u5b8c\u6210 if (regFuture.isDone()) { ChannelPromise promise = channel.newPromise(); // \u5982\u679c\u64cd\u4f5c\u5b8c\u6210\u8c03\u7528doBind0\u65b9\u6cd5 doBind0(regFuture, channel, localAddress, promise); return promise; } else { final PendingRegistrationPromise promise = new PendingRegistrationPromise(channel); // \u5982\u679c\u64cd\u4f5c\u8fd8\u672a\u5b8c\u6210\u5219\u6dfb\u52a0\u76d1\u542c\u5668\uff0c\u5728\u5b8c\u6210\u540e\u5224\u65ad\u64cd\u4f5c\u662f\u5426\u5931\u8d25\uff0c\u5982\u679c\u672a\u5931\u8d25\u5219\u7ee7\u7eed\u8c03\u7528doBind0\u65b9\u6cd5 regFuture.addListener(new ChannelFutureListener() { @Override public void operationComplete(ChannelFuture future) throws Exception { Throwable cause = future.cause(); if (cause != null) { promise.setFailure(cause); } else { promise.registered(); doBind0(regFuture, channel, localAddress, promise); } } }); return promise; } } \u5728initAndRegister\u65b9\u6cd5\u8fd4\u56de\u540e\uff0c\u901a\u8fc7DefaultPromise\u7684isDone\u65b9\u6cd5\u5224\u65ad\u4e00\u6b21register0\u65b9\u6cd5\u662f\u5426\u5b8c\u6210\u4e86\u8c03\u7528\uff0c\u5982\u679c\u5b8c\u6210\u5219\u76f4\u63a5\u8c03\u7528doBind0\u65b9\u6cd5\uff0c\u5982\u679c\u6ca1\u6709\u5b8c\u6210\u6dfb\u52a0\u4e00\u4e2a\u76d1\u542c\u5668\u53bb\u7b49\u5f85\u4efb\u52a1\u5b8c\u6210\u540e\u7ee7\u7eed\u6267\u884cdoBind0\u65b9\u6cd5\uff0c\u4e4b\u524d\u5206\u6790\u8fc7\u76d1\u542c\u5668\u4f1a\u5728safeSetSuccess\u4e2d\u88ab\u901a\u77e5\u3002\u56e0\u6b64\u65e0\u8bba\u5982\u4f55\uff0c\u6700\u7ec8\u90fd\u4f1a\u8c03\u7528doBind0\u65b9\u6cd5\uff1a private static void doBind0( final ChannelFuture regFuture, final Channel channel, final SocketAddress localAddress, final ChannelPromise promise) { // \u5728\u89e6\u53d1channelRegistered\u4e4b\u524d\u8c03\u7528\u6b64\u65b9\u6cd5 // \u4f7f\u7528\u6237\u5904\u7406\u7a0b\u5e8f\u6709\u673a\u4f1a\u5728\u5176channelRegistered\u5b9e\u73b0\u4e2d\u8bbe\u7f6e\u7ba1\u9053 channel.eventLoop().execute(new Runnable() { @Override public void run() { if (regFuture.isSuccess()) { channel.bind(localAddress, promise).addListener(ChannelFutureListener.CLOSE_ON_FAILURE); } else { promise.setFailure(regFuture.cause()); } } }); } \u8be5\u65b9\u6cd5\u76f4\u63a5\u8c03\u7528\u4e86AbstractChannel\u7684bind\u65b9\u6cd5\uff0c\u8c03\u7528\u94fe\u5982\u4e0b\uff1a public ChannelFuture bind(SocketAddress localAddress, ChannelPromise promise) { return pipeline.bind(localAddress, promise); } public final ChannelFuture bind(SocketAddress localAddress, ChannelPromise promise) { // \u8c03\u7528\u4e86TailContext\u7684bind\u65b9\u6cd5 return tail.bind(localAddress, promise); } public ChannelFuture bind(final SocketAddress localAddress, final ChannelPromise promise) { if (localAddress == null) { throw new NullPointerException(\"localAddress\"); } if (isNotValidPromise(promise, false)) { return promise; } // \u627e\u5230\u4e0a\u4e00\u4e2aoutbound final AbstractChannelHandlerContext next = findContextOutbound(); EventExecutor executor = next.executor(); // \u6267\u884cAbstractChannelHandlerContext\u7684invokeBind if (executor.inEventLoop()) { next.invokeBind(localAddress, promise); } else { safeExecute(executor, new Runnable() { @Override public void run() { next.invokeBind(localAddress, promise); } }, promise, null); } return promise; } \u901a\u8fc7findContextOutbound\u627e\u5230pipeline\u94fe\u8868\u4e2d\u7684\u4e0a\u4e00\u4e2a\u6301\u6709\u5b9e\u73b0\u4e86ChannelOutboundHandler\u63a5\u53e3\u7684Handler\u5bf9\u8c61\u7684AbstractChannelHandlerContext\u5bf9\u8c61\uff0cfindContextOutbound\u65b9\u6cd5\u5982\u4e0b\uff1a private AbstractChannelHandlerContext findContextOutbound() { AbstractChannelHandlerContext ctx = this; do { ctx = ctx.prev; } while (!ctx.outbound); return ctx; } \u76ee\u524d\u7684pipeline\u94fe\u8868\u5982\u4e0b\uff1a \u6240\u4ee5\u8fd9\u91cc\u627e\u5230\u7684AbstractChannelHandlerContext\u4e3aHeadContext\uff0c\u6700\u7ec8\u4f1a\u8fdb\u5165TailContext\u7684bind\u65b9\u6cd5\uff0c\u8c03\u7528\u94fe\u5982\u4e0b\uff1a public void bind( ChannelHandlerContext ctx, SocketAddress localAddress, ChannelPromise promise) { // \u7531\u4e8eTailContext\u662fpipeline\u7684\u5185\u90e8\u7c7b\uff0c\u6240\u4ee5\u8fd9\u91cc\u8c03\u7528\u4e86pipeline\u7684unsafe\u7684bind\u65b9\u6cd5 unsafe.bind(localAddress, promise); } public final void bind(final SocketAddress localAddress, final ChannelPromise promise) { assertEventLoop(); if (!promise.setUncancellable() || !ensureOpen(promise)) { return; } if (Boolean.TRUE.equals(config().getOption(ChannelOption.SO_BROADCAST)) && localAddress instanceof InetSocketAddress && !((InetSocketAddress) localAddress).getAddress().isAnyLocalAddress() && !PlatformDependent.isWindows() && !PlatformDependent.maybeSuperUser()) { logger.warn( \"A non-root user can't receive a broadcast packet if the socket \" + \"is not bound to a wildcard address; binding to a non-wildcard \" + \"address (\" + localAddress + \") anyway as requested.\"); } boolean wasActive = isActive(); try { // \u7ed1\u5b9aJava Channel\u5230\u6307\u5b9a\u7684\u7aef\u53e3 doBind(localAddress); } catch (Throwable t) { safeSetFailure(promise, t); closeIfClosed(); return; } // \u5982\u679cJava Channel\u4e4b\u524d\u662f\u672a\u7ed1\u5b9a\u7684\uff0c\u73b0\u5728\u5b8c\u6210\u4e86\u7ed1\u5b9a\u5219\u6267\u884cfireChannelActive\u903b\u8f91 if (!wasActive && isActive()) { // \u5728Channel\u7684EventLoop\u7684\u4efb\u52a1\u961f\u5217\u5c06pipeline.fireChannelActive()\u65b9\u6cd5\u4f5c\u4e3a\u4efb\u52a1\u63d0\u4ea4 invokeLater(new Runnable() { @Override public void run() { pipeline.fireChannelActive(); } }); } safeSetSuccess(promise); } \u8fd9\u91cc\u6709\u5f88\u91cd\u8981\u7684\u4e24\u6b65\u903b\u8f91\uff0c\u4e00\u662f\u901a\u8fc7doBind\u65b9\u6cd5\u5c06Java Channel\u7ed1\u5b9a\u5230\u5bf9\u5e94\u7684\u7aef\u53e3\uff1b\u7136\u540e\u5728\u7ed1\u5b9a\u4e4b\u540e\u63a5\u7740\u8c03\u7528fireChannelActive\u65b9\u6cd5\uff0c\u5f00\u59cb\u7ba1\u9053\u6fc0\u6d3b\u7684\u903b\u8f91\u3002 \u7531\u4e8e\u8fd9\u91cc\u7684Channel\u7c7b\u662fNioServerSocketChannel\uff0c\u6240\u4ee5\u8fdb\u5165NioServerSocketChannel\u7684doBind\u65b9\u6cd5\uff1a protected void doBind(SocketAddress localAddress) throws Exception { if (PlatformDependent.javaVersion() >= 7) { javaChannel().bind(localAddress, config.getBacklog()); } else { javaChannel().socket().bind(localAddress, config.getBacklog()); } } \u8fd9\u91cc\u5c31\u56de\u5230\u4e86Java NIO\u7684API\uff0c\u6839\u636eJDK\u7248\u672c\u5b9e\u73b0Java Channel\u7684\u7ed1\u5b9a\uff1a >= 7\uff0c\u8c03\u7528ServerSocketChannel.bind(SocketAddress\uff0cconfig.getBacklog()) \u5426\u5219\uff0c\u8c03\u7528ServerSocketChannel.socket().bind(SocketAddress\uff0cconfig.getBacklog()) \u5b8c\u6210\u7ed1\u5b9a\u540e\uff0c\u7a0d\u540e\u8c03\u7528 pipeline.fireChannelActive() \u65b9\u6cd5\u89e6\u53d1\u7ba1\u9053\u6fc0\u6d3b\u4e8b\u4ef6\uff1a public final ChannelPipeline fireChannelActive() { // \u4ee5HeadContext\u4f5c\u4e3a\u94fe\u8868\u7684\u5f00\u7aef\u89e6\u53d1pipeline\u7684\u6fc0\u6d3b\u65b9\u6cd5 AbstractChannelHandlerContext.invokeChannelActive(head); return this; } static void invokeChannelActive(final AbstractChannelHandlerContext next) { EventExecutor executor = next.executor(); if (executor.inEventLoop()) { next.invokeChannelActive(); } else { executor.execute(new Runnable() { @Override public void run() { next.invokeChannelActive(); } }); } } fireChannelActive\u65b9\u6cd5\u5c06HeadContext\u4f5c\u4e3a\u53c2\u6570\u8c03\u7528\u4e86invokeChannelActive\u65b9\u6cd5\uff0c\u56e0\u6b64\u6700\u7ec8\u5c06\u8c03\u7528HeadContext\u7684invokeChannelActive\u65b9\u6cd5\uff1a private void invokeChannelActive() { if (invokeHandler()) { try { // HeadContext\u7684handler\u65b9\u6cd5\u8fd4\u56de\u7684HeadContext\u81ea\u8eab // \u6240\u4ee5\u5c06\u7ee7\u7eed\u8c03\u7528HeadContext\u7684channelActive\u65b9\u6cd5 ((ChannelInboundHandler) handler()).channelActive(this); } catch (Throwable t) { notifyHandlerException(t); } } else { fireChannelActive(); } } \u7531\u4e8eHeadContext\u7684handler\u65b9\u6cd5\u8fd4\u56de\u7684HeadContext\u81ea\u8eab\uff0c\u6240\u4ee5\u5c06\u7ee7\u7eed\u8c03\u7528HeadContext\u7684channelActive\u65b9\u6cd5\uff1a public void channelActive(ChannelHandlerContext ctx) { // \u5c06\u6fc0\u6d3b\u4e8b\u4ef6\u4f20\u9012\u7ed9\u94fe\u8868\u4e2d\u7684\u5176\u4ed6HandlerContext ctx.fireChannelActive(); readIfIsAutoRead(); } HeadContext\u4f1a\u9996\u5148\u5c06\u6fc0\u6d3b\u4e8b\u4ef6\u4f20\u9012\u7ed9\u94fe\u8868\u4e2d\u7684\u5176\u4ed6HandlerContext\uff0c\u7531\u4e8e\u5176\u4ed6Context\u4e2d\u6ca1\u6709\u7279\u522b\u91cd\u8981\u7684\u6fc0\u6d3b\u4e8b\u4ef6\u7684\u903b\u8f91\uff0c\u8fd9\u91cc\u5c31\u4e0d\u8fdb\u884c\u6df1\u5165\u4e86\u3002\u63a5\u4e0b\u6765\u7ee7\u7eed\u6267\u884creadIfIsAutoRead\u65b9\u6cd5\uff0c\u903b\u8f91\u5982\u4e0b\uff1a private void readIfIsAutoRead() { if (channel.config().isAutoRead()) { channel.read(); } } public Channel read() { pipeline.read(); return this; } public final ChannelPipeline read() { tail.read(); return this; } public ChannelHandlerContext read() { final AbstractChannelHandlerContext next = findContextOutbound(); EventExecutor executor = next.executor(); if (executor.inEventLoop()) { next.invokeRead(); } else { Runnable task = next.invokeReadTask; if (task == null) { next.invokeReadTask = task = new Runnable() { @Override public void run() { next.invokeRead(); } }; } executor.execute(task); } return this; } \u53ef\u4ee5\u770b\u51fa\uff0cread\u65b9\u6cd5\u7684\u8c03\u7528\u94fe\u548cbind\u65b9\u6cd5\u7684\u8c03\u7528\u94fe\u5927\u540c\u5c0f\u5f02\uff0c\u4e5f\u662f\u901a\u8fc7TailContext\u5f80\u524d\u5bfb\u627e\u6301\u6709\u5b9e\u73b0\u4e86ChannelOutboundHandler\u63a5\u53e3\u7684Handler\u5bf9\u8c61\u7684AbstractChannelHandlerContext\u5bf9\u8c61\uff0c\u5728\u5f53\u524d\u94fe\u8868\u4e2d\u53ea\u80fd\u627e\u5230HeadContext\uff0c\u56e0\u6b64\u63a5\u4e0b\u6765\u5c06\u6267\u884cHeadContext\u7684read\u65b9\u6cd5\uff0c\u5982\u4e0b\uff1a public void read(ChannelHandlerContext ctx) { unsafe.beginRead(); } // AbstractUnsafe public final void beginRead() { assertEventLoop(); if (!isActive()) { return; } try { doBeginRead(); } catch (final Exception e) { invokeLater(new Runnable() { @Override public void run() { pipeline.fireExceptionCaught(e); } }); close(voidPromise()); } } // AbstractNioMessageChannel protected void doBeginRead() throws Exception { if (inputShutdown) { return; } super.doBeginRead(); } // AbstractNioChannel protected void doBeginRead() throws Exception { // \u8fd9\u91cc\u7684selectionKey\u5c31\u662f\u4e4b\u524d\u521d\u59cb\u5316NioServerSocketChannel\u65f6\u8bbe\u7f6e\u7684SelectionKey.OP_ACCEPT final SelectionKey selectionKey = this.selectionKey; if (!selectionKey.isValid()) { return; } readPending = true; final int interestOps = selectionKey.interestOps(); if ((interestOps & readInterestOp) == 0) { selectionKey.interestOps(interestOps | readInterestOp); } } \u6839\u636e\u8c03\u7528\u8c03\u7528\u94fe\u53ef\u77e5\u6700\u540e\u5c06\u8c03\u7528AbstractNioChannel\u7684doBeginRead\u65b9\u6cd5\uff0c\u5176\u4e2d\u7684readInterestOp\u5c31\u662f\u4e4b\u524d\u7684SelectionKey.OP_ACCEPT\u7684\u503c\uff0c\u53c8\u56de\u5230\u4e86Java NIO\u7684API\uff0c\u901a\u8fc7selectionKey .interestOps()\u6ce8\u518c\u4e00\u4e2aACCEPT\u4e8b\u4ef6\u3002\u5230\u8fd9\u91cc\u6574\u4e2a ServerBootstrap.bind \u7684\u903b\u8f91\u5c31\u5b8c\u6210\u4e86\uff0c\u63a5\u53d7\u8fde\u63a5\u8bf7\u6c42\u7684\u7ba1\u9053\u4e5f\u521d\u59cb\u5316\u548c\u521b\u5efa\u4e86\u3002 IO\u8bfb\u5199\u7ba1\u9053\u7684\u521b\u5efa\u548c\u6570\u636e\u7684\u51fa\u7ad9\u5165\u7ad9 \u8981\u5f00\u59cb\u505a\u4ea4\u63a5\u5de5\u4f5c\u4e86\uff0c\u540e\u7eed\u6709\u65f6\u95f4\u5728\u628a\u8fd9\u8fb9\u7684\u5206\u6790\u8865\u4e0a\u3002 <====To be continue... Ref https://blog.csdn.net/u013857458/article/details/82527722 https://blog.csdn.net/dk243553650/article/details/83062573","title":"Netty NIO\u7b14\u8bb0"},{"location":"Others/Netty NIO\u7b14\u8bb0/#netty-nio","text":"","title":"Netty NIO\u7b14\u8bb0"},{"location":"Others/Netty NIO\u7b14\u8bb0/#netty","text":"Netty NIO\u5bf9 Java NIO \u8fdb\u884c\u4e86\u5c01\u88c5\uff0c\u7b80\u5316\u4e86 Java NIO \u7f16\u7801\u5de5\u4f5c\u548c\u5b58\u5728\u7684BUG\u3002","title":"Netty\u67b6\u6784"},{"location":"Others/Netty NIO\u7b14\u8bb0/#reactor","text":"\u5728\u4ecb\u7ecdNetty\u7ebf\u7a0b\u6a21\u578b\u4e4b\u524d\uff0c\u5148\u7b80\u5355\u4ecb\u7ecdReactor\u7ebf\u7a0b\u6a21\u578b\uff0cReactor\u662f\u57fa\u4e8e\u4e8b\u4ef6\u9a71\u52a8\u7684\u6a21\u578b\uff0c\u5206\u4e3a\u4e09\u4e2a\u89d2\u8272\uff1a Acceptor\uff1a\u8d1f\u8d23\u63a5\u6536Accept\u4e8b\u4ef6\uff0c\u7136\u540e\u5c06\u8fde\u63a5\u6ce8\u518c\u6210\u8bfb\u4e8b\u4ef6\uff0c\u4f20\u9012\u7ed9dispatch; Dispatch\uff1a\u8d1f\u8d23\u5206\u53d1\u4e8b\u4ef6\uff0c\u5982\u679c\u662f\u63a5\u6536\u5230Accept\u4e8b\u4ef6,\u5219\u5206\u53d1\u7ed9Acceptor\u3002\u5982\u679c\u662fRead\u4e8b\u4ef6\uff0c\u5c06\u8bf7\u6c42\u4ea4\u7ed9ReadHandler\u5904\u7406\uff1b Handler\uff1a\u8d1f\u8d23\u5904\u7406\u5177\u4f53\u4e8b\u4ef6\uff1b Reactor\u7ebf\u7a0b\u6a21\u578b\u5173\u6ce8\u7684\u662f\uff1a\u4efb\u52a1\u63a5\u53d7\u4e4b\u540e\uff0c\u5bf9\u5904\u7406\u8fc7\u7a0b\u7ee7\u7eed\u8fdb\u884c\u5207\u5206\uff0c\u5212\u5206\u4e3a\u591a\u4e2a\u4e0d\u540c\u7684\u6b65\u9aa4\uff0c\u6bcf\u4e2a\u6b65\u9aa4\u7528\u4e0d\u540c\u7684\u7ebf\u7a0b\u6765\u5904\u7406\uff0c\u4e5f\u5c31\u662f\u539f\u672c\u7531\u4e00\u4e2a\u7ebf\u7a0b\u5904\u7406\u7684\u4efb\u52a1\u73b0\u5728\u7531\u591a\u4e2a\u7ebf\u7a0b\u6765\u5904\u7406\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u5728\u5904\u7406\u5b8c\u81ea\u5df1\u7684\u6b65\u9aa4\u4e4b\u540e\uff0c\u8fd8\u9700\u8981\u5c06\u4efb\u52a1\u8f6c\u53d1\u5230\u4e0b\u9636\u6bb5\u7ebf\u7a0b\u7ee7\u7eed\u8fdb\u884c\u5904\u7406\u3002 Netty\u4e2d\u7684Reactor\u6a21\u578b\u5982\u4e0b\uff1a \u5176\u4e2dmainReactor\u7ebf\u7a0b\u6c60\u8d1f\u8d23\u5904\u7406\u8fde\u63a5\u8bf7\u6c42\uff1b\u5f53acceptor\u63a5\u53d7\u8fde\u63a5\u540e\u4f1a\u5c06\u8fde\u63a5\u6ce8\u518c\u5230subReactor\u7684\u7ebf\u7a0b\u4e0a\uff1b\u7531subReactor\u6765\u5904\u7406IO\u8bf7\u6c42\uff1b\u800cThreadPool\u53ef\u4ee5\u7528\u6765\u5904\u7406\u8017\u65f6\u7684\u4e1a\u52a1\u903b\u8f91\u3002\u867d\u7136 Netty \u7684\u7ebf\u7a0b\u6a21\u578b\u57fa\u4e8e\u4e3b\u4ece Reactor \u591a\u7ebf\u7a0b\u6a21\u578b\uff0c\u4f46\u662f\u505a\u4e86\u90e8\u5206\u8c03\u6574\u548c\u4fee\u6539\uff0c\u5c06acceptor\u53d8\u6210\u4e86mainReactor\u4e2d\u7684\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u5e76\u4e14\u9ed8\u8ba4\u4f7f\u7528subReactor\u7ebf\u7a0b\u6c60\u4e2d\u7684\u7ebf\u7a0b\u6765\u5904\u7406compute\u5de5\u4f5c\uff0c\u540c\u65f6\u4e5f\u652f\u6301\u4f7f\u7528\u72ec\u7acb\u7684\u7ebf\u7a0b\u6c60\u5904\u7406compute\u5de5\u4f5c\uff0c\u8fd9\u9700\u8981\u8fdb\u884c\u624b\u52a8\u914d\u7f6e\u3002","title":"Reactor\u7ebf\u7a0b\u6a21\u578b"},{"location":"Others/Netty NIO\u7b14\u8bb0/#netty_1","text":"","title":"Netty\u7ebf\u7a0b\u6a21\u578b"},{"location":"Others/Netty NIO\u7b14\u8bb0/#netty_2","text":"","title":"Netty\u7ec4\u4ef6"},{"location":"Others/Netty NIO\u7b14\u8bb0/#nioeventloopnioeventloopgroup","text":"NioEventLoopGroup\u5b9e\u9645\u4e0a\u5c31\u662f\u4e00\u4e2a\u7ebf\u7a0b\u6c60\uff0c\u7ebf\u7a0b\u6c60\u4e2d\u6709\u591a\u4e2aNioEventLoop\u5de5\u4f5c\u7ebf\u7a0b\uff0c\u5982\u679c\u4e0d\u8fdb\u884c\u624b\u52a8\u8bbe\u7f6e\u9ed8\u8ba4\u5de5\u4f5c\u7ebf\u7a0b\u6570\u91cf\u4e3a\u7269\u7406\u673acpu\u6838\u5fc3\u6570\u91cf\u76842\u500d\u3002 \u6bcf\u4e2aNioEventLoop\u90fd\u7ed1\u5b9a\u4e86\u4e00\u4e2aSelector\u7528\u4e8e\u76d1\u542c\u6ce8\u518c\u5230Selector\u7684Channel\u7684IO\u4e8b\u4ef6\uff0cNioEventLoop\u7684\u5de5\u4f5c\u5305\u62ecIO\u4e8b\u4ef6\u76d1\u542c\u3001IO\u4e8b\u4ef6\u5904\u7406\u3001\u4ee5\u53ca\u4ea4\u7ed9NioEventLoop\u7684\u5176\u4ed6\u4efb\u52a1\u4e09\u4e2a\u90e8\u5206\u3002\u7531\u4e8eNetty\u6a21\u578b\u4e2d\u6709\u591a\u4e2aNioEventLoop\uff0c\u6240\u4ee5\u5b58\u5728\u591a\u7ec4Selector\u5728\u76d1\u542cIO\u5c31\u7eea\u4e8b\u4ef6\u3002 \u4e00\u4e2aNioEventLoop\u7684Selector\u53ef\u4ee5\u88ab\u591a\u4e2aChannel\u6ce8\u518c\uff0c\u4e5f\u5c31\u662f\u8bf4\u591a\u4e2aChannel\u5171\u4eab\u4e00\u4e2aEventLoop\u3002EventLoop\u7684Selecctor\u5bf9\u6240\u4ee5\u7ed1\u5b9a\u5230NioEventLoop\u7684Channel\u7684IO\u4e8b\u4ef6\u8fdb\u884c\u76d1\u542c\u3002\u4f46\u4e00\u4e2aChannel\u53ea\u80fd\u7ed1\u5b9a\u5230\u4e00\u4e2aNioEventLoop\u76f8\u5f53\u4e8e\u4e00\u4e2a\u8fde\u63a5\u7ed1\u5b9a\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u8fd9\u4e2a\u8fde\u63a5\u6240\u6709\u7684ChannelHandler\u90fd\u662f\u5728\u4e00\u4e2a\u7ebf\u7a0b\u4e2d\u6267\u884c\u7684\uff0c\u907f\u514d\u4e86\u591a\u7ebf\u7a0b\u5e72\u6270\u3002\u66f4\u91cd\u8981\u7684\u662fChannelPipline\u94fe\u8868\u5fc5\u987b\u4e25\u683c\u6309\u7167\u987a\u5e8f\u6267\u884c\u7684\u3002\u5355\u7ebf\u7a0b\u7684\u8bbe\u8ba1\u80fd\u591f\u4fdd\u8bc1ChannelHandler\u7684\u987a\u5e8f\u6267\u884c\u3002 \u5728\u76d1\u542c\u4e00\u4e2a\u7aef\u53e3\u7684\u60c5\u51b5\u4e0b\uff0c\u4e00\u4e2aNioEventLoop\u901a\u8fc7\u4e00\u4e2aNioServerSocketChannel\u76d1\u542c\u7aef\u53e3\uff0c\u5904\u7406TCP\u8fde\u63a5\u8bf7\u6c42\u3002\u540e\u7aef\u591a\u4e2aNioEventLoop\u5de5\u4f5c\u7ebf\u7a0b\u5904\u7406IO\u4e8b\u4ef6\u3002\u6bcf\u4e2aChannel\u7ed1\u5b9a\u4e00\u4e2aNioEventLoop\u7ebf\u7a0b\uff0c\u4e00\u4e2aNioEventLoop\u7ebf\u7a0b\u5173\u8054\u4e00\u4e2aSelector\u6765\u4e3a\u591a\u4e2a\u6ce8\u518c\u5230\u5b83\u7684Channel\u76d1\u542cIO\u5c31\u7eea\u4e8b\u4ef6\u3002NioEventLoop\u662f\u5355\u7ebf\u7a0b\u6267\u884c\uff0c\u4fdd\u8bc1ChannelPipline\u5728\u5355\u7ebf\u7a0b\u4e2d\u6267\u884c\uff0c\u4fdd\u8bc1\u4e86ChannelHandler\u7684\u6267\u884c\u987a\u5e8f\u3002","title":"NioEventLoop\u548cNioEventLoopGroup"},{"location":"Others/Netty NIO\u7b14\u8bb0/#channel","text":"Netty\u4e2d\u7684\u901a\u9053\u662f\u5bf9Java\u539f\u751f\u7f51\u7edcAPI\u7684\u5c01\u88c5\uff0c\u5176\u9876\u5c42\u63a5\u53e3\u4e3aChannel\u3002 \u4ee5TCP\u7f16\u7a0b\u4e3a\u4f8b \uff0c\u5728Java\u4e2d\uff0c\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a \u57fa\u4e8eBIO\uff0cJDK1.4\u4e4b\u524d\uff0c\u6211\u4eec\u901a\u5e38\u4f7f\u7528java.net\u5305\u4e2d\u7684ServerSocket\u548cSocket\u6765\u4ee3\u8868\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u3002 \u57fa\u4e8eNIO\uff0cJdk1.4\u5f15\u5165nio\u7f16\u7a0b\u4e4b\u540e\uff0c\u6211\u4eec\u4f7f\u7528java.nio.channels\u5305\u4e2d\u7684ServerSocketChannel\u548cSocketChannel\u6765\u4ee3\u8868\u670d\u52a1\u7aef\u4e0e\u5ba2\u6237\u7aef\u3002 \u5728Netty\u4e2d\uff0c\u5bf9java\u4e2d\u7684BIO\u3001NIO\u7f16\u7a0bapi\u90fd\u8fdb\u884c\u4e86\u5c01\u88c5\uff0c\u5206\u522b\u4e3a\uff1a \u4f7f\u7528\u4e86OioServerSocketChannel\uff0cOioSocketChannel\u5bf9java.net\u5305\u4e2d\u7684ServerSocket\u4e0eSocket\u8fdb\u884c\u4e86\u5c01\u88c5 \u4f7f\u7528NioServerSocketChannel\u548cNioSocketChannel\u5bf9java.nio.channels\u5305\u4e2d\u7684ServerSocketChannel\u548cSocketChannel\u8fdb\u884c\u4e86\u5c01\u88c5\u3002 \u7531\u4e8e\u672c\u6587\u53ea\u5bf9NIO\u8fdb\u884c\u8bf4\u660e\uff0c\u6240\u4ee5\u5c31\u4e0d\u5bf9BIO\u76f8\u5173\u7684\u5185\u5bb9\u8fdb\u884c\u6df1\u5165\uff0cNetty\u4e2dNIO\u76f8\u5173\u7684Channel\u7c7b\u5173\u7cfb\u56fe\u5982\u4e0b\uff1a NioServerSocketChannel\u548cNioSocketChannel\u4e2d\u90fd\u6301\u6709\u5bf9\u5e94\u7684Java NIO Channel\u7684\u5f15\u7528\uff0c\u6240\u4ee5NioServerSocketChannel\u6ce8\u518c\u5230NioEventLoop\uff0c\u5b9e\u9645\u4e0a\u5c31\u662fJava NIO Channel\u6ce8\u518c\u5230\u7ed1\u5b9a\u5728NioEventLoop\u4e0a\u7684Selector\u3002\u4e8c\u8005\u90fd\u7ee7\u627f\u81eaAbstractNioChannel\uff0c\u5176\u7ef4\u62a4\u4e86Netty\u4e2d\u7684Channel\u4e0eJava NIO\u4e2dChannel\u7684\u5bf9\u5e94\u5173\u7cfb\uff0c\u5e76\u63d0\u4f9b\u4e86 javaChannel() \u65b9\u6cd5\u83b7\u53d6\u5bf9\u5e94\u7684Java Channel\u3002 public abstract class AbstractNioChannel extends AbstractChannel { ... private final SelectableChannel ch; ... // \u83b7\u53d6\u5bf9\u5e94\u7684java channel protected SelectableChannel javaChannel() { return ch; } } SelectableChannel\u662fJava NIO\u4e2d\u7684\u7c7b\uff0c\u6211\u4eec\u524d\u9762\u63d0\u5230nio\u5305\u4e2d\u7684SocketChannel\u3001ServerSocketChannel\u90fd\u662f\u5176\u5b50\u7c7b\uff0cNioSocketChannel\u548cNioServerSocketChannel\u5bf9AbstractNioChannel\u7684 javaChannel() \u8fdb\u884c\u4e86\u91cd\u5199\uff0c\u5c06SelectableChannel\u5f3a\u8f6c\u4e3a\u5bf9\u5e94Java Channel\uff0c\u5982\u4e0b\uff1a io.netty.channel.socket.nio.NioServerSocketChannel#javaChannel @Override // \u8fd4\u56dejava.nio.channels.ServerSocketChannel protected ServerSocketChannel javaChannel() { return (ServerSocketChannel) super.javaChannel(); } io.netty.channel.socket.nio.NioSocketChannel#javaChannel @Override // \u8fd4\u56dejava.nio.channels.SocketChannel protected SocketChannel javaChannel() { return (SocketChannel) super.javaChannel(); } \u5728\u521b\u5efaNioServerSocketChannel\u548cNioSocketChannel\u5bf9\u8c61\u65f6\uff0c\u4f1a\u5728\u6784\u9020\u51fd\u6570\u4e2d\u4e3a\u5176\u6307\u5b9a\u5bf9\u5e94\u7684ServerSocket\u548cSocket\u5b9e\u4f8b\uff0c\u4ee5NioServerSocketChannel\u4e3a\u4f8b\uff1a public class NioServerSocketChannel extends AbstractNioMessageChannel implements io.netty.channel.socket.ServerSocketChannel { private static final SelectorProvider DEFAULT_SELECTOR_PROVIDER = SelectorProvider.provider(); private static ServerSocketChannel newSocket(SelectorProvider provider) { try { // \u751f\u6210\u4e00\u4e2a\u65b0\u7684ServerSocketChannel\u5bf9\u8c61 return provider.openServerSocketChannel(); } catch (IOException e) { throw new ChannelException( \"Failed to open a server socket.\", e); } } public NioServerSocketChannel() { this(newSocket(DEFAULT_SELECTOR_PROVIDER)); } public NioServerSocketChannel(SelectorProvider provider) { this(newSocket(provider)); } public NioServerSocketChannel(ServerSocketChannel channel) { super(null, channel, SelectionKey.OP_ACCEPT); config = new NioServerSocketChannelConfig(this, javaChannel().socket()); } ... }","title":"Channel"},{"location":"Others/Netty NIO\u7b14\u8bb0/#channelhandler","text":"\u5728NIO\u7f16\u7a0b\u4e2d\uff0c\u6211\u4eec\u7ecf\u5e38\u9700\u8981\u5bf9Channel\u7684\u8f93\u5165\u548c\u8f93\u51fa\u4e8b\u4ef6\u8fdb\u884c\u5904\u7406\uff0cNetty\u62bd\u8c61\u51fa\u4e00\u4e2aChannelHandler\u6982\u5ff5\uff0c\u4e13\u95e8\u7528\u4e8e\u5904\u7406\u6b64\u7c7b\u4e8b\u4ef6\uff0c\u56e0\u6b64\u7f16\u5199Handler\u662f\u6211\u4eec\u8fdb\u884cNetty\u6846\u67b6\u7f16\u7a0b\u65f6\u4e3b\u8981\u7f16\u7801\u5de5\u4f5c\u3002IO\u4e8b\u4ef6\u5206\u4e3a\u51fa\u7ad9\u548c\u5165\u7ad9\uff0c\u56e0\u6b64ChannelHandler\u53c8\u5177\u4f53\u7684\u5206\u4e3aChannelInboundHandler\u548cChannelOutboundHandler \uff0c\u5206\u522b\u7528\u4e8e\u51fa\u7ad9\u548c\u5165\u7ad9\u65f6\u67d0\u4e2a\u9636\u6bb5\u4e8b\u4ef6\u7684\u5904\u7406\u3002 ChannelHanler\u7684\u7c7b\u5173\u7cfb\u56fe\u5982\u4e0b\uff1a ChannelHandlerAdapter\u3001ChannelInboundHandlerAdapter \u3001ChannelOutboundHandlerAdapter\u662fNetty\u63d0\u4f9b\u7684Handler\u9aa8\u67b6\u7c7b\u5df2\u7ecf\u5b9e\u73b0\u4e86\u5927\u90e8\u5206\u9aa8\u67b6\u65b9\u6cd5\uff0c\u5bf9\u4e8e\u4e0d\u540c\u7684\u9700\u6c42\u4f60\u53ea\u8981\u76f8\u5e94\u7684Handler\u5e76\u91cd\u5199\u81ea\u5df1\u611f\u5174\u8da3\u7684\u65b9\u6cd5\u5373\u53ef\u3002\u8fd9\u91cc\u518d\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0bSimpleChannelInboundHandler\u548cChannelInitializer\u8fd9\u4e24\u4e2a\u7c7b\uff1a SimpleChannelInboundHandler SimpleChannelInboundHandler\u7ee7\u627f\u81eaChannelInboundHandlerAdapter\u7528\u4e8e\u5904\u7406\u5165\u7ad9\u4fe1\u606f\uff0c\u9700\u8981\u6307\u5b9a\u6cdb\u578b\u5373\u8be5Handler\u9700\u8981\u5904\u7406\u7684\u5bf9\u8c61\u7c7b\u578b\uff0c\u5f53\u4f20\u5165\u5bf9\u8c61\u7c7b\u578b\u4e0d\u6b63\u786e\u65f6\u4e0d\u8fdb\u884c\u6570\u636e\u5904\u7406\u3002\u4f7f\u7528\u65f6\u53ea\u9700\u8981\u5b9e\u73b0 channelRead0 \u65b9\u6cd5\u8fdb\u884c\u6570\u636e\u5904\u7406\u5373\u53ef\uff0c\u4f7f\u7528\u8be5\u7c7b\u597d\u5904\u5728\u4e8eSimpleChannelInboundHandler\u4f1a\u81ea\u52a8\u4e3a\u4f60\u91ca\u653eReferenceCounted\u7c7b\u578b\u5bf9\u8c61\uff08\u4f8b\u5982ByteBuf\uff09. ChannelInitializer ChannelInitializer\u7c7b\u7684 initChannel \u65b9\u6cd5\u4f1a\u5728Channel\u521d\u59cb\u5316\u88ab\u8c03\u7528\uff0c\u6240\u4ee5\u4e00\u822c\u901a\u8fc7\u91cd\u5199 initChannel \u65b9\u6cd5\u914d\u7f6epipline\u4e2d\u7684ChannelHandler\u94fe\u3002 \u5728\u5904\u7406Channel\u7684IO\u4e8b\u4ef6\u65f6\uff0c\u4e3a\u4e86\u4f7f\u903b\u8f91\u66f4\u6e05\u6670\u548c\u4ee3\u7801\u7684\u7b80\u6d01\u6027\u901a\u5e38\u4f1a\u5c06\u6570\u636e\u5904\u7406\u8fc7\u7a0b\u5206\u4e3a\u51e0\u4e2a\u9636\u6bb5\u3002\u4ee5\u5165\u7ad9\u4fe1\u606f\u4e3a\u4f8b\uff0c\u901a\u5e38\u7684\u5904\u7406\u903b\u8f91\u5982\u4e0b\uff1a \u5904\u7406\u534a\u5305\u6216\u8005\u7c98\u5305\u95ee\u9898-->\u6570\u636e\u7684\u89e3\u7801(\u6216\u8005\u8bf4\u662f\u53cd\u5e8f\u5217\u5316)-->\u6570\u636e\u7684\u4e1a\u52a1\u5904\u7406 \u53ef\u4ee5\u770b\u5230\u4e0d\u540c\u7684\u9636\u6bb5\u8981\u6267\u884c\u4e0d\u540c\u7684\u529f\u80fd\uff0c\u56e0\u6b64\u901a\u5e38\u6211\u4eec\u4f1a\u7f16\u5199\u591a\u4e2aChannelHandler\uff0c\u6765\u5b9e\u73b0\u4e0d\u540c\u7684\u529f\u80fd\u3002\u800c\u4e14\u591a\u4e2aChannelHandler\u4e4b\u95f4\u7684\u987a\u5e8f\u4e0d\u80fd\u98a0\u5012\uff0c\u4f8b\u5982\u6211\u4eec\u5fc5\u987b\u5148\u5904\u7406\u7c98\u5305\u89e3\u5305\u95ee\u9898\uff0c\u4e4b\u540e\u624d\u80fd\u8fdb\u884c\u6570\u636e\u7684\u4e1a\u52a1\u5904\u7406\u3002","title":"ChannelHandler"},{"location":"Others/Netty NIO\u7b14\u8bb0/#channelpipline","text":"Netty\u901a\u8fc7ChannelPipline\u6765\u4fdd\u8bc1\u591a\u4e2aChannelHandler\u4e4b\u95f4\u7684\u987a\u5e8f\u8c03\u7528\uff0c\u5177\u4f53\u662f\u901a\u8fc7\u4e00\u4e2a\u53cc\u5411\u94fe\u8868\u5b9e\u73b0\u7684\uff0c\u4e0b\u6587\u5c06\u4f1a\u8fdb\u884c\u4ecb\u7ecd\u3002\u5728\u6bcf\u4e2aChannel\u88ab\u521b\u5efa\u65f6\uff0c\u90fd\u4f1a\u81ea\u52a8\u521b\u5efa\u4e00\u4e2aChannelPipeline\u5bf9\u8c61\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7io.netty.channel.Channel\u5bf9\u8c61\u7684pipeline()\u65b9\u6cd5\u83b7\u53d6\u8fd9\u4e2a\u5bf9\u8c61\u5b9e\u4f8b\u3002 ChannelPipeline\u521b\u5efa\u662f\u5728AbstractChannel\u7c7b\u7684\u6784\u9020\u65b9\u6cd5\u4e2d\uff0c\u6240\u4ee5Netty\u4e2d\u6bcf\u4e2aChannel\u90fd\u4f1a\u62e5\u6709\u548c\u7ef4\u62a4\u4e00\u4e2a\u552f\u4e00\u7684ChannelPipeline\uff0c\u5982\u4e0b\uff1a public abstract class AbstractChannel extends DefaultAttributeMap implements Channel { .... private final DefaultChannelPipeline pipeline; .... protected AbstractChannel(Channel parent) { this.parent = parent; id = newId(); unsafe = newUnsafe(); // \u521d\u59cb\u5316pipline pipeline = newChannelPipeline(); } .... // \u521b\u5efa\u4e00\u4e2aDefaultChannelPipeline\u5e76\u628aChannel\u81ea\u8eab\u4f5c\u4e3a\u5f15\u7528\u4f20\u5165 protected DefaultChannelPipeline newChannelPipeline() { return new DefaultChannelPipeline(this); } .... @Override // \u8fd4\u56depipeline\u5b9e\u4f8b public ChannelPipeline pipeline() { return pipeline; } } \u4ece\u4e0a\u8ff0\u4ee3\u7801\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230ChannelPipleLine\u7684\u5177\u4f53\u521b\u5efa\u8fc7\u7a0b\u5b9e\u9645\u4e0a\u662f\u901a\u8fc7return new DefaultChannelPipeline(this)\u5b9e\u73b0\u7684\u3002DefaultChannelPipeline\u662fChannelPipeline\u7684\u9ed8\u8ba4\u5b9e\u73b0\u7c7b\u3002 \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7ChannelPipeline\u7684 addXX \u65b9\u6cd5\u5411pipline\u7684\u53cc\u5411\u94fe\u8868\u4e2d\u6dfb\u52a0Handler\u6765\u7ef4\u62a4Handler\u4e4b\u95f4\u7684\u8c03\u7528\u5173\u7cfb\uff0c\u5e38\u7528\u7684\u6dfb\u52a0\u65b9\u6cd5\u6709 addBefore, addAfter, addLast \u7b49\u3002 1\u3001\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4e00\u4e2aChannelPipeline\u5b9e\u4f8b\u4e2d\uff0c\u540c\u4e00\u4e2a\u7c7b\u578bChannelHandler\u53ea\u80fd\u88ab\u6dfb\u52a0\u4e00\u6b21\uff0c\u5982\u679c\u6dfb\u52a0\u591a\u6b21\uff0c\u5219\u4f1a\u629b\u51fa\u5f02\u5e38\uff0c\u5177\u4f53\u53c2\u89c1io.netty.channel.DefaultChannelPipeline#checkMultiplicity\u3002\u5982\u679c\u9700\u8981\u591a\u6b21\u6dfb\u52a0\u540c\u4e00\u4e2a\u7c7b\u578b\u7684ChannelHandler\u7684\u8bdd\uff0c\u5219\u9700\u8981\u5728\u8be5ChannelHandler\u5b9e\u73b0\u7c7b\u4e0a\u6dfb\u52a0@Sharable\u6ce8\u89e3\u3002 2\u3001\u5728ChannelPipeline\u4e2d\uff0c\u6bcf\u4e00\u4e2aChannelHandler\u90fd\u662f\u6709\u4e00\u4e2a\u540d\u5b57\u7684\uff0c\u800c\u4e14\u540d\u5b57\u5fc5\u987b\u7684\u662f\u552f\u4e00\u7684\uff0c\u5982\u679c\u540d\u5b57\u91cd\u590d\u4e86\uff0c\u5219\u4f1a\u629b\u51fa\u5f02\u5e38\uff0c\u53c2\u89c1io.netty.channel.DefaultChannelPipeline#checkDuplicateName\u3002 3\u3001\u5982\u679c\u6dfb\u52a0ChannelHanler\u7684\u65f6\u5019\u6ca1\u6709\u663e\u793a\u7684\u6307\u5b9a\u540d\u5b57\uff0c\u5219\u4f1a\u6309\u7167\u89c4\u5219\u5176\u8d77\u4e00\u4e2a\u9ed8\u8ba4\u7684\u540d\u5b57\u3002\u5177\u4f53\u89c4\u5219\u5982\u4e0b\uff0c\u5982\u679cChannelPipeline\u4e2d\u53ea\u6709\u67d0\u79cd\u7c7b\u578b\u7684handler\u5b9e\u4f8b\u53ea\u6709\u4e00\u4e2a\uff0c\u5982XXXHandler,YYYHandler\uff0c\u5219\u5176\u540d\u5b57\u5206\u522b\u4e3aXXXHandler#0\uff0cYYYHandler#0\uff0c\u5982\u679c\u540c\u4e00\u7c7b\u578b\u7684Handler\u6709\u591a\u4e2a\u5b9e\u4f8b\uff0c\u5219\u6bcf\u6b21\u4e4b\u540e\u7684\u7f16\u53f7\u52a01\u3002\u5177\u4f53\u53ef\u53c2\u89c1io.netty.channel.DefaultChannelPipeline#generateName\u65b9\u6cd5\u3002","title":"ChannelPipline"},{"location":"Others/Netty NIO\u7b14\u8bb0/#channelhandlercontext","text":"\u524d\u9762\u63d0\u5230\u53ef\u4ee5\u901a\u8fc7ChannelPipeline\u7684\u6dfb\u52a0\u65b9\u6cd5\uff0c\u6309\u7167\u987a\u5e8f\u6dfb\u52a0ChannelHandler\uff0c\u5e76\u5728\u4e4b\u540e\u6309\u7167\u987a\u5e8f\u8fdb\u884c\u8c03\u7528\u3002\u4e8b\u5b9e\u4e0a\uff0c\u6bcf\u4e2aChannelHandler\u4f1a\u88ab\u5148\u5c01\u88c5\u6210ChannelHandlerContext\uff0c\u4e4b\u540e\u518d\u5c01\u88c5\u8fdbChannelPipeline\u4e2d\uff0c\u6240\u4ee5ChannelPipline\u7ef4\u62a4\u7684\u53cc\u5411\u94fe\u8868\u5b9e\u9645\u4e0a\u662fChannelHandlerContext\u6784\u6210\u7684\u94fe\u8868\u3002\u4ee5DefaultChannelPipeline\u7684addLast\u65b9\u6cd5\u4e3a\u4f8b\uff1a @Override public ChannelPipeline addLast(EventExecutorGroup group, final String name, ChannelHandler handler) { synchronized (this) { // \u68c0\u67e5\u8fd9\u79cd\u7c7b\u578b\u7684handler\u5b9e\u4f8b\u662f\u5426\u5141\u8bb8\u88ab\u6dfb\u52a0\u591a\u6b21 checkDuplicateName(name); // \u5c06handler\u5305\u88c5\u6210\u4e00\u4e2aDefaultChannelHandlerContext\u7c7b AbstractChannelHandlerContext newCtx = new DefaultChannelHandlerContext(this, group, name, handler); // \u7ef4\u62a4AbstractChannelHandlerContext\u7684\u5148\u540e\u5173\u7cfb addLast0(name, newCtx); } return this; } \u53ef\u4ee5\u770b\u5230\u7684\u786e\u662f\u5148\u5c06ChannelHandler\u5f53\u505a\u53c2\u6570\u6784\u5efa\u6210\u4e00\u4e2aDefaultChannelHandlerContext\u5b9e\u4f8b\u4e4b\u540e\uff0c\u518d\u8c03\u7528addLast0\u65b9\u6cd5\u7ef4\u62a4ChannelHandlerContext\u7684\u5148\u540e\u5173\u7cfb\uff0c\u4ece\u800c\u786e\u5b9a\u4e86ChannelHandler\u7684\u5148\u540e\u5173\u7cfb\u3002\u53ef\u4ee5\u6ce8\u610f\u5230ChannelHandlerContext\u5bf9\u8c61\u6301\u6709ChannelPipeline\u3001EventExecutorGroup\u3001ChannelHandler\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u56e0\u6b64ChannelHandlerContext\u53ef\u4ee5\u65b9\u4fbf\u5f97\u83b7\u5f97\u548c\u4f7f\u7528\u8fd9\u4e9b\u5bf9\u8c61\uff0c\u5f53\u6709\u65b9\u6cd5\u7684\u53c2\u6570\u4e3aChannelHandlerContext\u65f6\u5c31\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u4f7f\u7528\u5176\u5f15\u7528\u7684\u5bf9\u8c61\uff0c\u6211\u89c9\u5f97\u8fd9\u5e94\u8be5\u662f\u5c06Handler\u5c01\u88c5\u4e3aChannelHandlerContext\u7684\u4e3b\u8981\u539f\u56e0\u3002 DefaultChannelPipeline\u5185\u90e8\u662f\u901a\u8fc7\u4e00\u4e2a\u53cc\u5411\u94fe\u8868\u8bb0\u5f55ChannelHandler\u7684\u5148\u540e\u5173\u7cfb\uff0c\u5185\u90e8\u901a\u8fc7\u4e24\u4e2a\u54e8\u5175\u8282\u70b9HeadContext\u548cTailContext\u4f5c\u4e3a\u94fe\u8868\u7684\u5f00\u59cb\u548c\u7ed3\u675f\uff0c\u53cc\u5411\u94fe\u8868\u7684\u8282\u70b9\u662fAbstractChannelHandlerContext\u7c7b\u3002\u4ee5\u4e0b\u662fAbstractChannelHandlerContext\u7c7b\u7684\u90e8\u5206\u6e90\u7801(\u53cc\u5411\u94fe\u8868\u8282\u70b9)\uff1a public class DefaultChannelPipeline implements ChannelPipeline { ... private static final String HEAD_NAME = generateName0(HeadContext.class); private static final String TAIL_NAME = generateName0(TailContext.class); ... final AbstractChannelHandlerContext head; final AbstractChannelHandlerContext tail; private final Channel channel; .... protected DefaultChannelPipeline(Channel channel) { this.channel = ObjectUtil.checkNotNull(channel, \"channel\"); .... // \u521b\u5efa\u53cc\u5411\u94fe\u8868\u5934\u90e8\u5143\u7d20\u5b9e\u4f8b tail = new TailContext(this); head = new HeadContext(this); // \u521b\u5efa\u53cc\u5411\u94fe\u8868\u7684\u5c3e\u90e8\u5143\u7d20\u5b9e\u4f8b head.next = tail; tail.prev = head; } .... .... private void addLast0(AbstractChannelHandlerContext newCtx) { // \u8bbe\u7f6eChannelHandler\u7684\u5148\u540e\u987a\u5e8f\u5173\u7cfb AbstractChannelHandlerContext prev = tail.prev; newCtx.prev = prev; newCtx.next = tail; prev.next = newCtx; tail.prev = newCtx; } } } \u5934\u5c3e\u4e24\u4e2a\u8282\u70b9\u4e0e\u5176\u4ed6Handler\u4e0d\u540c\u70b9\u5728\u4e8e\uff0c\u5b83\u4eec\u6301\u6709\u4e86Unsafe\u5bf9\u8c61\uff0c\u4ece\u800c\u80fd\u901a\u8fc7Unsafe\u5bf9\u8c61\u5bf9Java NIO\u7ec4\u4ef6\u8fdb\u884c\u64cd\u4f5c\u3002","title":"ChannelHandlerContext"},{"location":"Others/Netty NIO\u7b14\u8bb0/#netty_3","text":"","title":"Netty\u6e90\u7801\u5206\u6790"},{"location":"Others/Netty NIO\u7b14\u8bb0/#_1","text":"\u8ba9\u6211\u4eec\u4ee5\u4e00\u4e2a\u7b80\u5355\u7684EchoServer\u4e3a\u4f8b\u5b50\u8fdb\u884c\u8bf4\u660e\uff1a public class EchoServer { private final int port; public EchoServer(int port) { this.port = port; } public void start() throws Exception { // boss\u7ebf\u7a0b\u6c60\uff0c\u7528\u4e8e\u63a5\u53d7\u8fde\u63a5\u8bf7\u6c42 EventLoopGroup boss = new NioEventLoopGroup(1); // workers\u7ebf\u7a0b\u6c60\uff0c\u7528\u4e8e\u6267\u884cIO\u8bf7\u6c42 EventLoopGroup workers = new NioEventLoopGroup(); try { // \u542f\u52a8\u7c7b\uff0c\u7528\u4e8e\u914d\u7f6e\u5e76\u8f85\u52a9\u542f\u52a8\u670d\u52a1 ServerBootstrap b = new ServerBootstrap(); // \u914d\u7f6e\u7ebf\u7a0b\u6c60 b.group(boss, workers) // \u8bbe\u7f6e\u8981\u542f\u52a8\u7684Channel\u7c7b\u578b .channel(NioServerSocketChannel.class) // \u914d\u7f6eNioServerSocketChannel\u7684\u53c2\u6570 .option(ChannelOption.SO_BACKLOG, 128) // \u914d\u7f6e\u5b50Channel\u7684Handler\u94fe .childHandler(new EchoServerInitializer()); // \u7ebf\u7a0b\u7ed1\u5b9a\u76d1\u542c\u7aef\u53e3\uff0c\u542f\u52a8Netty\u670d\u52a1\u7aef ChannelFuture f = b.bind(port).sync(); f.channel().closeFuture().sync(); } finally { boss.shutdownGracefully(); workers.shutdownGracefully(); } } } \u53ef\u4ee5\u770b\u51fa\u5728Netty\u670d\u52a1\u542f\u52a8\u4e4b\u524d\uff0c\u4e3b\u8981\u8fdb\u884c\u4e86Netty\u670d\u52a1\u53c2\u6570\u914d\u7f6e\uff0c\u5176\u542b\u4e49\u6211\u4eec\u5148\u6309\u4e0b\u4e0d\u8868\uff0c\u771f\u6b63\u7684\u5f00\u542f\u670d\u52a1\u7684\u65b9\u6cd5\u5f88\u663e\u7136\u662fServerBootstrap\u7684 bind \u65b9\u6cd5\uff0cbind\u65b9\u6cd5\u7684\u8c03\u7528\u94fe\u5982\u4e0b\uff1a public ChannelFuture bind(int inetPort) { // \u4f7f\u7528\u7aef\u53e3\u53f7\u521b\u5efaInetSocketAddress\u4f5c\u4e3a\u53c2\u6570 return bind(new InetSocketAddress(inetPort)); } public ChannelFuture bind(SocketAddress localAddress) { // \u6821\u9a8c\u5de5\u4f5c validate(); if (localAddress == null) { throw new NullPointerException(\"localAddress\"); } return doBind(localAddress); } // \u6838\u5fc3\u65b9\u6cd5 private ChannelFuture doBind(final SocketAddress localAddress) { // \u521b\u5efa\u63a5\u53d7\u8fde\u63a5\u8bf7\u6c42\u7684Channel\u5e76\u6ce8\u518c\u5230NioEventLoop\u7684Selector final ChannelFuture regFuture = initAndRegister(); final Channel channel = regFuture.channel(); if (regFuture.cause() != null) { return regFuture; } // \u5224\u65ad\u64cd\u4f5c\u662f\u5426\u5b8c\u6210 if (regFuture.isDone()) { ChannelPromise promise = channel.newPromise(); // \u5982\u679c\u64cd\u4f5c\u5b8c\u6210\u8c03\u7528doBind0\u65b9\u6cd5 doBind0(regFuture, channel, localAddress, promise); return promise; } else { final PendingRegistrationPromise promise = new PendingRegistrationPromise(channel); // \u5982\u679c\u64cd\u4f5c\u8fd8\u672a\u5b8c\u6210\u5219\u6dfb\u52a0\u76d1\u542c\u5668\uff0c\u5728\u5b8c\u6210\u540e\u5224\u65ad\u64cd\u4f5c\u662f\u5426\u5931\u8d25\uff0c\u5982\u679c\u672a\u5931\u8d25\u5219\u7ee7\u7eed\u8c03\u7528doBind0\u65b9\u6cd5 regFuture.addListener(new ChannelFutureListener() { @Override public void operationComplete(ChannelFuture future) throws Exception { Throwable cause = future.cause(); if (cause != null) { promise.setFailure(cause); } else { promise.registered(); doBind0(regFuture, channel, localAddress, promise); } } }); return promise; } } \u901a\u8fc7bind\u65b9\u6cd5\u7684\u8c03\u7528\u94fe\uff0c\u6700\u7ec8\u5c06\u8c03\u7528ServerBootstrap\u7684doBind\u65b9\u6cd5\uff0cdoBind\u4e3b\u8981\u6709\u4e24\u4e2a\u6b65\u9aa4\u4e00\u662f\u901a\u8fc7 initAndRegister \u65b9\u6cd5\u521b\u5efaChannel\u5e76\u6ce8\u518c\u6ce8\u518c\u5230NioEventLoop\u7684Selector\u4e0a\u7528\u4e8e\u63a5\u53d7\u8fde\u63a5\u8bf7\u6c42\uff1b\u4e8c\u662f\u901a\u8fc7 doBind0 \u65b9\u6cd5\u5c06Java\u7ba1\u9053\u7ed1\u5b9a\u5230\u8981\u76d1\u542c\u7684\u7aef\u53e3\u3002 \u73b0\u5728\u6211\u4eec\u4f9d\u6b21\u5206\u6790\u8fd9\u4e24\u4e2a\u65b9\u6cd5\uff0c\u9996\u5148\u6765\u770b initAndRegister \u65b9\u6cd5 final ChannelFuture initAndRegister() { Channel channel = null; try { // \u4f7f\u7528channelFactory\u521b\u5efaNioSocketChannelServer channel = channelFactory.newChannel(); // \u521d\u59cb\u5316\u7ba1\u9053 init(channel); } // \u5982\u679c\u521b\u5efa\u6216\u521d\u59cb\u5316\u7ba1\u9053\u5931\u8d25\u4e86\uff0c\u8fd4\u56de\u5305\u542b\u9519\u8bef\u539f\u56e0\u7684ChannelFuture catch (Throwable t) { if (channel != null) { channel.unsafe().closeForcibly(); return new DefaultChannelPromise(channel, GlobalEventExecutor.INSTANCE).setFailure(t); } return new DefaultChannelPromise(new FailedChannel(), GlobalEventExecutor.INSTANCE).setFailure(t); } // \u5c06\u7ba1\u9053\u6ce8\u518c\u5230NioEventLoop\u7684Selector\u4e0a ChannelFuture regFuture = config().group().register(channel); if (regFuture.cause() != null) { if (channel.isRegistered()) { channel.close(); } else { channel.unsafe().closeForcibly(); } } return regFuture; } \u6211\u4eec\u53ef\u4ee5\u5c06 initAndRegister \u65b9\u6cd5\u7684\u903b\u8f91\u62c6\u5206\u6210\u4e09\u4e2a\u90e8\u5206\uff1a \u901a\u8fc7channelFactory.newChannel()\uff0c\u521b\u5efaChannel(\u5b9e\u9645\u4e0a\u662fNioServerSocketChannel) \u521d\u59cb\u5316\u521b\u5efa\u7684\u7ba1\u9053 \u901a\u8fc7config().group().register(channel)\uff0c\u5c06\u7ba1\u9053\u6ce8\u518c\u5230NioEventLoop\u7684Selector\u4e0a","title":"\u4ece\u670d\u52a1\u7aef\u7684\u521d\u59cb\u5316\u8bf4\u8d77"},{"location":"Others/Netty NIO\u7b14\u8bb0/#channelfactorychannel","text":"ChannelFactory\u662f\u600e\u4e48\u6765\u7684\u5462\uff0c\u8ba9\u6211\u4eec\u56de\u5230\u8c03\u7528EchoServe\u7c7b\u8c03\u7528bind\u65b9\u6cd5\u542f\u52a8\u4e4b\u524d\u7684\u914d\u7f6e\u903b\u8f91\u4e0a\u6765\uff1a // \u914d\u7f6e\u7ebf\u7a0b\u6c60 b.group(boss, workers) // \u8bbe\u7f6e\u8981\u542f\u52a8\u7684Channel\u7c7b\u578b .channel(NioServerSocketChannel.class) // \u914d\u7f6e\u5b50Channel\u7684Handler\u94fe .childHandler(new EchoServerInitializer()); \u5176\u4e2dchannel\u65b9\u6cd5\u914d\u7f6e\u4e86\u7ba1\u9053\u7c7b\u578b\u4e3aNioServerSocketChannel.class\uff0c\u8ba9\u6211\u4eec\u8fdb\u5165\u8be5\u65b9\u6cd5\u7684\u8c03\u7528\u94fe\uff1a public B channel(Class<? extends C> channelClass) { if (channelClass == null) { throw new NullPointerException(\"channelClass\"); } // \u4ee5channelClass\u4e3a\u53c2\u6570\uff0c\u8fd9\u91cc\u662fNioServerSocketChannel.class\uff0c\u521b\u5efaReflectiveChannelFactory return channelFactory(new ReflectiveChannelFactory<C>(channelClass)); } public B channelFactory(io.netty.channel.ChannelFactory<? extends C> channelFactory) { return channelFactory((ChannelFactory<C>) channelFactory); } public B channelFactory(ChannelFactory<? extends C> channelFactory) { if (channelFactory == null) { throw new NullPointerException(\"channelFactory\"); } if (this.channelFactory != null) { throw new IllegalStateException(\"channelFactory set already\"); } // \u5c06ServerBootstrap\u7684channelFactory\u8bbe\u7f6e\u4e3aReflectiveChannelFactory this.channelFactory = channelFactory; return self(); } \u53ef\u4ee5\u770b\u5230 channel \u4e3aServerBootstrap\u521b\u5efa\u4e86ReflectiveChannelFactory\u5bf9\u8c61\uff0c\u5e76\u7528\u5b83\u521d\u59cb\u5316\u4e86ServerBootstrap\u7684channelFactory\u57df\u3002 \u73b0\u5728\u8ba9\u6211\u4eec\u56de\u5230 channelFactory.newChannel() \u903b\u8f91\uff0c\u8fdb\u5165newChannel\u65b9\u6cd5\uff0c\u5982\u4e0b\uff1a public T newChannel() { try { return constructor.newInstance(); } catch (Throwable t) { throw new ChannelException(\"Unable to create Channel from class \" + constructor.getDeclaringClass(), t); } } newChannel\u65b9\u6cd5\u901a\u8fc7\u53cd\u5c04\u8c03\u7528\u521b\u5efa\u4e86Channel\u5bf9\u8c61\uff0c\u4ece\u4e0a\u9762\u7684\u5206\u6790\u53ef\u4ee5\u77e5\u9053\u8fd9\u91cc\u7684Channel\u7c7b\u4e3aNioServerSocketChannel \u6240\u4ee5\u8ba9\u6211\u4eec\u8fdb\u5165NioServerSocketChannel\u7684\u65e0\u53c2\u6784\u6210\u51fd\u6570\u7684\u8c03\u7528\u94fe\uff0c\u5982\u4e0b\uff1a public NioServerSocketChannel() { // \u521b\u5efaServerSocketChannel\u4f5c\u4e3a\u6784\u9020\u51fd\u6570\u53c2\u6570 this(newSocket(DEFAULT_SELECTOR_PROVIDER)); } private static ServerSocketChannel newSocket(SelectorProvider provider) { try { // \u901a\u8fc7Java NIO\u7684SelectorProvider\u6765\u6784\u5efaJava Channel return provider.openServerSocketChannel(); } catch (IOException e) { throw new ChannelException( \"Failed to open a server socket.\", e); } } public NioServerSocketChannel(ServerSocketChannel channel) { // \u8bbe\u7f6ereadInterestOp\u7684\u503c\u4e3aSelectionKey.OP_ACCEPT\uff0c\u5373\u76d1\u542c\u8fde\u63a5\u8bf7\u6c42 super(null, channel, SelectionKey.OP_ACCEPT); // \u521d\u59cb\u5316NettyNio\u914d\u7f6e\u5bf9\u8c61\uff0c\u7528\u4e8e\u5feb\u901f\u83b7\u5f97channel\u53c2\u6570\u4fe1\u606f config = new NioServerSocketChannelConfig(this, javaChannel().socket()); } // \u4e2d\u95f4\u5bf9\u8c61AbstractNioMessageChannel protected AbstractNioMessageChannel(Channel parent, SelectableChannel ch, int readInterestOp) { super(parent, ch, readInterestOp); } protected AbstractNioChannel(Channel parent, SelectableChannel ch, int readInterestOp) { super(parent); // \u8bbe\u7f6eNetty NioChannel\u6301\u6709\u7684Java Channel\u5f15\u7528 this.ch = ch; // \u8bbe\u7f6eChannel\u76d1\u542c\u7684\u64cd\u4f5c\u7c7b\u578b this.readInterestOp = readInterestOp; try { // \u8bbe\u7f6eJava Channel\u4e3a\u975e\u963b\u585e\u7684 ch.configureBlocking(false); } catch (IOException e) { try { ch.close(); } catch (IOException e2) { if (logger.isWarnEnabled()) { logger.warn( \"Failed to close a partially initialized socket.\", e2); } } throw new ChannelException(\"Failed to enter non-blocking mode.\", e); } } protected AbstractChannel(Channel parent) { this.parent = parent; // \u751f\u6210Channel\u7684\u5168\u5c40Id id = newId(); // \u521d\u59cb\u5316Unsafe\u5bf9\u8c61 unsafe = newUnsafe(); // \u521d\u59cb\u5316ChannelPipeline pipeline = newChannelPipeline(); } \u4eceNioServerSocketChannel\u6784\u9020\u51fd\u6570\u7684\u8c03\u7528\u94fe\u53ef\u4ee5\u770b\u51fa\uff0c\u5728\u521b\u5efaNetty NioChannel\u65f6\u4f1a\u521d\u59cb\u5bf9\u5e94\u7684Java Channel\u5e76\u4e14\u5c06Java Channel\u914d\u7f6e\u4e3a\u975e\u963b\u585e\u7684\u3002\u4e4b\u540e\u8fdb\u5165AbstractChannel\u7684\u903b\u8f91\uff0c\u521d\u59cb\u5316Netty NioChannel\u7684\u76f8\u5173\u5c5e\u6027\uff1a \u8c03\u7528newId()\uff0c\u751f\u6210\u4e00\u4e2aChannel\u7684\u5168\u5c40Id \u8c03\u7528newUnsafe()\uff0c\u751f\u6210Unsafe\u5bf9\u8c61\uff0cUnsafe\u80fd\u591f\u5904\u7406Java NIO\u76f8\u5173\u7684\u903b\u8f91\uff0c\u4f8b\u5982\u5728NioEventLoop\u7684Selector\u4e0a\u6ce8\u518cJava Channel\uff0c\u6216\u8005Java Channel\u7ed1\u5b9a\u5230\u5bf9\u5e94\u7684\u7aef\u53e3\u3002 \u8c03\u7528newChannelPipeline()\uff0c\u751f\u6210DefaultChannelPipeline\u5bf9\u8c61\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u5728 Netty\u7ec4\u4ef6 \u4e2d\u4ecb\u7ecd\u8fc7\uff0c\u662f\u7528\u6765\u7ef4\u62a4Netty Handler\u5904\u7406\u94fe\u7684\u3002 Netty\u7ec4\u4ef6 \u4e2d\u5bf9DefaultChannelPipeline\u5bf9\u8c61\u7684\u5206\u6790\u53ef\u4ee5\u77e5\u9053\uff0c\u5728DefaultChannelPipeline\u521d\u59cb\u5316\u5b8c\u6210\u65f6\uff0cpipeline\u4e2d\u53ea\u6709\u5934\u8282\u70b9\uff08head\uff09\u548c\u5c3e\u8282\u70b9\uff08tail\uff09\u4e24\u4e2a\u8282\u70b9\uff0c\u5176\u4e2d\u5934\u7ed3\u70b9\u540c\u65f6\u5b9e\u73b0\u4e86 ChannelOutboundHandler \u548c ChannelInboundHandler \u8fd9\u8868\u793a\u5934\u7ed3\u70b9\u5373\u53ef\u4ee5\u5904\u7406\u5165\u7ad9\u4fe1\u606f\u4e5f\u53ef\u4ee5\u5904\u7406\u51fa\u7ad9\u4fe1\u606f\uff1b\u800c\u5c3e\u8282\u70b9\u53ea\u5b9e\u73b0\u4e86 ChannelInboundHandler \u6240\u4ee5\u53ea\u80fd\u5904\u7406\u5165\u7ad9\u4fe1\u606f\uff0c\u5982\u4e0b\uff1a // \u5934\u7ed3\u70b9\u5b9e\u73b0\u7684\u63a5\u53e3 final class HeadContext extends AbstractChannelHandlerContext implements ChannelOutboundHandler, ChannelInboundHandler { private final Unsafe unsafe; HeadContext(DefaultChannelPipeline pipeline) { super(pipeline, null, HEAD_NAME, true, true); unsafe = pipeline.channel().unsafe(); setAddComplete(); } ... } // \u5c3e\u8282\u70b9\u5b9e\u73b0\u7684\u63a5\u53e3 final class TailContext extends AbstractChannelHandlerContext implements ChannelInboundHandler { TailContext(DefaultChannelPipeline pipeline) { super(pipeline, null, TAIL_NAME, true, false); setAddComplete(); } } \u6b64\u65f6pipeline\u7684\u94fe\u8868\u7ed3\u6784\u5982\u4e0b\uff1a \u81f3\u6b64\uff0c\u6574\u4e2aNioServerSocketChannel\u7684\u521b\u5efa\u5de5\u4f5c\u5c31\u5b8c\u6210\u4e86\uff0c\u63a5\u4e0b\u5c06\u8fdb\u884cNioServerSocketChannel\u521d\u59cb\u5316\u5de5\u4f5c\u3002","title":"\u4f7f\u7528ChannelFactory\u521b\u5efaChannel"},{"location":"Others/Netty NIO\u7b14\u8bb0/#nioserversocketchannel","text":"\u5b8c\u6210\u7ba1\u9053\u7684\u521b\u5efa\u5de5\u4f5c\u540e\uff0c\u7ee7\u7eed\u4eceServerBootstrap\u7684 initAndRegister \u65b9\u6cd5\u5f80\u4e0b\u8d70\uff0c\u63a5\u4e0b\u6765\u5c06\u8c03\u7528 init \u65b9\u6cd5\u6765\u8fdb\u884c\u7ba1\u9053\u7684\u521d\u59cb\u5316\u5de5\u4f5c\uff0c init \u65b9\u6cd5\u5982\u4e0b\uff1a void init(Channel channel) throws Exception { // \u83b7\u5f97\u901a\u8fc7Bootstrap\u5bf9\u8c61\u7684option\u65b9\u6cd5\u914d\u7f6e\u7684\u53c2\u6570 final Map<ChannelOption<?>, Object> options = options0(); synchronized (options) { // \u5c06\u914d\u7f6e\u5e94\u7528\u5230\u76f8\u5e94\u7684\u5bf9\u8c61\u4e0a\uff0c\u5982java channel\u6216java socket setChannelOptions(channel, options, logger); } // \u83b7\u5f97\u901a\u8fc7Bootstrap\u5bf9\u8c61\u7684attr\u65b9\u6cd5\u914d\u7f6e\u7684\u5c5e\u6027 final Map<AttributeKey<?>, Object> attrs = attrs0(); synchronized (attrs) { // \u4f7f\u7528for\u5faa\u73af\u4fee\u6539\u5c5e\u6027\u5bf9\u5e94\u7684\u503c for (Entry<AttributeKey<?>, Object> e: attrs.entrySet()) { @SuppressWarnings(\"unchecked\") AttributeKey<Object> key = (AttributeKey<Object>) e.getKey(); channel.attr(key).set(e.getValue()); } } // \u83b7\u5f97NioServerSocketChannel\u7684pipline\u5bf9\u8c61 ChannelPipeline p = channel.pipeline(); // \u83b7\u5f97\u5b50Channel\u53c2\u6570\u4fe1\u606f\uff0c\u7528\u4e8e\u521b\u5efaServerBootstrapAcceptor // ServerBootstrapAcceptor\u662f\u4e00\u4e2a\u5904\u7406\u8fde\u63a5\u8bf7\u6c42\u7684Handler\uff0c\u4f1a\u4e3a\u8fde\u63a5\u8bf7\u6c42\u521b\u5efa\u5bf9\u5e94\u7684Channel final EventLoopGroup currentChildGroup = childGroup; final ChannelHandler currentChildHandler = childHandler; final Entry<ChannelOption<?>, Object>[] currentChildOptions; final Entry<AttributeKey<?>, Object>[] currentChildAttrs; synchronized (childOptions) { currentChildOptions = childOptions.entrySet().toArray(newOptionArray(0)); } synchronized (childAttrs) { currentChildAttrs = childAttrs.entrySet().toArray(newAttrArray(0)); } // \u5728pipline\u4e2d\u6dfb\u52a0\u4e00\u4e2aChannelInitializer // \u5f53ChannelInitializer\u7684initChannel\u88ab\u8c03\u7528\u65f6\uff0c\u53ef\u4ee5\u5bf9\u7ba1\u9053\u8fdb\u884c\u64cd\u4f5c p.addLast(new ChannelInitializer<Channel>() { @Override public void initChannel(final Channel ch) throws Exception { final ChannelPipeline pipeline = ch.pipeline(); // \u5728pipline\u4e2d\u6dfb\u52a0\u901a\u8fc7Bootstrap\u5bf9\u8c61\u7684handler\u914d\u7f6e\u7684Handler ChannelHandler handler = config.handler(); if (handler != null) { pipeline.addLast(handler); } // \u5411EventLoop\u7ebf\u7a0b\u7684\u4efb\u52a1\u961f\u5217\u63d0\u4ea4\u521b\u5efaServerBootstrapAcceptor\u5bf9\u8c61\u7684\u4efb\u52a1 ch.eventLoop().execute(new Runnable() { @Override public void run() { pipeline.addLast(new ServerBootstrapAcceptor( ch, currentChildGroup, currentChildHandler, currentChildOptions, currentChildAttrs)); } }); } }); } \u53ef\u4ee5\u770b\u51fa\uff0c init \u65b9\u6cd5\u4e3b\u8981\u505a\u4e86\u4ee5\u4e0b\u5de5\u4f5c\uff1a \u5c06Bootstrap\u5bf9\u8c61\u7684option\u65b9\u6cd5\u914d\u7f6e\u7684\u53c2\u6570\u914d\u7f6e\u5230Config\u5bf9\u8c61\u4e0a \u5c06Bootstrap\u5bf9\u8c61\u7684attr\u65b9\u6cd5\u914d\u7f6e\u7684\u5c5e\u6027\u5e94\u7528\u5230channel\u5bf9\u5e94\u7684attr\u4e0a \u8c03\u7528addLast\u65b9\u6cd5\u5728NioServerSocketChannel\u7684pipline\u5c3e\u90e8\u6dfb\u52a0\u4e86\u4e00\u4e2aChannelInitializer\uff08ChannelInboundHandlerAdapter\u7684\u4e00\u4e2a\u5b50\u7c7b\uff09\uff0cChannelInitialize\u7684initChannel\u65b9\u6cd5\u4f1a\u5728\u540e\u7eed\u7684\u7ba1\u9053\u521d\u59cb\u5316\u8fc7\u7a0b\u4e2d\u88ab\u8c03\u7528\uff0c\u6240\u4ee5\u8fd9\u91cc\u5148\u4e0d\u5bf9initChannel\u65b9\u6cd5\u8fdb\u884c\u6df1\u5165 \u8ba9\u6211\u4eec\u8fdb\u5165pipline\u7684 addLast \u65b9\u6cd5\u7684\u8c03\u7528\u94fe\uff0c\u770b\u770b\u505a\u4e86\u54ea\u4e9b\u64cd\u4f5c\uff1a public final ChannelPipeline addLast(ChannelHandler... handlers) { // \u8fd9\u91cc\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3aEventExecutorGroup\uff0c\u4f5c\u7528\u662f\u6307\u5b9a\u7684\u6267\u884cHandler\u903b\u8f91\u7684\u7ebf\u7a0b\u6c60 // \u8bbe\u4e3anull\u5219\u8868\u793a\u4f7f\u7528BootStrap\u4e2d\u914d\u7f6e\u7684NioEeventLoopGroup\u7ebf\u7a0b\u6c60 return addLast(null, handlers); } public final ChannelPipeline addLast(EventExecutorGroup executor, ChannelHandler... handlers) { if (handlers == null) { throw new NullPointerException(\"handlers\"); } // \u901a\u8fc7for\u5faa\u73af\u4e2d\u7684addLast\u65b9\u6cd5\u5c06\u53ef\u53d8\u53c2\u6570\u4e2d\u7684handler\u52a0\u5165pipline for (ChannelHandler h: handlers) { if (h == null) { break; } addLast(executor, null, h); } return this; } public final ChannelPipeline addLast(EventExecutorGroup group, String name, ChannelHandler handler) { final AbstractChannelHandlerContext newCtx; synchronized (this) { // \u6821\u9a8chandler\u4fe1\u606f checkMultiplicity(handler); // \u6784\u5efaHandlerContext\u5bf9\u8c61\uff0c\u5e76\u4e14\u6839\u636ename\u662f\u5426\u4e3a\u7a7a\u6821\u9a8c\u6216\u8005\u751f\u6210handler\u540d\u5b57 newCtx = newContext(group, filterName(name, handler), handler); // \u5c06HandlerContext\u5bf9\u8c61\u6dfb\u52a0\u5230pipeline\u672b\u5c3e addLast0(newCtx); // \u5224\u65ad\u7ba1\u9053\u662f\u5426\u6ce8\u518c\u5230EventLoop if (!registered) { // \u5c06handler\u7684\u9636\u6bb5\u4eceINIT\u8bbe\u7f6e\u4e3aPENDING newCtx.setAddPending(); // \u521b\u5efa\u4e00\u4e2a\u7a0d\u540e\u6267\u884c\u7684callHandlerAdded0\u65b9\u6cd5\u7684\u56de\u8c03\u4efb\u52a1 callHandlerCallbackLater(newCtx, true); return this; } // \u5982\u679c\u7ba1\u9053\u5df2\u6ce8\u518c\u5230EventLoop // \u56e0\u4e3actx\u4e2dexecutor\u5bf9\u8c61\u4e3a\u7a7a\uff0c\u6240\u4ee5\u8fd9\u91cc\u7684exector\u662fChannel\u6301\u6709\u7684EventLoop\u5bf9\u8c61 EventExecutor executor = newCtx.executor(); // \u5982\u679c\u5f53\u524d\u7ebf\u7a0b\u4e0d\u662fEventLoop\u7684\u5de5\u4f5c\u7ebf\u7a0b if (!executor.inEventLoop()) { // \u5c06callHandlerAdded0\u7684\u8c03\u7528\u5c01\u88c5\u4e3atask\u63d0\u4ea4\u5230\u6307\u5b9a\u7684\u5de5\u4f5c\u7ebf\u7a0b\u6c60 callHandlerAddedInEventLoop(newCtx, executor); return this; } } // \u5982\u679c\u5f53\u524d\u7ebf\u7a0b\u662fEventLoop\u7684\u5de5\u4f5c\u7ebf\u7a0b // \u5219\u7acb\u523b\u6267\u884ccallHandlerAdded0\u65b9\u6cd5 callHandlerAdded0(newCtx); return this; } \u53ef\u4ee5\u770b\u5230addLast\u5bf9handler\u4e3b\u8981\u505a\u4e86\u4ee5\u4e0b\u5de5\u4f5c\uff1a \u5bf9handler\u4fe1\u606f\u8fdb\u884c\u6821\u9a8c private static void checkMultiplicity(ChannelHandler handler) { // \u5982\u679chandler\u662fChannelHandlerAdapter\u7684\u5b50\u7c7b if (handler instanceof ChannelHandlerAdapter) { ChannelHandlerAdapter h = (ChannelHandlerAdapter) handler; // \u5224\u65adhandler\u662f\u4e0d\u662f\u5df2\u7ecf\u88ab\u6dfb\u52a0\u5230\u7ba1\u9053\u4e86 // \u5982\u679c\u5df2\u7ecf\u6dfb\u52a0\u5230\u7ba1\u9053\u5e76\u4e14handler\u6ca1\u6709\u88ab@shareable\u6ce8\u89e3\u6807\u8bc6\uff0c\u629b\u51fa\u5f02\u5e38 if (!h.isSharable() && h.added) { throw new ChannelPipelineException( h.getClass().getName() + \" is not a @Sharable handler, so can't be added or removed multiple times.\"); } // \u5c06handler\u5df2\u7ecf\u88ab\u6dfb\u52a0\u5230\u7ba1\u9053\u7684\u6807\u5fd7\u8bbe\u7f6e\u4e3atrue h.added = true; } } \u8c03\u7528newContext\u65b9\u6cd5\uff0c\u5c06handler\u5305\u88c5\u6210AbstractChannelHandlerContext\u5bf9\u8c61 \u8c03\u7528addLast0\u5c06\u6784\u5efa\u7684AbstractChannelHandlerContext\u52a0\u5165pipline\u53cc\u5411\u94fe\u8868\u5c3e\u90e8 private void addLast0(AbstractChannelHandlerContext newCtx) { AbstractChannelHandlerContext prev = tail.prev; newCtx.prev = prev; newCtx.next = tail; prev.next = newCtx; tail.prev = newCtx; } \u63a5\u4e0b\u6765\u5c31\u662f\u5206\u60c5\u51b5\u8fdb\u884ccallHandlerAdded0\u65b9\u6cd5\u7684\u8c03\u7528\uff0c\u5982\u679cNioServerSocketChannel\u672a\u6ce8\u518c\u5230EventLoop\u5219\u8c03\u7528callHandlerCallbackLater\u65b9\u6cd5\u521b\u5efa\u4e00\u4e2a\u7a0d\u540e\u88ab\u6267\u884c\u7684Task\uff1b\u5982\u679cNioServerSocketChannel\u5df2\u7ecf\u6ce8\u518c\u5230EventLoop\uff0c\u5e76\u4e14\u5982\u679c\u5f53\u524d\u7ebf\u7a0b\u4e0d\u662fEventLoop\u7684\u5de5\u4f5c\u7ebf\u7a0b\uff0c\u5219callHandlerAdded0\u65b9\u6cd5\u4f1a\u63d0\u4ea4\u5230\u7ebf\u7a0b\u6c60\u4e2d\u88ab\u6267\u884c\uff1b\u5982\u679cNioServerSocketChannel\u5df2\u7ecf\u6ce8\u518c\u5230EventLoop\u5e76\u4e14\u5f53\u524d\u7ebf\u7a0b\u662fEventLoop\u7684\u5de5\u4f5c\u7ebf\u7a0b\uff0c\u5219\u4f7f\u7528\u5f53\u524d\u7ebf\u7a0b\u6267\u884ccallHandlerAdded0\u65b9\u6cd5\u3002\u663e\u7136\u8fd9\u65f6\u5019NioServerSocketChannel\u8fd8\u672a\u6ce8\u518c\u5230EventLoop\uff0c\u6240\u4ee5\u8ba9\u6211\u4eec\u63a5\u7740\u8fdb\u5165callHandlerCallbackLater\u65b9\u6cd5\u3002 private void callHandlerCallbackLater(AbstractChannelHandlerContext ctx, boolean added) { assert !registered; // \u6839\u636e\u8c03\u7528\u4f20\u5165\u7684\u53c2\u6570\uff0c\u8fd9\u91cc\u663e\u7136\u662f\u65b0\u5efa\u4e00\u4e2aPendingHandlerAddedTask\u5bf9\u8c61 PendingHandlerCallback task = added ? new PendingHandlerAddedTask(ctx) : new PendingHandlerRemovedTask(ctx); // \u83b7\u5f97PendingHandlerCallback\u94fe\u8868\u7684\u5934\u7ed3\u70b9\uff0cPendingHandlerCallback\u94fe\u8868\u662f\u4e00\u4e2a\u5355\u5411\u94fe\u8868 PendingHandlerCallback pending = pendingHandlerCallbackHead; // \u5982\u679c\u94fe\u8868\u4e3a\u7a7a\u5219\u5c06\u65b0\u7684Task\u4f5c\u4e3a\u94fe\u8868\u5934\uff0c\u5426\u5219\u5c06Task\u63d2\u5165\u94fe\u8868\u5c3e\u90e8 if (pending == null) { pendingHandlerCallbackHead = task; } else { // Find the tail of the linked-list. while (pending.next != null) { pending = pending.next; } pending.next = task; } } // PendingHandlerAddedTask\u5b9e\u73b0\u4e86Runnable\u548cPendingHandlerCallback\u7c7b\u7684execute\u62bd\u8c61\u65b9\u6cd5 // \u4e24\u4e2a\u65b9\u6cd5\u7684\u76ee\u7684\u90fd\u662f\u6267\u884ccallHandlerAdded0\u65b9\u6cd5 private final class PendingHandlerAddedTask extends PendingHandlerCallback { PendingHandlerAddedTask(AbstractChannelHandlerContext ctx) { super(ctx); } @Override public void run() { callHandlerAdded0(ctx); } @Override void execute() { EventExecutor executor = ctx.executor(); if (executor.inEventLoop()) { callHandlerAdded0(ctx); } else { try { executor.execute(this); } catch (RejectedExecutionException e) { ... } } } } \u8be5\u65b9\u6cd5\u53ea\u662f\u5728PendingHandlerCallback\u94fe\u8868\u4e2d\u52a0\u5165\u4e86\u4e00\u4e2a\u65b0\u7684PendingHandlerAddedTask\u800c\u6ca1\u6709\u6267\u884ccallHandlerAdded0\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u8c03\u7528\u7684\u65f6\u673a\u4f1a\u5728\u4e0b\u6587\u9610\u8ff0\u3002 \u81ea\u6b64addLast\u65b9\u6cd5\u7684\u8c03\u7528\u94fe\u5206\u6790\u5b8c\u6210\uff0c\u8fd9\u65f6\u5019NioServerSocketChannel\u7684pipline\u7684\u94fe\u8868\u7ed3\u6784\u5e94\u8be5\u5982\u4e0b\uff1a","title":"\u521d\u59cb\u5316NioServerSocketChannel"},{"location":"Others/Netty NIO\u7b14\u8bb0/#nioserversocketchanneleventloop","text":"\u521d\u59cb\u5316\u7ba1\u9053\u7684\u5de5\u4f5c\u5b8c\u6210\u540e\uff0c\u63a5\u4e0b\u6765\u5c31\u662f\u8c03\u7528 config().group().register(channel) \u8fdb\u884cChannel\u7684\u6ce8\u518c\u5de5\u4f5c\u4e86\u3002\u8fd9\u91cc\u7684group\u65b9\u6cd5\u8fd4\u56de\u7684\u662fMultithreadEventLoopGroup\u5bf9\u8c61\uff0c\u8be5\u5bf9\u8c61\u7684register\u65b9\u6cd5\u5982\u4e0b\uff1a public ChannelFuture register(Channel channel) { return next().register(channel); } MultithreadEventLoopGroup\u5bf9\u8c61\u7684register\u53ef\u4ee5\u88ab\u5206\u4e3a\u4e24\u4e2a\u90e8\u5206\uff1a \u8c03\u7528next\u65b9\u6cd5\u4f1a\u4f7f\u7528\u9009\u62e9\u5668\u8fd4\u56de\u4e00\u4e2aEventLoop\u5bf9\u8c61 // MultithreadEventLoopGroup.java public EventLoop next() { return (EventLoop) super.next(); } // MultithreadEventExecutorGroup.java public EventExecutor next() { return chooser.next(); } // GenericEventExecutorChooser public EventExecutor next() { // \u4f7f\u7528idx\u5bf9\u7ebf\u7a0b\u6c60\u957f\u5ea6\u8fdb\u884c\u53d6\u6a21\uff0c\u8fd9\u6837Channel\u88ab\u5e73\u5747\u5206\u914d\u5230\u7ebf\u7a0b\u6c60\u7684\u7ebf\u7a0b\u4e0a return executors[Math.abs(idx.getAndIncrement() % executors.length)]; } \u8c03\u7528SingleThreadEventLoop\u7684register\u65b9\u6cd5\u6765\u6ce8\u518cChannel public ChannelFuture register(Channel channel) { return register(new DefaultChannelPromise(channel, this)); } public ChannelFuture register(final ChannelPromise promise) { ObjectUtil.checkNotNull(promise, \"promise\"); // \u8c03\u7528Channel\u7684AbstractUnsafe\u5bf9\u8c61\u7684register\u65b9\u6cd5\u6765\u6ce8\u518c\u7ba1\u9053 promise.channel().unsafe().register(this, promise); return promise; } \u53ef\u4ee5\u770b\u51faSingleThreadEventLoop\u7684register\u65b9\u6cd5\u6700\u6784\u5efa\u4e00\u4e2aDefaultChannelPromise\u5bf9\u8c61\uff0cDefaultChannelPromise\u5bf9\u8c61\u662f\u4e00\u4e2a\u7528\u6765\u5b58\u50a8\u5f02\u6b65\u4efb\u52a1\u7ed3\u679c\u5e76\u4f5c\u4e3a\u5f02\u6b65\u4efb\u52a1\u89c2\u5bdf\u8005\u7684\u5b9e\u4f8b\uff1b\u7ec8\u4f1a\u8c03\u7528Channel\u7684Unsafe\u5bf9\u8c61\u7684register\u65b9\u6cd5\u6765\u6ce8\u518c\u7ba1\u9053\uff0c\u6240\u4ee5\u8ba9\u6211\u4eec\u7ee7\u7eed\u8fdb\u5165AbstractUnsafe\u5bf9\u8c61\u7684register\u65b9\u6cd5\uff1a public final void register(EventLoop eventLoop, final ChannelPromise promise) { // \u4e00\u4e9b\u6821\u9a8c\u5de5\u4f5c ... // AbstractUnsafe\u662fAbstractChannel\u7684\u4e00\u4e2a\u5185\u90e8\u7c7b // \u6240\u4ee5\u7528AbstractChannel.this.eventLoop\u6765\u6307\u5b9a\u5f53\u524d\u7684eventLoop AbstractChannel.this.eventLoop = eventLoop; // \u5224\u65ad\u5f53\u524d\u7ebf\u7a0b\u662f\u4e0d\u662f\u4f20\u5165\u7684EventLoop\u5bf9\u8c61\u7684\u5de5\u4f5c\u7ebf\u7a0b if (eventLoop.inEventLoop()) { // \u5982\u679c\u662f\u5c31\u76f4\u63a5\u6267\u884cregister0 register0(promise); } else { try { // \u5982\u679c\u4e0d\u662f\u5219\u5c06register0\u4f5c\u4e3a\u4e00\u4e2aTask\u653e\u5165eventLoop\u7684\u4efb\u52a1\u961f\u5217 eventLoop.execute(new Runnable() { @Override public void run() { register0(promise); } }); } catch (Throwable t) { logger.warn( \"Force-closing a channel whose registration task was not accepted by an event loop: {}\", AbstractChannel.this, t); closeForcibly(); closeFuture.setClosed(); safeSetFailure(promise, t); } } } \u53ef\u4ee5\u770b\u5230register\u65b9\u6cd5\u4e3b\u8981\u505a\u4e86\u4e24\u4ef6\u4e8b\uff0c\u9996\u5148\u8bbe\u7f6e\u5f53\u524dChannel\u7684EventLoop\uff0c\u7136\u540e\u6839\u636e\u5f53\u524d\u7ebf\u7a0b\u662f\u5426\u662fEventLoop\u4e2d\u7684\u5de5\u4f5c\u7ebf\u7a0b\u6765\u51b3\u5b9a\u5982\u4f55\u6267\u884cregister0\u65b9\u6cd5\uff0c\u6bcb\u5eb8\u7f6e\u7591\u5728\u6574\u4e2aService\u670d\u52a1\u8d77\u6765\u7684\u8fc7\u7a0b\u4e2d\u6267\u884c\u7ebf\u7a0b\u662f\u4e3b\u7ebf\u7a0b\uff0c\u6240\u4ee5\u8fd9\u91cc\u7684register0\u65b9\u6cd5\u4f1a\u5728EventLoop\u7684\u5de5\u4f5c\u961f\u5217\u4e2d\u7b49\u5f85\u6267\u884c\uff0c\u4e5f\u5c31\u662f\u8bf4register0\u65b9\u6cd5\u4e2d\u6240\u6709\u7684\u903b\u8f91\u90fd\u662f\u7531EventLoop\u7684\u5de5\u4f5c\u7ebf\u7a0b\u6765\u5b8c\u6210\u7684\u3002\u4efb\u52a1\u5728\u4f55\u65f6\u5f00\u59cb\u6267\u884c\u4e0eNetty\u7ebf\u7a0b\u6a21\u578b\u6709\u5173\uff0c\u8fd9\u91cc\u6211\u4eec\u6682\u65f6\u4e0d\u8fdb\u884c\u6df1\u5165\uff0c\u5148\u8fdb\u5165\u5f02\u6b65\u6267\u884c\u7684register0\u65b9\u6cd5\uff1a private void register0(ChannelPromise promise) { try { if (!promise.setUncancellable() || !ensureOpen(promise)) { return; } boolean firstRegistration = neverRegistered; // \u5c06Java Channel\u6ce8\u518c\u5230Selector doRegister(); // \u5c06\u4ece\u672a\u6ce8\u518c\u5b57\u6bb5\u8bbe\u7f6e\u4e3afalse neverRegistered = false; // \u5c06\u5df2\u7ecf\u6ce8\u518c\u53d8\u91cf\u8bbe\u7f6e\u4e3atrue registered = true; // \u5728\u901a\u77e5\u76d1\u542c\u5668\u4e4b\u524d\u6267\u884cPendingHandlerCallback\u94fe\u4e2dcallback\u7684\u903b\u8f91 pipeline.invokeHandlerAddedIfNeeded(); // \u5c06Promise\u7684\u4e2d\u6267\u884c\u7ed3\u679c\u6807\u8bb0\u4e3aSUCCESS\uff0c\u5e76\u901a\u77e5\u6240\u6709\u7684\u76d1\u542c\u5668\u6267\u884c\u4efb\u52a1 safeSetSuccess(promise); // \u8c03\u7528pipline\u7684fireChannelRegistered\uff0c\u6267\u884c\u7ba1\u9053\u6ce8\u518c\u5b8c\u6210\u7684\u903b\u8f91 pipeline.fireChannelRegistered(); // \u5982\u679cJava Channel\u5904\u4e8e\u7ed1\u5b9a\u72b6\u6001 if (isActive()) { // \u5982\u679c\u662f\u7b2c\u4e00\u6b21\u8fdb\u884c\u6ce8\u518c if (firstRegistration) { // \u8c03\u7528pipline\u7684fireChannelActive\uff0c\u6267\u884c\u7ba1\u9053\u6fc0\u6d3b\u5b8c\u6210\u7684\u5b8c\u6210\u7684\u903b\u8f91 pipeline.fireChannelActive(); } else if (config().isAutoRead()) { beginRead(); } } } catch (Throwable t) { // Close the channel directly to avoid FD leak. closeForcibly(); closeFuture.setClosed(); safeSetFailure(promise, t); } } register0\u65b9\u6cd5\u662fNetty\u521d\u59cb\u8fc7\u7a0b\u4e2d\u6bd4\u8f83\u6838\u5fc3\u7684\u4ee3\u7801\uff0c\u4e3b\u8981\u53ef\u4ee5\u5206\u6210\u4ee5\u4e0b\u51e0\u5757\u903b\u8f91\uff1a \u8c03\u7528doRegister\u5c06Java Channel\u6ce8\u518c\u5230Selector protected void doRegister() throws Exception { boolean selected = false; for (;;) { try { selectionKey = javaChannel().register(eventLoop().unwrappedSelector(), 0, this); return; } catch (CancelledKeyException e) { if (!selected) { eventLoop().selectNow(); selected = true; } else { throw e; } } } } \u5c06doRegister\u65b9\u6cd5\u4e2d\u5c06Java Channel\uff08\u8fd9\u91cc\u662fServerSocketChannel\uff09\u6ce8\u518c\u5230\u4e86EventLoop\u7684Selector\u4e0a\uff0c\u53ef\u4ee5\u6ce8\u610f\u5230\u8fd9\u91cc\u6ce8\u518c\u7684\u4e8b\u4ef6\u662f0\uff0c\u5373\u4e0d\u76d1\u542c\u4efb\u4f55\u4e8b\u4ef6\uff0c\u76d1\u542c\u7684\u4e8b\u4ef6\u5c06\u5728\u540e\u7eed\u8fdb\u884c\u6ce8\u518c\uff0c\u4e0b\u6587\u5c06\u4f1a\u63d0\u5230\uff1b\u4e3a\u4ec0\u4e48\u8981\u7528\u6b7b\u5faa\u73af\u7684\u539f\u56e0\u76ee\u524d\u6211\u5e76\u4e0d\u592a\u660e\u767d\u3002\u3002\u3002 \u5c06registered\u6807\u8bb0\u5b57\u6bb5\u8bbe\u7f6e\u4e3atrue\uff0c\u8868\u660e\u8be5Channel\u5df2\u7ecf\u5b8c\u6210\u4e86\u6ce8\u518c \u8c03\u7528 pipeline.invokeHandlerAddedIfNeeded() \uff0c\u8be5\u65b9\u6cd5\u4f1a\u6267\u884c\u4e4b\u524d\u5728pipline\u7684addLast\u65b9\u6cd5\u4e2d\u8fdb\u884c\u8fc7\u8bf4\u660e\u7684PendingHandlerCallback\u94fe\u4e2d\u6240\u6709\u7684Task\u7684execute\u65b9\u6cd5\uff0c\u4e5f\u5c31\u662f\u8bf4callHandlerAdded0\u65b9\u6cd5\u5c06\u5728\u8fd9\u91cc\u8fdb\u884c\u8c03\u7528\u3002 final void invokeHandlerAddedIfNeeded() { // \u7531\u4e8eregister0\u65b9\u6cd5\u662f\u7531EventLoop\u4e2d\u7684\u5de5\u4f5c\u7ebf\u7a0b\u6267\u884c\u7684 // \u6240\u4ee5\u5f53\u524d\u7ebf\u7a0b\u5fc5\u987b\u662fEventLoop\u4e2d\u7684\u5de5\u4f5c\u7ebf\u7a0b\uff0c\u8fd9\u91cc\u8fdb\u884c\u4e00\u6b21\u5224\u65ad\u6821\u9a8c assert channel.eventLoop().inEventLoop(); if (firstRegistration) { // firstRegistration\u5c5e\u6027\u7684\u503c\u4fee\u6539\u4e3afalse firstRegistration = false; // \u6267\u884c\u56de\u8c03\u903b\u8f91 callHandlerAddedForAllHandlers(); } } private void callHandlerAddedForAllHandlers() { final PendingHandlerCallback pendingHandlerCallbackHead; synchronized (this) { assert !registered; // \u4fee\u6539pipline\u7684registered\u5c5e\u6027\u7684\u503c\u4e3atrue registered = true; // \u83b7\u5f97\u94fe\u8868\u7684\u5934\u7ed3\u70b9 pendingHandlerCallbackHead = this.pendingHandlerCallbackHead; this.pendingHandlerCallbackHead = null; } // \u4ece\u5934\u7ed3\u70b9\u5f00\u59cb\u6cbf\u7740\u56de\u8c03\u94fe\u6267\u884c\u56de\u8c03\u7684execute\u65b9\u6cd5 PendingHandlerCallback task = pendingHandlerCallbackHead; while (task != null) { task.execute(); task = task.next; } } \u7531\u4e0a\u8ff0\u6d41\u7a0b\u53ef\u4ee5\u77e5\u9053invokeHandlerAddedIfNeeded\u6700\u7ec8\u5c06\u4f1a\u6267\u884cPendingHandlerCallback\u94fe\u4e2d\u6240\u6709\u7684task\u7684execute\u65b9\u6cd5\uff0c\u6240\u4ee5\u4e4b\u524d\u901a\u8fc7pipline\u7684addLast\u65b9\u6cd5\u6700\u7ec8\u6dfb\u52a0\u5230\u94fe\u4e2d\u7684PendingHandlerAddedTask\u5bf9\u8c61\u7684execute\u65b9\u6cd5\u4e5f\u5728\u6b64\u65f6\u88ab\u6267\u884c\uff0c\u8ba9\u6211\u4eec\u56de\u5230PendingHandlerAddedTask\u7684execute\u65b9\u6cd5\uff1a void execute() { // \u56e0\u4e3actx\u4e2dexecutor\u5bf9\u8c61\u4e3a\u7a7a\uff0c\u6240\u4ee5\u8fd9\u91cc\u7684exector\u662fChannel\u6301\u6709\u7684EventLoop\u5bf9\u8c61 EventExecutor executor = ctx.executor(); // \u5224\u65ad\u5f53\u524d\u7ebf\u7a0b\u662f\u4e0d\u662fexecutor\u7684\u5de5\u4f5c\u7ebf\u7a0b if (executor.inEventLoop()) { // \u76f4\u63a5\u6267\u884ccallHandlerAdded0\u65b9\u6cd5 callHandlerAdded0(ctx); } else { try { // \u628a\u81ea\u5df1\u4f5c\u4e3atask\u63d0\u4ea4\uff0c\u4e5f\u5c31\u662f\u4f1a\u5728\u7a0d\u540e\u6267\u884c\u81ea\u8eab\u7684run\u65b9\u6cd5 // run\u65b9\u6cd5\u4e2d\u4e5f\u662f\u6267\u884c\u7684callHandlerAdded0\u65b9\u6cd5 executor.execute(this); } catch (RejectedExecutionException e) { if (logger.isWarnEnabled()) { logger.warn( \"Can't invoke handlerAdded() as the EventExecutor {} rejected it, removing handler {}.\", executor, ctx.name(), e); } remove0(ctx); ctx.setRemoved(); } } } public void run() { callHandlerAdded0(ctx); } \u7531\u4e4b\u524d\u5bf9AbstractUnsafe\u5bf9\u8c61\u7684register\u65b9\u6cd5\u5206\u6790\u53ef\u77e5\uff0cAbstractUnsafe\u5bf9\u8c61\u7684register0\u65b9\u6cd5\u662f\u7531EventLoop\u4e2d\u7684\u5de5\u4f5c\u7ebf\u7a0b\u53bb\u6267\u884c\u7684\uff0c\u6240\u4ee5register0\u4e2d\u6240\u6709\u7684\u903b\u8f91\u90fd\u7531EventLoop\u4e2d\u7684\u5de5\u4f5c\u7ebf\u7a0b\u6765\u5b8c\u6210\uff0c\u56e0\u6b64 executor.inEventLoop() \u5f97\u5230\u7684\u7ed3\u679c\u4e3atrue\uff0c\u6240\u4ee5\u63a5\u4e0b\u5c06\u76f4\u63a5\u6267\u884cDefaultChannelPipline\u7684callHandlerAdded0\u65b9\u6cd5\uff1a private void callHandlerAdded0(final AbstractChannelHandlerContext ctx) { try { ctx.callHandlerAdded(); } catch (Throwable t) { // \u9519\u8bef\u5904\u7406\u903b\u8f91 ... } } \u76ee\u524d\u6211\u4eec\u53ea\u5728ServerBootstrap\u7684 init \u65b9\u6cd5\u4e2d\u5728\u94fe\u8868\u672b\u5c3e\u6dfb\u52a0\u4e86\u4e00\u4e2a\u6dfb\u52a0\u4e86\u4e00\u4e2aChannelInitializer\uff0c\u6240\u4ee5\u8fd9\u91cc\u7684HandlerContext\u5c31\u662f\u5c01\u88c5ChannelInitializer\u7684HandlerContext\u3002\u63a5\u7740\u8fdb\u5165HandlerContext\u7684callHandlerAdded\u65b9\u6cd5\uff1a final void callHandlerAdded() throws Exception { // \u5c06Handler\u7684\u72b6\u6001\u4fee\u6539\u4e3aADD_COMPLETE if (setAddComplete()) { // \u901a\u8fc7handler\u65b9\u6cd5\u83b7\u5f97context\u4e2d\u7684handler\uff0c\u5e76\u4e14\u8c03\u7528handler\u7684handlerAdded\u65b9\u6cd5 handler().handlerAdded(this); } } \u5f88\u663e\u7136\u8fd9\u91cc\u7684handler\u65b9\u6cd5\u83b7\u5f97\u7684\u5c31\u662fChannelInitializer\u5bf9\u8c61\uff0c\u63a5\u7740\u8fdb\u5165ChannelInitializer\u7684handlerAdded\u65b9\u6cd5\uff1a public void handlerAdded(ChannelHandlerContext ctx) throws Exception { // \u5982\u679c\u7ba1\u9053\u5df2\u7ecf\u5b8c\u6210\u6ce8\u518c\uff0c\u5373registered\u6807\u8bb0\u4e3atrue if (ctx.channel().isRegistered()) { if (initChannel(ctx)) { // \u505a\u4e00\u4e9b\u540e\u7eed\u7684\u5904\u7406 removeState(ctx); } } } private boolean initChannel(ChannelHandlerContext ctx) throws Exception { // \u4fdd\u8bc1\u4e00\u4e2acontext\u53ea\u4f1a\u88ab\u6267\u884c\u4e00\u6b21 if (initMap.add(ctx)) { try { // \u6267\u884c\u7531\u5b50\u7c7b\u5b9e\u73b0\u7684initChannel\u65b9\u6cd5 initChannel((C) ctx.channel()); } catch (Throwable cause) { // \u8c03\u7528Handler\u7684\u5f02\u5e38\u5904\u7406\u65b9\u6cd5 exceptionCaught(ctx, cause); } finally { // \u6700\u540e\u5c06ChannelInitializer\u4ecepipline\u4e2d\u5220\u9664 ChannelPipeline pipeline = ctx.pipeline(); if (pipeline.context(this) != null) { pipeline.remove(this); } } return true; } return false; } \u6700\u7ec8handlerAdded\u4f1a\u8c03\u7528\u5b50\u7c7b\u5b9e\u73b0\u7684initChannel\u65b9\u6cd5\uff0c\u73b0\u5728\u6211\u4eec\u56de\u8fc7\u5934\u6765\u770b\u88ab\u6dfb\u52a0\u5230pipeline\u7684ChannelInitializer\u5b9e\u73b0\u7684initChannel\u65b9\u6cd5\uff1a p.addLast(new ChannelInitializer<Channel>() { @Override public void initChannel(final Channel ch) throws Exception { final ChannelPipeline pipeline = ch.pipeline(); // \u5728pipline\u4e2d\u6dfb\u52a0\u901a\u8fc7Bootstrap\u5bf9\u8c61\u7684handler\u914d\u7f6e\u7684Handler ChannelHandler handler = config.handler(); if (handler != null) { pipeline.addLast(handler); } // \u5411EventLoop\u7ebf\u7a0b\u7684\u4efb\u52a1\u961f\u5217\u63d0\u4ea4\u521b\u5efaServerBootstrapAcceptor\u5bf9\u8c61\u7684\u4efb\u52a1 ch.eventLoop().execute(new Runnable() { @Override public void run() { pipeline.addLast(new ServerBootstrapAcceptor( ch, currentChildGroup, currentChildHandler, currentChildOptions, currentChildAttrs)); } }); } }); initChannel\u65b9\u6cd5\u53ea\u505a\u4e86\u4e24\u4ef6\u4e8b\uff0c\u4e00\u662f\u5c06\u5728Bootstrap\u5bf9\u8c61\u7684handler\u65b9\u6cd5\u4e2d\u914d\u7f6e\u7684Handler\u52a0\u5165\u5230pipeline\u4e2d\uff0c\u7531\u4e8e\u6211\u4eec\u5e76\u6ca1\u6709\u914d\u7f6eHandler\u6240\u4ee5\u8fd9\u4e00\u6b65\u6ca1\u6709\u6dfb\u52a0Handler\uff1b\u4e8c\u662f\u5c06\u6dfb\u52a0ServerBootstrapAcceptor\u5bf9\u8c61\u5230pipeline\u7684\u5de5\u4f5c\u4ea4\u7ed9Channel\u7684EventLoop\u6765\u5904\u7406\u3002\u8fd9\u91cc\u8fd9\u4e48\u505a\u7684\u539f\u56e0\u662f\uff0c\u8981\u4fdd\u8bc1\u5982\u679cconfig\u4e2dHandler\u4e5f\u662fChannelInitializer\u65f6\uff0cChannelInitializer\u914d\u7f6e\u7684Handler\u4f1a\u5728ServerBootstrapAcceptor\u4e4b\u524d\uff0c\u90a3\u4e3a\u4ec0\u4e48\u80fd\u4fdd\u8bc1\u5462\uff1f \u6211\u662f\u8fd9\u6837\u8ba4\u4e3a\u7684\uff0c\u4e4b\u524d\u5728addLast\u65b9\u6cd5\u4e2d\u5206\u6790\u8fc7\uff0caddLast\u6267\u884ccallHandlerAdded0\u65b9\u6cd5\uff0c\u5c31\u662f\u6700\u7ec8\u6267\u884cChannelInitializer\u7684initChannel\u65b9\u6cd5\u7684\u53ef\u80fd\u6027\u6709\u4e09\u79cd\uff0c\u5176\u4e2d\u4e00\u79cd\u7684\u6761\u4ef6\u662fpipeline\u7684register\u5c5e\u6027\u4e3afalse\uff0c\u6b64\u65f6register\u5df2\u7ecf\u88ab\u8bbe\u7f6e\u4e3atrue\u6240\u4ee5\u4e0d\u8003\u8651\u8fd9\u79cd\u53ef\u80fd\u6027\uff1b\u4f46\u662f\u5b58\u5728\u5f53\u524d\u7ebf\u7a0b\u4e0eEventLoop\u7684\u5de5\u4f5c\u7ebf\u7a0b\u4e0d\u662f\u540c\u4e00\u4e2a\u7ebf\u7a0b\u7684\u60c5\u51b5\uff0ccallHandlerAdded0\u65b9\u6cd5\u53ef\u80fd\u88ab\u76f4\u63a5\u6267\u884c\uff0c\u8fd9\u79cd\u60c5\u51b5\u662f\u53ef\u4ee5\u4fdd\u8bc1\u5148\u540e\u987a\u5e8f\u7684\uff0c\u4f46\u4e5f\u53ef\u80fd\u88ab\u653e\u5165EventLoop\u7684\u4efb\u52a1\u961f\u5217\u4e2d\u53bb\u6267\u884c\uff0c\u6240\u4ee5\u4e3a\u4e86\u4fdd\u8bc1ServerBootstrapAcceptor\u5728pipeline\u7684\u672b\u5c3e\uff0c\u9700\u8981\u5c06\u6dfb\u52a0ServerBootstrapAcceptor\u5de5\u4f5c\u52a0\u5165\u5230\u4efb\u52a1\u961f\u5217\u4e2d\u53bb\u3002 \u8fd9\u91cc\u5bf9ServerBootstrapAcceptor\u8fdb\u884c\u4e00\u4e2a\u7b80\u5355\u7684\u8bf4\u660e\uff0cServerBootstrapAcceptor\u5b9e\u73b0\u4e86ChannelInboundHandlerAdapter\u63a5\u53e3\u8d1f\u8d23\u76d1\u542c\u8fde\u63a5\u8bf7\u6c42\uff0c\u5728\u5b8c\u6210\u8fde\u63a5\u4ee5\u540e\u4f1a\u521b\u5efa\u4e00\u4e2aNioSocketChannel\u6765\u8868\u793a\u5ba2\u6237\u7aef\u8fde\u63a5\uff0cNioSocketChanne\u4f1a\u88abl\u6ce8\u518c\u5230workerGroup\uff0c\u7528\u4e8e\u76d1\u542cIO\u8bfb\u5199\u8bf7\u6c42\u3002 \u5728\u8c03\u7528\u5b8c\u5b50\u7c7b\u7684initChannel\u65b9\u6cd5\u4e4b\u540e\uff0c\u5728finally\u5757\u4e2d\u6700\u540e\u4f1a\u4ecepiplien\u4e2d\u5c06ChannelInitializer\u79fb\u9664\uff0c\u81f3\u6b64invokeHandlerAddedIfNeeded()\u65b9\u6cd5\u7684\u6574\u4e2a\u8c03\u7528\u6d41\u7a0b\u5c31\u7ed3\u675f\u4e86\uff0cpipeline\u94fe\u8868\u7684\u7ed3\u6784\u5982\u4e0b\uff1a \u8c03\u7528safeSetSuccess\u65b9\u6cd5\uff0c\u8c03\u7528\u94fe\u5982\u4e0b\uff1a protected final void safeSetSuccess(ChannelPromise promise) { if (!(promise instanceof VoidChannelPromise) && !promise.trySuccess()) { logger.warn(\"Failed to mark a promise as success because it is done already: {}\", promise); } } public boolean trySuccess() { return trySuccess(null); } public boolean trySuccess(V result) { if (setSuccess0(result)) { notifyListeners(); return true; } return false; } \u8be5\u65b9\u6cd5\u7684\u4e3b\u8981\u903b\u8f91\u5c31\u662f\u5c06DefaultPromise\u5bf9\u8c61\u7684\u7ed3\u679c\u8bbe\u7f6e\u4e3aSUCCESS\u5e76\u4e14\u901a\u77e5\u6240\u6709\u7684\u76d1\u542c\u5668\u6267\u884coperationComplete\u65b9\u6cd5\uff0c\u8fd9\u91cc\u5c31\u4e0d\u6df1\u5165\u5177\u4f53\u7684\u903b\u8f91\u4e86\u3002 pipeline\u7684fireChannelRegistered\u65b9\u6cd5\u4f1a\u4f9d\u6b21\u8c03\u7528pipleline\u4e2d\u7684\u53cc\u5411\u94fe\u8868\u4e2d\u7684InboundHandler\u7684channelRegistered()\u65b9\u6cd5\uff0c\u6267\u884c\u7ba1\u9053\u6ce8\u518c\u5b8c\u6210\u7684\u903b\u8f91\uff0c\u8fd9\u91cc\u4e5f\u4e0d\u7ee7\u7eed\u8fdb\u884c\u5c55\u5f00\u3002 \u6700\u540e\uff0c\u5982\u679cJava Channel\u5904\u4e8e\u7ed1\u5b9a\u72b6\u6001\uff0c\u901a\u8fc7pipeline.fireChannelActive()\u65b9\u6cd5\u4f9d\u6b21\u8c03\u7528pipleline\u4e2d\u7684\u53cc\u5411\u94fe\u8868\u4e2d\u7684InboundHandler\u7684channelActive()\u65b9\u6cd5\uff0c\u6267\u884c\u7ba1\u9053\u6fc0\u6d3b\u5b8c\u6210\u7684\u903b\u8f91\uff0c\u4f46\u662f\u8fd9\u65f6\u5019\u7ba1\u9053\u8fd8\u672a\u7ed1\u5b9a\u6240\u4ee5\u4e0d\u4f1a\u6267\u884c\u8fd9\u91cc\u7684\u903b\u8f91\u3002 \u8fd9\u6837register0\u65b9\u6cd5\u7684\u8c03\u7528\u5c31\u7ed3\u675f\u4e86\uff0c\u7136\u800c\u56e0\u4e3aregister0\u662f\u4e00\u4e2a\u5f02\u6b65\u8c03\u7528\u8fc7\u7a0b\u6240\u4ee5\u5b9e\u9645\u4e0a\u8c03\u7528register0\u7684register\u65b9\u6cd5\u65e9\u5c31\u8fd4\u56de\u4e86\uff0c\u968f\u7740register\u65b9\u6cd5\u65e9\u5c31\u8fd4\u56deinitAndRegister\u65b9\u6cd5\u7684\u8c03\u7528\u4e5f\u7ed3\u675f\u4e86\u5e76\u4e14\u8fd4\u56de\u4e86\u5b58\u653eregister0\u8fd9\u4e2a\u5f02\u6b65\u8c03\u7528\u7ed3\u679c\u7684DefaultPromise\u5bf9\u8c61\uff0c\u8ba9\u6211\u4eec\u56de\u5230ServerBootstrap\u7684doBind\u65b9\u6cd5\u4e2d\uff1a private ChannelFuture doBind(final SocketAddress localAddress) { // \u521b\u5efa\u63a5\u53d7\u8fde\u63a5\u8bf7\u6c42\u7684Channel\u5e76\u6ce8\u518c\u5230NioEventLoop\u7684Selector final ChannelFuture regFuture = initAndRegister(); final Channel channel = regFuture.channel(); if (regFuture.cause() != null) { return regFuture; } // \u5224\u65ad\u64cd\u4f5c\u662f\u5426\u5b8c\u6210 if (regFuture.isDone()) { ChannelPromise promise = channel.newPromise(); // \u5982\u679c\u64cd\u4f5c\u5b8c\u6210\u8c03\u7528doBind0\u65b9\u6cd5 doBind0(regFuture, channel, localAddress, promise); return promise; } else { final PendingRegistrationPromise promise = new PendingRegistrationPromise(channel); // \u5982\u679c\u64cd\u4f5c\u8fd8\u672a\u5b8c\u6210\u5219\u6dfb\u52a0\u76d1\u542c\u5668\uff0c\u5728\u5b8c\u6210\u540e\u5224\u65ad\u64cd\u4f5c\u662f\u5426\u5931\u8d25\uff0c\u5982\u679c\u672a\u5931\u8d25\u5219\u7ee7\u7eed\u8c03\u7528doBind0\u65b9\u6cd5 regFuture.addListener(new ChannelFutureListener() { @Override public void operationComplete(ChannelFuture future) throws Exception { Throwable cause = future.cause(); if (cause != null) { promise.setFailure(cause); } else { promise.registered(); doBind0(regFuture, channel, localAddress, promise); } } }); return promise; } } \u5728initAndRegister\u65b9\u6cd5\u8fd4\u56de\u540e\uff0c\u901a\u8fc7DefaultPromise\u7684isDone\u65b9\u6cd5\u5224\u65ad\u4e00\u6b21register0\u65b9\u6cd5\u662f\u5426\u5b8c\u6210\u4e86\u8c03\u7528\uff0c\u5982\u679c\u5b8c\u6210\u5219\u76f4\u63a5\u8c03\u7528doBind0\u65b9\u6cd5\uff0c\u5982\u679c\u6ca1\u6709\u5b8c\u6210\u6dfb\u52a0\u4e00\u4e2a\u76d1\u542c\u5668\u53bb\u7b49\u5f85\u4efb\u52a1\u5b8c\u6210\u540e\u7ee7\u7eed\u6267\u884cdoBind0\u65b9\u6cd5\uff0c\u4e4b\u524d\u5206\u6790\u8fc7\u76d1\u542c\u5668\u4f1a\u5728safeSetSuccess\u4e2d\u88ab\u901a\u77e5\u3002\u56e0\u6b64\u65e0\u8bba\u5982\u4f55\uff0c\u6700\u7ec8\u90fd\u4f1a\u8c03\u7528doBind0\u65b9\u6cd5\uff1a private static void doBind0( final ChannelFuture regFuture, final Channel channel, final SocketAddress localAddress, final ChannelPromise promise) { // \u5728\u89e6\u53d1channelRegistered\u4e4b\u524d\u8c03\u7528\u6b64\u65b9\u6cd5 // \u4f7f\u7528\u6237\u5904\u7406\u7a0b\u5e8f\u6709\u673a\u4f1a\u5728\u5176channelRegistered\u5b9e\u73b0\u4e2d\u8bbe\u7f6e\u7ba1\u9053 channel.eventLoop().execute(new Runnable() { @Override public void run() { if (regFuture.isSuccess()) { channel.bind(localAddress, promise).addListener(ChannelFutureListener.CLOSE_ON_FAILURE); } else { promise.setFailure(regFuture.cause()); } } }); } \u8be5\u65b9\u6cd5\u76f4\u63a5\u8c03\u7528\u4e86AbstractChannel\u7684bind\u65b9\u6cd5\uff0c\u8c03\u7528\u94fe\u5982\u4e0b\uff1a public ChannelFuture bind(SocketAddress localAddress, ChannelPromise promise) { return pipeline.bind(localAddress, promise); } public final ChannelFuture bind(SocketAddress localAddress, ChannelPromise promise) { // \u8c03\u7528\u4e86TailContext\u7684bind\u65b9\u6cd5 return tail.bind(localAddress, promise); } public ChannelFuture bind(final SocketAddress localAddress, final ChannelPromise promise) { if (localAddress == null) { throw new NullPointerException(\"localAddress\"); } if (isNotValidPromise(promise, false)) { return promise; } // \u627e\u5230\u4e0a\u4e00\u4e2aoutbound final AbstractChannelHandlerContext next = findContextOutbound(); EventExecutor executor = next.executor(); // \u6267\u884cAbstractChannelHandlerContext\u7684invokeBind if (executor.inEventLoop()) { next.invokeBind(localAddress, promise); } else { safeExecute(executor, new Runnable() { @Override public void run() { next.invokeBind(localAddress, promise); } }, promise, null); } return promise; } \u901a\u8fc7findContextOutbound\u627e\u5230pipeline\u94fe\u8868\u4e2d\u7684\u4e0a\u4e00\u4e2a\u6301\u6709\u5b9e\u73b0\u4e86ChannelOutboundHandler\u63a5\u53e3\u7684Handler\u5bf9\u8c61\u7684AbstractChannelHandlerContext\u5bf9\u8c61\uff0cfindContextOutbound\u65b9\u6cd5\u5982\u4e0b\uff1a private AbstractChannelHandlerContext findContextOutbound() { AbstractChannelHandlerContext ctx = this; do { ctx = ctx.prev; } while (!ctx.outbound); return ctx; } \u76ee\u524d\u7684pipeline\u94fe\u8868\u5982\u4e0b\uff1a \u6240\u4ee5\u8fd9\u91cc\u627e\u5230\u7684AbstractChannelHandlerContext\u4e3aHeadContext\uff0c\u6700\u7ec8\u4f1a\u8fdb\u5165TailContext\u7684bind\u65b9\u6cd5\uff0c\u8c03\u7528\u94fe\u5982\u4e0b\uff1a public void bind( ChannelHandlerContext ctx, SocketAddress localAddress, ChannelPromise promise) { // \u7531\u4e8eTailContext\u662fpipeline\u7684\u5185\u90e8\u7c7b\uff0c\u6240\u4ee5\u8fd9\u91cc\u8c03\u7528\u4e86pipeline\u7684unsafe\u7684bind\u65b9\u6cd5 unsafe.bind(localAddress, promise); } public final void bind(final SocketAddress localAddress, final ChannelPromise promise) { assertEventLoop(); if (!promise.setUncancellable() || !ensureOpen(promise)) { return; } if (Boolean.TRUE.equals(config().getOption(ChannelOption.SO_BROADCAST)) && localAddress instanceof InetSocketAddress && !((InetSocketAddress) localAddress).getAddress().isAnyLocalAddress() && !PlatformDependent.isWindows() && !PlatformDependent.maybeSuperUser()) { logger.warn( \"A non-root user can't receive a broadcast packet if the socket \" + \"is not bound to a wildcard address; binding to a non-wildcard \" + \"address (\" + localAddress + \") anyway as requested.\"); } boolean wasActive = isActive(); try { // \u7ed1\u5b9aJava Channel\u5230\u6307\u5b9a\u7684\u7aef\u53e3 doBind(localAddress); } catch (Throwable t) { safeSetFailure(promise, t); closeIfClosed(); return; } // \u5982\u679cJava Channel\u4e4b\u524d\u662f\u672a\u7ed1\u5b9a\u7684\uff0c\u73b0\u5728\u5b8c\u6210\u4e86\u7ed1\u5b9a\u5219\u6267\u884cfireChannelActive\u903b\u8f91 if (!wasActive && isActive()) { // \u5728Channel\u7684EventLoop\u7684\u4efb\u52a1\u961f\u5217\u5c06pipeline.fireChannelActive()\u65b9\u6cd5\u4f5c\u4e3a\u4efb\u52a1\u63d0\u4ea4 invokeLater(new Runnable() { @Override public void run() { pipeline.fireChannelActive(); } }); } safeSetSuccess(promise); } \u8fd9\u91cc\u6709\u5f88\u91cd\u8981\u7684\u4e24\u6b65\u903b\u8f91\uff0c\u4e00\u662f\u901a\u8fc7doBind\u65b9\u6cd5\u5c06Java Channel\u7ed1\u5b9a\u5230\u5bf9\u5e94\u7684\u7aef\u53e3\uff1b\u7136\u540e\u5728\u7ed1\u5b9a\u4e4b\u540e\u63a5\u7740\u8c03\u7528fireChannelActive\u65b9\u6cd5\uff0c\u5f00\u59cb\u7ba1\u9053\u6fc0\u6d3b\u7684\u903b\u8f91\u3002 \u7531\u4e8e\u8fd9\u91cc\u7684Channel\u7c7b\u662fNioServerSocketChannel\uff0c\u6240\u4ee5\u8fdb\u5165NioServerSocketChannel\u7684doBind\u65b9\u6cd5\uff1a protected void doBind(SocketAddress localAddress) throws Exception { if (PlatformDependent.javaVersion() >= 7) { javaChannel().bind(localAddress, config.getBacklog()); } else { javaChannel().socket().bind(localAddress, config.getBacklog()); } } \u8fd9\u91cc\u5c31\u56de\u5230\u4e86Java NIO\u7684API\uff0c\u6839\u636eJDK\u7248\u672c\u5b9e\u73b0Java Channel\u7684\u7ed1\u5b9a\uff1a >= 7\uff0c\u8c03\u7528ServerSocketChannel.bind(SocketAddress\uff0cconfig.getBacklog()) \u5426\u5219\uff0c\u8c03\u7528ServerSocketChannel.socket().bind(SocketAddress\uff0cconfig.getBacklog()) \u5b8c\u6210\u7ed1\u5b9a\u540e\uff0c\u7a0d\u540e\u8c03\u7528 pipeline.fireChannelActive() \u65b9\u6cd5\u89e6\u53d1\u7ba1\u9053\u6fc0\u6d3b\u4e8b\u4ef6\uff1a public final ChannelPipeline fireChannelActive() { // \u4ee5HeadContext\u4f5c\u4e3a\u94fe\u8868\u7684\u5f00\u7aef\u89e6\u53d1pipeline\u7684\u6fc0\u6d3b\u65b9\u6cd5 AbstractChannelHandlerContext.invokeChannelActive(head); return this; } static void invokeChannelActive(final AbstractChannelHandlerContext next) { EventExecutor executor = next.executor(); if (executor.inEventLoop()) { next.invokeChannelActive(); } else { executor.execute(new Runnable() { @Override public void run() { next.invokeChannelActive(); } }); } } fireChannelActive\u65b9\u6cd5\u5c06HeadContext\u4f5c\u4e3a\u53c2\u6570\u8c03\u7528\u4e86invokeChannelActive\u65b9\u6cd5\uff0c\u56e0\u6b64\u6700\u7ec8\u5c06\u8c03\u7528HeadContext\u7684invokeChannelActive\u65b9\u6cd5\uff1a private void invokeChannelActive() { if (invokeHandler()) { try { // HeadContext\u7684handler\u65b9\u6cd5\u8fd4\u56de\u7684HeadContext\u81ea\u8eab // \u6240\u4ee5\u5c06\u7ee7\u7eed\u8c03\u7528HeadContext\u7684channelActive\u65b9\u6cd5 ((ChannelInboundHandler) handler()).channelActive(this); } catch (Throwable t) { notifyHandlerException(t); } } else { fireChannelActive(); } } \u7531\u4e8eHeadContext\u7684handler\u65b9\u6cd5\u8fd4\u56de\u7684HeadContext\u81ea\u8eab\uff0c\u6240\u4ee5\u5c06\u7ee7\u7eed\u8c03\u7528HeadContext\u7684channelActive\u65b9\u6cd5\uff1a public void channelActive(ChannelHandlerContext ctx) { // \u5c06\u6fc0\u6d3b\u4e8b\u4ef6\u4f20\u9012\u7ed9\u94fe\u8868\u4e2d\u7684\u5176\u4ed6HandlerContext ctx.fireChannelActive(); readIfIsAutoRead(); } HeadContext\u4f1a\u9996\u5148\u5c06\u6fc0\u6d3b\u4e8b\u4ef6\u4f20\u9012\u7ed9\u94fe\u8868\u4e2d\u7684\u5176\u4ed6HandlerContext\uff0c\u7531\u4e8e\u5176\u4ed6Context\u4e2d\u6ca1\u6709\u7279\u522b\u91cd\u8981\u7684\u6fc0\u6d3b\u4e8b\u4ef6\u7684\u903b\u8f91\uff0c\u8fd9\u91cc\u5c31\u4e0d\u8fdb\u884c\u6df1\u5165\u4e86\u3002\u63a5\u4e0b\u6765\u7ee7\u7eed\u6267\u884creadIfIsAutoRead\u65b9\u6cd5\uff0c\u903b\u8f91\u5982\u4e0b\uff1a private void readIfIsAutoRead() { if (channel.config().isAutoRead()) { channel.read(); } } public Channel read() { pipeline.read(); return this; } public final ChannelPipeline read() { tail.read(); return this; } public ChannelHandlerContext read() { final AbstractChannelHandlerContext next = findContextOutbound(); EventExecutor executor = next.executor(); if (executor.inEventLoop()) { next.invokeRead(); } else { Runnable task = next.invokeReadTask; if (task == null) { next.invokeReadTask = task = new Runnable() { @Override public void run() { next.invokeRead(); } }; } executor.execute(task); } return this; } \u53ef\u4ee5\u770b\u51fa\uff0cread\u65b9\u6cd5\u7684\u8c03\u7528\u94fe\u548cbind\u65b9\u6cd5\u7684\u8c03\u7528\u94fe\u5927\u540c\u5c0f\u5f02\uff0c\u4e5f\u662f\u901a\u8fc7TailContext\u5f80\u524d\u5bfb\u627e\u6301\u6709\u5b9e\u73b0\u4e86ChannelOutboundHandler\u63a5\u53e3\u7684Handler\u5bf9\u8c61\u7684AbstractChannelHandlerContext\u5bf9\u8c61\uff0c\u5728\u5f53\u524d\u94fe\u8868\u4e2d\u53ea\u80fd\u627e\u5230HeadContext\uff0c\u56e0\u6b64\u63a5\u4e0b\u6765\u5c06\u6267\u884cHeadContext\u7684read\u65b9\u6cd5\uff0c\u5982\u4e0b\uff1a public void read(ChannelHandlerContext ctx) { unsafe.beginRead(); } // AbstractUnsafe public final void beginRead() { assertEventLoop(); if (!isActive()) { return; } try { doBeginRead(); } catch (final Exception e) { invokeLater(new Runnable() { @Override public void run() { pipeline.fireExceptionCaught(e); } }); close(voidPromise()); } } // AbstractNioMessageChannel protected void doBeginRead() throws Exception { if (inputShutdown) { return; } super.doBeginRead(); } // AbstractNioChannel protected void doBeginRead() throws Exception { // \u8fd9\u91cc\u7684selectionKey\u5c31\u662f\u4e4b\u524d\u521d\u59cb\u5316NioServerSocketChannel\u65f6\u8bbe\u7f6e\u7684SelectionKey.OP_ACCEPT final SelectionKey selectionKey = this.selectionKey; if (!selectionKey.isValid()) { return; } readPending = true; final int interestOps = selectionKey.interestOps(); if ((interestOps & readInterestOp) == 0) { selectionKey.interestOps(interestOps | readInterestOp); } } \u6839\u636e\u8c03\u7528\u8c03\u7528\u94fe\u53ef\u77e5\u6700\u540e\u5c06\u8c03\u7528AbstractNioChannel\u7684doBeginRead\u65b9\u6cd5\uff0c\u5176\u4e2d\u7684readInterestOp\u5c31\u662f\u4e4b\u524d\u7684SelectionKey.OP_ACCEPT\u7684\u503c\uff0c\u53c8\u56de\u5230\u4e86Java NIO\u7684API\uff0c\u901a\u8fc7selectionKey .interestOps()\u6ce8\u518c\u4e00\u4e2aACCEPT\u4e8b\u4ef6\u3002\u5230\u8fd9\u91cc\u6574\u4e2a ServerBootstrap.bind \u7684\u903b\u8f91\u5c31\u5b8c\u6210\u4e86\uff0c\u63a5\u53d7\u8fde\u63a5\u8bf7\u6c42\u7684\u7ba1\u9053\u4e5f\u521d\u59cb\u5316\u548c\u521b\u5efa\u4e86\u3002","title":"\u5c06NioServerSocketChannel\u6ce8\u518c\u5230EventLoop"},{"location":"Others/Netty NIO\u7b14\u8bb0/#io","text":"\u8981\u5f00\u59cb\u505a\u4ea4\u63a5\u5de5\u4f5c\u4e86\uff0c\u540e\u7eed\u6709\u65f6\u95f4\u5728\u628a\u8fd9\u8fb9\u7684\u5206\u6790\u8865\u4e0a\u3002 <====To be continue...","title":"IO\u8bfb\u5199\u7ba1\u9053\u7684\u521b\u5efa\u548c\u6570\u636e\u7684\u51fa\u7ad9\u5165\u7ad9"},{"location":"Others/Netty NIO\u7b14\u8bb0/#ref","text":"https://blog.csdn.net/u013857458/article/details/82527722 https://blog.csdn.net/dk243553650/article/details/83062573","title":"Ref"},{"location":"Others/\u6570\u5b57\u8bc1\u4e66\u539f\u7406/","text":"SSL/TLS\u534f\u8bae TLS\uff08Transport Layer Security\uff0c\u4f20\u8f93\u5c42\u5b89\u5168\u534f\u8bae\uff09\uff0c\u53ca\u5176\u524d\u8eabSSL\uff08Secure Sockets Layer\uff0c\u5b89\u5168\u5957\u63a5\u5c42\uff09\u662f\u4e00\u79cd\u5b89\u5168\u534f\u8bae\uff0c\u76ee\u7684\u662f\u4e3a\u4e92\u8054\u7f51\u901a\u4fe1\u63d0\u4f9b\u5b89\u5168\u53ca\u6570\u636e\u5b8c\u6574\u6027\u4fdd\u969c\u3002 TLS\u534f\u8bae\u7684\u4f18\u52bf\u662f\u4e0e\u9ad8\u5c42\u7684\u5e94\u7528\u5c42\u534f\u8bae\uff08\u5982HTTP\u3001FTP\u3001Telnet\u7b49\uff09\u65e0\u8026\u5408\u3002\u5e94\u7528\u5c42\u534f\u8bae\u80fd\u900f\u660e\u5730\u8fd0\u884c\u5728TLS\u534f\u8bae\u4e4b\u4e0a\uff0c\u7531TLS\u534f\u8bae\u8fdb\u884c\u521b\u5efa\u52a0\u5bc6\u901a\u9053\u9700\u8981\u7684\u534f\u5546\u548c\u8ba4\u8bc1\u3002\u5e94\u7528\u5c42\u534f\u8bae\u4f20\u9001\u7684\u6570\u636e\u5728\u901a\u8fc7TLS\u534f\u8bae\u65f6\u90fd\u4f1a\u88ab\u52a0\u5bc6\uff0c\u4ece\u800c\u4fdd\u8bc1\u901a\u4fe1\u7684\u79c1\u5bc6\u6027\u3002 TLS\u534f\u8bae\u662f\u53ef\u9009\u7684\uff0c\u5fc5\u987b\u914d\u7f6e\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u624d\u80fd\u4f7f\u7528\u3002\u4e3b\u8981\u6709\u4e24\u79cd\u65b9\u5f0f\u5b9e\u73b0\u8fd9\u4e00\u76ee\u6807\uff1a\u4e00\u4e2a\u662f\u4f7f\u7528\u7edf\u4e00\u7684TLS\u534f\u8bae\u901a\u4fe1\u7aef\u53e3\uff08\u4f8b\u5982\uff1a\u7528\u4e8eHTTPS\u7684\u7aef\u53e3443\uff09\uff1b\u53e6\u4e00\u4e2a\u662f\u5ba2\u6237\u7aef\u8bf7\u6c42\u670d\u52a1\u5668\u8fde\u63a5\u5230TLS\u65f6\u4f7f\u7528\u7279\u5b9a\u7684\u534f\u8bae\u673a\u5236\uff08\u4f8b\u5982\uff1a\u90ae\u4ef6\u3001\u65b0\u95fb\u534f\u8bae\u548cSTARTTLS\uff09\u3002\u4e00\u65e6\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u90fd\u540c\u610f\u4f7f\u7528TLS\u534f\u8bae\uff0c\u4ed6\u4eec\u901a\u8fc7\u4f7f\u7528\u4e00\u4e2a\u63e1\u624b\u8fc7\u7a0b\u534f\u5546\u51fa\u4e00\u4e2a\u6709\u72b6\u6001\u7684\u8fde\u63a5\u4ee5\u4f20\u8f93\u6570\u636e\u3002 TLS\u534f\u8bae\u4f7f\u7528\u4ee5\u4e0b\u4e09\u79cd\u673a\u5236\u4e3a\u4fe1\u606f\u901a\u4fe1\u63d0\u4f9b\u5b89\u5168\u4f20\u8f93\uff1a 1\u3001\u9690\u79d8\u6027\uff0c\u6240\u6709\u901a\u4fe1\u90fd\u901a\u8fc7\u52a0\u5bc6\u540e\u8fdb\u884c\u4f20\u64ad 2\u3001\u8eab\u4efd\u8ba4\u8bc1\uff0c\u901a\u8fc7\u8bc1\u4e66\u8fdb\u884c\u8ba4\u8bc1 3\u3001\u53ef\u9760\u6027\uff0c\u901a\u8fc7\u6821\u9a8c\u6570\u636e\u5b8c\u6574\u6027\u7ef4\u62a4\u4e00\u4e2a\u53ef\u9760\u7684\u5b89\u5168\u8fde\u63a5 TLS\u534f\u8bae\u7684\u5de5\u4f5c\u673a\u5236 TLS\u534f\u8bae\u7531TLS Record Layer\uff08TLS \u8bb0\u5f55\u534f\u8bae\uff09\u548cTLS handshake protocol\uff08TLS\u63e1\u624b\u534f\u8bae\uff09\u4e24\u4e2a\u90e8\u5206\u7ec4\u6210\u3002 TLS Record Layer \u4e3a\u6bcf\u6761\u4fe1\u606f\u63d0\u4f9b\u4e00\u4e2aheader\u548c\u5728\u5c3e\u90e8\u751f\u6210\u4e00\u4e2a\u4eceMessage Authentication Code (MAC) \u5f97\u5230\u7684hash\u503c\uff0c\u5176\u4e2dheader\u75315 bytes\u7ec4\u6210\uff0c\u5206\u522b\u662f\u534f\u8bae\u8bf4\u660e(1bytes),\u534f\u8bae\u7248\u672c(2bytes)\u548c\u957f\u5ea6(2bytes)\uff0c\u8ddf\u5728header\u540e\u9762\u7684\u534f\u8bae\u4fe1\u606f\u957f\u5ea6\u4e0d\u5f97\u8d85\u8fc716384bytes\u3002 TLS handshake protocol \u901a\u8fc7\u63e1\u624b\u534f\u8bae\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u534f\u5546\u5404\u79cd\u53c2\u6570\u7528\u4e8e\u521b\u5efa\u5b89\u5168\u8fde\u63a5\uff0c\u4e3b\u8981\u6b65\u9aa4\u5982\u4e0b\uff1a TLS\u534f\u8bae\u63e1\u624b\u534f\u8bae\u9996\u5148\uff0c\u8fd8\u662f\u8981\u7ecf\u8fc7TCP\u4e09\u6b21\u63e1\u624b\u5efa\u7acb\u8fde\u63a5\uff0c\u7136\u540e\u624d\u662fTLS\u63e1\u624b\u7684\u5f00\u59cb\uff1a \u9996\u5148\u8fd8\u662f\u8981\u7ecf\u8fc7TCP\u4e09\u6b21\u63e1\u624b\u5efa\u7acb\u8fde\u63a5\uff0c\u7136\u540e\u624d\u662fTLS\u63e1\u624b\u7684\u5f00\u59cb\uff1a ClientHello\uff1aClient\u7aef\u5c06\u81ea\u5df1\u7684TLS\u534f\u8bae\u7248\u672c\uff0c\u52a0\u5bc6\u5957\u4ef6\uff0c\u538b\u7f29\u65b9\u6cd5\uff0c\u968f\u673a\u6570\uff0cSessionID(\u672a\u586b\u5145)\u53d1\u9001\u7ed9Server\u7aef ServerHello\uff1aServer\u7aef\u5c06\u9009\u62e9\u540e\u7684SSL\u534f\u8bae\u7248\u672c\uff0c\u538b\u7f29\u7b97\u6cd5\uff0c\u5bc6\u7801\u5957\u4ef6\uff0c\u586b\u5145SessionID\uff0c\u751f\u6210\u7684\u968f\u673a\u6570\u7b49\u4fe1\u606f\u53d1\u9001\u7ed9Client\u7aef ServerCertificates\uff1aServer\u7aef\u5c06\u81ea\u5df1\u7684\u6570\u5b57\u8bc1\u4e66(\u5305\u542b\u516c\u94a5)\uff0c\u53d1\u9001\u7ed9Client\u7aef\u3002(\u8bc1\u4e66\u9700\u8981\u4ece\u6570\u5b57\u8bc1\u4e66\u8ba4\u8bc1\u673a\u6784(CA)\u7533\u8bf7\uff0c\u8bc1\u4e66\u662f\u5bf9\u4e8e\u670d\u52a1\u7aef\u7684\u4e00\u79cd\u8ba4\u8bc1)\uff0c\u82e5\u8981\u8fdb\u884c\u66f4\u4e3a\u5b89\u5168\u7684\u6570\u636e\u901a\u4fe1\uff0cServer\u7aef\u8fd8\u53ef\u4ee5\u5411Client\u7aef\u53d1\u9001Cerficate Request\u6765\u8981\u53bb\u5ba2\u6237\u7aef\u53d1\u9001\u5bf9\u65b9\u7684\u8bc1\u4e66\u8fdb\u884c\u5408\u6cd5\u6027\u7684\u8ba4\u8bc1\u3002 ServerHelloDone\uff1a\u5f53\u5b8c\u6210ServerHello\u540e\uff0cServer\u7aef\u4f1a\u53d1\u9001Server Hello Done\u7684\u6d88\u606f\u7ed9\u5ba2\u6237\u7aef\uff0c\u8868\u793aServerHello \u7ed3\u675f\u4e86\u3002 ClientKeyExchage\uff1a\u5f53Client\u7aef\u6536\u5230Server\u7aef\u7684\u8bc1\u4e66\u7b49\u4fe1\u606f\u540e\uff0c\u4f1a\u5148\u5bf9\u670d\u52a1\u7aef\u7684\u8bc1\u4e66\u8fdb\u884c\u68c0\u67e5\uff0c\u68c0\u67e5\u8bc1\u4e66\u7684\u5b8c\u6574\u6027\u4ee5\u53ca\u8bc1\u4e66\u8ddf\u670d\u52a1\u7aef\u57df\u540d\u662f\u5426\u543b\u5408\uff0c\u7136\u540e\u4f7f\u7528\u52a0\u5bc6\u7b97\u6cd5\u751f\u6210\u4e00\u4e2aPreMaster Secret\uff0c\u5e76\u901a\u8fc7Server\u7aef\u7684\u516c\u94a5\u8fdb\u884c\u52a0\u5bc6\uff0c\u7136\u540e\u53d1\u9001\u7ed9Server\u7aef\u3002 ClientFinishd\uff1aClient\u7aef\u4f1a\u53d1\u9001\u4e00\u4e2aChangeCipherSpec(\u4e00\u79cd\u534f\u8bae\uff0c\u6570\u636e\u53ea\u6709\u4e00\u5b57\u8282)\uff0c\u7528\u4e8e\u544a\u77e5Server\u7aef\u5df2\u7ecf\u5207\u6362\u5230\u4e4b\u524d\u534f\u5546\u597d\u7684\u52a0\u5bc6\u5957\u4ef6\u7684\u72b6\u6001\uff0c\u51c6\u5907\u4f7f\u7528\u4e4b\u524d\u534f\u5546\u597d\u7684\u52a0\u5bc6\u5957\u4ef6\u52a0\u5bc6\u6570\u636e\u5e76\u8fdb\u884c\u4f20\u8f93\u4e86\u3002\u7136\u540e\u4f7f\u7528Master Secret(\u901a\u8fc7\u4e24\u4e2a\u968f\u673a\u6570\u3001PreMaster Secret\u548c\u52a0\u5bc6\u7b97\u6cd5\u8ba1\u7b97\u5f97\u51fa)\u52a0\u5bc6\u4e00\u6bb5Finish\u7684\u6570\u636e\u4f20\u9001\u7ed9\u670d\u52a1\u7aef\uff0c\u6b64\u6570\u636e\u662f\u4e3a\u4e86\u5728\u6b63\u5f0f\u4f20\u8f93\u5e94\u7528\u6570\u636e\u4e4b\u524d\u5bf9\u521a\u521a\u63e1\u624b\u5efa\u7acb\u8d77\u6765\u7684\u52a0\u89e3\u5bc6\u901a\u9053\u8fdb\u884c\u9a8c\u8bc1\u3002 Server Finishd\uff1aSever\u7aef\u5728\u63a5\u6536\u5230Client\u7aef\u4f20\u8fc7\u6765\u7684\u52a0\u5bc6\u6570\u636e\u540e\uff0c\u4f7f\u7528\u79c1\u94a5\u5bf9\u8fd9\u6bb5\u52a0\u5bc6\u6570\u636e\u8fdb\u884c\u89e3\u5bc6\uff0c\u5e76\u5bf9\u6570\u636e\u8fdb\u884c\u9a8c\u8bc1\uff0c\u7136\u540e\u4f1a\u7ed9\u5ba2\u6237\u7aef\u53d1\u9001\u4e00\u4e2aChangeCipherSpec\uff0c\u544a\u77e5\u5ba2\u6237\u7aef\u5df2\u7ecf\u5207\u6362\u5230\u534f\u5546\u8fc7\u7684\u52a0\u5bc6\u5957\u4ef6\u72b6\u6001\uff0c\u51c6\u5907\u4f7f\u7528\u52a0\u5bc6\u5957\u4ef6\u52a0\u5bc6\u6570\u636e\u5e76\u4f20\u8f93\u4e86\u3002\u4e4b\u540e\uff0c\u670d\u52a1\u7aef\u4e5f\u4f1a\u4f7f\u7528Master Secret\u52a0\u5bc6\u4e00\u6bb5Finish\u6d88\u606f\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef\uff0c\u4ee5\u9a8c\u8bc1\u4e4b\u524d\u901a\u8fc7\u63e1\u624b\u5efa\u7acb\u8d77\u6765\u7684\u52a0\u89e3\u5bc6\u901a\u9053\u662f\u5426\u6210\u529f\u3002 \u6839\u636e\u4e4b\u524d\u7684\u63e1\u624b\u4fe1\u606f\uff0c\u5982\u679c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u90fd\u80fd\u5bf9Finish\u4fe1\u606f\u8fdb\u884c\u6b63\u5e38\u52a0\u89e3\u5bc6\u4e14\u6d88\u606f\u6b63\u786e\u7684\u88ab\u9a8c\u8bc1\uff0c\u5219\u8bf4\u660e\u63e1\u624b\u901a\u9053\u5df2\u7ecf\u5efa\u7acb\u6210\u529f\u3002 \u63a5\u4e0b\u6765\uff0c\u53cc\u65b9\u6240\u6709\u7684\u901a\u4fe1\u6570\u636e\u90fd\u901a\u8fc7Master Secret\u8fdb\u884c\u52a0\u5bc6\u540e\u4f20\u8f93\u3002\u3000\u3000\u3000\u3000 \u8bc1\u4e66\u7684\u4e3b\u8981\u5185\u5bb9 \u25c6Issuer (\u8bc1\u4e66\u7684\u53d1\u5e03\u673a\u6784) \u6307\u51fa\u662f\u4ec0\u4e48\u673a\u6784\u9881\u53d1\u7684\u8fd9\u4e2a\u8bc1\u4e66\uff0c\u4e5f\u5c31\u662f\u6307\u660e\u8fd9\u4e2a\u8bc1\u4e66\u662f\u54ea\u4e2a\u516c\u53f8\u521b\u5efa\u7684(\u53ea\u662f\u521b\u5efa\u8bc1\u4e66\uff0c\u4e0d\u662f\u6307\u8bc1\u4e66\u7684\u4f7f\u7528\u8005)\u3002 \u25c6Start date , Expire date (\u8bc1\u4e66\u7684\u6709\u6548\u671f) \u4e5f\u5c31\u662f\u8bc1\u4e66\u7684\u6709\u6548\u65f6\u95f4\uff0c\u6216\u8005\u8bf4\u8bc1\u4e66\u7684\u4f7f\u7528\u671f\u9650\u3002 \u8fc7\u4e86\u6709\u6548\u671f\u9650\uff0c\u8bc1\u4e66\u5c31\u4f1a\u4f5c\u5e9f\uff0c\u4e0d\u80fd\u4f7f\u7528\u4e86\u3002 \u25c6Public key (\u516c\u94a5) \u7528\u6765\u52a0\u89e3\u5bc6\u4fe1\u606f\u3002 \u25c6Subject (\u4e3b\u9898) \u8fd9\u4e2a\u8bc1\u4e66\u662f\u53d1\u5e03\u7ed9\u8c01\u7684\uff0c\u6216\u8005\u8bf4\u8bc1\u4e66\u7684\u6240\u6709\u8005\uff0c\u4e00\u822c\u662f\u67d0\u4e2a\u4eba\u6216\u8005\u67d0\u4e2a\u516c\u53f8\u540d\u79f0\u3001\u673a\u6784\u7684\u540d\u79f0\u3001\u516c\u53f8\u7f51\u7ad9\u7684\u7f51\u5740\u7b49\u3002 \u25c6Signature algorithm (\u7b7e\u540d\u6240\u4f7f\u7528\u7684\u7b97\u6cd5) \u5c31\u662f\u6307\u7684\u8fd9\u4e2a\u6570\u5b57\u8bc1\u4e66\u7684\u6570\u5b57\u7b7e\u540d\u6240\u4f7f\u7528\u7684\u52a0\u5bc6\u7b97\u6cd5\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4f7f\u7528\u8bc1\u4e66\u53d1\u5e03\u673a\u6784\u7684\u8bc1\u4e66\u91cc\u9762\u7684\u516c\u94a5\uff0c\u6839\u636e\u8fd9\u4e2a\u7b97\u6cd5\u5bf9\u6307\u7eb9\u8fdb\u884c\u89e3\u5bc6\u3002\u6307\u7eb9\u7684\u52a0\u5bc6\u7ed3\u679c\u5c31\u662f\u6570\u5b57\u7b7e\u540d\u3002 \u25c6Thumbprint, Thumbprint algorithm (\u6307\u7eb9\u4ee5\u53ca\u6307\u7eb9\u7b97\u6cd5) \u8fd9\u4e2a\u662f\u7528\u6765\u4fdd\u8bc1\u8bc1\u4e66\u7684\u5b8c\u6574\u6027\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u786e\u4fdd\u8bc1\u4e66\u6ca1\u6709\u88ab\u4fee\u6539\u8fc7\u3002 \u5176\u539f\u7406\u5c31\u662f\u5728\u53d1\u5e03\u8bc1\u4e66\u65f6\uff0c\u53d1\u5e03\u8005\u6839\u636e\u6307\u7eb9\u7b97\u6cd5(\u4e00\u4e2ahash\u7b97\u6cd5)\u8ba1\u7b97 \u8bc1\u4e66\u5185\u5bb9 \u7684hash\u503c(\u6307\u7eb9)\u5e76\u548c\u8bc1\u4e66\u653e\u5728\u4e00\u8d77\uff0c\u4f7f\u7528\u8005\u5728\u6253\u5f00\u8bc1\u4e66\u65f6\uff0c\u81ea\u5df1\u4e5f\u6839\u636e\u6307\u7eb9\u7b97\u6cd5\u8ba1\u7b97\u4e00\u4e0b\u8bc1\u4e66\u7684hash\u503c(\u6307\u7eb9)\uff0c\u5982\u679c\u548c\u521a\u5f00\u59cb\u7684\u503c\u5bf9\u5f97\u4e0a\uff0c\u5c31\u8bf4\u660e\u8bc1\u4e66\u6ca1\u6709\u88ab\u4fee\u6539\u8fc7\uff0c\u56e0\u4e3a\u8bc1\u4e66\u7684\u5185\u5bb9\u88ab\u4fee\u6539\u540e\uff0c\u6839\u636e\u8bc1\u4e66\u7684\u5185\u5bb9\u8ba1\u7b97\u7684\u51fa\u7684hash\u503c(\u6307\u7eb9)\u662f\u4f1a\u53d8\u5316\u7684\u3002 \u6ce8\u610f\uff0c\u8fd9\u4e2a\u6307\u7eb9\u4f1a\u4f7f\u7528\u8fd9\u4e2a\u8bc1\u4e66\u673a\u6784\u7684\u79c1\u94a5\u7528\u7b7e\u540d\u7b97\u6cd5(Signature algorithm)\u52a0\u5bc6\u540e\u548c\u8bc1\u4e66\u653e\u5728\u4e00\u8d77\u3002 \u8bc1\u4e66\u7684\u5185\u5bb9\u5927\u81f4\u5982\u4e0b\uff1a -----BEGIN CERTIFICATE----- subject: CN=localhost.localdomain,O=localdomain,C=CN start date: Jul 24 15:46:10 2019 GMT expire date: Jun 28 15:46:10 2024 GMT common name: localhost.localdomain issuer: CN=localhost.localdomain.87263,O=localdomain,C=CN public key: xxxxxxxxxxxxxx\uff08\u5f88\u957f\u4e00\u4e32\uff09#CA\u4f1a\u628apublic key\u5bf9\u5e94\u7684private key\u4ea4\u7ed9Server #{}\u4e2d\u7684\u5185\u5bb9\u662f\u4f7f\u7528CA\u673a\u6784\u7684\u79c1\u94a5\u8fdb\u884c\u52a0\u5bc6\u5f97\u5230\uff0c\u9700\u8981\u4f7f\u7528\u5bf9\u5e94\u7684\u516c\u94a5\u8fdb\u884c\u89e3\u5bc6 { \u8bc1\u4e66\u6307\u7eb9:\u5bf9\u8bc1\u4e66\u7684\u6240\u6709\u5185\u5bb9\uff08content\uff09\u4f7f\u7528hash\u7b97\u6cd5\u8ba1\u7b97\u5f97\u5230 \u6307\u7eb9\u7b97\u6cd5:\u6307\u51fa\u8ba1\u7b97\u6307\u7eb9\u7684hash\u7b97\u6cd5 } -----END CERTIFICATE----- \u4ece\u4e0a\u9762\u7684\u8bc1\u4e66\u53ef\u4ee5\u770b\u51fa\uff0c\u8981\u9a8c\u8bc1\u670d\u52a1\u5668\u8bc1\u4e66\u7684\u5408\u6cd5\u6027\u5c31\u5fc5\u987b\u62e5\u6709CA\u673a\u6784\u7684\u516c\u94a5\uff0c\u90a3\u4e48CA\u673a\u6784\u7684\u4e00\u5b9a\u5b58\u5728\u81ea\u5df1\u7684\u8bc1\u4e66\uff0c\u6240\u4ee5\u5728\u9a8c\u8bc1\u670d\u52a1\u5668\u8bc1\u4e66\u7684\u5408\u6cd5\u6027\u65f6\u9700\u8981\u4f7f\u7528SSL\u8bf7\u6c42\u7684\u5ba2\u6237\u7aef\u62e5\u6709CA\u673a\u6784\u8bc1\u4e66\u3002 \u5bf9\u7b49\u8bc1\u4e66\u6821\u9a8c \uff08client\u786e\u8ba4server\u7684\u5408\u6cd5\u6027\uff09 HTTPS\u534f\u8bae\u4f7f\u7528\u7684\u5bf9\u7b49\u8bc1\u4e66\u6821\u9a8c\u7684\u65b9\u5f0f\uff0c\u5373Client\u901a\u8fc7\u4fe1\u4efb\u7684\u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff08CA\uff09\u9881\u53d1\u7684\u8bc1\u4e66\u6765\u786e\u8ba4\u670d\u52a1\u7aef\u53d1\u9001\u8fc7\u6765\u8bc1\u4e66\u7684\u6709\u6548\u6027\u3002 \u5728curl\u547d\u4ee4\u884c\u5de5\u5177\u4e2d\u53ef\u4ee5\u4f7f\u7528--cacert\u53c2\u6570\u6765\u6307\u5b9a\u8bc1\u4e66\u6587\u4ef6\u7684\u4f4d\u7f6e\u3002 \u6821\u9a8c\u670d\u52a1\u5668\u8bc1\u4e66\u7684\u5177\u4f53\u8fc7\u7a0b\uff1a \uff081\uff09\u5ba2\u6237\u7aef\u8bfb\u53d6\u8bc1\u4e66\u4e2d\u7684Issuer(\u53d1\u5e03\u673a\u6784)\uff0c\u7136\u540e\u5728\u5ba2\u6237\u7aef\u53d7\u4fe1\u4efb\u7684\u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff08CA\uff09\u7684\u8bc1\u4e66\u4e2d\u5bfb\u627e\u5bf9\u5e94\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u7684\u8bc1\u4e66\uff0c\u7528\u4e8e\u6821\u9a8c\u8bc1\u4e66\u662f\u5426\u4e3a\u4fe1\u4efb\u7684\u9881\u53d1\u673a\u6784\u9881\u53d1\u7684\u3002 \uff082\uff09\u5982\u679c\u627e\u4e0d\u5230\u8be5\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u7684\u8bc1\u4e66\uff0c\u5ba2\u6237\u7aef\u5c31\u4f1a\u62a5\u9519\uff0c\u8bf4\u660e\u670d\u52a1\u5668\u53d1\u6765\u7684\u8bc1\u4e66\u662f\u4e0d\u53ef\u4fe1\u4efb\u7684\u3002 \uff083\uff09\u5982\u679c\u627e\u5230\u9881\u53d1\u673a\u6784\u7684\u8bc1\u4e66\uff0c\u90a3\u4e48\u5ba2\u6237\u7aef\u5c31\u4f1a\u4ece\u5bf9\u5e94\u7684\u8bc1\u4e66\u4e2d\u83b7\u5f97\u7684\u516c\u94a5\uff0c\u7136\u540e\u4f7f\u7528\u516c\u94a5\u89e3\u5bc6\u88ab\u52a0\u5bc6\u7684\u8bc1\u4e66\u6307\u7eb9\u4ee5\u53ca\u6307\u7eb9\u7b97\u6cd5 \uff084\uff09\u5ba2\u6237\u7aef\u4f7f\u7528 \u89e3\u5bc6\u83b7\u5f97\u7684\u6307\u7eb9\u52a0\u5bc6\u7b97\u6cd5 \u8ba1\u7b97\u51fa\u670d\u52a1\u5668\u53d1\u6765\u7684\u8bc1\u4e66\u7684\u6307\u7eb9\uff0c\u5c06\u8ba1\u7b97\u7ed3\u679c\u4e0e \u89e3\u5bc6\u83b7\u5f97\u7684\u8bc1\u4e66\u6307\u7eb9 \u5bf9\u6bd4\uff0c\u5982\u679c\u4e00\u81f4\uff0c\u8bf4\u660e\u670d\u52a1\u5668\u53d1\u6765\u7684\u8bc1\u4e66\u80af\u5b9a\u6ca1\u6709\u88ab\u4fee\u6539\u8fc7\uff0c\u5e76\u4e14\u8bc1\u4e66\u662f\u53d7\u4fe1\u4efb\u7684\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u53d1\u5e03\u7684 \uff085\uff09\u6b64\u65f6\u5ba2\u6237\u7aef\u5c31\u53ef\u4ee5\u8bfb\u53d6\u8bc1\u4e66\u4e2d\u7684\u516c\u94a5\uff0c\u7528\u4e8e\u540e\u7eed\u52a0\u5bc6\u4e86 \u975e\u5bf9\u7b49\u8bc1\u4e66\u6821\u9a8c \uff08\u4e0d\u9a8c\u8bc1server\u7684\u5408\u6cd5\u6027\uff09 \u8df3\u8fc7\u6821\u9a8c\u670d\u52a1\u5668\u8bc1\u4e66\u5408\u6cd5\u6027\u7684\u6b65\u9aa4\uff0c\u5e76\u76f4\u63a5\u4f7f\u7528\u670d\u52a1\u5668\u53d1\u9001\u7684\u8bc1\u4e66\u4e2d\u7684\u516c\u94a5\u52a0\u5bc6\u76f8\u5e94\u7684\u5185\u5bb9\u3002\u5728curl\u547d\u4ee4\u884c\u5de5\u5177\u4e2d\u53ef\u4ee5\u4f7f\u7528-k/--insecure\u53c2\u6570\u6765\u8df3\u8fc7\u8bc1\u4e66\u6821\u9a8c\u3002 \u53c2\u8003 \u200b https://www.cnblogs.com/JeffreySun/archive/2010/06/24/1627247.html \u200b https://www.cnblogs.com/codecc/p/5192023.html \u200b https://blog.csdn.net/chengqiuming/article/details/83115642 \u200b https://xz.aliyun.com/t/2531#toc-0","title":"\u6570\u5b57\u8bc1\u4e66\u539f\u7406"},{"location":"Others/\u6570\u5b57\u8bc1\u4e66\u539f\u7406/#ssltls","text":"TLS\uff08Transport Layer Security\uff0c\u4f20\u8f93\u5c42\u5b89\u5168\u534f\u8bae\uff09\uff0c\u53ca\u5176\u524d\u8eabSSL\uff08Secure Sockets Layer\uff0c\u5b89\u5168\u5957\u63a5\u5c42\uff09\u662f\u4e00\u79cd\u5b89\u5168\u534f\u8bae\uff0c\u76ee\u7684\u662f\u4e3a\u4e92\u8054\u7f51\u901a\u4fe1\u63d0\u4f9b\u5b89\u5168\u53ca\u6570\u636e\u5b8c\u6574\u6027\u4fdd\u969c\u3002 TLS\u534f\u8bae\u7684\u4f18\u52bf\u662f\u4e0e\u9ad8\u5c42\u7684\u5e94\u7528\u5c42\u534f\u8bae\uff08\u5982HTTP\u3001FTP\u3001Telnet\u7b49\uff09\u65e0\u8026\u5408\u3002\u5e94\u7528\u5c42\u534f\u8bae\u80fd\u900f\u660e\u5730\u8fd0\u884c\u5728TLS\u534f\u8bae\u4e4b\u4e0a\uff0c\u7531TLS\u534f\u8bae\u8fdb\u884c\u521b\u5efa\u52a0\u5bc6\u901a\u9053\u9700\u8981\u7684\u534f\u5546\u548c\u8ba4\u8bc1\u3002\u5e94\u7528\u5c42\u534f\u8bae\u4f20\u9001\u7684\u6570\u636e\u5728\u901a\u8fc7TLS\u534f\u8bae\u65f6\u90fd\u4f1a\u88ab\u52a0\u5bc6\uff0c\u4ece\u800c\u4fdd\u8bc1\u901a\u4fe1\u7684\u79c1\u5bc6\u6027\u3002 TLS\u534f\u8bae\u662f\u53ef\u9009\u7684\uff0c\u5fc5\u987b\u914d\u7f6e\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u624d\u80fd\u4f7f\u7528\u3002\u4e3b\u8981\u6709\u4e24\u79cd\u65b9\u5f0f\u5b9e\u73b0\u8fd9\u4e00\u76ee\u6807\uff1a\u4e00\u4e2a\u662f\u4f7f\u7528\u7edf\u4e00\u7684TLS\u534f\u8bae\u901a\u4fe1\u7aef\u53e3\uff08\u4f8b\u5982\uff1a\u7528\u4e8eHTTPS\u7684\u7aef\u53e3443\uff09\uff1b\u53e6\u4e00\u4e2a\u662f\u5ba2\u6237\u7aef\u8bf7\u6c42\u670d\u52a1\u5668\u8fde\u63a5\u5230TLS\u65f6\u4f7f\u7528\u7279\u5b9a\u7684\u534f\u8bae\u673a\u5236\uff08\u4f8b\u5982\uff1a\u90ae\u4ef6\u3001\u65b0\u95fb\u534f\u8bae\u548cSTARTTLS\uff09\u3002\u4e00\u65e6\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u90fd\u540c\u610f\u4f7f\u7528TLS\u534f\u8bae\uff0c\u4ed6\u4eec\u901a\u8fc7\u4f7f\u7528\u4e00\u4e2a\u63e1\u624b\u8fc7\u7a0b\u534f\u5546\u51fa\u4e00\u4e2a\u6709\u72b6\u6001\u7684\u8fde\u63a5\u4ee5\u4f20\u8f93\u6570\u636e\u3002 TLS\u534f\u8bae\u4f7f\u7528\u4ee5\u4e0b\u4e09\u79cd\u673a\u5236\u4e3a\u4fe1\u606f\u901a\u4fe1\u63d0\u4f9b\u5b89\u5168\u4f20\u8f93\uff1a 1\u3001\u9690\u79d8\u6027\uff0c\u6240\u6709\u901a\u4fe1\u90fd\u901a\u8fc7\u52a0\u5bc6\u540e\u8fdb\u884c\u4f20\u64ad 2\u3001\u8eab\u4efd\u8ba4\u8bc1\uff0c\u901a\u8fc7\u8bc1\u4e66\u8fdb\u884c\u8ba4\u8bc1 3\u3001\u53ef\u9760\u6027\uff0c\u901a\u8fc7\u6821\u9a8c\u6570\u636e\u5b8c\u6574\u6027\u7ef4\u62a4\u4e00\u4e2a\u53ef\u9760\u7684\u5b89\u5168\u8fde\u63a5","title":"SSL/TLS\u534f\u8bae"},{"location":"Others/\u6570\u5b57\u8bc1\u4e66\u539f\u7406/#tls","text":"TLS\u534f\u8bae\u7531TLS Record Layer\uff08TLS \u8bb0\u5f55\u534f\u8bae\uff09\u548cTLS handshake protocol\uff08TLS\u63e1\u624b\u534f\u8bae\uff09\u4e24\u4e2a\u90e8\u5206\u7ec4\u6210\u3002","title":"TLS\u534f\u8bae\u7684\u5de5\u4f5c\u673a\u5236"},{"location":"Others/\u6570\u5b57\u8bc1\u4e66\u539f\u7406/#tls-record-layer","text":"\u4e3a\u6bcf\u6761\u4fe1\u606f\u63d0\u4f9b\u4e00\u4e2aheader\u548c\u5728\u5c3e\u90e8\u751f\u6210\u4e00\u4e2a\u4eceMessage Authentication Code (MAC) \u5f97\u5230\u7684hash\u503c\uff0c\u5176\u4e2dheader\u75315 bytes\u7ec4\u6210\uff0c\u5206\u522b\u662f\u534f\u8bae\u8bf4\u660e(1bytes),\u534f\u8bae\u7248\u672c(2bytes)\u548c\u957f\u5ea6(2bytes)\uff0c\u8ddf\u5728header\u540e\u9762\u7684\u534f\u8bae\u4fe1\u606f\u957f\u5ea6\u4e0d\u5f97\u8d85\u8fc716384bytes\u3002","title":"TLS Record Layer"},{"location":"Others/\u6570\u5b57\u8bc1\u4e66\u539f\u7406/#tls-handshake-protocol","text":"\u901a\u8fc7\u63e1\u624b\u534f\u8bae\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u534f\u5546\u5404\u79cd\u53c2\u6570\u7528\u4e8e\u521b\u5efa\u5b89\u5168\u8fde\u63a5\uff0c\u4e3b\u8981\u6b65\u9aa4\u5982\u4e0b\uff1a TLS\u534f\u8bae\u63e1\u624b\u534f\u8bae\u9996\u5148\uff0c\u8fd8\u662f\u8981\u7ecf\u8fc7TCP\u4e09\u6b21\u63e1\u624b\u5efa\u7acb\u8fde\u63a5\uff0c\u7136\u540e\u624d\u662fTLS\u63e1\u624b\u7684\u5f00\u59cb\uff1a \u9996\u5148\u8fd8\u662f\u8981\u7ecf\u8fc7TCP\u4e09\u6b21\u63e1\u624b\u5efa\u7acb\u8fde\u63a5\uff0c\u7136\u540e\u624d\u662fTLS\u63e1\u624b\u7684\u5f00\u59cb\uff1a ClientHello\uff1aClient\u7aef\u5c06\u81ea\u5df1\u7684TLS\u534f\u8bae\u7248\u672c\uff0c\u52a0\u5bc6\u5957\u4ef6\uff0c\u538b\u7f29\u65b9\u6cd5\uff0c\u968f\u673a\u6570\uff0cSessionID(\u672a\u586b\u5145)\u53d1\u9001\u7ed9Server\u7aef ServerHello\uff1aServer\u7aef\u5c06\u9009\u62e9\u540e\u7684SSL\u534f\u8bae\u7248\u672c\uff0c\u538b\u7f29\u7b97\u6cd5\uff0c\u5bc6\u7801\u5957\u4ef6\uff0c\u586b\u5145SessionID\uff0c\u751f\u6210\u7684\u968f\u673a\u6570\u7b49\u4fe1\u606f\u53d1\u9001\u7ed9Client\u7aef ServerCertificates\uff1aServer\u7aef\u5c06\u81ea\u5df1\u7684\u6570\u5b57\u8bc1\u4e66(\u5305\u542b\u516c\u94a5)\uff0c\u53d1\u9001\u7ed9Client\u7aef\u3002(\u8bc1\u4e66\u9700\u8981\u4ece\u6570\u5b57\u8bc1\u4e66\u8ba4\u8bc1\u673a\u6784(CA)\u7533\u8bf7\uff0c\u8bc1\u4e66\u662f\u5bf9\u4e8e\u670d\u52a1\u7aef\u7684\u4e00\u79cd\u8ba4\u8bc1)\uff0c\u82e5\u8981\u8fdb\u884c\u66f4\u4e3a\u5b89\u5168\u7684\u6570\u636e\u901a\u4fe1\uff0cServer\u7aef\u8fd8\u53ef\u4ee5\u5411Client\u7aef\u53d1\u9001Cerficate Request\u6765\u8981\u53bb\u5ba2\u6237\u7aef\u53d1\u9001\u5bf9\u65b9\u7684\u8bc1\u4e66\u8fdb\u884c\u5408\u6cd5\u6027\u7684\u8ba4\u8bc1\u3002 ServerHelloDone\uff1a\u5f53\u5b8c\u6210ServerHello\u540e\uff0cServer\u7aef\u4f1a\u53d1\u9001Server Hello Done\u7684\u6d88\u606f\u7ed9\u5ba2\u6237\u7aef\uff0c\u8868\u793aServerHello \u7ed3\u675f\u4e86\u3002 ClientKeyExchage\uff1a\u5f53Client\u7aef\u6536\u5230Server\u7aef\u7684\u8bc1\u4e66\u7b49\u4fe1\u606f\u540e\uff0c\u4f1a\u5148\u5bf9\u670d\u52a1\u7aef\u7684\u8bc1\u4e66\u8fdb\u884c\u68c0\u67e5\uff0c\u68c0\u67e5\u8bc1\u4e66\u7684\u5b8c\u6574\u6027\u4ee5\u53ca\u8bc1\u4e66\u8ddf\u670d\u52a1\u7aef\u57df\u540d\u662f\u5426\u543b\u5408\uff0c\u7136\u540e\u4f7f\u7528\u52a0\u5bc6\u7b97\u6cd5\u751f\u6210\u4e00\u4e2aPreMaster Secret\uff0c\u5e76\u901a\u8fc7Server\u7aef\u7684\u516c\u94a5\u8fdb\u884c\u52a0\u5bc6\uff0c\u7136\u540e\u53d1\u9001\u7ed9Server\u7aef\u3002 ClientFinishd\uff1aClient\u7aef\u4f1a\u53d1\u9001\u4e00\u4e2aChangeCipherSpec(\u4e00\u79cd\u534f\u8bae\uff0c\u6570\u636e\u53ea\u6709\u4e00\u5b57\u8282)\uff0c\u7528\u4e8e\u544a\u77e5Server\u7aef\u5df2\u7ecf\u5207\u6362\u5230\u4e4b\u524d\u534f\u5546\u597d\u7684\u52a0\u5bc6\u5957\u4ef6\u7684\u72b6\u6001\uff0c\u51c6\u5907\u4f7f\u7528\u4e4b\u524d\u534f\u5546\u597d\u7684\u52a0\u5bc6\u5957\u4ef6\u52a0\u5bc6\u6570\u636e\u5e76\u8fdb\u884c\u4f20\u8f93\u4e86\u3002\u7136\u540e\u4f7f\u7528Master Secret(\u901a\u8fc7\u4e24\u4e2a\u968f\u673a\u6570\u3001PreMaster Secret\u548c\u52a0\u5bc6\u7b97\u6cd5\u8ba1\u7b97\u5f97\u51fa)\u52a0\u5bc6\u4e00\u6bb5Finish\u7684\u6570\u636e\u4f20\u9001\u7ed9\u670d\u52a1\u7aef\uff0c\u6b64\u6570\u636e\u662f\u4e3a\u4e86\u5728\u6b63\u5f0f\u4f20\u8f93\u5e94\u7528\u6570\u636e\u4e4b\u524d\u5bf9\u521a\u521a\u63e1\u624b\u5efa\u7acb\u8d77\u6765\u7684\u52a0\u89e3\u5bc6\u901a\u9053\u8fdb\u884c\u9a8c\u8bc1\u3002 Server Finishd\uff1aSever\u7aef\u5728\u63a5\u6536\u5230Client\u7aef\u4f20\u8fc7\u6765\u7684\u52a0\u5bc6\u6570\u636e\u540e\uff0c\u4f7f\u7528\u79c1\u94a5\u5bf9\u8fd9\u6bb5\u52a0\u5bc6\u6570\u636e\u8fdb\u884c\u89e3\u5bc6\uff0c\u5e76\u5bf9\u6570\u636e\u8fdb\u884c\u9a8c\u8bc1\uff0c\u7136\u540e\u4f1a\u7ed9\u5ba2\u6237\u7aef\u53d1\u9001\u4e00\u4e2aChangeCipherSpec\uff0c\u544a\u77e5\u5ba2\u6237\u7aef\u5df2\u7ecf\u5207\u6362\u5230\u534f\u5546\u8fc7\u7684\u52a0\u5bc6\u5957\u4ef6\u72b6\u6001\uff0c\u51c6\u5907\u4f7f\u7528\u52a0\u5bc6\u5957\u4ef6\u52a0\u5bc6\u6570\u636e\u5e76\u4f20\u8f93\u4e86\u3002\u4e4b\u540e\uff0c\u670d\u52a1\u7aef\u4e5f\u4f1a\u4f7f\u7528Master Secret\u52a0\u5bc6\u4e00\u6bb5Finish\u6d88\u606f\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef\uff0c\u4ee5\u9a8c\u8bc1\u4e4b\u524d\u901a\u8fc7\u63e1\u624b\u5efa\u7acb\u8d77\u6765\u7684\u52a0\u89e3\u5bc6\u901a\u9053\u662f\u5426\u6210\u529f\u3002 \u6839\u636e\u4e4b\u524d\u7684\u63e1\u624b\u4fe1\u606f\uff0c\u5982\u679c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u90fd\u80fd\u5bf9Finish\u4fe1\u606f\u8fdb\u884c\u6b63\u5e38\u52a0\u89e3\u5bc6\u4e14\u6d88\u606f\u6b63\u786e\u7684\u88ab\u9a8c\u8bc1\uff0c\u5219\u8bf4\u660e\u63e1\u624b\u901a\u9053\u5df2\u7ecf\u5efa\u7acb\u6210\u529f\u3002 \u63a5\u4e0b\u6765\uff0c\u53cc\u65b9\u6240\u6709\u7684\u901a\u4fe1\u6570\u636e\u90fd\u901a\u8fc7Master Secret\u8fdb\u884c\u52a0\u5bc6\u540e\u4f20\u8f93\u3002","title":"TLS handshake protocol"},{"location":"Others/\u6570\u5b57\u8bc1\u4e66\u539f\u7406/#_1","text":"\u25c6Issuer (\u8bc1\u4e66\u7684\u53d1\u5e03\u673a\u6784) \u6307\u51fa\u662f\u4ec0\u4e48\u673a\u6784\u9881\u53d1\u7684\u8fd9\u4e2a\u8bc1\u4e66\uff0c\u4e5f\u5c31\u662f\u6307\u660e\u8fd9\u4e2a\u8bc1\u4e66\u662f\u54ea\u4e2a\u516c\u53f8\u521b\u5efa\u7684(\u53ea\u662f\u521b\u5efa\u8bc1\u4e66\uff0c\u4e0d\u662f\u6307\u8bc1\u4e66\u7684\u4f7f\u7528\u8005)\u3002 \u25c6Start date , Expire date (\u8bc1\u4e66\u7684\u6709\u6548\u671f) \u4e5f\u5c31\u662f\u8bc1\u4e66\u7684\u6709\u6548\u65f6\u95f4\uff0c\u6216\u8005\u8bf4\u8bc1\u4e66\u7684\u4f7f\u7528\u671f\u9650\u3002 \u8fc7\u4e86\u6709\u6548\u671f\u9650\uff0c\u8bc1\u4e66\u5c31\u4f1a\u4f5c\u5e9f\uff0c\u4e0d\u80fd\u4f7f\u7528\u4e86\u3002 \u25c6Public key (\u516c\u94a5) \u7528\u6765\u52a0\u89e3\u5bc6\u4fe1\u606f\u3002 \u25c6Subject (\u4e3b\u9898) \u8fd9\u4e2a\u8bc1\u4e66\u662f\u53d1\u5e03\u7ed9\u8c01\u7684\uff0c\u6216\u8005\u8bf4\u8bc1\u4e66\u7684\u6240\u6709\u8005\uff0c\u4e00\u822c\u662f\u67d0\u4e2a\u4eba\u6216\u8005\u67d0\u4e2a\u516c\u53f8\u540d\u79f0\u3001\u673a\u6784\u7684\u540d\u79f0\u3001\u516c\u53f8\u7f51\u7ad9\u7684\u7f51\u5740\u7b49\u3002 \u25c6Signature algorithm (\u7b7e\u540d\u6240\u4f7f\u7528\u7684\u7b97\u6cd5) \u5c31\u662f\u6307\u7684\u8fd9\u4e2a\u6570\u5b57\u8bc1\u4e66\u7684\u6570\u5b57\u7b7e\u540d\u6240\u4f7f\u7528\u7684\u52a0\u5bc6\u7b97\u6cd5\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4f7f\u7528\u8bc1\u4e66\u53d1\u5e03\u673a\u6784\u7684\u8bc1\u4e66\u91cc\u9762\u7684\u516c\u94a5\uff0c\u6839\u636e\u8fd9\u4e2a\u7b97\u6cd5\u5bf9\u6307\u7eb9\u8fdb\u884c\u89e3\u5bc6\u3002\u6307\u7eb9\u7684\u52a0\u5bc6\u7ed3\u679c\u5c31\u662f\u6570\u5b57\u7b7e\u540d\u3002 \u25c6Thumbprint, Thumbprint algorithm (\u6307\u7eb9\u4ee5\u53ca\u6307\u7eb9\u7b97\u6cd5) \u8fd9\u4e2a\u662f\u7528\u6765\u4fdd\u8bc1\u8bc1\u4e66\u7684\u5b8c\u6574\u6027\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u786e\u4fdd\u8bc1\u4e66\u6ca1\u6709\u88ab\u4fee\u6539\u8fc7\u3002 \u5176\u539f\u7406\u5c31\u662f\u5728\u53d1\u5e03\u8bc1\u4e66\u65f6\uff0c\u53d1\u5e03\u8005\u6839\u636e\u6307\u7eb9\u7b97\u6cd5(\u4e00\u4e2ahash\u7b97\u6cd5)\u8ba1\u7b97 \u8bc1\u4e66\u5185\u5bb9 \u7684hash\u503c(\u6307\u7eb9)\u5e76\u548c\u8bc1\u4e66\u653e\u5728\u4e00\u8d77\uff0c\u4f7f\u7528\u8005\u5728\u6253\u5f00\u8bc1\u4e66\u65f6\uff0c\u81ea\u5df1\u4e5f\u6839\u636e\u6307\u7eb9\u7b97\u6cd5\u8ba1\u7b97\u4e00\u4e0b\u8bc1\u4e66\u7684hash\u503c(\u6307\u7eb9)\uff0c\u5982\u679c\u548c\u521a\u5f00\u59cb\u7684\u503c\u5bf9\u5f97\u4e0a\uff0c\u5c31\u8bf4\u660e\u8bc1\u4e66\u6ca1\u6709\u88ab\u4fee\u6539\u8fc7\uff0c\u56e0\u4e3a\u8bc1\u4e66\u7684\u5185\u5bb9\u88ab\u4fee\u6539\u540e\uff0c\u6839\u636e\u8bc1\u4e66\u7684\u5185\u5bb9\u8ba1\u7b97\u7684\u51fa\u7684hash\u503c(\u6307\u7eb9)\u662f\u4f1a\u53d8\u5316\u7684\u3002 \u6ce8\u610f\uff0c\u8fd9\u4e2a\u6307\u7eb9\u4f1a\u4f7f\u7528\u8fd9\u4e2a\u8bc1\u4e66\u673a\u6784\u7684\u79c1\u94a5\u7528\u7b7e\u540d\u7b97\u6cd5(Signature algorithm)\u52a0\u5bc6\u540e\u548c\u8bc1\u4e66\u653e\u5728\u4e00\u8d77\u3002 \u8bc1\u4e66\u7684\u5185\u5bb9\u5927\u81f4\u5982\u4e0b\uff1a -----BEGIN CERTIFICATE----- subject: CN=localhost.localdomain,O=localdomain,C=CN start date: Jul 24 15:46:10 2019 GMT expire date: Jun 28 15:46:10 2024 GMT common name: localhost.localdomain issuer: CN=localhost.localdomain.87263,O=localdomain,C=CN public key: xxxxxxxxxxxxxx\uff08\u5f88\u957f\u4e00\u4e32\uff09#CA\u4f1a\u628apublic key\u5bf9\u5e94\u7684private key\u4ea4\u7ed9Server #{}\u4e2d\u7684\u5185\u5bb9\u662f\u4f7f\u7528CA\u673a\u6784\u7684\u79c1\u94a5\u8fdb\u884c\u52a0\u5bc6\u5f97\u5230\uff0c\u9700\u8981\u4f7f\u7528\u5bf9\u5e94\u7684\u516c\u94a5\u8fdb\u884c\u89e3\u5bc6 { \u8bc1\u4e66\u6307\u7eb9:\u5bf9\u8bc1\u4e66\u7684\u6240\u6709\u5185\u5bb9\uff08content\uff09\u4f7f\u7528hash\u7b97\u6cd5\u8ba1\u7b97\u5f97\u5230 \u6307\u7eb9\u7b97\u6cd5:\u6307\u51fa\u8ba1\u7b97\u6307\u7eb9\u7684hash\u7b97\u6cd5 } -----END CERTIFICATE----- \u4ece\u4e0a\u9762\u7684\u8bc1\u4e66\u53ef\u4ee5\u770b\u51fa\uff0c\u8981\u9a8c\u8bc1\u670d\u52a1\u5668\u8bc1\u4e66\u7684\u5408\u6cd5\u6027\u5c31\u5fc5\u987b\u62e5\u6709CA\u673a\u6784\u7684\u516c\u94a5\uff0c\u90a3\u4e48CA\u673a\u6784\u7684\u4e00\u5b9a\u5b58\u5728\u81ea\u5df1\u7684\u8bc1\u4e66\uff0c\u6240\u4ee5\u5728\u9a8c\u8bc1\u670d\u52a1\u5668\u8bc1\u4e66\u7684\u5408\u6cd5\u6027\u65f6\u9700\u8981\u4f7f\u7528SSL\u8bf7\u6c42\u7684\u5ba2\u6237\u7aef\u62e5\u6709CA\u673a\u6784\u8bc1\u4e66\u3002 \u5bf9\u7b49\u8bc1\u4e66\u6821\u9a8c \uff08client\u786e\u8ba4server\u7684\u5408\u6cd5\u6027\uff09 HTTPS\u534f\u8bae\u4f7f\u7528\u7684\u5bf9\u7b49\u8bc1\u4e66\u6821\u9a8c\u7684\u65b9\u5f0f\uff0c\u5373Client\u901a\u8fc7\u4fe1\u4efb\u7684\u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff08CA\uff09\u9881\u53d1\u7684\u8bc1\u4e66\u6765\u786e\u8ba4\u670d\u52a1\u7aef\u53d1\u9001\u8fc7\u6765\u8bc1\u4e66\u7684\u6709\u6548\u6027\u3002 \u5728curl\u547d\u4ee4\u884c\u5de5\u5177\u4e2d\u53ef\u4ee5\u4f7f\u7528--cacert\u53c2\u6570\u6765\u6307\u5b9a\u8bc1\u4e66\u6587\u4ef6\u7684\u4f4d\u7f6e\u3002 \u6821\u9a8c\u670d\u52a1\u5668\u8bc1\u4e66\u7684\u5177\u4f53\u8fc7\u7a0b\uff1a \uff081\uff09\u5ba2\u6237\u7aef\u8bfb\u53d6\u8bc1\u4e66\u4e2d\u7684Issuer(\u53d1\u5e03\u673a\u6784)\uff0c\u7136\u540e\u5728\u5ba2\u6237\u7aef\u53d7\u4fe1\u4efb\u7684\u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff08CA\uff09\u7684\u8bc1\u4e66\u4e2d\u5bfb\u627e\u5bf9\u5e94\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u7684\u8bc1\u4e66\uff0c\u7528\u4e8e\u6821\u9a8c\u8bc1\u4e66\u662f\u5426\u4e3a\u4fe1\u4efb\u7684\u9881\u53d1\u673a\u6784\u9881\u53d1\u7684\u3002 \uff082\uff09\u5982\u679c\u627e\u4e0d\u5230\u8be5\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u7684\u8bc1\u4e66\uff0c\u5ba2\u6237\u7aef\u5c31\u4f1a\u62a5\u9519\uff0c\u8bf4\u660e\u670d\u52a1\u5668\u53d1\u6765\u7684\u8bc1\u4e66\u662f\u4e0d\u53ef\u4fe1\u4efb\u7684\u3002 \uff083\uff09\u5982\u679c\u627e\u5230\u9881\u53d1\u673a\u6784\u7684\u8bc1\u4e66\uff0c\u90a3\u4e48\u5ba2\u6237\u7aef\u5c31\u4f1a\u4ece\u5bf9\u5e94\u7684\u8bc1\u4e66\u4e2d\u83b7\u5f97\u7684\u516c\u94a5\uff0c\u7136\u540e\u4f7f\u7528\u516c\u94a5\u89e3\u5bc6\u88ab\u52a0\u5bc6\u7684\u8bc1\u4e66\u6307\u7eb9\u4ee5\u53ca\u6307\u7eb9\u7b97\u6cd5 \uff084\uff09\u5ba2\u6237\u7aef\u4f7f\u7528 \u89e3\u5bc6\u83b7\u5f97\u7684\u6307\u7eb9\u52a0\u5bc6\u7b97\u6cd5 \u8ba1\u7b97\u51fa\u670d\u52a1\u5668\u53d1\u6765\u7684\u8bc1\u4e66\u7684\u6307\u7eb9\uff0c\u5c06\u8ba1\u7b97\u7ed3\u679c\u4e0e \u89e3\u5bc6\u83b7\u5f97\u7684\u8bc1\u4e66\u6307\u7eb9 \u5bf9\u6bd4\uff0c\u5982\u679c\u4e00\u81f4\uff0c\u8bf4\u660e\u670d\u52a1\u5668\u53d1\u6765\u7684\u8bc1\u4e66\u80af\u5b9a\u6ca1\u6709\u88ab\u4fee\u6539\u8fc7\uff0c\u5e76\u4e14\u8bc1\u4e66\u662f\u53d7\u4fe1\u4efb\u7684\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u53d1\u5e03\u7684 \uff085\uff09\u6b64\u65f6\u5ba2\u6237\u7aef\u5c31\u53ef\u4ee5\u8bfb\u53d6\u8bc1\u4e66\u4e2d\u7684\u516c\u94a5\uff0c\u7528\u4e8e\u540e\u7eed\u52a0\u5bc6\u4e86 \u975e\u5bf9\u7b49\u8bc1\u4e66\u6821\u9a8c \uff08\u4e0d\u9a8c\u8bc1server\u7684\u5408\u6cd5\u6027\uff09 \u8df3\u8fc7\u6821\u9a8c\u670d\u52a1\u5668\u8bc1\u4e66\u5408\u6cd5\u6027\u7684\u6b65\u9aa4\uff0c\u5e76\u76f4\u63a5\u4f7f\u7528\u670d\u52a1\u5668\u53d1\u9001\u7684\u8bc1\u4e66\u4e2d\u7684\u516c\u94a5\u52a0\u5bc6\u76f8\u5e94\u7684\u5185\u5bb9\u3002\u5728curl\u547d\u4ee4\u884c\u5de5\u5177\u4e2d\u53ef\u4ee5\u4f7f\u7528-k/--insecure\u53c2\u6570\u6765\u8df3\u8fc7\u8bc1\u4e66\u6821\u9a8c\u3002","title":"\u8bc1\u4e66\u7684\u4e3b\u8981\u5185\u5bb9"},{"location":"Others/\u6570\u5b57\u8bc1\u4e66\u539f\u7406/#_2","text":"\u200b https://www.cnblogs.com/JeffreySun/archive/2010/06/24/1627247.html \u200b https://www.cnblogs.com/codecc/p/5192023.html \u200b https://blog.csdn.net/chengqiuming/article/details/83115642 \u200b https://xz.aliyun.com/t/2531#toc-0","title":"\u53c2\u8003"},{"location":"Spring/SpringSecurity/SpringSecurtiy\u6e90\u7801\u5206\u6790/","text":"SpringSecurity\u7b14\u8bb0 SpringSecurity\u6743\u9650\u9a8c\u8bc1\u662f\u901a\u8fc7\u4e00\u7cfb\u5217\u7684\u8fc7\u6ee4\u5668\uff08Filter\uff09\u6765\u5b9e\u73b0\u7684\uff0c\u4f46\u4ece\u5bb9\u5668\u7684\u89d2\u5ea6\u6765\u770b\u5728\u8fc7\u6ee4\u94fe\u4e2d\u5b83\u8868\u73b0\u4e3a\u4e00\u4e2a Filter \uff0c\u5176\u7c7b\u578b\u662f FilterChainProxy \u3002\u6362\u53e5\u8bdd\u8bf4\uff0cSpringSecurity\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u7269\u7406\u8fc7\u6ee4\u5668\uff0c\u4f46\u662f\u5b83\u5c06\u8bf7\u6c42\u59d4\u6258\u7ed9\u4e00\u7cfb\u5217\u7684\u5185\u90e8\u8fc7\u6ee4\u5668\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a SpringSecurity\u7684\u5185\u90e8\u8fc7\u6ee4\u5668\u94fe\u5982\u4e0b\uff1a \u522b\u540d \u7c7b\u540d\u79f0 Namespace Element or Attribute CHANNEL_FILTER ChannelProcessingFilter http/intercept-url @requires -channel SECURITY_CONTEXT_FILTER SecurityContextPersistenceFilter http CONCURRENT_SESSION_FILTER ConcurrentSessionFilter session-management/concurrency-control HEADERS_FILTER HeaderWriterFilter http/headers CSRF_FILTER CsrfFilter http/csrf LOGOUT_FILTER LogoutFilter http/logout X509_FILTER X509AuthenticationFilter http/x509 PRE_AUTH_FILTER AbstractPreAuthenticatedProcessingFilter( Subclasses) N/A CAS_FILTER CasAuthenticationFilter N/A FORM_LOGIN_FILTER UsernamePasswordAuthenticationFilter http/form-login BASIC_AUTH_FILTER BasicAuthenticationFilter http/http-basic SERVLET_API_SUPPORT_FILTER SecurityContextHolderAwareRequestFilter http/ @servlet -api-provision JAAS_API_SUPPORT_FILTER JaasApiIntegrationFilter http/ @jaas -api-provision REMEMBER_ME_FILTER RememberMeAuthenticationFilter http/remember-me ANONYMOUS_FILTER AnonymousAuthenticationFilter http/anonymous SESSION_MANAGEMENT_FILTER SessionManagementFilter session-management EXCEPTION_TRANSLATION_FILTER ExceptionTranslationFilter http FILTER_SECURITY_INTERCEPTOR FilterSecurityInterceptor http SWITCH_USER_FILTER SwitchUserFilter N/A \u8fc7\u6ee4\u5668\u7684\u8fc7\u6ee4\u987a\u5e8f\u81ea\u4e0a\u800c\u4e0b\uff0c\u6309\u987a\u5e8f\u6267\u884c\u3002 \u57fa\u4e8e\u6570\u636e\u5e93\u7684\u767b\u5165\u8ba4\u8bc1 spring security\u57fa\u4e8e\u6570\u636e\u5e93\u7684\u767b\u5f55\u8ba4\u8bc1\u4f7f\u7528\u7684\u9ed8\u8ba4\u8fc7\u6ee4\u5668\u4e3a UsernamePasswordAuthenticationFilter \u7c7b\uff0c\u8be5\u7c7b\u7ee7\u627f\u81ea AbstractAuthenticationProcessingFilter \u62bd\u8c61\u7c7b\u3002 AbstractAuthenticationProcessingFilter \u62bd\u8c61\u7c7b\u901a\u8fc7doFilter\u5c01\u88c5\u4e86\u767b\u5165\u8ba4\u8bc1\u7684\u57fa\u672c\u903b\u8f91\uff0c\u5b50\u7c7b\u5b9e\u73b0\u5176\u4e2d\u7684\u62bd\u8c61\u65b9\u6cd5\u8fdb\u884c\u8ba4\u8bc1\uff0c\u8be5\u7c7bdoFilter\u65b9\u6cd5\u5982\u4e0b\uff1a /** * \u8c03\u7528 #requiresAuthentication(HttpServletRequest, HttpServletResponse) \u51b3\u5b9a\u662f\u5426\u9700\u8981\u8fdb\u884c\u9a8c\u8bc1\u64cd\u4f5c\u3002 * \u5982\u679c\u9700\u8981\u9a8c\u8bc1\uff0c\u5219\u4f1a\u8c03\u7528 #attemptAuthentication(HttpServletRequest, HttpServletResponse) \u65b9\u6cd5\u3002 * \u6709\u4e09\u79cd\u7ed3\u679c\uff1a * 1\u3001\u8fd4\u56de\u4e00\u4e2a Authentication \u5bf9\u8c61\u3002 * \u914d\u7f6e\u7684 SessionAuthenticationStrategy` \u5c06\u88ab\u8c03\u7528\uff0c * \u7136\u540e \u7136\u540e\u8c03\u7528 #successfulAuthentication(HttpServletRequest\uff0cHttpServletResponse\uff0cFilterChain\uff0cAuthentication) \u65b9\u6cd5\u3002 * 2\u3001\u9a8c\u8bc1\u65f6\u53d1\u751f AuthenticationException\u3002 * #unsuccessfulAuthentication(HttpServletRequest, HttpServletResponse, AuthenticationException) \u65b9\u6cd5\u5c06\u88ab\u8c03\u7528\u3002 * 3\u3001\u8fd4\u56deNull\uff0c\u8868\u793a\u8eab\u4efd\u9a8c\u8bc1\u4e0d\u5b8c\u6574\u3002\u5047\u8bbe\u5b50\u7c7b\u505a\u4e86\u4e00\u4e9b\u5fc5\u8981\u7684\u5de5\u4f5c\uff08\u5982\u91cd\u5b9a\u5411\uff09\u6765\u7ee7\u7eed\u5904\u7406\u9a8c\u8bc1\uff0c\u65b9\u6cd5\u5c06\u7acb\u5373\u8fd4\u56de\u3002 * \u5047\u8bbe\u540e\u4e00\u4e2a\u8bf7\u6c42\u5c06\u88ab\u8fd9\u79cd\u65b9\u6cd5\u63a5\u6536\uff0c\u5176\u4e2d\u8fd4\u56de\u7684Authentication\u5bf9\u8c61\u4e0d\u4e3a\u7a7a\u3002 */ public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) throws IOException, ServletException { HttpServletRequest request = (HttpServletRequest) req; HttpServletResponse response = (HttpServletResponse) res; //\u5224\u65ad\u662f\u5426\u8981\u8fdb\u884c\u9a8c\u8bc1\uff0c\u5373\u5224\u65adurl\u662f\u5426\u4e3a\"/login\"(\u4f60\u8bbe\u7f6e\u7684\u767b\u5165url)\u5e76\u4e14\u8bf7\u6c42\u65b9\u6cd5\u662f\u5426\u4e3apost if (!requiresAuthentication(request, response)) { chain.doFilter(request, response); return; } if (logger.isDebugEnabled()) { logger.debug(\"Request is to process authentication\"); } Authentication authResult; try { //\u8be5\u65b9\u6cd5\u4e3a\u62bd\u8c61\u65b9\u6cd5\u7531\u5b50\u7c7b\u5b9e\u73b0 authResult = attemptAuthentication(request, response); if (authResult == null) { // return immediately as subclass has indicated that it hasn't completed // authentication return; } sessionStrategy.onAuthentication(authResult, request, response); } catch (InternalAuthenticationServiceException failed) { logger.error( \"An internal error occurred while trying to authenticate the user.\", failed); unsuccessfulAuthentication(request, response, failed); return; } catch (AuthenticationException failed) { // Authentication failed unsuccessfulAuthentication(request, response, failed); return; } // Authentication success if (continueChainBeforeSuccessfulAuthentication) { chain.doFilter(request, response); } successfulAuthentication(request, response, chain, authResult); } \u4e0a\u6587\u63d0\u5230\u4e86 AbstractAuthenticationProcessingFilter \u62bd\u8c61\u7c7b\u5728SpringSecurity\u7684\u9ed8\u8ba4\u5b9e\u73b0\u4e3a UsernamePasswordAuthenticationFilter \uff0c\u56e0\u6b64\u5c06\u8c03\u7528\u7684 UsernamePasswordAuthenticationFilter \u7c7b\u7684 #attemptAuthentication \u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u4e3b\u8981\u4f5c\u7528\u662f\u63d0\u53d6request\u4e2d\u7684\u8d26\u6237\uff08username\uff09\u548c\u5bc6\u7801\uff08password\uff09\u5c5e\u6027\u751f\u6210 UsernamePasswordAuthenticationToken \u5bf9\u8c61\uff0c\u4ea4\u7ed9 AuthenticationManager \u8fdb\u884c\u9a8c\u8bc1\uff08\u5373\u8c03\u7528this.getAuthenticationManager().authenticate(authRequest) \uff09\u3002\u4ee3\u7801\u5982\u4e0b\uff1a public Authentication attemptAuthentication(HttpServletRequest request, HttpServletResponse response) throws AuthenticationException { if (postOnly && !request.getMethod().equals(\"POST\")) { throw new AuthenticationServiceException( \"Authentication method not supported: \" + request.getMethod()); } //\u4ecerequest\u4e2d\u83b7\u5f97\u8d26\u6237\u548c\u5bc6\u7801 String username = obtainUsername(request); String password = obtainPassword(request); if (username == null) { username = \"\"; } if (password == null) { password = \"\"; } // \u5220\u9664\u5934\u5c3e\u7684\u7a7a\u683c username = username.trim(); UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken( username, password); // Allow subclasses to set the \"details\" property setDetails(request, authRequest); return this.getAuthenticationManager().authenticate(authRequest); } \u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b UsernamePasswordAuthenticationFilter \u7c7b\u6301\u6709\u7684AuthenticationManager\u5b9e\u4f8b\u5bf9\u8c61\u4e3a ProviderManager \uff0c\u8be5\u7c7b\u7684 #authenticate \u65b9\u6cd5\u904d\u5386\u6240\u6709\u7684AuthenticationProvider\uff0c\u5e76\u9009\u62e9\u7b26\u5408\u6761\u4ef6\u7684Provider\u8c03\u7528\u5176\u9a8c\u8bc1\u65b9\u6cd5\u3002\u4ee3\u7801\u5982\u4e0b\uff1a /** * \u5c1d\u8bd5\u9a8c\u8bc1 Authentication \u5bf9\u8c61 * AuthenticationProvider \u5217\u8868\u5c06\u88ab\u8fde\u7eed\u5c1d\u8bd5\uff0c\u76f4\u5230 AuthenticationProvider \u8868\u793a\u5b83\u80fd\u591f\u8ba4\u8bc1\u4f20\u9012\u7684\u8fc7\u6765\u7684Authentication \u5bf9\u8c61\u3002\u7136\u540e\u5c06\u4f7f\u7528\u8be5 AuthenticationProvider \u5c1d\u8bd5\u8eab\u4efd\u9a8c\u8bc1\u3002 * \u5982\u679c\u6709\u591a\u4e2a AuthenticationProvider \u652f\u6301\u9a8c\u8bc1\u4f20\u9012\u8fc7\u6765\u7684Authentication \u5bf9\u8c61\uff0c\u90a3\u4e48\u7531\u7b2c\u4e00\u4e2a\u6765\u786e\u5b9a\u7ed3\u679c\uff0c\u8986\u76d6\u65e9\u671f\u652f\u6301AuthenticationProviders \u6240\u5f15\u53d1\u7684\u4efb\u4f55\u53ef\u80fd\u7684AuthenticationException\u3002 \u6210\u529f\u9a8c\u8bc1\u540e\uff0c\u5c06\u4e0d\u4f1a\u5c1d\u8bd5\u540e\u7eed\u7684AuthenticationProvider\u3002 * \u5982\u679c\u6700\u540e\u6240\u6709\u7684 AuthenticationProviders \u90fd\u6ca1\u6709\u6210\u529f\u9a8c\u8bc1 Authentication \u5bf9\u8c61\uff0c\u5c06\u629b\u51fa AuthenticationException\u3002 */ public Authentication authenticate(Authentication authentication) throws AuthenticationException { Class<? extends Authentication> toTest = authentication.getClass(); AuthenticationException lastException = null; Authentication result = null; boolean debug = logger.isDebugEnabled(); for (AuthenticationProvider provider : getProviders()) { if (!provider.supports(toTest)) { continue; } if (debug) { logger.debug(\"Authentication attempt using \" + provider.getClass().getName()); } try { result = provider.authenticate(authentication); if (result != null) { copyDetails(authentication, result); break; } } catch (AccountStatusException e) { prepareException(e, authentication); // SEC-546: Avoid polling additional providers if auth failure is due to // invalid account status throw e; } catch (InternalAuthenticationServiceException e) { prepareException(e, authentication); throw e; } catch (AuthenticationException e) { lastException = e; } } if (result == null && parent != null) { // Allow the parent to try. try { result = parent.authenticate(authentication); } catch (ProviderNotFoundException e) { // ignore as we will throw below if no other exception occurred prior to // calling parent and the parent // may throw ProviderNotFound even though a provider in the child already // handled the request } catch (AuthenticationException e) { lastException = e; } } if (result != null) { if (eraseCredentialsAfterAuthentication && (result instanceof CredentialsContainer)) { // Authentication is complete. Remove credentials and other secret data // from authentication ((CredentialsContainer) result).eraseCredentials(); } eventPublisher.publishAuthenticationSuccess(result); return result; } // Parent was null, or didn't authenticate (or throw an exception). if (lastException == null) { lastException = new ProviderNotFoundException(messages.getMessage( \"ProviderManager.providerNotFound\", new Object[] { toTest.getName() }, \"No AuthenticationProvider found for {0}\")); } prepareException(lastException, authentication); throw lastException; } \u901a\u8fc7\u4e0a\u9762\u7684\u4ee3\u7801\u53ef\u4ee5\u770b\u51fa\uff0c\u9a8c\u8bc1\u7684\u6838\u5fc3\u4ee3\u7801\u4e3a\uff1a result = provider.authenticate(authentication); SpringSecurity\u4e2d\u5904\u7406UsernamePasswordAuthenticationToken\u7684AuthenticationProvider\u662f\u62bd\u8c61\u7c7b AbstractUserDetailsAuthenticationProvider \u7684\u5b50\u7c7b\uff0c\u8be5\u7c7b\u7684 #authenticate \u65b9\u6cd5\u4ee3\u7801\u5982\u4e0b\uff1a // \u9a8c\u8bc1 authentication public Authentication authenticate(Authentication authentication) throws AuthenticationException { Assert.isInstanceOf(UsernamePasswordAuthenticationToken.class, authentication, messages.getMessage( \"AbstractUserDetailsAuthenticationProvider.onlySupports\", \"Only UsernamePasswordAuthenticationToken is supported\")); // Determine username String username = (authentication.getPrincipal() == null) ? \"NONE_PROVIDED\" : authentication.getName(); boolean cacheWasUsed = true; //\u8fd9\u91cc\u4f7f\u7528\u4e86\u7f13\u5b58\u673a\u5236\uff0c\u5148\u5728\u7f13\u5b58\u4e2d\u67e5\u627e\u7528\u6237\u662f\u5426\u5b58\u5728\uff08\u9ed8\u8ba4\u7f13\u5b58\u4e3aNullUserCache\uff0c\u5373\u4e0d\u505a\u7f13\u5b58\uff09 UserDetails user = this.userCache.getUserFromCache(username); if (user == null) { cacheWasUsed = false; try { //\u5982\u679c\u7528\u6237\u4e0d\u5b58\u5728\u5219\u8c03\u7528retrieveUser\u65b9\u6cd5 //retrieveUser\u65b9\u6cd5\u4e3a\u62bd\u8c61\u65b9\u6cd5\uff0c\u7531\u5b50\u7c7b\u5b9e\u73b0 user = retrieveUser(username, (UsernamePasswordAuthenticationToken) authentication); } catch (UsernameNotFoundException notFound) { logger.debug(\"User '\" + username + \"' not found\"); if (hideUserNotFoundExceptions) { throw new BadCredentialsException(messages.getMessage( \"AbstractUserDetailsAuthenticationProvider.badCredentials\", \"Bad credentials\")); } else { throw notFound; } } Assert.notNull(user, \"retrieveUser returned null - a violation of the interface contract\"); } try { preAuthenticationChecks.check(user); additionalAuthenticationChecks(user, (UsernamePasswordAuthenticationToken) authentication); } catch (AuthenticationException exception) { if (cacheWasUsed) { //\u8fd9\u91cc\u6d89\u53ca\u5230\u4e00\u4e2a\u95ee\u9898 //\u4ece\u7f13\u5b58\u4e2d\u83b7\u5f97\u7684\u7528\u6237\u53ef\u80fd\u4e0d\u662f\u6700\u65b0\u7684\u7528\u6237\u4fe1\u606f\uff0c\u56e0\u6b64\u5728\u9a8c\u8bc1\u5931\u8d25\u540e\u8fd8\u4f1a\u8fdb\u884c\u4e00\u6b21\u9a8c\u8bc1 cacheWasUsed = false; user = retrieveUser(username, (UsernamePasswordAuthenticationToken) authentication); preAuthenticationChecks.check(user); additionalAuthenticationChecks(user, (UsernamePasswordAuthenticationToken) authentication); } else { throw exception; } } postAuthenticationChecks.check(user); if (!cacheWasUsed) { this.userCache.putUserInCache(user); } Object principalToReturn = user; if (forcePrincipalAsString) { principalToReturn = user.getUsername(); } return createSuccessAuthentication(principalToReturn, authentication, user); } \u4ece\u4e0a\u9762\u7684\u4ee3\u7801\u53ef\u4ee5\u770b\u51fa AbstractUserDetailsAuthenticationProvider \u4f7f\u7528\u4e86\u7f13\u5b58\u673a\u5236\uff0c\u73b0\u5728\u7f13\u5b58\u4e2d\u83b7\u53d6\u7528\u6237\uff0c\u5982\u679c\u7528\u6237\u4e0d\u5b58\u5728\u5219\u8c03\u7528 #retrieveUser \u83b7\u5f97\uff0c\u7136\u540e\u518d\u4e0e\u4f20\u5165\u7684\u7528\u6237\u4fe1\u606f\u8fdb\u884c\u6bd4\u5bf9\u3002\u8fd9\u91cc\u6709\u4e00\u70b9\u9700\u8981\u6ce8\u610f\uff0c\u5728\u9a8c\u8bc1\u5931\u8d25\u540eSpringSecurity\u53c8\u8fdb\u884c\u4e86\u4e00\u6b21\u9a8c\u8bc1\uff0c\u76ee\u7684\u662f\u9632\u6b62\u7f13\u5b58\u4e2d\u7684\u4fe1\u606f\u8fc7\u65f6\u3002 \u5176\u4e2d\u7684 #retrieveUser \u65b9\u6cd5\u4e3a\u62bd\u8c61\u65b9\u6cd5\uff0c\u5728SpringSecurity\u4e2d\u7531 AbstractUserDetailsAuthenticationProvider \u7684\u9ed8\u8ba4\u5b50\u7c7b DaoAuthenticationProvider \u5b9e\u73b0\u3002\u4ee3\u7801\u5982\u4e0b\uff1a protected final UserDetails retrieveUser(String username, UsernamePasswordAuthenticationToken authentication) throws AuthenticationException { UserDetails loadedUser; try { //\u8c03\u7528UserDetailsService\u7684loadUserByUsername\u65b9\u6cd5\u4ece\u6570\u636e\u5e93\u83b7\u5f97\u7528\u6237 loadedUser = this.getUserDetailsService().loadUserByUsername(username); } catch (UsernameNotFoundException notFound) { if (authentication.getCredentials() != null) { String presentedPassword = authentication.getCredentials().toString(); passwordEncoder.isPasswordValid(userNotFoundEncodedPassword, presentedPassword, null); } throw notFound; } catch (Exception repositoryProblem) { throw new InternalAuthenticationServiceException( repositoryProblem.getMessage(), repositoryProblem); } if (loadedUser == null) { throw new InternalAuthenticationServiceException( \"UserDetailsService returned null, which is an interface contract violation\"); } return loadedUser; } \u53ef\u4ee5\u770b\u51fa\u6b64\u5904\u7684\u8fd4\u56de\u5bf9\u8c61 userDetails \u662f\u7531 UserDetailsService \u7684 #loadUserByUsername(username) \u6765\u83b7\u53d6\u7684\u3002\u800cUserDetailsService\u53c8\u662f\u4ece\u4f55\u800c\u6765\u5462\uff1f\u5b9e\u9645\u4e0a\uff0c UserDetailsService \u662f\u5728SpringSecurity\u76f8\u5173\u914d\u7f6e\u4e2d\u5b9a\u4e49\u7684\uff0c\u4e0b\u6587\u4f1a\u4f7f\u7528\u7b80\u5355\u7684\u4f8b\u5b50\u8fdb\u884c\u8bf4\u660e\u3002 \u5728Spring-boot\u4e2d\u4f7f\u7528SpringSecurity\u8fdb\u884c\u57fa\u4e8e\u6570\u636e\u5e93\u7684\u767b\u5165\u8ba4\u8bc1 \u9996\u5148\uff0c\u5728 pom.xml \u6587\u4ef6\u4e2d\u6dfb\u52a0SpringSecurity\u4f9d\u8d56\uff0c\u5982\u4e0b\uff1a <dependencies> ... <dependency> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter-security</artifactId> </dependency> ... </dependencies> \u63a5\u7740\uff0c\u5bf9SpringSecurity\u8fdb\u884c\u914d\u7f6e\uff0c\u9700\u8981\u6ce8\u610f\u4e00\u4e0b\u51e0\u70b9\uff1a \u5728Spring-boot\u4e2d\u4f7f\u7528SpringSecurity\u9700\u8981\u4f7f\u7528 @EnableWebSecurity \u6ce8\u89e3\uff0c\u8be5\u6ce8\u89e3\u9700\u8981\u914d\u5408@Configuration\u4e00\u8d77\u4f7f\u7528\uff0c\u7528\u6765\u6807\u6ce8SpringSecurity\u7684\u914d\u7f6e\u7c7b\u3002 SpringSecurity\u914d\u7f6e\u7c7b\u9700\u8981\u5b9e\u73b0 WebSecurityConfigurer \u63a5\u53e3\uff0c\u6216\u8005\u7ee7\u627f\u81ea WebSecurityConfigurerAdapter \u3002 \u4e00\u822c\u4f1a\u9009\u62e9\u7ee7\u627f WebSecurityConfigurerAdapter \u62bd\u8c61\u7c7b\u6765\u4f7f\u7528SpringSecurity\u7684\u9ed8\u8ba4\u914d\u7f6e\uff0c\u5e76\u4e14\u91cd\u5199configure(AuthenticationManagerBuilder auth) \u548c configure(HttpSecurity http)\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u6765\u8fdb\u884c\u5ba2\u6237\u5316\u914d\u7f6e\u3002 \u4e0b\u9762\u4e3aSpringSecurity\u914d\u7f6e\u7684\u4f8b\u5b50\uff1a @Configuration @EnableWebSecurity public class WebSecurityConfig extends WebSecurityConfigurerAdapter { @AutoWired private UserDetailsService myUserDetailsService; @Override protected void configure(HttpSecurity http) throws Exception { http .authorizeRequests() .antMatchers(\"/\", \"/home\").permitAll() .anyRequest().authenticated() .and() .formLogin() .loginPage(\"/login\") .permitAll() .and() .logout() .permitAll(); } @Override protected void configure(AuthenticationManagerBuilder builder) throws Exception{ builder.userDetailsService(myUserDetailsService) .passwordEncoder(passwordEncoder()); } @Bean public BCryptPasswordEncoder passwordEncoder(){ return new BCryptPasswordEncoder(); } } \u5176\u4e2d configure(HttpSecurity) \u65b9\u6cd5\u4e3b\u8981\u8d1f\u8d23\u914d\u7f6e\u8d44\u6e90\u548cURL\u7684\u6743\u9650\u63a7\u5236\uff0c\u5373\u914d\u7f6e\u54ea\u4e9b\u8d44\u6e90\u6216URL\u9700\u8981\u6388\u6743\uff08\u72ed\u4e49\u4e0a\u5c31\u662f\u767b\u5165\uff09\u4ee5\u540e\u624d\u80fd\u8bbf\u95ee\uff0c\u54ea\u4e9b\u8d44\u6e90\u6216URL\u53ef\u4ee5\u81ea\u7531\u8bbf\u95ee\u3002\u5177\u4f53\u4ee5\u4e0a\u9762\u7684\u4f8b\u5b50\u6765\u8bf4\uff0c\"/\"\u548c\"/home\"\u4e0b\u7684\u8d44\u6e90\u88ab\u914d\u7f6e\u4e3a\u4e0d\u9700\u8981\u8fdb\u884c\u4efb\u4f55\u8eab\u4efd\u9a8c\u8bc1\u5373\u53ef\u8bbf\u95ee\uff0c\u5176\u4ed6\u8def\u5f84\u4e0b\u7684\u8d44\u6e90\u8bbf\u95ee\u5fc5\u987b\u5148\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\uff1b\u5f00\u542f\u4e86\u8868\u5355\u767b\u5165\u529f\u80fd\uff0c\u767b\u5165\u9875\u9762\u4e3a\"/login\"\u4e5f\u4e0d\u9700\u8981\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u5373\u53ef\u8bbf\u95ee\uff0c\u5f53\u672a\u6388\u6743\u5bf9\u9700\u8981\u6388\u6743\u8d44\u6e90\u8fdb\u884c\u8bbf\u95ee\u65f6\u4f1a\u8df3\u8f6c\u5230\u6307\u5b9a\u7684\u767b\u5165\u754c\u9762\u3002 \u800cconfigure(AuthenticationManagerBuilder)\u65b9\u6cd5\u4ece\u53c2\u6570\u540d\u5c31\u53ef\u4ee5\u770b\u51fa\u8be5\u65b9\u6cd5\u5bf9AuthenticationManagerBuilder\u8fdb\u884c\u914d\u7f6e\uff0c\u5b83\u53ef\u4ee5\u4f7f\u7528\u5185\u5b58\u65b9\u5f0f\uff08in-memory\uff09\u3001JDBC \u6216 LDAP\u3001\u6216\u81ea\u5b9a\u4e49\u7684 UserDetailService \u6765\u8ba4\u8bc1\u7528\u6237\uff0c\u4ece\u800c\u5f71\u54cd\u5230AuthenticationManager\u7684\u5c5e\u6027\u3002\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\u914d\u7f6e\u4e86\u6388\u6743\u8ba4\u8bc1\u8fc7\u7a0b\u7684UserDetailsService\u5bf9\u8c61\u4ee5\u53ca\u5bc6\u7801\u52a0\u5bc6\u5bf9\u8c61\uff0c\u5373\u5728 \u57fa\u4e8e\u6570\u636e\u5e93\u7684\u767b\u5165\u9a8c\u8bc1 \u90e8\u5206 DaoAuthenticationProvider \u83b7\u5f97\u7684UserDetailsService\u5728\u8fd9\u91cc\u88ab\u8bbe\u7f6e\u4e86\u3002\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u76f4\u63a5\u5bf9 DaoAuthenticationProvider \u8fdb\u884c\u914d\u7f6e\uff1a @Configuration @EnableWebSecurity public class SecurityConfiguration extends WebSecurityConfigurerAdapter { private final UserDetailsService userDetailsService; @Autowired public SecurityConfiguration(@Qualifier(\"userService\") UserDetailsService userDetailsService) { this.userDetailsService = userDetailsService; } @Autowired public void configureGlobal(AuthenticationManagerBuilder auth, PasswordEncoder passwordEncoder) throws Exception { // \u8bbe\u7f6e\u8eab\u4efd\u9a8c\u8bc1\u5668 DaoAuthenticationProvider authenticationProvider = new DaoAuthenticationProvider(); authenticationProvider.setUserDetailsService(userDetailsService);// \u8bbe\u7f6e\u7528\u6237\u670d\u52a1\u7c7b authenticationProvider.setPasswordEncoder(passwordEncoder); // \u8bbe\u7f6e\u5bc6\u7801\u52a0\u5bc6\u65b9\u5f0f auth.authenticationProvider(authenticationProvider);//\u8bbe\u7f6eauthenticationProvider } ...//\u5176\u4ed6\u914d\u7f6e\u7701\u7565 } UserDetailsService\u5b9e\u9645\u4e0a\u53ea\u662f\u4e00\u4e2a\u63a5\u53e3\uff0c\u5176\u4e2d\u5b9a\u4e49\u4e86 #loadUserByUsername \u65b9\u6cd5\u7528\u4e8e\u8fd4\u56de\u7528\u6237\u4fe1\u606f\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u8ba9UserService\u5b9e\u73b0\u8be5\u63a5\u53e3\uff0c\u5982\u4e0b\uff1a @Service public class UserService implements UserDetailsService { ...//\u7701\u7565\u5176\u4ed6\u65b9\u6cd5 @Override public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException { if(username == null){ throw new UsernameNotFoundException(\"\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a\"); } return userDao.findByName(username); } } \u4e0a\u8ff0\u914d\u7f6e\u5b8c\u6210\u540e\uff0cSpringSecurity\u4e0e\u6570\u636e\u5e93\u5bf9\u8c61\u4e4b\u95f4\u5c31\u5efa\u7acb\u4e86\u8054\u7cfb\uff0c\u5f53\u7528\u6237\u8fdb\u884c\u8d44\u6e90\u8bbf\u95ee\u65f6\u4f1a\u5148\u53bb\u6570\u636e\u5e93\u83b7\u5f97\u8be5\u5bf9\u8c61\u8fdb\u884c\u6bd4\u5bf9\uff0c\u5224\u65ad\u662f\u5426\u6709\u6743\u9650\u83b7\u5f97\u76f8\u5e94\u7684\u8d44\u6e90\u3002 SpringSecurity\u4e2d\u7684\u8bbf\u95ee\u63a7\u5236 \u5728Spring Security\u4e2d\u9ed8\u8ba4\u7684\u8bbf\u95ee\u63a7\u5236\u7684\u5165\u53e3\u4e3a FilterSecurityInterceptor \u8fc7\u6ee4\u5668\uff0c\u5728Spring Security\u7684\u8fc7\u6ee4\u5668\u94fe\u4e2d\u8be5\u8fc7\u6ee4\u5668\u8d1f\u8d23\u89d2\u8272\u548c\u6743\u9650\u7684\u63a7\u5236\u3002 FilterSecurityInterceptor \u7ee7\u627f\u81ea AbstractSecurityInterceptor \u5e76\u4e14\u5b9e\u73b0\u4e86Filter\u63a5\u53e3\uff0c\u8be5\u7c7b\u7684\u4e3b\u8981\u4f5c\u7528\u662f\u4f5c\u4e3aFilter\u52a0\u5165\u8fc7\u6ee4\u94fe\uff0c\u4e3b\u8981\u7684\u6743\u9650\u63a7\u5236\u903b\u8f91\u7531 AbstractSecurityInterceptor \u5b9e\u73b0\u3002\u5b83\u7684doFilter\u65b9\u6cd5\uff0c\u5982\u4e0b\uff1a /** *\u4f7f\u7528request,response,filterChain\u6784\u5efaFilterInvocation\u5bf9\u8c61\u5e76\u4f20\u7ed9invoke\u65b9\u6cd5 */ public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException { FilterInvocation fi = new FilterInvocation(request, response, chain); invoke(fi); } \u4ece\u4e0a\u9762\u7684\u4ee3\u7801\u53ef\u4ee5\u770b\u51fa\uff0c #invoke \u65b9\u6cd5\u4e3a\u6743\u9650\u9a8c\u8bc1\u7684\u5165\u53e3\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a /** *\u5148\u5224\u65ad\u662f\u5426\u5df2\u7ecf\u8fdb\u884c\u4e86\u6743\u9650\u9a8c\u8bc1 *\u5982\u679c\u6ca1\u6709\u8fdb\u884c\u8fc7\u6743\u9650\u9a8c\u8bc1\uff0c\u5219\u8c03\u7528\u7236\u7c7b\u7684beforeInvocation\u65b9\u6cd5 */ public void invoke(FilterInvocation fi) throws IOException, ServletException { if ((fi.getRequest() != null) && (fi.getRequest().getAttribute(FILTER_APPLIED) != null) && observeOncePerRequest) { // filter already applied to this request and user wants us to observe // once-per-request handling, so don't re-do security checking fi.getChain().doFilter(fi.getRequest(), fi.getResponse()); } else { // first time this request being called, so perform security checking if (fi.getRequest() != null && observeOncePerRequest) { fi.getRequest().setAttribute(FILTER_APPLIED, Boolean.TRUE); } //beforeInvocation\u4e3a\u5173\u952e\u65b9\u6cd5 //\u82e5\u8be5\u65b9\u6cd5\u672a\u629b\u51faRuntimeException\u5219\u8bf4\u660e\u6743\u9650\u8ba4\u8bc1\u6210\u529f\uff0c\u5373\u4f7f\u8fd4\u56denull\u5bf9\u8c61 InterceptorStatusToken token = super.beforeInvocation(fi); try { fi.getChain().doFilter(fi.getRequest(), fi.getResponse()); } finally { super.finallyInvocation(token); } super.afterInvocation(token, null); } } \u4ece\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0c\u8be5\u65b9\u6cd5\u53ea\u662f\u505a\u4e86\u662f\u5426\u9700\u8981\u6743\u9650\u8ba4\u8bc1\u7684\u5224\u65ad\u5de5\u4f5c\uff0c\u800c\u4e3b\u8981\u7684\u8ba4\u8bc1\u5de5\u4f5c\u4ea4\u7ed9\u4e86\u7236\u7c7b\u7684 #beforeInvocation \u65b9\u6cd5\u3002\u8fd9\u91cc\u6709\u4e00\u4e2a\u95ee\u9898\uff0crequest\u5bf9\u8c61\u5728\u6bcf\u6b21\u8bf7\u6c42\u65f6\u90fd\u4f1a\u7531Web\u5bb9\u5668\u91cd\u65b0\u521b\u5efa\uff0c\u4e3a\u4ec0\u4e48\u4e0a\u9762\u7684\u4ee3\u7801\u8981\u8fdb\u884c\u4e00\u6b21\u662f\u5426\u5df2\u7ecf\u8fdb\u884c\u6743\u9650\u8ba4\u8bc1\u7684\u5de5\u4f5c\u5462\uff1f\u731c\u6d4b\u662f\u8003\u8651\u8fdb\u884c\u4e86\u8bf7\u6c42\u8f6c\u53d1\u7684\u60c5\u51b5\u4e0b\uff0c\u4e0d\u9700\u8981\u7684\u91cd\u65b0\u8fdb\u884c\u6743\u9650\u8ba4\u8bc1\u3002\u7ee7\u7eed\u5f80\u4e0b\u770b\uff0c AbstractSecurityInterceptor \u7684 #beforeInvocation \u65b9\u6cd5\u5982\u4e0b\uff1a /** *1.\u5224\u65ad\u662f\u5426\u914d\u7f6e\u4e86\u652f\u6301\u4f20\u5165\u5bf9\u8c61\u7684\u8ba4\u8bc1\uff0c\u82e5\u4e0d\u652f\u6301\u5219\u629b\u51fa\u5f02\u5e38 *2.\u83b7\u5f97SecurityMetadataSource\u7684Attributes\uff0cAttributes\u4e2d\u5305\u542b\u4e86\u672c\u6b21\u8bf7\u6c42\uff08request\uff09\u6240\u9700\u7684\u6743\u9650\u7ea7\u522b *3.\u5224\u65ad\u662f\u5426\u9700\u8981\u8fdb\u884c\u767b\u5165\u8ba4\u8bc1\uff0c\u5e76\u8fd4\u56deAuthentication\u5bf9\u8c61 *4.\u8c03\u7528AccessDecisionManager.decide()\u65b9\u6cd5\u8fdb\u884c\u6743\u9650\u9a8c\u8bc1 */ protected InterceptorStatusToken beforeInvocation(Object object) { Assert.notNull(object, \"Object was null\"); final boolean debug = logger.isDebugEnabled(); if (!getSecureObjectClass().isAssignableFrom(object.getClass())) { throw new IllegalArgumentException( \"Security invocation attempted for object \" + object.getClass().getName() + \" but AbstractSecurityInterceptor only configured to support secure objects of type: \" + getSecureObjectClass()); } //\u901a\u8fc7SecurityMetadataSource\u83b7\u5f97\u672c\u6b21\u8bf7\u6c42\u9700\u8981\u7684\u6743\u9650 //\u6743\u9650\u662f\u5728SecurityConfiguration\u4e2d\u7531hasAnyAuthority\u3001hasAnyRole\u6216hasRole\u65b9\u6cd5\u914d\u7f6e\u7684 Collection<ConfigAttribute> attributes = this.obtainSecurityMetadataSource() .getAttributes(object); if (attributes == null || attributes.isEmpty()) { if (rejectPublicInvocations) { throw new IllegalArgumentException( \"Secure object invocation \" + object + \" was denied as public invocations are not allowed via this interceptor. \" + \"This indicates a configuration error because the \" + \"rejectPublicInvocations property is set to 'true'\"); } if (debug) { logger.debug(\"Public object - authentication not attempted\"); } publishEvent(new PublicInvocationEvent(object)); return null; // no further work post-invocation } if (debug) { logger.debug(\"Secure object: \" + object + \"; Attributes: \" + attributes); } if (SecurityContextHolder.getContext().getAuthentication() == null) { credentialsNotFound(messages.getMessage( \"AbstractSecurityInterceptor.authenticationNotFound\", \"An Authentication object was not found in the SecurityContext\"), object, attributes); } // \u5224\u65ad\u662f\u5426\u9700\u8981\u8fdb\u884c\u767b\u5165\u8ba4\u8bc1\uff0c\u82e5\u9700\u8981\u5219\u8fdb\u884c\u8ba4\u8bc1\u5e76\u8fd4\u56deAuthentication\u5bf9\u8c61\uff0c\u4e3b\u8981\u4f5c\u7528\u662f\u8fd4\u56deAuthentication\u5bf9\u8c61 Authentication authenticated = authenticateIfRequired(); // Attempt authorization try { //\u6743\u9650\u9a8c\u8bc1\u7684\u6838\u5fc3\u65b9\u6cd5\uff0c\u8c03\u7528AccessDecisionManager\u7684decide\u65b9\u6cd5\u8fdb\u884c\u6743\u9650\u8ba4\u8bc1\uff0c\u672a\u629b\u51fa\u5f02\u5e38\u8bf4\u660e\u6709\u6743\u9650 this.accessDecisionManager.decide(authenticated, object, attributes); } catch (AccessDeniedException accessDeniedException) { publishEvent(new AuthorizationFailureEvent(object, attributes, authenticated, accessDeniedException)); throw accessDeniedException; } if (debug) { logger.debug(\"Authorization successful\"); } if (publishAuthorizationSuccess) { publishEvent(new AuthorizedEvent(object, attributes, authenticated)); } // Attempt to run as a different user Authentication runAs = this.runAsManager.buildRunAs(authenticated, object, attributes); if (runAs == null) { if (debug) { logger.debug(\"RunAsManager did not change Authentication object\"); } // no further work post-invocation return new InterceptorStatusToken(SecurityContextHolder.getContext(), false, attributes, object); } else { if (debug) { logger.debug(\"Switching to RunAs Authentication: \" + runAs); } SecurityContext origCtx = SecurityContextHolder.getContext(); SecurityContextHolder.setContext(SecurityContextHolder.createEmptyContext()); SecurityContextHolder.getContext().setAuthentication(runAs); // need to revert to token.Authenticated post-invocation return new InterceptorStatusToken(origCtx, true, attributes, object); } } \u4ece\u4e0a\u9762\u4ee3\u7801\u53ef\u4ee5\u770b\u51fa\u6743\u9650\u9a8c\u8bc1\u7684\u6838\u5fc3\u65b9\u6cd5\u4e3a AccessDecisionManager#decide \uff0c #decide \u65b9\u6cd5\u63a5\u53e3\u4ee3\u7801\u5982\u4e0b\uff1a void decide(Authentication authentication, Object object, Collection<ConfigAttribute> configAttributes) throws AccessDeniedException, InsufficientAuthenticationException; \u663e\u800c\u6613\u89c1\u8be5\u65b9\u6cd5\u9700\u8981\u4f20\u5165\u4e09\u4e2a\u53c2\u6570\uff1a Authentication \uff0c\u5728\u767b\u5165\u8ba4\u8bc1\u5b8c\u6210\u540e\u8fd4\u56de\u7684\u51ed\u8bc1\uff0c\u786e\u5b9a\u8bbf\u95ee\u5f53\u524d\u8d44\u6e90\u7684\u7528\u6237\uff0c\u5e76\u4e14\u4ece\u51ed\u8bc1\u53ef\u4ee5\u83b7\u53d6\u5f53\u524d\u7528\u6237\u6240\u62e5\u6709\u7684\u6743\u9650\uff08\u9700\u8981\u5728 UserDetailsService#loadUserByUsername \u65b9\u6cd5\u4e2d\u8bbe\u7f6e\uff09\u3002 Object \uff0c\u5b9e\u9645\u4e0a\u4e3aFilterInvocation\u5bf9\u8c61\u5b83\u6301\u6709request\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u5373\u5f53\u524d\u88ab\u8bbf\u95ee\u7684\u8d44\u6e90\u3002 Collection<ConfigAttribute> \uff0c\u8bbf\u95ee\u8d44\u6e90\u8981\u6c42\u7684\u6743\u9650\uff0c\u5728SpringSecurity\u914d\u7f6e\u4e2d\u8fdb\u884c\u8bbe\u7f6e\u3002 \u6240\u4ee5 AccessDecisionManager \u7684 #decide \u65b9\u6cd5\u7684\u4e3b\u8981\u601d\u8def\u662f\u4ece Authentication \u83b7\u5f97\u5f53\u524d\u7528\u6237\u6240\u62e5\u6709\u7684\u6743\u9650\uff0c\u518d\u4e0e\u8bbf\u95ee\u5f53\u524d\u8d44\u6e90\uff08object\uff09\u6240\u9700\u8981\u7684\u6743\u9650\u8fdb\u884c\u6bd4\u5bf9\uff0c\u5373\u53ef\u5224\u65ad\u5f53\u524d\u8ba4\u8bc1\u7528\u6237\u662f\u5426\u80fd\u591f\u8bbf\u95ee\u8be5\u8d44\u6e90\u3002 Spring Security\u5f15\u5165\u4e86\u6295\u7968\u5668\uff08voter\uff09\u7684\u6982\u5ff5\uff0c\u771f\u6b63\u7684\u6743\u9650\u8ba4\u8bc1\u5de5\u4f5c\u7531 AccessDecisionManager \u4e2d\u7684\u4e00\u7ec4 AccessDecisionVoter \u6765\u5b9e\u73b0\uff0c\u6709\u65e0\u6743\u9650\u8bbf\u95ee\u7684\u6700\u7ec8\u89c9\u5f97\u6743\u662f\u7531\u6295\u7968\u5668\u6765\u51b3\u5b9a\u7684\u3002 AccessDecisionManager \u7ef4\u62a4\u7740\u4e00\u4e2a AccessDecisionVoter \u5217\u8868\u53c2\u4e0e\u6388\u6743\u7684\u6295\u7968\u3002\u6839\u636e\u5904\u7406\u6295\u7968\u7684\u7b56\u7565\u4e0d\u540cSpring Security\u4e2d AccessDecisionManager \u67093\u4e2a\u4e0d\u540c\u7684\u5b9e\u73b0\uff1a UnanimousBased\uff08\u5168\u7968\u901a\u8fc7\uff09\uff1a\u6240\u6709\u6295\u7968\u5668\u90fd\u901a\u8fc7\u624d\u5141\u8bb8\u8bbf\u95ee\u8d44\u6e90\u3002 ConsensusBased\uff08\u5c11\u6570\u670d\u4ece\u591a\u6570\uff09\uff1a\u8d85\u8fc7\u4e00\u534a\u7684\u6295\u7968\u5668\u901a\u8fc7\u624d\u5141\u8bb8\u8bbf\u95ee\u8d44\u6e90\u3002 AffirmativeBased\uff08\u4e00\u7968\u901a\u8fc7\uff09\uff1a\u53ea\u8981\u6709\u4e00\u4e2a\u6295\u7968\u5668\u6295\u7968\u901a\u8fc7\uff0c\u5c31\u5141\u8bb8\u8bbf\u95ee\u8d44\u6e90\u3002AffirmativeBased\u4e3a\u9ed8\u8ba4\u7684AccessDecisionManager\u3002 \u4e0b\u9762\u4ee5 AffirmativeBased \u7684 #decide \u65b9\u6cd5\u4e3a\u4f8b\u8fdb\u884c\u7b80\u8981\u8bf4\u660e\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a public void decide(Authentication authentication, Object object, Collection<ConfigAttribute> configAttributes) throws AccessDeniedException { int deny = 0; //\u904d\u5386voter\u5217\u8868\uff0c\u5faa\u73af\u8c03\u7528vote\u7684\u65b9\u6cd5 for (AccessDecisionVoter voter : getDecisionVoters()) { int result = voter.vote(authentication, object, configAttributes); if (logger.isDebugEnabled()) { logger.debug(\"Voter: \" + voter + \", returned: \" + result); } switch (result) { case AccessDecisionVoter.ACCESS_GRANTED: return; //\u5f53\u6709result\u4e3aACCESS_GRANTED\u5219\u6743\u9650\u8ba4\u8bc1\u6210\u529f case AccessDecisionVoter.ACCESS_DENIED: deny++; break; default: break; } } if (deny > 0) { throw new AccessDeniedException(messages.getMessage( \"AbstractAccessDecisionManager.accessDenied\", \"Access is denied\")); } // To get this far, every AccessDecisionVoter abstained checkAllowIfAllAbstainDecisions(); } \u53ef\u4ee5\u770b\u51fa #decide \u65b9\u6cd5\u53ea\u662f\u5faa\u73af\u8c03\u7528\u4e86 AccessDecisionVoter \u7684 #vote \uff0c\u8be5\u65b9\u6cd5\u4f1a\u8fd4\u56de\u4e00\u4e2a\u6295\u7968\u7ed3\u679c\uff0c\u5f53\u6709\u4e00\u4e2avoter\u7684\u6295\u7968\u7ed3\u679c\u4e3aACCESS_GRANTED\u65f6\uff0c\u5219\u6743\u9650\u8ba4\u8bc1\u6210\u529f\uff1b\u5982\u679c\u6240\u6709\u7684\u6295\u7968\u7ed3\u679c\u4e2d\u90fd\u6ca1\u6709ACCESS_GRANTED\u65f6\uff0c\u629b\u51faAccessDeniedException\u5f02\u5e38\u8868\u660e\u8ba4\u8bc1\u5931\u8d25\u3002 Spring Security\u63d0\u4f9b\u51e0\u4e2a\u7f3a\u7701\u7684AccessDecisionVoter\uff0c\u5b83\u4eec\u5206\u522b\u5bf9\u5e94\u4e0d\u540c\u7684SpringSecurity\u914d\u7f6e\uff0c\u4e0b\u9762\u5bf9\u5e38\u7528\u7684\u4e24\u4e2a\u6295\u7968\u5668\u8fdb\u884c\u8bf4\u660e\uff1a RoleVoter\uff0c\u6700\u5e38\u89c1\u7684\u6295\u7968\u5668\uff0c\u5728RoleVoter\u4e2d\u5b9a\u4e49\u4e86\u6743\u9650\u7684\u524d\u7f00\uff08\u9ed8\u8ba4\u4e3a\"ROLE_\"\uff09\uff0c\u5f53\u914d\u7f6e\u4e2d\u6709\u4ee5\u6743\u9650\u524d\u7f00\u5f00\u5934\u7684\u914d\u7f6e\u65f6 #vote \u65b9\u6cd5\u624d\u4f1a\u8fdb\u884c\u6295\u7968\uff0c\u5426\u5219\u5f03\u6743\u3002 AuthenticatedVoter\uff0c\u5f53\u914d\u7f6e\u4e2d\u6709\u4ee5\u4e0b\u914d\u7f6e\u65f6\u624d\u4f1a\u8fdb\u884c\u6295\u7968\uff0c\u5426\u5219\u5f03\u6743\uff1a IS_AUTHENTICATED_ANONYMOUSLY \u5141\u8bb8\u533f\u540d\u7528\u6237\u8bbf\u95ee IS_AUTHENTICATED_FULLY \u5141\u8bb8\u767b\u5f55\u7528\u6237\u8bbf\u95ee IS_AUTHENTICATED_REMEMBERED \u5141\u8bb8\u767b\u5f55\u7528\u6237\u548crememberMe\u7528\u6237\u8bbf\u95ee \u5728SpringBoot\u4e2d\u4f7f\u7528SpringSecurity\u8fdb\u884c\u6743\u9650\u63a7\u5236 \u4ece\u6e90\u7801\u4e2d\u53ef\u4ee5\u5f97\u51fa\u7ed3\u8bba\uff0cSpringSecurity\u7684\u6743\u9650\u63a7\u5236\u9700\u8981\u4f7f\u7528\u8005\u505a\u7684\u5de5\u4f5c\u81f3\u5c11\u6709\u4ee5\u4e0b\u4e24\u4e2a\uff1a \u914d\u7f6e\u8bbf\u95ee\u5177\u4f53\u7684URL\u9700\u8981\u7684\u89d2\u8272\u6216\u8005\u6743\u9650\uff1b \u5728\u7528\u6237\u767b\u5165\u9a8c\u8bc1\u65f6\uff0c\u5c06\u5176\u62e5\u6709\u7684\u6743\u9650\u4ea4\u7ed9 UserDetails \u5bf9\u8c61\u3002 \u4e0b\u9762\u5c06\u4f7f\u7528SpringBoot + SpringDataJPA + SpringSecurity\u4e3a\u6280\u672f\u6846\u67b6\u8fdb\u884c\u4e00\u4e2a\u7b80\u5355\u8bf4\u660e\u3002 SysUser\u4e3a\u7cfb\u7edf\u7528\u6237\u5bf9\u8c61\uff0c\u5176\u89d2\u8272\u4f7f\u7528\u679a\u4e3e\u7c7bRoleType\u8868\u793a\uff0c\u5e76\u4e14\u5b58\u5728\u6570\u636e\u5e93\u4e2d\u3002 @Entity(name = \"user\") public class SysUser { @Id @GenericGenerator(name = \"uuid2\", strategy = \"org.hibernate.id.UUIDGenerator\") @GeneratedValue(generator = \"uuid2\") @Column(name = \"user_uuid\", columnDefinition = \"uuid\") private UUID uuid; @Column(name = \"user_name\", unique = true, nullable = false, length = 64) protected String username; @Column(name = \"role_type\", nullable = false) @Enumerated(EnumType.STRING) protected RoleType role; @Column(name = \"password\") private String password; //getter\u3001setter } RoleType\u4e3a\u679a\u4e3e\u7c7b\uff0c\u5728\u7cfb\u7edf\u4e2d\u4ee3\u8868\u7528\u6237\u7684\u89d2\u8272\u7c7b\u578b\u3002 public enum RoleType { SUPER_ADMIN(0,\"\u8d85\u7ea7\u7ba1\u7406\u5458\",\"super_admin\",true,true), ADMIN(1,\"\u7ba1\u7406\u5458\",\"admin\",true,true), GUEST(99,\"\u6e38\u5ba2\",\"guest\", false, false); private int value; private String name; private String roleName; private boolean isLogin; private boolean isAdmin; } UserService\u662f\u7cfb\u7edf\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u7684Service\u7c7b\uff0c\u5b9e\u73b0\u7684SpringSecurity\u7684UserDetailsService\u63a5\u53e3\uff0c\u5b83\u5b9e\u73b0\u4e86 #loadUserByUsername \u65b9\u6cd5\u662fSpringSecurity\u5b9e\u73b0\u767b\u5165\u548c\u6743\u9650\u8ba4\u8bc1\u7684\u5173\u952e\u65b9\u6cd5\uff0c\u9700\u8981\u8fd4\u56de User \u7684\u5177\u4f53\u4fe1\u606f\uff08\u5305\u62ec\u6743\u9650\uff09\u3002 @Service public class UserDetailService implements UserDetailsService { private final UserRepository userRepository; //\u5728JPA\u4e2d\u76f8\u5f53\u4e8edao\uff0c\u8fd9\u91cc\u4e0d\u5c55\u5f00\u8bf4\u660e\u3000\u3000\u3000\u3000\u3000 @Autowired public UserDetailService(UserRepository userRepository){ this.repository = userRepository; } public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException { SysUser user = repository.findUserByUsername(username); if (user==null) throw new UsernameNotFoundException(\"\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef\");\u3000//\u629b\u51fa\u5f02\u5e38\uff0c\u4f1a\u6839\u636e\u914d\u7f6e\u8df3\u5230\u767b\u5f55\u5931\u8d25\u9875\u9762 List<GrantedAuthority> authorities = getRoles(user);\u3000//\u83b7\u53d6\u7528\u6237\u6743\u9650 org.springframework.security.core.userdetails.User auth_user = new org.springframework.security.core.userdetails.User(user.getUsername(), user.getPassword(), list);\u3000\u3000\u3000\u3000\u3000\u3000//\u5c06\u6743\u9650\u4f20\u9012\u7ed9UserDetails return auth_user; } /**\u6839\u636e\u7528\u6237\u8fd4\u56de\u4ed6\u7684\u6743\u9650\u5217\u8868*/ public List<GrantedAuthority> getRoles(SysUser user){ List<GrantedAuthority> authorities = new ArrayList<>(); //SpringSecurity\u5bf9\u89d2\u8272\u7684\u8ba4\u8bc1\u9700\u8981\u4ee5\"ROLE_\"\u4f5c\u4e3a\u5f00\u5934\uff0c\u53ef\u4ee5\u8bbe\u7f6e String role = \"ROLE_\" + user.getRoleType().name(); authorities.add(new SimpleGrantedAuthority(role)); return authorities; } } \u914d\u7f6eSpringSecurity \u5728SpringBoot\u4e2d\u53ef\u4ee5\u901a\u8fc7\u7ee7\u627f WebSecurityConfigurerAdapter \u7c7b\u5e76\u4f7f\u7528 @Configuration \u548c @EnableWebSecurity \u6ce8\u89e3\u6765\u914d\u7f6eSpringSecurity\uff0c\u5982\u4e0b\uff1a @Configuration @EnableWebSecurity public class WebSecurityConfig extends WebSecurityConfigurerAdapter{\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 @Autowired private UserDetailService userDetailService;//\u5373\u6211\u4eec\u5b9e\u73b0\u7684UserService @Override protected void configure(HttpSecurity http) throws Exception { http.authorizeRequests() //\u7ba1\u7406\u5458\u9875\u9762\u53ea\u5141\u8bb8\u62e5\u6709ADMIN,SUPER_ADMIN\u89d2\u8272\u7684\u7528\u6237\u8bbf\u95ee //\u8fd9\u91cc\u7684\"ADMIN\"\u4e0d\u9700\u8981\u52a0\"ROLE_\"\u524d\u7f00\u662f\u56e0\u4e3ahasAnyRole\u65b9\u6cd5\u4f1a\u9ed8\u8ba4\u6dfb\u52a0\"ROLE_\"\u524d\u7f00 .antMatchers(\"/admin.html\").hasAnyRole(\"ADMIN\",\"SUPER_ADMIN\") .anyRequest() .authenticated() .accessDecisionManager(buildDecisionManager()) .and() .formLogin() //\u767b\u5165\u9875\u9762,\u4e3a\u767b\u5165\u65f6\u4f1a\u8df3\u8f6c\u5230\u8be5\u9875\u9762 .loginPage(\"/login.html\") .permitAll() //SpringSecurity\u63a5\u53d7\u767b\u5165\u8bf7\u6c42\u7684url\uff0c\u9ed8\u8ba4\u4e3a\"/login\" .loginProcessingUrl(\"/login\")\u3000\u3000 .and() .logout() //SpringSecurity\u63a5\u53d7\u767b\u51fa\u8bf7\u6c42\u7684url\uff0c\u9ed8\u8ba4\u4e3a\"/logout\" \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000.logoutUrl(\"/logout\") .permitAll(); } @Override protected void configure(AuthenticationManagerBuilder auth) throws Exception { auth.userDetailsService(userDetailService);\u3000//\u914d\u7f6e\u81ea\u5b9a\u4e49userDetailService } @Bean public AccessDecisionManager buildDecisionManager() { //\u5bf9AccessDecisionManager\u8fdb\u884c\u5ba2\u6237\u5316\u914d\u7f6e //\u8fd9\u91cc\u4f7f\u7528AffirmativeBased\uff08\u4e00\u7968\u901a\u8fc7\uff09\u7ba1\u7406\u5668 //\u5e76\u4e14\u53ea\u914d\u7f6e\u4e86RoleVoter\uff0c\u53ea\u8fdb\u884c\u89d2\u8272\u9650\u5236 List<AccessDecisionVoter<? extends Object>> decisionVoters = Arrays.asList\uff08new RoleVoter()); return new AffirmativeBased(decisionVoters); } } \u5982\u4e0a\u914d\u7f6e\u7c7b\u6240\u793a\uff0c\u6211\u4eec\u5bf9admin.html\u7684\u8bbf\u95ee\u52a0\u4e86\u89d2\u8272\u9650\u5236\uff0c\u53ea\u6709\u4e3a\u89d2\u8272\"ADMIN\"\u6216\"SUPER_ADMIN\"\u7684\u7528\u6237\u53ef\u4ee5\u8bbf\u95ee\u8be5\u9875\u9762\uff0c\u5e76\u4e14\u5bf9 AccessDecisionManager \u5ba2\u6237\u5316\u7684\u914d\u7f6e\uff0c\u6743\u9650\u7ba1\u7406\u5668\u4f7f\u7528\u4e86AffirmativeBased\u5e76\u4e14\u5b83\u7684\u6295\u7968\u8005\u53ea\u6709RoleVoter\u3002 SpringSecurity\u6743\u9650\u63a7\u5236\u76f8\u5173\u6ce8\u89e3 \u53c2\u8003 http://www.spring4all.com/article/420 https://elim.iteye.com/blog/2247057 https://blog.csdn.net/neweastsun/article/details/80633421 https://www.cnblogs.com/scau-chm/p/5967931.html","title":"SpringSecurity\u7b14\u8bb0"},{"location":"Spring/SpringSecurity/SpringSecurtiy\u6e90\u7801\u5206\u6790/#springsecurity","text":"SpringSecurity\u6743\u9650\u9a8c\u8bc1\u662f\u901a\u8fc7\u4e00\u7cfb\u5217\u7684\u8fc7\u6ee4\u5668\uff08Filter\uff09\u6765\u5b9e\u73b0\u7684\uff0c\u4f46\u4ece\u5bb9\u5668\u7684\u89d2\u5ea6\u6765\u770b\u5728\u8fc7\u6ee4\u94fe\u4e2d\u5b83\u8868\u73b0\u4e3a\u4e00\u4e2a Filter \uff0c\u5176\u7c7b\u578b\u662f FilterChainProxy \u3002\u6362\u53e5\u8bdd\u8bf4\uff0cSpringSecurity\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u7269\u7406\u8fc7\u6ee4\u5668\uff0c\u4f46\u662f\u5b83\u5c06\u8bf7\u6c42\u59d4\u6258\u7ed9\u4e00\u7cfb\u5217\u7684\u5185\u90e8\u8fc7\u6ee4\u5668\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a SpringSecurity\u7684\u5185\u90e8\u8fc7\u6ee4\u5668\u94fe\u5982\u4e0b\uff1a \u522b\u540d \u7c7b\u540d\u79f0 Namespace Element or Attribute CHANNEL_FILTER ChannelProcessingFilter http/intercept-url @requires -channel SECURITY_CONTEXT_FILTER SecurityContextPersistenceFilter http CONCURRENT_SESSION_FILTER ConcurrentSessionFilter session-management/concurrency-control HEADERS_FILTER HeaderWriterFilter http/headers CSRF_FILTER CsrfFilter http/csrf LOGOUT_FILTER LogoutFilter http/logout X509_FILTER X509AuthenticationFilter http/x509 PRE_AUTH_FILTER AbstractPreAuthenticatedProcessingFilter( Subclasses) N/A CAS_FILTER CasAuthenticationFilter N/A FORM_LOGIN_FILTER UsernamePasswordAuthenticationFilter http/form-login BASIC_AUTH_FILTER BasicAuthenticationFilter http/http-basic SERVLET_API_SUPPORT_FILTER SecurityContextHolderAwareRequestFilter http/ @servlet -api-provision JAAS_API_SUPPORT_FILTER JaasApiIntegrationFilter http/ @jaas -api-provision REMEMBER_ME_FILTER RememberMeAuthenticationFilter http/remember-me ANONYMOUS_FILTER AnonymousAuthenticationFilter http/anonymous SESSION_MANAGEMENT_FILTER SessionManagementFilter session-management EXCEPTION_TRANSLATION_FILTER ExceptionTranslationFilter http FILTER_SECURITY_INTERCEPTOR FilterSecurityInterceptor http SWITCH_USER_FILTER SwitchUserFilter N/A \u8fc7\u6ee4\u5668\u7684\u8fc7\u6ee4\u987a\u5e8f\u81ea\u4e0a\u800c\u4e0b\uff0c\u6309\u987a\u5e8f\u6267\u884c\u3002","title":"SpringSecurity\u7b14\u8bb0"},{"location":"Spring/SpringSecurity/SpringSecurtiy\u6e90\u7801\u5206\u6790/#_1","text":"spring security\u57fa\u4e8e\u6570\u636e\u5e93\u7684\u767b\u5f55\u8ba4\u8bc1\u4f7f\u7528\u7684\u9ed8\u8ba4\u8fc7\u6ee4\u5668\u4e3a UsernamePasswordAuthenticationFilter \u7c7b\uff0c\u8be5\u7c7b\u7ee7\u627f\u81ea AbstractAuthenticationProcessingFilter \u62bd\u8c61\u7c7b\u3002 AbstractAuthenticationProcessingFilter \u62bd\u8c61\u7c7b\u901a\u8fc7doFilter\u5c01\u88c5\u4e86\u767b\u5165\u8ba4\u8bc1\u7684\u57fa\u672c\u903b\u8f91\uff0c\u5b50\u7c7b\u5b9e\u73b0\u5176\u4e2d\u7684\u62bd\u8c61\u65b9\u6cd5\u8fdb\u884c\u8ba4\u8bc1\uff0c\u8be5\u7c7bdoFilter\u65b9\u6cd5\u5982\u4e0b\uff1a /** * \u8c03\u7528 #requiresAuthentication(HttpServletRequest, HttpServletResponse) \u51b3\u5b9a\u662f\u5426\u9700\u8981\u8fdb\u884c\u9a8c\u8bc1\u64cd\u4f5c\u3002 * \u5982\u679c\u9700\u8981\u9a8c\u8bc1\uff0c\u5219\u4f1a\u8c03\u7528 #attemptAuthentication(HttpServletRequest, HttpServletResponse) \u65b9\u6cd5\u3002 * \u6709\u4e09\u79cd\u7ed3\u679c\uff1a * 1\u3001\u8fd4\u56de\u4e00\u4e2a Authentication \u5bf9\u8c61\u3002 * \u914d\u7f6e\u7684 SessionAuthenticationStrategy` \u5c06\u88ab\u8c03\u7528\uff0c * \u7136\u540e \u7136\u540e\u8c03\u7528 #successfulAuthentication(HttpServletRequest\uff0cHttpServletResponse\uff0cFilterChain\uff0cAuthentication) \u65b9\u6cd5\u3002 * 2\u3001\u9a8c\u8bc1\u65f6\u53d1\u751f AuthenticationException\u3002 * #unsuccessfulAuthentication(HttpServletRequest, HttpServletResponse, AuthenticationException) \u65b9\u6cd5\u5c06\u88ab\u8c03\u7528\u3002 * 3\u3001\u8fd4\u56deNull\uff0c\u8868\u793a\u8eab\u4efd\u9a8c\u8bc1\u4e0d\u5b8c\u6574\u3002\u5047\u8bbe\u5b50\u7c7b\u505a\u4e86\u4e00\u4e9b\u5fc5\u8981\u7684\u5de5\u4f5c\uff08\u5982\u91cd\u5b9a\u5411\uff09\u6765\u7ee7\u7eed\u5904\u7406\u9a8c\u8bc1\uff0c\u65b9\u6cd5\u5c06\u7acb\u5373\u8fd4\u56de\u3002 * \u5047\u8bbe\u540e\u4e00\u4e2a\u8bf7\u6c42\u5c06\u88ab\u8fd9\u79cd\u65b9\u6cd5\u63a5\u6536\uff0c\u5176\u4e2d\u8fd4\u56de\u7684Authentication\u5bf9\u8c61\u4e0d\u4e3a\u7a7a\u3002 */ public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) throws IOException, ServletException { HttpServletRequest request = (HttpServletRequest) req; HttpServletResponse response = (HttpServletResponse) res; //\u5224\u65ad\u662f\u5426\u8981\u8fdb\u884c\u9a8c\u8bc1\uff0c\u5373\u5224\u65adurl\u662f\u5426\u4e3a\"/login\"(\u4f60\u8bbe\u7f6e\u7684\u767b\u5165url)\u5e76\u4e14\u8bf7\u6c42\u65b9\u6cd5\u662f\u5426\u4e3apost if (!requiresAuthentication(request, response)) { chain.doFilter(request, response); return; } if (logger.isDebugEnabled()) { logger.debug(\"Request is to process authentication\"); } Authentication authResult; try { //\u8be5\u65b9\u6cd5\u4e3a\u62bd\u8c61\u65b9\u6cd5\u7531\u5b50\u7c7b\u5b9e\u73b0 authResult = attemptAuthentication(request, response); if (authResult == null) { // return immediately as subclass has indicated that it hasn't completed // authentication return; } sessionStrategy.onAuthentication(authResult, request, response); } catch (InternalAuthenticationServiceException failed) { logger.error( \"An internal error occurred while trying to authenticate the user.\", failed); unsuccessfulAuthentication(request, response, failed); return; } catch (AuthenticationException failed) { // Authentication failed unsuccessfulAuthentication(request, response, failed); return; } // Authentication success if (continueChainBeforeSuccessfulAuthentication) { chain.doFilter(request, response); } successfulAuthentication(request, response, chain, authResult); } \u4e0a\u6587\u63d0\u5230\u4e86 AbstractAuthenticationProcessingFilter \u62bd\u8c61\u7c7b\u5728SpringSecurity\u7684\u9ed8\u8ba4\u5b9e\u73b0\u4e3a UsernamePasswordAuthenticationFilter \uff0c\u56e0\u6b64\u5c06\u8c03\u7528\u7684 UsernamePasswordAuthenticationFilter \u7c7b\u7684 #attemptAuthentication \u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u4e3b\u8981\u4f5c\u7528\u662f\u63d0\u53d6request\u4e2d\u7684\u8d26\u6237\uff08username\uff09\u548c\u5bc6\u7801\uff08password\uff09\u5c5e\u6027\u751f\u6210 UsernamePasswordAuthenticationToken \u5bf9\u8c61\uff0c\u4ea4\u7ed9 AuthenticationManager \u8fdb\u884c\u9a8c\u8bc1\uff08\u5373\u8c03\u7528this.getAuthenticationManager().authenticate(authRequest) \uff09\u3002\u4ee3\u7801\u5982\u4e0b\uff1a public Authentication attemptAuthentication(HttpServletRequest request, HttpServletResponse response) throws AuthenticationException { if (postOnly && !request.getMethod().equals(\"POST\")) { throw new AuthenticationServiceException( \"Authentication method not supported: \" + request.getMethod()); } //\u4ecerequest\u4e2d\u83b7\u5f97\u8d26\u6237\u548c\u5bc6\u7801 String username = obtainUsername(request); String password = obtainPassword(request); if (username == null) { username = \"\"; } if (password == null) { password = \"\"; } // \u5220\u9664\u5934\u5c3e\u7684\u7a7a\u683c username = username.trim(); UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken( username, password); // Allow subclasses to set the \"details\" property setDetails(request, authRequest); return this.getAuthenticationManager().authenticate(authRequest); } \u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b UsernamePasswordAuthenticationFilter \u7c7b\u6301\u6709\u7684AuthenticationManager\u5b9e\u4f8b\u5bf9\u8c61\u4e3a ProviderManager \uff0c\u8be5\u7c7b\u7684 #authenticate \u65b9\u6cd5\u904d\u5386\u6240\u6709\u7684AuthenticationProvider\uff0c\u5e76\u9009\u62e9\u7b26\u5408\u6761\u4ef6\u7684Provider\u8c03\u7528\u5176\u9a8c\u8bc1\u65b9\u6cd5\u3002\u4ee3\u7801\u5982\u4e0b\uff1a /** * \u5c1d\u8bd5\u9a8c\u8bc1 Authentication \u5bf9\u8c61 * AuthenticationProvider \u5217\u8868\u5c06\u88ab\u8fde\u7eed\u5c1d\u8bd5\uff0c\u76f4\u5230 AuthenticationProvider \u8868\u793a\u5b83\u80fd\u591f\u8ba4\u8bc1\u4f20\u9012\u7684\u8fc7\u6765\u7684Authentication \u5bf9\u8c61\u3002\u7136\u540e\u5c06\u4f7f\u7528\u8be5 AuthenticationProvider \u5c1d\u8bd5\u8eab\u4efd\u9a8c\u8bc1\u3002 * \u5982\u679c\u6709\u591a\u4e2a AuthenticationProvider \u652f\u6301\u9a8c\u8bc1\u4f20\u9012\u8fc7\u6765\u7684Authentication \u5bf9\u8c61\uff0c\u90a3\u4e48\u7531\u7b2c\u4e00\u4e2a\u6765\u786e\u5b9a\u7ed3\u679c\uff0c\u8986\u76d6\u65e9\u671f\u652f\u6301AuthenticationProviders \u6240\u5f15\u53d1\u7684\u4efb\u4f55\u53ef\u80fd\u7684AuthenticationException\u3002 \u6210\u529f\u9a8c\u8bc1\u540e\uff0c\u5c06\u4e0d\u4f1a\u5c1d\u8bd5\u540e\u7eed\u7684AuthenticationProvider\u3002 * \u5982\u679c\u6700\u540e\u6240\u6709\u7684 AuthenticationProviders \u90fd\u6ca1\u6709\u6210\u529f\u9a8c\u8bc1 Authentication \u5bf9\u8c61\uff0c\u5c06\u629b\u51fa AuthenticationException\u3002 */ public Authentication authenticate(Authentication authentication) throws AuthenticationException { Class<? extends Authentication> toTest = authentication.getClass(); AuthenticationException lastException = null; Authentication result = null; boolean debug = logger.isDebugEnabled(); for (AuthenticationProvider provider : getProviders()) { if (!provider.supports(toTest)) { continue; } if (debug) { logger.debug(\"Authentication attempt using \" + provider.getClass().getName()); } try { result = provider.authenticate(authentication); if (result != null) { copyDetails(authentication, result); break; } } catch (AccountStatusException e) { prepareException(e, authentication); // SEC-546: Avoid polling additional providers if auth failure is due to // invalid account status throw e; } catch (InternalAuthenticationServiceException e) { prepareException(e, authentication); throw e; } catch (AuthenticationException e) { lastException = e; } } if (result == null && parent != null) { // Allow the parent to try. try { result = parent.authenticate(authentication); } catch (ProviderNotFoundException e) { // ignore as we will throw below if no other exception occurred prior to // calling parent and the parent // may throw ProviderNotFound even though a provider in the child already // handled the request } catch (AuthenticationException e) { lastException = e; } } if (result != null) { if (eraseCredentialsAfterAuthentication && (result instanceof CredentialsContainer)) { // Authentication is complete. Remove credentials and other secret data // from authentication ((CredentialsContainer) result).eraseCredentials(); } eventPublisher.publishAuthenticationSuccess(result); return result; } // Parent was null, or didn't authenticate (or throw an exception). if (lastException == null) { lastException = new ProviderNotFoundException(messages.getMessage( \"ProviderManager.providerNotFound\", new Object[] { toTest.getName() }, \"No AuthenticationProvider found for {0}\")); } prepareException(lastException, authentication); throw lastException; } \u901a\u8fc7\u4e0a\u9762\u7684\u4ee3\u7801\u53ef\u4ee5\u770b\u51fa\uff0c\u9a8c\u8bc1\u7684\u6838\u5fc3\u4ee3\u7801\u4e3a\uff1a result = provider.authenticate(authentication); SpringSecurity\u4e2d\u5904\u7406UsernamePasswordAuthenticationToken\u7684AuthenticationProvider\u662f\u62bd\u8c61\u7c7b AbstractUserDetailsAuthenticationProvider \u7684\u5b50\u7c7b\uff0c\u8be5\u7c7b\u7684 #authenticate \u65b9\u6cd5\u4ee3\u7801\u5982\u4e0b\uff1a // \u9a8c\u8bc1 authentication public Authentication authenticate(Authentication authentication) throws AuthenticationException { Assert.isInstanceOf(UsernamePasswordAuthenticationToken.class, authentication, messages.getMessage( \"AbstractUserDetailsAuthenticationProvider.onlySupports\", \"Only UsernamePasswordAuthenticationToken is supported\")); // Determine username String username = (authentication.getPrincipal() == null) ? \"NONE_PROVIDED\" : authentication.getName(); boolean cacheWasUsed = true; //\u8fd9\u91cc\u4f7f\u7528\u4e86\u7f13\u5b58\u673a\u5236\uff0c\u5148\u5728\u7f13\u5b58\u4e2d\u67e5\u627e\u7528\u6237\u662f\u5426\u5b58\u5728\uff08\u9ed8\u8ba4\u7f13\u5b58\u4e3aNullUserCache\uff0c\u5373\u4e0d\u505a\u7f13\u5b58\uff09 UserDetails user = this.userCache.getUserFromCache(username); if (user == null) { cacheWasUsed = false; try { //\u5982\u679c\u7528\u6237\u4e0d\u5b58\u5728\u5219\u8c03\u7528retrieveUser\u65b9\u6cd5 //retrieveUser\u65b9\u6cd5\u4e3a\u62bd\u8c61\u65b9\u6cd5\uff0c\u7531\u5b50\u7c7b\u5b9e\u73b0 user = retrieveUser(username, (UsernamePasswordAuthenticationToken) authentication); } catch (UsernameNotFoundException notFound) { logger.debug(\"User '\" + username + \"' not found\"); if (hideUserNotFoundExceptions) { throw new BadCredentialsException(messages.getMessage( \"AbstractUserDetailsAuthenticationProvider.badCredentials\", \"Bad credentials\")); } else { throw notFound; } } Assert.notNull(user, \"retrieveUser returned null - a violation of the interface contract\"); } try { preAuthenticationChecks.check(user); additionalAuthenticationChecks(user, (UsernamePasswordAuthenticationToken) authentication); } catch (AuthenticationException exception) { if (cacheWasUsed) { //\u8fd9\u91cc\u6d89\u53ca\u5230\u4e00\u4e2a\u95ee\u9898 //\u4ece\u7f13\u5b58\u4e2d\u83b7\u5f97\u7684\u7528\u6237\u53ef\u80fd\u4e0d\u662f\u6700\u65b0\u7684\u7528\u6237\u4fe1\u606f\uff0c\u56e0\u6b64\u5728\u9a8c\u8bc1\u5931\u8d25\u540e\u8fd8\u4f1a\u8fdb\u884c\u4e00\u6b21\u9a8c\u8bc1 cacheWasUsed = false; user = retrieveUser(username, (UsernamePasswordAuthenticationToken) authentication); preAuthenticationChecks.check(user); additionalAuthenticationChecks(user, (UsernamePasswordAuthenticationToken) authentication); } else { throw exception; } } postAuthenticationChecks.check(user); if (!cacheWasUsed) { this.userCache.putUserInCache(user); } Object principalToReturn = user; if (forcePrincipalAsString) { principalToReturn = user.getUsername(); } return createSuccessAuthentication(principalToReturn, authentication, user); } \u4ece\u4e0a\u9762\u7684\u4ee3\u7801\u53ef\u4ee5\u770b\u51fa AbstractUserDetailsAuthenticationProvider \u4f7f\u7528\u4e86\u7f13\u5b58\u673a\u5236\uff0c\u73b0\u5728\u7f13\u5b58\u4e2d\u83b7\u53d6\u7528\u6237\uff0c\u5982\u679c\u7528\u6237\u4e0d\u5b58\u5728\u5219\u8c03\u7528 #retrieveUser \u83b7\u5f97\uff0c\u7136\u540e\u518d\u4e0e\u4f20\u5165\u7684\u7528\u6237\u4fe1\u606f\u8fdb\u884c\u6bd4\u5bf9\u3002\u8fd9\u91cc\u6709\u4e00\u70b9\u9700\u8981\u6ce8\u610f\uff0c\u5728\u9a8c\u8bc1\u5931\u8d25\u540eSpringSecurity\u53c8\u8fdb\u884c\u4e86\u4e00\u6b21\u9a8c\u8bc1\uff0c\u76ee\u7684\u662f\u9632\u6b62\u7f13\u5b58\u4e2d\u7684\u4fe1\u606f\u8fc7\u65f6\u3002 \u5176\u4e2d\u7684 #retrieveUser \u65b9\u6cd5\u4e3a\u62bd\u8c61\u65b9\u6cd5\uff0c\u5728SpringSecurity\u4e2d\u7531 AbstractUserDetailsAuthenticationProvider \u7684\u9ed8\u8ba4\u5b50\u7c7b DaoAuthenticationProvider \u5b9e\u73b0\u3002\u4ee3\u7801\u5982\u4e0b\uff1a protected final UserDetails retrieveUser(String username, UsernamePasswordAuthenticationToken authentication) throws AuthenticationException { UserDetails loadedUser; try { //\u8c03\u7528UserDetailsService\u7684loadUserByUsername\u65b9\u6cd5\u4ece\u6570\u636e\u5e93\u83b7\u5f97\u7528\u6237 loadedUser = this.getUserDetailsService().loadUserByUsername(username); } catch (UsernameNotFoundException notFound) { if (authentication.getCredentials() != null) { String presentedPassword = authentication.getCredentials().toString(); passwordEncoder.isPasswordValid(userNotFoundEncodedPassword, presentedPassword, null); } throw notFound; } catch (Exception repositoryProblem) { throw new InternalAuthenticationServiceException( repositoryProblem.getMessage(), repositoryProblem); } if (loadedUser == null) { throw new InternalAuthenticationServiceException( \"UserDetailsService returned null, which is an interface contract violation\"); } return loadedUser; } \u53ef\u4ee5\u770b\u51fa\u6b64\u5904\u7684\u8fd4\u56de\u5bf9\u8c61 userDetails \u662f\u7531 UserDetailsService \u7684 #loadUserByUsername(username) \u6765\u83b7\u53d6\u7684\u3002\u800cUserDetailsService\u53c8\u662f\u4ece\u4f55\u800c\u6765\u5462\uff1f\u5b9e\u9645\u4e0a\uff0c UserDetailsService \u662f\u5728SpringSecurity\u76f8\u5173\u914d\u7f6e\u4e2d\u5b9a\u4e49\u7684\uff0c\u4e0b\u6587\u4f1a\u4f7f\u7528\u7b80\u5355\u7684\u4f8b\u5b50\u8fdb\u884c\u8bf4\u660e\u3002","title":"\u57fa\u4e8e\u6570\u636e\u5e93\u7684\u767b\u5165\u8ba4\u8bc1"},{"location":"Spring/SpringSecurity/SpringSecurtiy\u6e90\u7801\u5206\u6790/#spring-bootspringsecurity","text":"\u9996\u5148\uff0c\u5728 pom.xml \u6587\u4ef6\u4e2d\u6dfb\u52a0SpringSecurity\u4f9d\u8d56\uff0c\u5982\u4e0b\uff1a <dependencies> ... <dependency> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter-security</artifactId> </dependency> ... </dependencies> \u63a5\u7740\uff0c\u5bf9SpringSecurity\u8fdb\u884c\u914d\u7f6e\uff0c\u9700\u8981\u6ce8\u610f\u4e00\u4e0b\u51e0\u70b9\uff1a \u5728Spring-boot\u4e2d\u4f7f\u7528SpringSecurity\u9700\u8981\u4f7f\u7528 @EnableWebSecurity \u6ce8\u89e3\uff0c\u8be5\u6ce8\u89e3\u9700\u8981\u914d\u5408@Configuration\u4e00\u8d77\u4f7f\u7528\uff0c\u7528\u6765\u6807\u6ce8SpringSecurity\u7684\u914d\u7f6e\u7c7b\u3002 SpringSecurity\u914d\u7f6e\u7c7b\u9700\u8981\u5b9e\u73b0 WebSecurityConfigurer \u63a5\u53e3\uff0c\u6216\u8005\u7ee7\u627f\u81ea WebSecurityConfigurerAdapter \u3002 \u4e00\u822c\u4f1a\u9009\u62e9\u7ee7\u627f WebSecurityConfigurerAdapter \u62bd\u8c61\u7c7b\u6765\u4f7f\u7528SpringSecurity\u7684\u9ed8\u8ba4\u914d\u7f6e\uff0c\u5e76\u4e14\u91cd\u5199configure(AuthenticationManagerBuilder auth) \u548c configure(HttpSecurity http)\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u6765\u8fdb\u884c\u5ba2\u6237\u5316\u914d\u7f6e\u3002 \u4e0b\u9762\u4e3aSpringSecurity\u914d\u7f6e\u7684\u4f8b\u5b50\uff1a @Configuration @EnableWebSecurity public class WebSecurityConfig extends WebSecurityConfigurerAdapter { @AutoWired private UserDetailsService myUserDetailsService; @Override protected void configure(HttpSecurity http) throws Exception { http .authorizeRequests() .antMatchers(\"/\", \"/home\").permitAll() .anyRequest().authenticated() .and() .formLogin() .loginPage(\"/login\") .permitAll() .and() .logout() .permitAll(); } @Override protected void configure(AuthenticationManagerBuilder builder) throws Exception{ builder.userDetailsService(myUserDetailsService) .passwordEncoder(passwordEncoder()); } @Bean public BCryptPasswordEncoder passwordEncoder(){ return new BCryptPasswordEncoder(); } } \u5176\u4e2d configure(HttpSecurity) \u65b9\u6cd5\u4e3b\u8981\u8d1f\u8d23\u914d\u7f6e\u8d44\u6e90\u548cURL\u7684\u6743\u9650\u63a7\u5236\uff0c\u5373\u914d\u7f6e\u54ea\u4e9b\u8d44\u6e90\u6216URL\u9700\u8981\u6388\u6743\uff08\u72ed\u4e49\u4e0a\u5c31\u662f\u767b\u5165\uff09\u4ee5\u540e\u624d\u80fd\u8bbf\u95ee\uff0c\u54ea\u4e9b\u8d44\u6e90\u6216URL\u53ef\u4ee5\u81ea\u7531\u8bbf\u95ee\u3002\u5177\u4f53\u4ee5\u4e0a\u9762\u7684\u4f8b\u5b50\u6765\u8bf4\uff0c\"/\"\u548c\"/home\"\u4e0b\u7684\u8d44\u6e90\u88ab\u914d\u7f6e\u4e3a\u4e0d\u9700\u8981\u8fdb\u884c\u4efb\u4f55\u8eab\u4efd\u9a8c\u8bc1\u5373\u53ef\u8bbf\u95ee\uff0c\u5176\u4ed6\u8def\u5f84\u4e0b\u7684\u8d44\u6e90\u8bbf\u95ee\u5fc5\u987b\u5148\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\uff1b\u5f00\u542f\u4e86\u8868\u5355\u767b\u5165\u529f\u80fd\uff0c\u767b\u5165\u9875\u9762\u4e3a\"/login\"\u4e5f\u4e0d\u9700\u8981\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u5373\u53ef\u8bbf\u95ee\uff0c\u5f53\u672a\u6388\u6743\u5bf9\u9700\u8981\u6388\u6743\u8d44\u6e90\u8fdb\u884c\u8bbf\u95ee\u65f6\u4f1a\u8df3\u8f6c\u5230\u6307\u5b9a\u7684\u767b\u5165\u754c\u9762\u3002 \u800cconfigure(AuthenticationManagerBuilder)\u65b9\u6cd5\u4ece\u53c2\u6570\u540d\u5c31\u53ef\u4ee5\u770b\u51fa\u8be5\u65b9\u6cd5\u5bf9AuthenticationManagerBuilder\u8fdb\u884c\u914d\u7f6e\uff0c\u5b83\u53ef\u4ee5\u4f7f\u7528\u5185\u5b58\u65b9\u5f0f\uff08in-memory\uff09\u3001JDBC \u6216 LDAP\u3001\u6216\u81ea\u5b9a\u4e49\u7684 UserDetailService \u6765\u8ba4\u8bc1\u7528\u6237\uff0c\u4ece\u800c\u5f71\u54cd\u5230AuthenticationManager\u7684\u5c5e\u6027\u3002\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\u914d\u7f6e\u4e86\u6388\u6743\u8ba4\u8bc1\u8fc7\u7a0b\u7684UserDetailsService\u5bf9\u8c61\u4ee5\u53ca\u5bc6\u7801\u52a0\u5bc6\u5bf9\u8c61\uff0c\u5373\u5728 \u57fa\u4e8e\u6570\u636e\u5e93\u7684\u767b\u5165\u9a8c\u8bc1 \u90e8\u5206 DaoAuthenticationProvider \u83b7\u5f97\u7684UserDetailsService\u5728\u8fd9\u91cc\u88ab\u8bbe\u7f6e\u4e86\u3002\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u76f4\u63a5\u5bf9 DaoAuthenticationProvider \u8fdb\u884c\u914d\u7f6e\uff1a @Configuration @EnableWebSecurity public class SecurityConfiguration extends WebSecurityConfigurerAdapter { private final UserDetailsService userDetailsService; @Autowired public SecurityConfiguration(@Qualifier(\"userService\") UserDetailsService userDetailsService) { this.userDetailsService = userDetailsService; } @Autowired public void configureGlobal(AuthenticationManagerBuilder auth, PasswordEncoder passwordEncoder) throws Exception { // \u8bbe\u7f6e\u8eab\u4efd\u9a8c\u8bc1\u5668 DaoAuthenticationProvider authenticationProvider = new DaoAuthenticationProvider(); authenticationProvider.setUserDetailsService(userDetailsService);// \u8bbe\u7f6e\u7528\u6237\u670d\u52a1\u7c7b authenticationProvider.setPasswordEncoder(passwordEncoder); // \u8bbe\u7f6e\u5bc6\u7801\u52a0\u5bc6\u65b9\u5f0f auth.authenticationProvider(authenticationProvider);//\u8bbe\u7f6eauthenticationProvider } ...//\u5176\u4ed6\u914d\u7f6e\u7701\u7565 } UserDetailsService\u5b9e\u9645\u4e0a\u53ea\u662f\u4e00\u4e2a\u63a5\u53e3\uff0c\u5176\u4e2d\u5b9a\u4e49\u4e86 #loadUserByUsername \u65b9\u6cd5\u7528\u4e8e\u8fd4\u56de\u7528\u6237\u4fe1\u606f\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u8ba9UserService\u5b9e\u73b0\u8be5\u63a5\u53e3\uff0c\u5982\u4e0b\uff1a @Service public class UserService implements UserDetailsService { ...//\u7701\u7565\u5176\u4ed6\u65b9\u6cd5 @Override public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException { if(username == null){ throw new UsernameNotFoundException(\"\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a\"); } return userDao.findByName(username); } } \u4e0a\u8ff0\u914d\u7f6e\u5b8c\u6210\u540e\uff0cSpringSecurity\u4e0e\u6570\u636e\u5e93\u5bf9\u8c61\u4e4b\u95f4\u5c31\u5efa\u7acb\u4e86\u8054\u7cfb\uff0c\u5f53\u7528\u6237\u8fdb\u884c\u8d44\u6e90\u8bbf\u95ee\u65f6\u4f1a\u5148\u53bb\u6570\u636e\u5e93\u83b7\u5f97\u8be5\u5bf9\u8c61\u8fdb\u884c\u6bd4\u5bf9\uff0c\u5224\u65ad\u662f\u5426\u6709\u6743\u9650\u83b7\u5f97\u76f8\u5e94\u7684\u8d44\u6e90\u3002","title":"\u5728Spring-boot\u4e2d\u4f7f\u7528SpringSecurity\u8fdb\u884c\u57fa\u4e8e\u6570\u636e\u5e93\u7684\u767b\u5165\u8ba4\u8bc1"},{"location":"Spring/SpringSecurity/SpringSecurtiy\u6e90\u7801\u5206\u6790/#springsecurity_1","text":"\u5728Spring Security\u4e2d\u9ed8\u8ba4\u7684\u8bbf\u95ee\u63a7\u5236\u7684\u5165\u53e3\u4e3a FilterSecurityInterceptor \u8fc7\u6ee4\u5668\uff0c\u5728Spring Security\u7684\u8fc7\u6ee4\u5668\u94fe\u4e2d\u8be5\u8fc7\u6ee4\u5668\u8d1f\u8d23\u89d2\u8272\u548c\u6743\u9650\u7684\u63a7\u5236\u3002 FilterSecurityInterceptor \u7ee7\u627f\u81ea AbstractSecurityInterceptor \u5e76\u4e14\u5b9e\u73b0\u4e86Filter\u63a5\u53e3\uff0c\u8be5\u7c7b\u7684\u4e3b\u8981\u4f5c\u7528\u662f\u4f5c\u4e3aFilter\u52a0\u5165\u8fc7\u6ee4\u94fe\uff0c\u4e3b\u8981\u7684\u6743\u9650\u63a7\u5236\u903b\u8f91\u7531 AbstractSecurityInterceptor \u5b9e\u73b0\u3002\u5b83\u7684doFilter\u65b9\u6cd5\uff0c\u5982\u4e0b\uff1a /** *\u4f7f\u7528request,response,filterChain\u6784\u5efaFilterInvocation\u5bf9\u8c61\u5e76\u4f20\u7ed9invoke\u65b9\u6cd5 */ public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException { FilterInvocation fi = new FilterInvocation(request, response, chain); invoke(fi); } \u4ece\u4e0a\u9762\u7684\u4ee3\u7801\u53ef\u4ee5\u770b\u51fa\uff0c #invoke \u65b9\u6cd5\u4e3a\u6743\u9650\u9a8c\u8bc1\u7684\u5165\u53e3\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a /** *\u5148\u5224\u65ad\u662f\u5426\u5df2\u7ecf\u8fdb\u884c\u4e86\u6743\u9650\u9a8c\u8bc1 *\u5982\u679c\u6ca1\u6709\u8fdb\u884c\u8fc7\u6743\u9650\u9a8c\u8bc1\uff0c\u5219\u8c03\u7528\u7236\u7c7b\u7684beforeInvocation\u65b9\u6cd5 */ public void invoke(FilterInvocation fi) throws IOException, ServletException { if ((fi.getRequest() != null) && (fi.getRequest().getAttribute(FILTER_APPLIED) != null) && observeOncePerRequest) { // filter already applied to this request and user wants us to observe // once-per-request handling, so don't re-do security checking fi.getChain().doFilter(fi.getRequest(), fi.getResponse()); } else { // first time this request being called, so perform security checking if (fi.getRequest() != null && observeOncePerRequest) { fi.getRequest().setAttribute(FILTER_APPLIED, Boolean.TRUE); } //beforeInvocation\u4e3a\u5173\u952e\u65b9\u6cd5 //\u82e5\u8be5\u65b9\u6cd5\u672a\u629b\u51faRuntimeException\u5219\u8bf4\u660e\u6743\u9650\u8ba4\u8bc1\u6210\u529f\uff0c\u5373\u4f7f\u8fd4\u56denull\u5bf9\u8c61 InterceptorStatusToken token = super.beforeInvocation(fi); try { fi.getChain().doFilter(fi.getRequest(), fi.getResponse()); } finally { super.finallyInvocation(token); } super.afterInvocation(token, null); } } \u4ece\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0c\u8be5\u65b9\u6cd5\u53ea\u662f\u505a\u4e86\u662f\u5426\u9700\u8981\u6743\u9650\u8ba4\u8bc1\u7684\u5224\u65ad\u5de5\u4f5c\uff0c\u800c\u4e3b\u8981\u7684\u8ba4\u8bc1\u5de5\u4f5c\u4ea4\u7ed9\u4e86\u7236\u7c7b\u7684 #beforeInvocation \u65b9\u6cd5\u3002\u8fd9\u91cc\u6709\u4e00\u4e2a\u95ee\u9898\uff0crequest\u5bf9\u8c61\u5728\u6bcf\u6b21\u8bf7\u6c42\u65f6\u90fd\u4f1a\u7531Web\u5bb9\u5668\u91cd\u65b0\u521b\u5efa\uff0c\u4e3a\u4ec0\u4e48\u4e0a\u9762\u7684\u4ee3\u7801\u8981\u8fdb\u884c\u4e00\u6b21\u662f\u5426\u5df2\u7ecf\u8fdb\u884c\u6743\u9650\u8ba4\u8bc1\u7684\u5de5\u4f5c\u5462\uff1f\u731c\u6d4b\u662f\u8003\u8651\u8fdb\u884c\u4e86\u8bf7\u6c42\u8f6c\u53d1\u7684\u60c5\u51b5\u4e0b\uff0c\u4e0d\u9700\u8981\u7684\u91cd\u65b0\u8fdb\u884c\u6743\u9650\u8ba4\u8bc1\u3002\u7ee7\u7eed\u5f80\u4e0b\u770b\uff0c AbstractSecurityInterceptor \u7684 #beforeInvocation \u65b9\u6cd5\u5982\u4e0b\uff1a /** *1.\u5224\u65ad\u662f\u5426\u914d\u7f6e\u4e86\u652f\u6301\u4f20\u5165\u5bf9\u8c61\u7684\u8ba4\u8bc1\uff0c\u82e5\u4e0d\u652f\u6301\u5219\u629b\u51fa\u5f02\u5e38 *2.\u83b7\u5f97SecurityMetadataSource\u7684Attributes\uff0cAttributes\u4e2d\u5305\u542b\u4e86\u672c\u6b21\u8bf7\u6c42\uff08request\uff09\u6240\u9700\u7684\u6743\u9650\u7ea7\u522b *3.\u5224\u65ad\u662f\u5426\u9700\u8981\u8fdb\u884c\u767b\u5165\u8ba4\u8bc1\uff0c\u5e76\u8fd4\u56deAuthentication\u5bf9\u8c61 *4.\u8c03\u7528AccessDecisionManager.decide()\u65b9\u6cd5\u8fdb\u884c\u6743\u9650\u9a8c\u8bc1 */ protected InterceptorStatusToken beforeInvocation(Object object) { Assert.notNull(object, \"Object was null\"); final boolean debug = logger.isDebugEnabled(); if (!getSecureObjectClass().isAssignableFrom(object.getClass())) { throw new IllegalArgumentException( \"Security invocation attempted for object \" + object.getClass().getName() + \" but AbstractSecurityInterceptor only configured to support secure objects of type: \" + getSecureObjectClass()); } //\u901a\u8fc7SecurityMetadataSource\u83b7\u5f97\u672c\u6b21\u8bf7\u6c42\u9700\u8981\u7684\u6743\u9650 //\u6743\u9650\u662f\u5728SecurityConfiguration\u4e2d\u7531hasAnyAuthority\u3001hasAnyRole\u6216hasRole\u65b9\u6cd5\u914d\u7f6e\u7684 Collection<ConfigAttribute> attributes = this.obtainSecurityMetadataSource() .getAttributes(object); if (attributes == null || attributes.isEmpty()) { if (rejectPublicInvocations) { throw new IllegalArgumentException( \"Secure object invocation \" + object + \" was denied as public invocations are not allowed via this interceptor. \" + \"This indicates a configuration error because the \" + \"rejectPublicInvocations property is set to 'true'\"); } if (debug) { logger.debug(\"Public object - authentication not attempted\"); } publishEvent(new PublicInvocationEvent(object)); return null; // no further work post-invocation } if (debug) { logger.debug(\"Secure object: \" + object + \"; Attributes: \" + attributes); } if (SecurityContextHolder.getContext().getAuthentication() == null) { credentialsNotFound(messages.getMessage( \"AbstractSecurityInterceptor.authenticationNotFound\", \"An Authentication object was not found in the SecurityContext\"), object, attributes); } // \u5224\u65ad\u662f\u5426\u9700\u8981\u8fdb\u884c\u767b\u5165\u8ba4\u8bc1\uff0c\u82e5\u9700\u8981\u5219\u8fdb\u884c\u8ba4\u8bc1\u5e76\u8fd4\u56deAuthentication\u5bf9\u8c61\uff0c\u4e3b\u8981\u4f5c\u7528\u662f\u8fd4\u56deAuthentication\u5bf9\u8c61 Authentication authenticated = authenticateIfRequired(); // Attempt authorization try { //\u6743\u9650\u9a8c\u8bc1\u7684\u6838\u5fc3\u65b9\u6cd5\uff0c\u8c03\u7528AccessDecisionManager\u7684decide\u65b9\u6cd5\u8fdb\u884c\u6743\u9650\u8ba4\u8bc1\uff0c\u672a\u629b\u51fa\u5f02\u5e38\u8bf4\u660e\u6709\u6743\u9650 this.accessDecisionManager.decide(authenticated, object, attributes); } catch (AccessDeniedException accessDeniedException) { publishEvent(new AuthorizationFailureEvent(object, attributes, authenticated, accessDeniedException)); throw accessDeniedException; } if (debug) { logger.debug(\"Authorization successful\"); } if (publishAuthorizationSuccess) { publishEvent(new AuthorizedEvent(object, attributes, authenticated)); } // Attempt to run as a different user Authentication runAs = this.runAsManager.buildRunAs(authenticated, object, attributes); if (runAs == null) { if (debug) { logger.debug(\"RunAsManager did not change Authentication object\"); } // no further work post-invocation return new InterceptorStatusToken(SecurityContextHolder.getContext(), false, attributes, object); } else { if (debug) { logger.debug(\"Switching to RunAs Authentication: \" + runAs); } SecurityContext origCtx = SecurityContextHolder.getContext(); SecurityContextHolder.setContext(SecurityContextHolder.createEmptyContext()); SecurityContextHolder.getContext().setAuthentication(runAs); // need to revert to token.Authenticated post-invocation return new InterceptorStatusToken(origCtx, true, attributes, object); } } \u4ece\u4e0a\u9762\u4ee3\u7801\u53ef\u4ee5\u770b\u51fa\u6743\u9650\u9a8c\u8bc1\u7684\u6838\u5fc3\u65b9\u6cd5\u4e3a AccessDecisionManager#decide \uff0c #decide \u65b9\u6cd5\u63a5\u53e3\u4ee3\u7801\u5982\u4e0b\uff1a void decide(Authentication authentication, Object object, Collection<ConfigAttribute> configAttributes) throws AccessDeniedException, InsufficientAuthenticationException; \u663e\u800c\u6613\u89c1\u8be5\u65b9\u6cd5\u9700\u8981\u4f20\u5165\u4e09\u4e2a\u53c2\u6570\uff1a Authentication \uff0c\u5728\u767b\u5165\u8ba4\u8bc1\u5b8c\u6210\u540e\u8fd4\u56de\u7684\u51ed\u8bc1\uff0c\u786e\u5b9a\u8bbf\u95ee\u5f53\u524d\u8d44\u6e90\u7684\u7528\u6237\uff0c\u5e76\u4e14\u4ece\u51ed\u8bc1\u53ef\u4ee5\u83b7\u53d6\u5f53\u524d\u7528\u6237\u6240\u62e5\u6709\u7684\u6743\u9650\uff08\u9700\u8981\u5728 UserDetailsService#loadUserByUsername \u65b9\u6cd5\u4e2d\u8bbe\u7f6e\uff09\u3002 Object \uff0c\u5b9e\u9645\u4e0a\u4e3aFilterInvocation\u5bf9\u8c61\u5b83\u6301\u6709request\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u5373\u5f53\u524d\u88ab\u8bbf\u95ee\u7684\u8d44\u6e90\u3002 Collection<ConfigAttribute> \uff0c\u8bbf\u95ee\u8d44\u6e90\u8981\u6c42\u7684\u6743\u9650\uff0c\u5728SpringSecurity\u914d\u7f6e\u4e2d\u8fdb\u884c\u8bbe\u7f6e\u3002 \u6240\u4ee5 AccessDecisionManager \u7684 #decide \u65b9\u6cd5\u7684\u4e3b\u8981\u601d\u8def\u662f\u4ece Authentication \u83b7\u5f97\u5f53\u524d\u7528\u6237\u6240\u62e5\u6709\u7684\u6743\u9650\uff0c\u518d\u4e0e\u8bbf\u95ee\u5f53\u524d\u8d44\u6e90\uff08object\uff09\u6240\u9700\u8981\u7684\u6743\u9650\u8fdb\u884c\u6bd4\u5bf9\uff0c\u5373\u53ef\u5224\u65ad\u5f53\u524d\u8ba4\u8bc1\u7528\u6237\u662f\u5426\u80fd\u591f\u8bbf\u95ee\u8be5\u8d44\u6e90\u3002 Spring Security\u5f15\u5165\u4e86\u6295\u7968\u5668\uff08voter\uff09\u7684\u6982\u5ff5\uff0c\u771f\u6b63\u7684\u6743\u9650\u8ba4\u8bc1\u5de5\u4f5c\u7531 AccessDecisionManager \u4e2d\u7684\u4e00\u7ec4 AccessDecisionVoter \u6765\u5b9e\u73b0\uff0c\u6709\u65e0\u6743\u9650\u8bbf\u95ee\u7684\u6700\u7ec8\u89c9\u5f97\u6743\u662f\u7531\u6295\u7968\u5668\u6765\u51b3\u5b9a\u7684\u3002 AccessDecisionManager \u7ef4\u62a4\u7740\u4e00\u4e2a AccessDecisionVoter \u5217\u8868\u53c2\u4e0e\u6388\u6743\u7684\u6295\u7968\u3002\u6839\u636e\u5904\u7406\u6295\u7968\u7684\u7b56\u7565\u4e0d\u540cSpring Security\u4e2d AccessDecisionManager \u67093\u4e2a\u4e0d\u540c\u7684\u5b9e\u73b0\uff1a UnanimousBased\uff08\u5168\u7968\u901a\u8fc7\uff09\uff1a\u6240\u6709\u6295\u7968\u5668\u90fd\u901a\u8fc7\u624d\u5141\u8bb8\u8bbf\u95ee\u8d44\u6e90\u3002 ConsensusBased\uff08\u5c11\u6570\u670d\u4ece\u591a\u6570\uff09\uff1a\u8d85\u8fc7\u4e00\u534a\u7684\u6295\u7968\u5668\u901a\u8fc7\u624d\u5141\u8bb8\u8bbf\u95ee\u8d44\u6e90\u3002 AffirmativeBased\uff08\u4e00\u7968\u901a\u8fc7\uff09\uff1a\u53ea\u8981\u6709\u4e00\u4e2a\u6295\u7968\u5668\u6295\u7968\u901a\u8fc7\uff0c\u5c31\u5141\u8bb8\u8bbf\u95ee\u8d44\u6e90\u3002AffirmativeBased\u4e3a\u9ed8\u8ba4\u7684AccessDecisionManager\u3002 \u4e0b\u9762\u4ee5 AffirmativeBased \u7684 #decide \u65b9\u6cd5\u4e3a\u4f8b\u8fdb\u884c\u7b80\u8981\u8bf4\u660e\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a public void decide(Authentication authentication, Object object, Collection<ConfigAttribute> configAttributes) throws AccessDeniedException { int deny = 0; //\u904d\u5386voter\u5217\u8868\uff0c\u5faa\u73af\u8c03\u7528vote\u7684\u65b9\u6cd5 for (AccessDecisionVoter voter : getDecisionVoters()) { int result = voter.vote(authentication, object, configAttributes); if (logger.isDebugEnabled()) { logger.debug(\"Voter: \" + voter + \", returned: \" + result); } switch (result) { case AccessDecisionVoter.ACCESS_GRANTED: return; //\u5f53\u6709result\u4e3aACCESS_GRANTED\u5219\u6743\u9650\u8ba4\u8bc1\u6210\u529f case AccessDecisionVoter.ACCESS_DENIED: deny++; break; default: break; } } if (deny > 0) { throw new AccessDeniedException(messages.getMessage( \"AbstractAccessDecisionManager.accessDenied\", \"Access is denied\")); } // To get this far, every AccessDecisionVoter abstained checkAllowIfAllAbstainDecisions(); } \u53ef\u4ee5\u770b\u51fa #decide \u65b9\u6cd5\u53ea\u662f\u5faa\u73af\u8c03\u7528\u4e86 AccessDecisionVoter \u7684 #vote \uff0c\u8be5\u65b9\u6cd5\u4f1a\u8fd4\u56de\u4e00\u4e2a\u6295\u7968\u7ed3\u679c\uff0c\u5f53\u6709\u4e00\u4e2avoter\u7684\u6295\u7968\u7ed3\u679c\u4e3aACCESS_GRANTED\u65f6\uff0c\u5219\u6743\u9650\u8ba4\u8bc1\u6210\u529f\uff1b\u5982\u679c\u6240\u6709\u7684\u6295\u7968\u7ed3\u679c\u4e2d\u90fd\u6ca1\u6709ACCESS_GRANTED\u65f6\uff0c\u629b\u51faAccessDeniedException\u5f02\u5e38\u8868\u660e\u8ba4\u8bc1\u5931\u8d25\u3002 Spring Security\u63d0\u4f9b\u51e0\u4e2a\u7f3a\u7701\u7684AccessDecisionVoter\uff0c\u5b83\u4eec\u5206\u522b\u5bf9\u5e94\u4e0d\u540c\u7684SpringSecurity\u914d\u7f6e\uff0c\u4e0b\u9762\u5bf9\u5e38\u7528\u7684\u4e24\u4e2a\u6295\u7968\u5668\u8fdb\u884c\u8bf4\u660e\uff1a RoleVoter\uff0c\u6700\u5e38\u89c1\u7684\u6295\u7968\u5668\uff0c\u5728RoleVoter\u4e2d\u5b9a\u4e49\u4e86\u6743\u9650\u7684\u524d\u7f00\uff08\u9ed8\u8ba4\u4e3a\"ROLE_\"\uff09\uff0c\u5f53\u914d\u7f6e\u4e2d\u6709\u4ee5\u6743\u9650\u524d\u7f00\u5f00\u5934\u7684\u914d\u7f6e\u65f6 #vote \u65b9\u6cd5\u624d\u4f1a\u8fdb\u884c\u6295\u7968\uff0c\u5426\u5219\u5f03\u6743\u3002 AuthenticatedVoter\uff0c\u5f53\u914d\u7f6e\u4e2d\u6709\u4ee5\u4e0b\u914d\u7f6e\u65f6\u624d\u4f1a\u8fdb\u884c\u6295\u7968\uff0c\u5426\u5219\u5f03\u6743\uff1a IS_AUTHENTICATED_ANONYMOUSLY \u5141\u8bb8\u533f\u540d\u7528\u6237\u8bbf\u95ee IS_AUTHENTICATED_FULLY \u5141\u8bb8\u767b\u5f55\u7528\u6237\u8bbf\u95ee IS_AUTHENTICATED_REMEMBERED \u5141\u8bb8\u767b\u5f55\u7528\u6237\u548crememberMe\u7528\u6237\u8bbf\u95ee","title":"SpringSecurity\u4e2d\u7684\u8bbf\u95ee\u63a7\u5236"},{"location":"Spring/SpringSecurity/SpringSecurtiy\u6e90\u7801\u5206\u6790/#springbootspringsecurity","text":"\u4ece\u6e90\u7801\u4e2d\u53ef\u4ee5\u5f97\u51fa\u7ed3\u8bba\uff0cSpringSecurity\u7684\u6743\u9650\u63a7\u5236\u9700\u8981\u4f7f\u7528\u8005\u505a\u7684\u5de5\u4f5c\u81f3\u5c11\u6709\u4ee5\u4e0b\u4e24\u4e2a\uff1a \u914d\u7f6e\u8bbf\u95ee\u5177\u4f53\u7684URL\u9700\u8981\u7684\u89d2\u8272\u6216\u8005\u6743\u9650\uff1b \u5728\u7528\u6237\u767b\u5165\u9a8c\u8bc1\u65f6\uff0c\u5c06\u5176\u62e5\u6709\u7684\u6743\u9650\u4ea4\u7ed9 UserDetails \u5bf9\u8c61\u3002 \u4e0b\u9762\u5c06\u4f7f\u7528SpringBoot + SpringDataJPA + SpringSecurity\u4e3a\u6280\u672f\u6846\u67b6\u8fdb\u884c\u4e00\u4e2a\u7b80\u5355\u8bf4\u660e\u3002 SysUser\u4e3a\u7cfb\u7edf\u7528\u6237\u5bf9\u8c61\uff0c\u5176\u89d2\u8272\u4f7f\u7528\u679a\u4e3e\u7c7bRoleType\u8868\u793a\uff0c\u5e76\u4e14\u5b58\u5728\u6570\u636e\u5e93\u4e2d\u3002 @Entity(name = \"user\") public class SysUser { @Id @GenericGenerator(name = \"uuid2\", strategy = \"org.hibernate.id.UUIDGenerator\") @GeneratedValue(generator = \"uuid2\") @Column(name = \"user_uuid\", columnDefinition = \"uuid\") private UUID uuid; @Column(name = \"user_name\", unique = true, nullable = false, length = 64) protected String username; @Column(name = \"role_type\", nullable = false) @Enumerated(EnumType.STRING) protected RoleType role; @Column(name = \"password\") private String password; //getter\u3001setter } RoleType\u4e3a\u679a\u4e3e\u7c7b\uff0c\u5728\u7cfb\u7edf\u4e2d\u4ee3\u8868\u7528\u6237\u7684\u89d2\u8272\u7c7b\u578b\u3002 public enum RoleType { SUPER_ADMIN(0,\"\u8d85\u7ea7\u7ba1\u7406\u5458\",\"super_admin\",true,true), ADMIN(1,\"\u7ba1\u7406\u5458\",\"admin\",true,true), GUEST(99,\"\u6e38\u5ba2\",\"guest\", false, false); private int value; private String name; private String roleName; private boolean isLogin; private boolean isAdmin; } UserService\u662f\u7cfb\u7edf\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u7684Service\u7c7b\uff0c\u5b9e\u73b0\u7684SpringSecurity\u7684UserDetailsService\u63a5\u53e3\uff0c\u5b83\u5b9e\u73b0\u4e86 #loadUserByUsername \u65b9\u6cd5\u662fSpringSecurity\u5b9e\u73b0\u767b\u5165\u548c\u6743\u9650\u8ba4\u8bc1\u7684\u5173\u952e\u65b9\u6cd5\uff0c\u9700\u8981\u8fd4\u56de User \u7684\u5177\u4f53\u4fe1\u606f\uff08\u5305\u62ec\u6743\u9650\uff09\u3002 @Service public class UserDetailService implements UserDetailsService { private final UserRepository userRepository; //\u5728JPA\u4e2d\u76f8\u5f53\u4e8edao\uff0c\u8fd9\u91cc\u4e0d\u5c55\u5f00\u8bf4\u660e\u3000\u3000\u3000\u3000\u3000 @Autowired public UserDetailService(UserRepository userRepository){ this.repository = userRepository; } public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException { SysUser user = repository.findUserByUsername(username); if (user==null) throw new UsernameNotFoundException(\"\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef\");\u3000//\u629b\u51fa\u5f02\u5e38\uff0c\u4f1a\u6839\u636e\u914d\u7f6e\u8df3\u5230\u767b\u5f55\u5931\u8d25\u9875\u9762 List<GrantedAuthority> authorities = getRoles(user);\u3000//\u83b7\u53d6\u7528\u6237\u6743\u9650 org.springframework.security.core.userdetails.User auth_user = new org.springframework.security.core.userdetails.User(user.getUsername(), user.getPassword(), list);\u3000\u3000\u3000\u3000\u3000\u3000//\u5c06\u6743\u9650\u4f20\u9012\u7ed9UserDetails return auth_user; } /**\u6839\u636e\u7528\u6237\u8fd4\u56de\u4ed6\u7684\u6743\u9650\u5217\u8868*/ public List<GrantedAuthority> getRoles(SysUser user){ List<GrantedAuthority> authorities = new ArrayList<>(); //SpringSecurity\u5bf9\u89d2\u8272\u7684\u8ba4\u8bc1\u9700\u8981\u4ee5\"ROLE_\"\u4f5c\u4e3a\u5f00\u5934\uff0c\u53ef\u4ee5\u8bbe\u7f6e String role = \"ROLE_\" + user.getRoleType().name(); authorities.add(new SimpleGrantedAuthority(role)); return authorities; } } \u914d\u7f6eSpringSecurity \u5728SpringBoot\u4e2d\u53ef\u4ee5\u901a\u8fc7\u7ee7\u627f WebSecurityConfigurerAdapter \u7c7b\u5e76\u4f7f\u7528 @Configuration \u548c @EnableWebSecurity \u6ce8\u89e3\u6765\u914d\u7f6eSpringSecurity\uff0c\u5982\u4e0b\uff1a @Configuration @EnableWebSecurity public class WebSecurityConfig extends WebSecurityConfigurerAdapter{\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 @Autowired private UserDetailService userDetailService;//\u5373\u6211\u4eec\u5b9e\u73b0\u7684UserService @Override protected void configure(HttpSecurity http) throws Exception { http.authorizeRequests() //\u7ba1\u7406\u5458\u9875\u9762\u53ea\u5141\u8bb8\u62e5\u6709ADMIN,SUPER_ADMIN\u89d2\u8272\u7684\u7528\u6237\u8bbf\u95ee //\u8fd9\u91cc\u7684\"ADMIN\"\u4e0d\u9700\u8981\u52a0\"ROLE_\"\u524d\u7f00\u662f\u56e0\u4e3ahasAnyRole\u65b9\u6cd5\u4f1a\u9ed8\u8ba4\u6dfb\u52a0\"ROLE_\"\u524d\u7f00 .antMatchers(\"/admin.html\").hasAnyRole(\"ADMIN\",\"SUPER_ADMIN\") .anyRequest() .authenticated() .accessDecisionManager(buildDecisionManager()) .and() .formLogin() //\u767b\u5165\u9875\u9762,\u4e3a\u767b\u5165\u65f6\u4f1a\u8df3\u8f6c\u5230\u8be5\u9875\u9762 .loginPage(\"/login.html\") .permitAll() //SpringSecurity\u63a5\u53d7\u767b\u5165\u8bf7\u6c42\u7684url\uff0c\u9ed8\u8ba4\u4e3a\"/login\" .loginProcessingUrl(\"/login\")\u3000\u3000 .and() .logout() //SpringSecurity\u63a5\u53d7\u767b\u51fa\u8bf7\u6c42\u7684url\uff0c\u9ed8\u8ba4\u4e3a\"/logout\" \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000.logoutUrl(\"/logout\") .permitAll(); } @Override protected void configure(AuthenticationManagerBuilder auth) throws Exception { auth.userDetailsService(userDetailService);\u3000//\u914d\u7f6e\u81ea\u5b9a\u4e49userDetailService } @Bean public AccessDecisionManager buildDecisionManager() { //\u5bf9AccessDecisionManager\u8fdb\u884c\u5ba2\u6237\u5316\u914d\u7f6e //\u8fd9\u91cc\u4f7f\u7528AffirmativeBased\uff08\u4e00\u7968\u901a\u8fc7\uff09\u7ba1\u7406\u5668 //\u5e76\u4e14\u53ea\u914d\u7f6e\u4e86RoleVoter\uff0c\u53ea\u8fdb\u884c\u89d2\u8272\u9650\u5236 List<AccessDecisionVoter<? extends Object>> decisionVoters = Arrays.asList\uff08new RoleVoter()); return new AffirmativeBased(decisionVoters); } } \u5982\u4e0a\u914d\u7f6e\u7c7b\u6240\u793a\uff0c\u6211\u4eec\u5bf9admin.html\u7684\u8bbf\u95ee\u52a0\u4e86\u89d2\u8272\u9650\u5236\uff0c\u53ea\u6709\u4e3a\u89d2\u8272\"ADMIN\"\u6216\"SUPER_ADMIN\"\u7684\u7528\u6237\u53ef\u4ee5\u8bbf\u95ee\u8be5\u9875\u9762\uff0c\u5e76\u4e14\u5bf9 AccessDecisionManager \u5ba2\u6237\u5316\u7684\u914d\u7f6e\uff0c\u6743\u9650\u7ba1\u7406\u5668\u4f7f\u7528\u4e86AffirmativeBased\u5e76\u4e14\u5b83\u7684\u6295\u7968\u8005\u53ea\u6709RoleVoter\u3002","title":"\u5728SpringBoot\u4e2d\u4f7f\u7528SpringSecurity\u8fdb\u884c\u6743\u9650\u63a7\u5236"},{"location":"Spring/SpringSecurity/SpringSecurtiy\u6e90\u7801\u5206\u6790/#springsecurity_2","text":"","title":"SpringSecurity\u6743\u9650\u63a7\u5236\u76f8\u5173\u6ce8\u89e3"},{"location":"Spring/SpringSecurity/SpringSecurtiy\u6e90\u7801\u5206\u6790/#_2","text":"http://www.spring4all.com/article/420 https://elim.iteye.com/blog/2247057 https://blog.csdn.net/neweastsun/article/details/80633421 https://www.cnblogs.com/scau-chm/p/5967931.html","title":"\u53c2\u8003"},{"location":"Spring/Spring_DBs/SpringDataJpa\u7b14\u8bb0/","text":"1.\u5b9e\u4f53\u7c7b\u76f8\u5173\u7684\u6ce8\u89e3 @Entity\u3001@Id @Entity \u6ce8\u89e3\u8868\u660e\u8be5\u7c7b\u662f\u4e00\u4e2a\u5b9e\u4f53\u7c7b\uff0c\u5e76\u4e14\u4f7f\u7528\u9ed8\u8ba4\u7684 ORM \u89c4\u5219\uff0c\u5373\u7c7b\u540d\u4f5c\u4e3a\u6570\u636e\u5e93\u8868\u4e2d\u8868\u540d\uff0c\u7c7b\u7684\u5c5e\u6027\u540d\u4f5c\u4e3a\u8868\u4e2d\u7684\u5b57\u6bb5\u540d\u3002\u4ee5\u4e0b\u9762\u4ee3\u7801\u4e3a\u4f8b\uff1a @Entity public class Employee implements Serializable { private static final long serialVersionUID = 1L; @Id private Long id; private String name; private int age; private String addree; // Getters and Setters } \u5982\u679c\u6ca1\u6709 @javax.persistence.Entity \u548c @javax.persistence.Id \u8fd9\u4e24\u4e2a\u6ce8\u89e3\u7684\u8bdd\uff0c\u5b83\u53ea\u662f\u4e00\u4e2a\u5178\u578b\u7684 POJO \u7684 Java \u7c7b\uff0c\u73b0\u5728\u52a0\u4e0a\u8fd9\u4e24\u4e2a\u6ce8\u89e3\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u5b9e\u4f53\u7c7b\u4e0e\u6570\u636e\u5e93\u4e2d\u7684\u8868\u76f8\u5bf9\u5e94\uff0c\u5373ORM\u6846\u67b6\u4f1a\u81ea\u52a8\u5e2e\u4f60\u5b8c\u6210\u6620\u5c04\u3002 \u8981\u4f7f\u5b9e\u4f53\u7c7b\u4e0e\u6570\u636e\u5e93\u4e2d\u7684\u8868\u76f8\u5bf9\u5e94\u5fc5\u987b\u9075\u5b88\u4ee5\u4e0b\u89c4\u5219\uff1a \u5b9e\u4f53\u7c7b\u5fc5\u987b\u7528 @Entity \u8fdb\u884c\u6ce8\u89e3\uff1b \u5fc5\u987b\u4f7f\u7528 @Id \u6765\u6ce8\u89e3\u4e00\u4e2a\u4e3b\u952e\uff1b \u5b9e\u4f53\u7c7b\u5fc5\u987b\u62e5\u6709\u4e00\u4e2a public \u6216\u8005 protected \u7684\u65e0\u53c2\u6784\u9020\u51fd\u6570\uff0c\u6b64\u5916\u5b9e\u4f53\u7c7b\u8fd8\u53ef\u4ee5\u62e5\u6709\u5176\u4ed6\u7684\u6784\u9020\u51fd\u6570\uff1b \u5b9e\u4f53\u7c7b\u5fc5\u987b\u662f\u4e00\u4e2a\u9876\u7ea7\u7c7b\uff08top-level class\uff09\u3002\u4e00\u4e2a\u679a\u4e3e\uff08enum\uff09\u6216\u8005\u4e00\u4e2a\u63a5\u53e3\uff08interface\uff09\u4e0d\u80fd\u88ab\u6ce8\u89e3\u4e3a\u4e00\u4e2a\u5b9e\u4f53\uff1b \u5982\u679c\u5b9e\u4f53\u7c7b\u7684\u4e00\u4e2a\u5b9e\u4f8b\u9700\u8981\u7528\u4f20\u503c\u7684\u65b9\u5f0f\u8c03\u7528\uff08\u4f8b\u5982\uff0c\u8fdc\u7a0b\u8c03\u7528\uff09\uff0c\u5219\u8fd9\u4e2a\u5b9e\u4f53\u7c7b\u5fc5\u987b\u5b9e\u73b0java.io.Serializable \u63a5\u53e3\u3002 @Table @Table \u6ce8\u89e3\u662f\u4e00\u4e2a\u975e\u5fc5\u987b\u7684\u6ce8\u89e3\uff0c\u5fc5\u987b\u914d\u5408@Entity\u4f7f\u7528\u3002@Table \u6ce8\u89e3\u6307\u5b9a\u4e86 Entity \u6240\u8981\u6620\u5c04\u5e26\u6570\u636e\u5e93\u8868\u540d\uff0c\u5176\u4e2d @Table.name\u7528\u6765\u6307\u5b9a\u6620\u5c04\u8868\u7684\u8868\u540d\u3002\u58f0\u660e\u6b64\u5bf9\u8c61\u6620\u5c04\u5230\u6570\u636e\u5e93\u7684\u6570\u636e\u8868\uff0c\u901a\u8fc7\u5b83\u53ef\u4ee5\u4e3a\u5b9e\u4f53\u6307\u5b9a\u8868\u540d(name)\uff0c\u76ee\u5f55 (catalog) \u548c schema\u3002 \u6ce8\uff1a\u5f53@Table\u548c@Entity\u540c\u65f6\u6307name\u65f6\uff0c@Table.name\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8e@Entity.name @GeneratedValue\u3001@GenericGenerator @GeneratedValue\u901a\u7528\u7b56\u7565\u751f\u6210\u5668\uff0c\u5fc5\u987b\u914d\u5408@Id\u6ce8\u89e3\u4f7f\u7528\uff0c\u7528\u6765\u6307\u5b9a\u4e3b\u952e\u7684\u751f\u6210\u7b56\u7565\u3002 @GenericGenerator\u81ea\u5b9a\u4e49\u4e3b\u952e\u751f\u6210\u7b56\u7565\uff0c\u7528\u4e8e\u914d\u5408@GeneratedValue\u6ce8\u89e3\uff0c\u6765\u751f\u6210\u5176\u4ed6\u7c7b\u578b\u7684\u4e3b\u952e\u3002\u4f8b\u5982\uff0c\u4f7f\u7528UUID\u4f5c\u4e3a\u4e3b\u952e @Id @GenericGenerator(name = \"uuid2\", strategy = \"org.hibernate.id.UUIDGenerator\") @GeneratedValue(generator = \"uuid2\") private UUID uuid; @Column @Column\u6ce8\u89e3\u58f0\u660e\u4e86\u5c5e\u6027\u4e0e\u6570\u636e\u5e93\u4e4b\u95f4\u7684\u6620\u5c04\u5173\u7cfb\u3002\u4f8b\u5982\uff0c\u8be5\u5b57\u6bb5\u662f\u5426\u552f\u4e00\u3001\u662f\u5426\u80fd\u4e3a\u7a7a\u3001\u957f\u5ea6\u3001\u5b57\u6bb5\u540d\u7b49\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\u5f53\u6709\u5c5e\u6027\u4e0d\u9700\u8981\u4e0e\u6570\u636e\u5e93\u5b57\u6bb5\u6620\u5c04\u65f6\uff0c\u9700\u8981\u4f7f\u7528 @Transitent \u4fee\u9970\uff0c\u8868\u793a\u6b64\u5c5e\u6027\u4e0e\u8868\u6ca1\u6709\u6620\u5c04\u5173\u7cfb\u3002 @CreatedDate\u3001@LastModifiedDate \u4ece\u5b57\u9762\u610f\u601d\u5c31\u53ef\u4ee5\u7406\u89e3\uff0c\u8fd9\u4e24\u4e2a\u6ce8\u89e3\u5206\u522b\u8868\u793a\u5b9e\u4f53\u521b\u5efa\u65e5\u671f\u548c\u5b9e\u4f53\u6700\u540e\u66f4\u65b0\u7684\u65e5\u671f\u3002\u5728\u8fdb\u884c\u65b0\u5efa\u548c\u66f4\u65b0\u64cd\u4f5c\u65f6\uff0c\u5b57\u6bb5\u4f1a\u81ea\u52a8\u8bbe\u7f6e\u5e76\u63d2\u5165\u6570\u636e\u5e93\u3002 \u4f7f\u7528\u65b9\u5f0f\uff0c\u9700\u8981\u5728\u5b9e\u4f53\u7c7b\u4e0a\u52a0\u4e0a\u76d1\u542c\u5668\u6ce8\u89e3\uff0c\u5e76\u4e14\u5411\u76f8\u5e94\u5b57\u6bb5\u4e0a\u52a0\u4e0a@CreatedDate\u548c@LastModifiedDate\u6ce8\u89e3\uff0c\u6700\u540e\u5fc5\u987b\u5728application\u7c7b\u4e0a\u52a0\u4e0a@EnableJpaAuditing\u6ce8\u89e3\uff0c\u5982\u4e0b\uff1a @Entity @Table(name = \"store_source_bind\") @EntityListeners(AuditingEntityListener.class) public class StoreSourceBind { /** * \u521b\u5efa\u65f6\u95f4 */ @Column(name = \"create_time\") @CreatedDate private Date createTime; /** * \u4fee\u6539\u65f6\u95f4 */ @Column(name = \"lastmodified_time\") @LastModifiedDate private Date lastmodifiedTime\uff1b } @SpringBootApplication @EnableJpaAuditing public class WalletApplication { public static void main(String[] args) { new SpringApplicationBuilder(WalletApplication.class).web(true).run(args); } } @OneToOne JPA\u4f7f\u7528@OneToOne\u6765\u8868\u793a\u4e00\u5bf9\u4e00\u7684\u6620\u5c04\u5173\u7cfb\uff0c\u4e00\u5bf9\u4e00\u5173\u7cfb\u6709\u4e24\u79cd\u63cf\u8ff0\u65b9\u5f0f\u3002 \u5916\u952e\uff0c\u4e00\u4e2a\u5b9e\u4f53\u901a\u8fc7\u5c06\u53e6\u4e00\u4e2a\u5b9e\u4f53\u7684\u4e3b\u952e\u4f5c\u4e3a\u5916\u952e\u3002 \u4e2d\u95f4\u8868\uff0c\u901a\u8fc7\u4e2d\u95f4\u8868\u6765\u4fdd\u5b58\u4e24\u4e2a\u5b9e\u4f53\u7684\u4e3b\u952e\u3002 \u4e0b\u9762\u4ee5\u7528\u6237\uff08People\uff09\u4e0e\u5730\u5740\uff08Address\uff09\u4e3a\u4f8b\u8fdb\u884c\u8bf4\u660e\u3002 \u5916\u952e people \u8868\uff08 id \uff0cname\uff0c address_id \uff09 address \u8868\uff08 id \uff0caddress\uff09 \u901a\u8fc7 @OneToOne \u548c @JoinColumn \u6ce8\u89e3\u5728people\u8868\u4e2d\u5c06adress\u4e3b\u952e\u4f5c\u4e3a\u5916\u952e People.java ```java @Entity\uff08name = \"people\"\uff09 public class People { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = \"id\", nullable = false) private Long id; @Column(name = \"name\", nullable = true, length = 20) private String name; @OneToOne(cascade=CascadeType.ALL)//People\u662f\u5173\u7cfb\u7684\u7ef4\u62a4\u7aef\uff0c\u5f53\u5220\u9664 people\uff0c\u4f1a\u7ea7\u8054\u5220\u9664 address @JoinColumn(name = \"address_id\")//\u9ed8\u8ba4\u4ee5address\u7684\u4e3b\u952e\u4f5c\u4e3a\u5916\u952e,\u5982\u679c\u4e0d\u60f3\u4f7f\u7528\u4e3b\u952e\u4f5c\u4e3a\u5916\u952e\u53ef\u4ee5\u4f7f\u7528referencedColumnName\u5c5e\u6027\u6765\u8bbe\u7f6e private Address address; } ``` Adress.java ```java @Entity(name = \"address\") public class Address { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = \"id\", nullable = false) private Long id;//id @Column(name = \"address\", nullable = true, length = 100) private String address;//\u5730\u5740 //mappedBy\u8868\u793aAddress\u662f\u5173\u7cfb\u7684\u88ab\u7ef4\u62a4\u7aef\uff0c\u5176\u503caddress\u4e3aAddress\u5728People\u4e2d\u7684\u5c5e\u6027\u540d\uff0cAddress\u65e0\u6cd5\u7ef4\u62a4\u4e0ePeople\u4e4b\u95f4\u7684\u5173\u7cfb //optinoal\u5c5e\u6027\u8868\u793a\u8be5\u5c5e\u6027\u662f\u5426\u80fd\u4e3a\u7a7a\uff0cfalse\u8868\u793a\u4e0d\u80fd\u4e3a\u7a7a //\u5982\u679c\u4e0d\u9700\u8981\u6839\u636eAddress\u7ea7\u8054\u67e5\u8be2People\uff0c\u53ef\u4ee5\u53bb\u6389\u8fd9\u4e2a\u5b57\u6bb5 @OneToOne(mappedBy = \"address\", cascade = {CascadeType.MERGE, CascadeType.REFRESH}, optional = false) private People people; } ``` \u4e2d\u95f4\u8868 people \u8868\uff08 id \uff0cname\uff09 address \u8868\uff08 id \uff0caddress\uff09 people_address\u8868 ( people_id , address_id ) \u901a\u8fc7 @OneToOne \u548c @JoinTable \u6ce8\u89e3\u6765\u521b\u5efa\u4e2d\u95f4\u8868 People.java ```java @Entity\uff08name = \"people\"\uff09 public class People { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = \"id\", nullable = false) private Long id; @Column(name = \"name\", nullable = true, length = 20) private String name; @OneToOne(cascade=CascadeType.ALL)//People\u662f\u5173\u7cfb\u7684\u7ef4\u62a4\u7aef\uff0c\u5f53\u5220\u9664 people\uff0c\u4f1a\u7ea7\u8054\u5220\u9664 address @JoinTable(name = \"people_address\", joinColumns = @JoinColumn(name=\"people_id\"), inverseJoinColumns = @JoinColumn(name = \"address_id\")) private Address address; } ``` Adress.java \u4e0d\u53d8 @OneToMany\u548c@ManyToOne \u4f7f\u7528\u8f83\u591a\u7684\u4e00\u5bf9\u591a\u5173\u7cfb\u5305\u62ec\u5355\u5411\u591a\u5bf9\u4e00\u548c\u53cc\u5411\u4e00\u5bf9\u591a\u3002\u8fd9\u4e24\u8005\u7684\u533a\u522b\u4e3b\u8981\u5728\u4e8e\u4e00\u7aef\u662f\u5426\u6301\u6709\u591a\u7aef\u7684\u5f15\u7528\uff0c\u5355\u5411\u4e00\u5bf9\u591a\u53ea\u9700\u8981\u5728\u591a\u7aef\u4f7f\u7528@ManyToOne\u6ce8\u89e3\uff0c\u5728\u591a\u7aef\u7684\u8868\u4e2d\u5c06\u5355\u7aef\u7684\u4e3b\u952e\u4f5c\u4e3a\u5916\u952e\uff1b\u800c\u53cc\u5411\u4e00\u5bf9\u591a\u7684\u8868\u7ed3\u6784\u548c\u5355\u5411\u4e00\u5bf9\u591a\u7684\u8868\u7ed3\u6784\u6ca1\u6709\u533a\u522b\uff0c\u5dee\u5f02\u5728\u4e8e\u4e00\u7aef\u662f\u5426\u4f7f\u7528@OneToMany\u6ce8\u89e3\u5e76\u6301\u6709\u591a\u7aef\u5bf9\u8c61\u3002 \u5355\u5411\u591a\u5bf9\u4e00\uff08\u53ea\u4f7f\u7528@ManyToOne\u6ce8\u89e3\uff09 \u4e0b\u9762\u4ee5\u8ba2\u5355\uff08order\uff0c\u591a\u7aef\uff09\u548c\u5ba2\u6237\uff08customer\uff0c\u4e00\u7aef\uff09\u4e3a\u4f8b\uff0c\u8fdb\u884c\u8bf4\u660e\u3002\u4e00\u4e2a\u5ba2\u6237\u53ef\u4ee5\u6709\u591a\u4e2a\u8ba2\u5355\uff0c\u53ea\u9700\u8981\u4ece\u8ba2\u5355\u7aef\u627e\u5230\u5bf9\u5e94\u7684\u5ba2\u6237\uff0c\u800c\u4e0d\u5173\u5fc3\u5ba2\u6237\u7684\u6240\u6709\u8ba2\u5355\u3002\u6b64\u65f6\u53ef\u4ee5\u4f7f\u7528\u5355\u5411\u591a\u5bf9\u4e00\uff0c\u53ea\u9700\u8981\u4ece\u4e00\u7aef\u8bbf\u95ee\u591a\u7aef\u3002 \u8868\u7ed3\u6784 customer\u8868\uff08 id , name\uff09 order\u8868\uff08 id , orderNumber, customer_id \uff09 \u901a\u8fc7@ManyToOne\u548c@JoinColumu\u6ce8\u89e3\u8bbe\u7f6eorder\u8868\u7684\u5916\u952e Customer.java ```java @Entity(name = \"customer\") public class Customer { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = \"id\", nullable = false) private Long id; @Column(name = \"name\", nullable = true, length = 32) private String name; } ``` Order.java ```java @Entity(name = \"customer\") public class Order { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = \"id\", nullable = false) private Long id; @Column(name = \"name\", nullable = true, length = 32) private String orderNumber; @ManyToOne(optional = false)//optional\u5c5e\u6027\u8868\u793a\u662f\u5426\u80fd\u4e3a\u7a7a\uff0cfalse\u8868\u793a\u4e0d\u80fd\u4e3a\u7a7a @JoinColumn(name = \"customer_id\") //\u8bbe\u7f6e\u5728order\u8868\u4e2d\u7684\u5173\u8054\u5b57\u6bb5(\u5916\u952e),\u9ed8\u8ba4\u4e3a\u5173\u8054\u5b9e\u4f53\u7684\u4e3b\u952e private Customer customer; } ``` \u53cc\u5411\u4e00\u5bf9\u591a\uff08@ManyToOne\u548c@JoinColumu\u6ce8\u89e3\u540c\u65f6\u4f7f\u7528\uff09 \u5728JPA\u89c4\u8303\u4e2d\uff0c\u4e00\u5bf9\u591a\u7684\u53cc\u5411\u5173\u7cfb\u7531\u591a\u7aef\u6765\u7ef4\u62a4\u3002\u591a\u7aef\u4e3a\u5173\u7cfb\u7ef4\u62a4\u7aef\uff0c\u8d1f\u8d23\u5173\u7cfb\u7684\u589e\u5220\u6539\u67e5\u3002\u4e00\u7aef\u5219\u4e3a\u5173\u7cfb\u88ab\u7ef4\u62a4\u7aef\uff0c\u4e0d\u80fd\u7ef4\u62a4\u5173\u7cfb\u3002 \u8fd8\u662f\u4ee5\u8ba2\u5355\uff08order\uff0c\u591a\u7aef\uff09\u548c\u5ba2\u6237\uff08customer\uff0c\u4e00\u7aef\uff09\u4e3a\u4f8b\uff0c\u5f53\u5ba2\u6237\u9700\u8981\u77e5\u9053\u81ea\u5df1\u7684\u6240\u6709\u8ba2\u5355\u65f6\u5373\u9700\u8981\u901a\u8fc7\u5ba2\u6237\u83b7\u5f97\u5bf9\u5e94\u7684\u8ba2\u5355\uff0c\u5fc5\u987b\u4f7f\u7528\u53cc\u5411\u4e00\u5bf9\u591a\u5173\u7cfb\u3002 \u8868\u7ed3\u6784 customer\u8868\uff08 id , name\uff09 order\u8868\uff08 id , orderNumber, customer_id \uff09 Customer.java ```java @Entity(name = \"customer\") public class Customer { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = \"id\", nullable = false) private Long id; @Column(name = \"name\", nullable = true, length = 32\uff09 private String name; @OneToMany(mappedBy = \"customer\")//\u7528\u4e8emappedBy\u5c5e\u6027\u7684\u4e3a\u5173\u7cfb\u88ab\u7ef4\u62a4\u7aef private List<Order> orders; } ``` Order.java \u4e0d\u53d8 @ManyToMany JPA\u4e2d\u4f7f\u7528@ManyToMany\u6ce8\u89e3\u6765\u6620\u5c04\u591a\u5bf9\u591a\u7684\u5173\u7cfb\uff0c\u5fc5\u987b\u901a\u8fc7\u4e2d\u95f4\u8868\u6765\u7ef4\u62a4\u3002\u4e2d\u95f4\u8868\u7684\u8868\u540d\u9ed8\u8ba4\u662f\uff1a\u4e3b\u8868\u540d+\u4e0b\u5212\u7ebf+\u4ece\u8868\u540d(\u4e3b\u8868\u662f\u6307\u5173\u7cfb\u7ef4\u62a4\u7aef\u5bf9\u5e94\u7684\u8868,\u4ece\u8868\u6307\u5173\u7cfb\u88ab\u7ef4\u62a4\u7aef\u5bf9\u5e94\u7684\u8868)\u3002\u8fd9\u4e2a\u5173\u8054\u8868\u53ea\u6709\u4e24\u4e2a\u5916\u952e\u5b57\u6bb5\uff0c\u5206\u522b\u6307\u5411\u4e3b\u8868ID\u548c\u4ece\u8868ID\u3002\u5b57\u6bb5\u7684\u540d\u79f0\u9ed8\u8ba4\u4e3a\uff1a\u4e3b\u8868\u540d+\u4e0b\u5212\u7ebf+\u4e3b\u8868\u4e2d\u7684\u4e3b\u952e\u5217\u540d\uff0c\u4ece\u8868\u540d+\u4e0b\u5212\u7ebf+\u4ece\u8868\u4e2d\u7684\u4e3b\u952e\u5217\u540d\u3002 \u591a\u5bf9\u591a\u5173\u7cfb\u4e0e\u4e00\u5bf9\u591a\u5173\u7cfb\u7c7b\u4f3c\uff0c\u4e5f\u5b58\u5728\u5355\u5411\u591a\u5bf9\u591a\u548c\u53cc\u5411\u591a\u5bf9\u591a\u5173\u7cfb\u3002 \u5355\u5411\u591a\u5bf9\u591a\uff08\u53ea\u5728\u4e00\u7aef\u4f7f\u7528@ManyToMany\u6ce8\u89e3\uff09 \u4e0b\u9762\u4ee5\u7c7b\u522b\uff08category\uff0c\u5173\u7cfb\u7ef4\u62a4\u7aef\uff09\u548c\u6761\u76ee\uff08item, \u5173\u7cfb\u88ab\u7ef4\u62a4\u7aef\uff09\u4e3a\u4f8b\u8fdb\u884c\u8bf4\u660e\u3002\u4e00\u4e2a\u7c7b\u522b\u53ef\u4ee5\u6709\u591a\u4e2a\u6761\u76ee\uff0c\u4e00\u4e2a\u6761\u76ee\u53ef\u4ee5\u5c5e\u4e8e\u591a\u4e2a\u7c7b\u522b\uff0c\u5355\u5411\u591a\u5bf9\u591a\u4e2d\u53ea\u9700\u8981\u901a\u8fc7\u7c7b\u522b\u6765\u627e\u5230\u6240\u6709\u6761\u76ee\uff0c\u800c\u4e0d\u9700\u8981\u901a\u8fc7\u6761\u76ee\u83b7\u5f97\u5176\u6240\u5c5e\u7684\u6240\u6709\u7c7b\u522b\u3002 \u8868\u7ed3\u6784 category \u8868\uff08 id , name\uff09 item\u8868\uff08 id , name, price\uff09 category _items\u8868\uff08 category _id , item_id \uff09 Category .java ```java @Entity(name = \"category\") public class Category { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = \"id\", nullable = false) private Long id; @Column(name = \"name\", nullable = false) private String name; @ManyToMany @JoinTable(name = \"category_item\", joinColumns = @JoinColumn(name = \"category_id\"), inverseJoinColumns = @JoinColumn(name = \"item_id\")) private List<Item> items; } ``` \u5173\u4e8ecategory\u6709\u51e0\u70b9\u9700\u8981\u8bf4\u660e\uff1a \u5173\u7cfb\u7ef4\u62a4\u7aef\uff0c\u8d1f\u8d23\u591a\u5bf9\u591a\u5173\u7cfb\u7684\u7ed1\u5b9a\u548c\u89e3\u9664\uff0c\u5373\u53ea\u80fd\u7531category\u5bf9\u8c61\u6765\u6dfb\u52a0items\u5bf9\u8c61\uff0citem\u65e0\u6cd5\u7ef4\u62a4\u4ed6\u4eec\u7684\u5173\u7cfb\u3002 @JoinTable\u6ce8\u89e3\u7684name\u5c5e\u6027\u6307\u5b9a\u5173\u8054\u8868\u7684\u540d\u5b57\uff1bjoinColumns\u6307\u5b9a\u4e3b\u8868\u4e3b\u952e\u7684\u540d\u5b57\uff0c\u5173\u8054\u5230\u5173\u7cfb\u7ef4\u62a4\u7aefcategory\uff1binverseJoinColumns\u6307\u5b9a\u4ece\u8868\u4e3b\u952e\u7684\u540d\u5b57\uff0c\u5173\u8054\u5230\u5173\u7cfb\u88ab\u7ef4\u62a4\u7aef(item) @JionTable\u6ce8\u89e3\u53ef\u4ee5\u7701\u7565\uff0c\u7531\u9ed8\u8ba4\u89c4\u5219\u751f\u6210\u4e2d\u95f4\u8868\u3002 Item.java ```java @Entity(name = \"item\") public class Item { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = \"id\", nullable = false) private Long id; @Column(name = \"name\", nullable = false) private String name; } ``` \u53cc\u5411\u591a\u5bf9\u591a\uff08\u4e24\u7aef\u90fd\u4f7f\u7528@ManyToMany\u6ce8\u89e3\uff09 \u53cc\u5411\u591a\u5bf9\u591a\u5173\u7cfb\u4e2d\uff0c\u53ef\u4ee5\u6307\u5b9a\u4efb\u610f\u4e00\u7aef\u4e3a\u5173\u7cfb\u7ef4\u62a4\u7aef\uff0c\u6307\u5b9a\u5173\u7cfb\u7ef4\u62a4\u7aef\u540e\uff08\u975emappedBy\u5c5e\u6027\u6301\u6709\u7aef\uff09\uff0c\u4e24\u7aef\u5173\u7cfb\u7684\u7ed1\u5b9a\u548c\u89e3\u9664\u90fd\u53ea\u80fd\u7531\u7ef4\u62a4\u7aef\u6765\u5b8c\u6210\u3002\u5f53\u7ed1\u5b9a\u5173\u7cfb\u540e\uff0c\u65e0\u6cd5\u76f4\u63a5\u5220\u9664\u5173\u7cfb\u88ab\u7ef4\u62a4\u7aef\uff0c\u8981\u89e3\u9664\u7ed1\u5b9a\u5173\u7cfb\u540e\u624d\u80fd\u5220\u9664\uff0c\u4f46\u53ef\u4ee5\u76f4\u63a5\u5220\u9664\u5173\u7cfb\u7ef4\u62a4\u7aef\uff0c\u5220\u9664\u65f6\u4f1a\u5148\u89e3\u9664\u7ed1\u5b9a\u5173\u7cfb\u3002 \u8fd8\u662f\u4ee5\u7c7b\u522b\uff08category\uff0c\u5173\u7cfb\u7ef4\u62a4\u7aef\uff09\u548c\u6761\u76ee\uff08item, \u5173\u7cfb\u88ab\u7ef4\u62a4\u7aef\uff09\u4e3a\u4f8b\u8fdb\u884c\u8bf4\u660e\u3002\u5f53\u53cc\u65b9\u90fd\u9700\u8981\u901a\u8fc7\u81ea\u8eab\u6765\u627e\u5230\u5bf9\u5e94\u7684\u5bf9\u8c61\u65f6\uff0c\u9700\u8981\u4f7f\u7528\u53cc\u5411\u591a\u5bf9\u591a\u3002 \u8868\u7ed3\u6784 category \u8868\uff08 id , name\uff09 item\u8868\uff08 id , name, price\uff09 category _items\u8868\uff08 category _id , item_id \uff09 Category .java \u4e0e\u4e0a\u6587\u4e2d\u76f8\u540c Item.java \u4e0e\u4e0a\u6587\u4e2d\u5b9e\u4f53\u7c7b\u76f8\u4f3c\uff0c\u4f46\u662f\u5728Item\u4e2d\u589e\u52a0\u4e86category\u7684\u96c6\u5408\u3002 ```java @Entity(name = \"item\") public class Item { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = \"id\", nullable = false) private Long id; @Column(name = \"name\", nullable = false) private String name; @ManyToMany(mappedBy = \"items\") private List<Category> categories; } ``` <==To be continue... 2.\u5728SpringBoot\u4e2d\u4f7f\u7528Hibernate Validate\u6821\u9a8c\u524d\u53f0\u4f20\u5165\u7684\u5c5e\u6027 \u8be6\u89c1 https://www.jianshu.com/p/5ab860e4f25a 3.\u4f7f\u7528SpringDataJPA\u5b9e\u73b0\u6570\u636e\u5e93\u8bbf\u95ee\uff08\u9ed8\u8ba4\u89c4\u5219\u3001\u7ee7\u627f\u5173\u7cfb\u4e4b\u7c7b\uff09 4.JpaSpecificationExecutor\u63a5\u53e3\uff08\u52a8\u6001\u67e5\u8be2\uff09 5.\u81ea\u5b9a\u4e49Repositiry\u5e76\u4e0e\u9ed8\u8ba4\u5b9e\u73b0\u6574\u5408\uff0c\u5c01\u88c5\u81ea\u5df1\u7684BaseRepository \u53c2\u8003 https://liuyanzhao.com/7913.html","title":"SpringDataJpa\u7b14\u8bb0"},{"location":"Spring/Spring_DBs/SpringDataJpa\u7b14\u8bb0/#1","text":"@Entity\u3001@Id @Entity \u6ce8\u89e3\u8868\u660e\u8be5\u7c7b\u662f\u4e00\u4e2a\u5b9e\u4f53\u7c7b\uff0c\u5e76\u4e14\u4f7f\u7528\u9ed8\u8ba4\u7684 ORM \u89c4\u5219\uff0c\u5373\u7c7b\u540d\u4f5c\u4e3a\u6570\u636e\u5e93\u8868\u4e2d\u8868\u540d\uff0c\u7c7b\u7684\u5c5e\u6027\u540d\u4f5c\u4e3a\u8868\u4e2d\u7684\u5b57\u6bb5\u540d\u3002\u4ee5\u4e0b\u9762\u4ee3\u7801\u4e3a\u4f8b\uff1a @Entity public class Employee implements Serializable { private static final long serialVersionUID = 1L; @Id private Long id; private String name; private int age; private String addree; // Getters and Setters } \u5982\u679c\u6ca1\u6709 @javax.persistence.Entity \u548c @javax.persistence.Id \u8fd9\u4e24\u4e2a\u6ce8\u89e3\u7684\u8bdd\uff0c\u5b83\u53ea\u662f\u4e00\u4e2a\u5178\u578b\u7684 POJO \u7684 Java \u7c7b\uff0c\u73b0\u5728\u52a0\u4e0a\u8fd9\u4e24\u4e2a\u6ce8\u89e3\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u5b9e\u4f53\u7c7b\u4e0e\u6570\u636e\u5e93\u4e2d\u7684\u8868\u76f8\u5bf9\u5e94\uff0c\u5373ORM\u6846\u67b6\u4f1a\u81ea\u52a8\u5e2e\u4f60\u5b8c\u6210\u6620\u5c04\u3002 \u8981\u4f7f\u5b9e\u4f53\u7c7b\u4e0e\u6570\u636e\u5e93\u4e2d\u7684\u8868\u76f8\u5bf9\u5e94\u5fc5\u987b\u9075\u5b88\u4ee5\u4e0b\u89c4\u5219\uff1a \u5b9e\u4f53\u7c7b\u5fc5\u987b\u7528 @Entity \u8fdb\u884c\u6ce8\u89e3\uff1b \u5fc5\u987b\u4f7f\u7528 @Id \u6765\u6ce8\u89e3\u4e00\u4e2a\u4e3b\u952e\uff1b \u5b9e\u4f53\u7c7b\u5fc5\u987b\u62e5\u6709\u4e00\u4e2a public \u6216\u8005 protected \u7684\u65e0\u53c2\u6784\u9020\u51fd\u6570\uff0c\u6b64\u5916\u5b9e\u4f53\u7c7b\u8fd8\u53ef\u4ee5\u62e5\u6709\u5176\u4ed6\u7684\u6784\u9020\u51fd\u6570\uff1b \u5b9e\u4f53\u7c7b\u5fc5\u987b\u662f\u4e00\u4e2a\u9876\u7ea7\u7c7b\uff08top-level class\uff09\u3002\u4e00\u4e2a\u679a\u4e3e\uff08enum\uff09\u6216\u8005\u4e00\u4e2a\u63a5\u53e3\uff08interface\uff09\u4e0d\u80fd\u88ab\u6ce8\u89e3\u4e3a\u4e00\u4e2a\u5b9e\u4f53\uff1b \u5982\u679c\u5b9e\u4f53\u7c7b\u7684\u4e00\u4e2a\u5b9e\u4f8b\u9700\u8981\u7528\u4f20\u503c\u7684\u65b9\u5f0f\u8c03\u7528\uff08\u4f8b\u5982\uff0c\u8fdc\u7a0b\u8c03\u7528\uff09\uff0c\u5219\u8fd9\u4e2a\u5b9e\u4f53\u7c7b\u5fc5\u987b\u5b9e\u73b0java.io.Serializable \u63a5\u53e3\u3002 @Table @Table \u6ce8\u89e3\u662f\u4e00\u4e2a\u975e\u5fc5\u987b\u7684\u6ce8\u89e3\uff0c\u5fc5\u987b\u914d\u5408@Entity\u4f7f\u7528\u3002@Table \u6ce8\u89e3\u6307\u5b9a\u4e86 Entity \u6240\u8981\u6620\u5c04\u5e26\u6570\u636e\u5e93\u8868\u540d\uff0c\u5176\u4e2d @Table.name\u7528\u6765\u6307\u5b9a\u6620\u5c04\u8868\u7684\u8868\u540d\u3002\u58f0\u660e\u6b64\u5bf9\u8c61\u6620\u5c04\u5230\u6570\u636e\u5e93\u7684\u6570\u636e\u8868\uff0c\u901a\u8fc7\u5b83\u53ef\u4ee5\u4e3a\u5b9e\u4f53\u6307\u5b9a\u8868\u540d(name)\uff0c\u76ee\u5f55 (catalog) \u548c schema\u3002 \u6ce8\uff1a\u5f53@Table\u548c@Entity\u540c\u65f6\u6307name\u65f6\uff0c@Table.name\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8e@Entity.name @GeneratedValue\u3001@GenericGenerator @GeneratedValue\u901a\u7528\u7b56\u7565\u751f\u6210\u5668\uff0c\u5fc5\u987b\u914d\u5408@Id\u6ce8\u89e3\u4f7f\u7528\uff0c\u7528\u6765\u6307\u5b9a\u4e3b\u952e\u7684\u751f\u6210\u7b56\u7565\u3002 @GenericGenerator\u81ea\u5b9a\u4e49\u4e3b\u952e\u751f\u6210\u7b56\u7565\uff0c\u7528\u4e8e\u914d\u5408@GeneratedValue\u6ce8\u89e3\uff0c\u6765\u751f\u6210\u5176\u4ed6\u7c7b\u578b\u7684\u4e3b\u952e\u3002\u4f8b\u5982\uff0c\u4f7f\u7528UUID\u4f5c\u4e3a\u4e3b\u952e @Id @GenericGenerator(name = \"uuid2\", strategy = \"org.hibernate.id.UUIDGenerator\") @GeneratedValue(generator = \"uuid2\") private UUID uuid; @Column @Column\u6ce8\u89e3\u58f0\u660e\u4e86\u5c5e\u6027\u4e0e\u6570\u636e\u5e93\u4e4b\u95f4\u7684\u6620\u5c04\u5173\u7cfb\u3002\u4f8b\u5982\uff0c\u8be5\u5b57\u6bb5\u662f\u5426\u552f\u4e00\u3001\u662f\u5426\u80fd\u4e3a\u7a7a\u3001\u957f\u5ea6\u3001\u5b57\u6bb5\u540d\u7b49\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\u5f53\u6709\u5c5e\u6027\u4e0d\u9700\u8981\u4e0e\u6570\u636e\u5e93\u5b57\u6bb5\u6620\u5c04\u65f6\uff0c\u9700\u8981\u4f7f\u7528 @Transitent \u4fee\u9970\uff0c\u8868\u793a\u6b64\u5c5e\u6027\u4e0e\u8868\u6ca1\u6709\u6620\u5c04\u5173\u7cfb\u3002 @CreatedDate\u3001@LastModifiedDate \u4ece\u5b57\u9762\u610f\u601d\u5c31\u53ef\u4ee5\u7406\u89e3\uff0c\u8fd9\u4e24\u4e2a\u6ce8\u89e3\u5206\u522b\u8868\u793a\u5b9e\u4f53\u521b\u5efa\u65e5\u671f\u548c\u5b9e\u4f53\u6700\u540e\u66f4\u65b0\u7684\u65e5\u671f\u3002\u5728\u8fdb\u884c\u65b0\u5efa\u548c\u66f4\u65b0\u64cd\u4f5c\u65f6\uff0c\u5b57\u6bb5\u4f1a\u81ea\u52a8\u8bbe\u7f6e\u5e76\u63d2\u5165\u6570\u636e\u5e93\u3002 \u4f7f\u7528\u65b9\u5f0f\uff0c\u9700\u8981\u5728\u5b9e\u4f53\u7c7b\u4e0a\u52a0\u4e0a\u76d1\u542c\u5668\u6ce8\u89e3\uff0c\u5e76\u4e14\u5411\u76f8\u5e94\u5b57\u6bb5\u4e0a\u52a0\u4e0a@CreatedDate\u548c@LastModifiedDate\u6ce8\u89e3\uff0c\u6700\u540e\u5fc5\u987b\u5728application\u7c7b\u4e0a\u52a0\u4e0a@EnableJpaAuditing\u6ce8\u89e3\uff0c\u5982\u4e0b\uff1a @Entity @Table(name = \"store_source_bind\") @EntityListeners(AuditingEntityListener.class) public class StoreSourceBind { /** * \u521b\u5efa\u65f6\u95f4 */ @Column(name = \"create_time\") @CreatedDate private Date createTime; /** * \u4fee\u6539\u65f6\u95f4 */ @Column(name = \"lastmodified_time\") @LastModifiedDate private Date lastmodifiedTime\uff1b } @SpringBootApplication @EnableJpaAuditing public class WalletApplication { public static void main(String[] args) { new SpringApplicationBuilder(WalletApplication.class).web(true).run(args); } } @OneToOne JPA\u4f7f\u7528@OneToOne\u6765\u8868\u793a\u4e00\u5bf9\u4e00\u7684\u6620\u5c04\u5173\u7cfb\uff0c\u4e00\u5bf9\u4e00\u5173\u7cfb\u6709\u4e24\u79cd\u63cf\u8ff0\u65b9\u5f0f\u3002 \u5916\u952e\uff0c\u4e00\u4e2a\u5b9e\u4f53\u901a\u8fc7\u5c06\u53e6\u4e00\u4e2a\u5b9e\u4f53\u7684\u4e3b\u952e\u4f5c\u4e3a\u5916\u952e\u3002 \u4e2d\u95f4\u8868\uff0c\u901a\u8fc7\u4e2d\u95f4\u8868\u6765\u4fdd\u5b58\u4e24\u4e2a\u5b9e\u4f53\u7684\u4e3b\u952e\u3002 \u4e0b\u9762\u4ee5\u7528\u6237\uff08People\uff09\u4e0e\u5730\u5740\uff08Address\uff09\u4e3a\u4f8b\u8fdb\u884c\u8bf4\u660e\u3002 \u5916\u952e people \u8868\uff08 id \uff0cname\uff0c address_id \uff09 address \u8868\uff08 id \uff0caddress\uff09 \u901a\u8fc7 @OneToOne \u548c @JoinColumn \u6ce8\u89e3\u5728people\u8868\u4e2d\u5c06adress\u4e3b\u952e\u4f5c\u4e3a\u5916\u952e People.java ```java @Entity\uff08name = \"people\"\uff09 public class People { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = \"id\", nullable = false) private Long id; @Column(name = \"name\", nullable = true, length = 20) private String name; @OneToOne(cascade=CascadeType.ALL)//People\u662f\u5173\u7cfb\u7684\u7ef4\u62a4\u7aef\uff0c\u5f53\u5220\u9664 people\uff0c\u4f1a\u7ea7\u8054\u5220\u9664 address @JoinColumn(name = \"address_id\")//\u9ed8\u8ba4\u4ee5address\u7684\u4e3b\u952e\u4f5c\u4e3a\u5916\u952e,\u5982\u679c\u4e0d\u60f3\u4f7f\u7528\u4e3b\u952e\u4f5c\u4e3a\u5916\u952e\u53ef\u4ee5\u4f7f\u7528referencedColumnName\u5c5e\u6027\u6765\u8bbe\u7f6e private Address address; } ``` Adress.java ```java @Entity(name = \"address\") public class Address { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = \"id\", nullable = false) private Long id;//id @Column(name = \"address\", nullable = true, length = 100) private String address;//\u5730\u5740 //mappedBy\u8868\u793aAddress\u662f\u5173\u7cfb\u7684\u88ab\u7ef4\u62a4\u7aef\uff0c\u5176\u503caddress\u4e3aAddress\u5728People\u4e2d\u7684\u5c5e\u6027\u540d\uff0cAddress\u65e0\u6cd5\u7ef4\u62a4\u4e0ePeople\u4e4b\u95f4\u7684\u5173\u7cfb //optinoal\u5c5e\u6027\u8868\u793a\u8be5\u5c5e\u6027\u662f\u5426\u80fd\u4e3a\u7a7a\uff0cfalse\u8868\u793a\u4e0d\u80fd\u4e3a\u7a7a //\u5982\u679c\u4e0d\u9700\u8981\u6839\u636eAddress\u7ea7\u8054\u67e5\u8be2People\uff0c\u53ef\u4ee5\u53bb\u6389\u8fd9\u4e2a\u5b57\u6bb5 @OneToOne(mappedBy = \"address\", cascade = {CascadeType.MERGE, CascadeType.REFRESH}, optional = false) private People people; } ``` \u4e2d\u95f4\u8868 people \u8868\uff08 id \uff0cname\uff09 address \u8868\uff08 id \uff0caddress\uff09 people_address\u8868 ( people_id , address_id ) \u901a\u8fc7 @OneToOne \u548c @JoinTable \u6ce8\u89e3\u6765\u521b\u5efa\u4e2d\u95f4\u8868 People.java ```java @Entity\uff08name = \"people\"\uff09 public class People { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = \"id\", nullable = false) private Long id; @Column(name = \"name\", nullable = true, length = 20) private String name; @OneToOne(cascade=CascadeType.ALL)//People\u662f\u5173\u7cfb\u7684\u7ef4\u62a4\u7aef\uff0c\u5f53\u5220\u9664 people\uff0c\u4f1a\u7ea7\u8054\u5220\u9664 address @JoinTable(name = \"people_address\", joinColumns = @JoinColumn(name=\"people_id\"), inverseJoinColumns = @JoinColumn(name = \"address_id\")) private Address address; } ``` Adress.java \u4e0d\u53d8 @OneToMany\u548c@ManyToOne \u4f7f\u7528\u8f83\u591a\u7684\u4e00\u5bf9\u591a\u5173\u7cfb\u5305\u62ec\u5355\u5411\u591a\u5bf9\u4e00\u548c\u53cc\u5411\u4e00\u5bf9\u591a\u3002\u8fd9\u4e24\u8005\u7684\u533a\u522b\u4e3b\u8981\u5728\u4e8e\u4e00\u7aef\u662f\u5426\u6301\u6709\u591a\u7aef\u7684\u5f15\u7528\uff0c\u5355\u5411\u4e00\u5bf9\u591a\u53ea\u9700\u8981\u5728\u591a\u7aef\u4f7f\u7528@ManyToOne\u6ce8\u89e3\uff0c\u5728\u591a\u7aef\u7684\u8868\u4e2d\u5c06\u5355\u7aef\u7684\u4e3b\u952e\u4f5c\u4e3a\u5916\u952e\uff1b\u800c\u53cc\u5411\u4e00\u5bf9\u591a\u7684\u8868\u7ed3\u6784\u548c\u5355\u5411\u4e00\u5bf9\u591a\u7684\u8868\u7ed3\u6784\u6ca1\u6709\u533a\u522b\uff0c\u5dee\u5f02\u5728\u4e8e\u4e00\u7aef\u662f\u5426\u4f7f\u7528@OneToMany\u6ce8\u89e3\u5e76\u6301\u6709\u591a\u7aef\u5bf9\u8c61\u3002 \u5355\u5411\u591a\u5bf9\u4e00\uff08\u53ea\u4f7f\u7528@ManyToOne\u6ce8\u89e3\uff09 \u4e0b\u9762\u4ee5\u8ba2\u5355\uff08order\uff0c\u591a\u7aef\uff09\u548c\u5ba2\u6237\uff08customer\uff0c\u4e00\u7aef\uff09\u4e3a\u4f8b\uff0c\u8fdb\u884c\u8bf4\u660e\u3002\u4e00\u4e2a\u5ba2\u6237\u53ef\u4ee5\u6709\u591a\u4e2a\u8ba2\u5355\uff0c\u53ea\u9700\u8981\u4ece\u8ba2\u5355\u7aef\u627e\u5230\u5bf9\u5e94\u7684\u5ba2\u6237\uff0c\u800c\u4e0d\u5173\u5fc3\u5ba2\u6237\u7684\u6240\u6709\u8ba2\u5355\u3002\u6b64\u65f6\u53ef\u4ee5\u4f7f\u7528\u5355\u5411\u591a\u5bf9\u4e00\uff0c\u53ea\u9700\u8981\u4ece\u4e00\u7aef\u8bbf\u95ee\u591a\u7aef\u3002 \u8868\u7ed3\u6784 customer\u8868\uff08 id , name\uff09 order\u8868\uff08 id , orderNumber, customer_id \uff09 \u901a\u8fc7@ManyToOne\u548c@JoinColumu\u6ce8\u89e3\u8bbe\u7f6eorder\u8868\u7684\u5916\u952e Customer.java ```java @Entity(name = \"customer\") public class Customer { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = \"id\", nullable = false) private Long id; @Column(name = \"name\", nullable = true, length = 32) private String name; } ``` Order.java ```java @Entity(name = \"customer\") public class Order { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = \"id\", nullable = false) private Long id; @Column(name = \"name\", nullable = true, length = 32) private String orderNumber; @ManyToOne(optional = false)//optional\u5c5e\u6027\u8868\u793a\u662f\u5426\u80fd\u4e3a\u7a7a\uff0cfalse\u8868\u793a\u4e0d\u80fd\u4e3a\u7a7a @JoinColumn(name = \"customer_id\") //\u8bbe\u7f6e\u5728order\u8868\u4e2d\u7684\u5173\u8054\u5b57\u6bb5(\u5916\u952e),\u9ed8\u8ba4\u4e3a\u5173\u8054\u5b9e\u4f53\u7684\u4e3b\u952e private Customer customer; } ``` \u53cc\u5411\u4e00\u5bf9\u591a\uff08@ManyToOne\u548c@JoinColumu\u6ce8\u89e3\u540c\u65f6\u4f7f\u7528\uff09 \u5728JPA\u89c4\u8303\u4e2d\uff0c\u4e00\u5bf9\u591a\u7684\u53cc\u5411\u5173\u7cfb\u7531\u591a\u7aef\u6765\u7ef4\u62a4\u3002\u591a\u7aef\u4e3a\u5173\u7cfb\u7ef4\u62a4\u7aef\uff0c\u8d1f\u8d23\u5173\u7cfb\u7684\u589e\u5220\u6539\u67e5\u3002\u4e00\u7aef\u5219\u4e3a\u5173\u7cfb\u88ab\u7ef4\u62a4\u7aef\uff0c\u4e0d\u80fd\u7ef4\u62a4\u5173\u7cfb\u3002 \u8fd8\u662f\u4ee5\u8ba2\u5355\uff08order\uff0c\u591a\u7aef\uff09\u548c\u5ba2\u6237\uff08customer\uff0c\u4e00\u7aef\uff09\u4e3a\u4f8b\uff0c\u5f53\u5ba2\u6237\u9700\u8981\u77e5\u9053\u81ea\u5df1\u7684\u6240\u6709\u8ba2\u5355\u65f6\u5373\u9700\u8981\u901a\u8fc7\u5ba2\u6237\u83b7\u5f97\u5bf9\u5e94\u7684\u8ba2\u5355\uff0c\u5fc5\u987b\u4f7f\u7528\u53cc\u5411\u4e00\u5bf9\u591a\u5173\u7cfb\u3002 \u8868\u7ed3\u6784 customer\u8868\uff08 id , name\uff09 order\u8868\uff08 id , orderNumber, customer_id \uff09 Customer.java ```java @Entity(name = \"customer\") public class Customer { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = \"id\", nullable = false) private Long id; @Column(name = \"name\", nullable = true, length = 32\uff09 private String name; @OneToMany(mappedBy = \"customer\")//\u7528\u4e8emappedBy\u5c5e\u6027\u7684\u4e3a\u5173\u7cfb\u88ab\u7ef4\u62a4\u7aef private List<Order> orders; } ``` Order.java \u4e0d\u53d8 @ManyToMany JPA\u4e2d\u4f7f\u7528@ManyToMany\u6ce8\u89e3\u6765\u6620\u5c04\u591a\u5bf9\u591a\u7684\u5173\u7cfb\uff0c\u5fc5\u987b\u901a\u8fc7\u4e2d\u95f4\u8868\u6765\u7ef4\u62a4\u3002\u4e2d\u95f4\u8868\u7684\u8868\u540d\u9ed8\u8ba4\u662f\uff1a\u4e3b\u8868\u540d+\u4e0b\u5212\u7ebf+\u4ece\u8868\u540d(\u4e3b\u8868\u662f\u6307\u5173\u7cfb\u7ef4\u62a4\u7aef\u5bf9\u5e94\u7684\u8868,\u4ece\u8868\u6307\u5173\u7cfb\u88ab\u7ef4\u62a4\u7aef\u5bf9\u5e94\u7684\u8868)\u3002\u8fd9\u4e2a\u5173\u8054\u8868\u53ea\u6709\u4e24\u4e2a\u5916\u952e\u5b57\u6bb5\uff0c\u5206\u522b\u6307\u5411\u4e3b\u8868ID\u548c\u4ece\u8868ID\u3002\u5b57\u6bb5\u7684\u540d\u79f0\u9ed8\u8ba4\u4e3a\uff1a\u4e3b\u8868\u540d+\u4e0b\u5212\u7ebf+\u4e3b\u8868\u4e2d\u7684\u4e3b\u952e\u5217\u540d\uff0c\u4ece\u8868\u540d+\u4e0b\u5212\u7ebf+\u4ece\u8868\u4e2d\u7684\u4e3b\u952e\u5217\u540d\u3002 \u591a\u5bf9\u591a\u5173\u7cfb\u4e0e\u4e00\u5bf9\u591a\u5173\u7cfb\u7c7b\u4f3c\uff0c\u4e5f\u5b58\u5728\u5355\u5411\u591a\u5bf9\u591a\u548c\u53cc\u5411\u591a\u5bf9\u591a\u5173\u7cfb\u3002 \u5355\u5411\u591a\u5bf9\u591a\uff08\u53ea\u5728\u4e00\u7aef\u4f7f\u7528@ManyToMany\u6ce8\u89e3\uff09 \u4e0b\u9762\u4ee5\u7c7b\u522b\uff08category\uff0c\u5173\u7cfb\u7ef4\u62a4\u7aef\uff09\u548c\u6761\u76ee\uff08item, \u5173\u7cfb\u88ab\u7ef4\u62a4\u7aef\uff09\u4e3a\u4f8b\u8fdb\u884c\u8bf4\u660e\u3002\u4e00\u4e2a\u7c7b\u522b\u53ef\u4ee5\u6709\u591a\u4e2a\u6761\u76ee\uff0c\u4e00\u4e2a\u6761\u76ee\u53ef\u4ee5\u5c5e\u4e8e\u591a\u4e2a\u7c7b\u522b\uff0c\u5355\u5411\u591a\u5bf9\u591a\u4e2d\u53ea\u9700\u8981\u901a\u8fc7\u7c7b\u522b\u6765\u627e\u5230\u6240\u6709\u6761\u76ee\uff0c\u800c\u4e0d\u9700\u8981\u901a\u8fc7\u6761\u76ee\u83b7\u5f97\u5176\u6240\u5c5e\u7684\u6240\u6709\u7c7b\u522b\u3002 \u8868\u7ed3\u6784 category \u8868\uff08 id , name\uff09 item\u8868\uff08 id , name, price\uff09 category _items\u8868\uff08 category _id , item_id \uff09 Category .java ```java @Entity(name = \"category\") public class Category { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = \"id\", nullable = false) private Long id; @Column(name = \"name\", nullable = false) private String name; @ManyToMany @JoinTable(name = \"category_item\", joinColumns = @JoinColumn(name = \"category_id\"), inverseJoinColumns = @JoinColumn(name = \"item_id\")) private List<Item> items; } ``` \u5173\u4e8ecategory\u6709\u51e0\u70b9\u9700\u8981\u8bf4\u660e\uff1a \u5173\u7cfb\u7ef4\u62a4\u7aef\uff0c\u8d1f\u8d23\u591a\u5bf9\u591a\u5173\u7cfb\u7684\u7ed1\u5b9a\u548c\u89e3\u9664\uff0c\u5373\u53ea\u80fd\u7531category\u5bf9\u8c61\u6765\u6dfb\u52a0items\u5bf9\u8c61\uff0citem\u65e0\u6cd5\u7ef4\u62a4\u4ed6\u4eec\u7684\u5173\u7cfb\u3002 @JoinTable\u6ce8\u89e3\u7684name\u5c5e\u6027\u6307\u5b9a\u5173\u8054\u8868\u7684\u540d\u5b57\uff1bjoinColumns\u6307\u5b9a\u4e3b\u8868\u4e3b\u952e\u7684\u540d\u5b57\uff0c\u5173\u8054\u5230\u5173\u7cfb\u7ef4\u62a4\u7aefcategory\uff1binverseJoinColumns\u6307\u5b9a\u4ece\u8868\u4e3b\u952e\u7684\u540d\u5b57\uff0c\u5173\u8054\u5230\u5173\u7cfb\u88ab\u7ef4\u62a4\u7aef(item) @JionTable\u6ce8\u89e3\u53ef\u4ee5\u7701\u7565\uff0c\u7531\u9ed8\u8ba4\u89c4\u5219\u751f\u6210\u4e2d\u95f4\u8868\u3002 Item.java ```java @Entity(name = \"item\") public class Item { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = \"id\", nullable = false) private Long id; @Column(name = \"name\", nullable = false) private String name; } ``` \u53cc\u5411\u591a\u5bf9\u591a\uff08\u4e24\u7aef\u90fd\u4f7f\u7528@ManyToMany\u6ce8\u89e3\uff09 \u53cc\u5411\u591a\u5bf9\u591a\u5173\u7cfb\u4e2d\uff0c\u53ef\u4ee5\u6307\u5b9a\u4efb\u610f\u4e00\u7aef\u4e3a\u5173\u7cfb\u7ef4\u62a4\u7aef\uff0c\u6307\u5b9a\u5173\u7cfb\u7ef4\u62a4\u7aef\u540e\uff08\u975emappedBy\u5c5e\u6027\u6301\u6709\u7aef\uff09\uff0c\u4e24\u7aef\u5173\u7cfb\u7684\u7ed1\u5b9a\u548c\u89e3\u9664\u90fd\u53ea\u80fd\u7531\u7ef4\u62a4\u7aef\u6765\u5b8c\u6210\u3002\u5f53\u7ed1\u5b9a\u5173\u7cfb\u540e\uff0c\u65e0\u6cd5\u76f4\u63a5\u5220\u9664\u5173\u7cfb\u88ab\u7ef4\u62a4\u7aef\uff0c\u8981\u89e3\u9664\u7ed1\u5b9a\u5173\u7cfb\u540e\u624d\u80fd\u5220\u9664\uff0c\u4f46\u53ef\u4ee5\u76f4\u63a5\u5220\u9664\u5173\u7cfb\u7ef4\u62a4\u7aef\uff0c\u5220\u9664\u65f6\u4f1a\u5148\u89e3\u9664\u7ed1\u5b9a\u5173\u7cfb\u3002 \u8fd8\u662f\u4ee5\u7c7b\u522b\uff08category\uff0c\u5173\u7cfb\u7ef4\u62a4\u7aef\uff09\u548c\u6761\u76ee\uff08item, \u5173\u7cfb\u88ab\u7ef4\u62a4\u7aef\uff09\u4e3a\u4f8b\u8fdb\u884c\u8bf4\u660e\u3002\u5f53\u53cc\u65b9\u90fd\u9700\u8981\u901a\u8fc7\u81ea\u8eab\u6765\u627e\u5230\u5bf9\u5e94\u7684\u5bf9\u8c61\u65f6\uff0c\u9700\u8981\u4f7f\u7528\u53cc\u5411\u591a\u5bf9\u591a\u3002 \u8868\u7ed3\u6784 category \u8868\uff08 id , name\uff09 item\u8868\uff08 id , name, price\uff09 category _items\u8868\uff08 category _id , item_id \uff09 Category .java \u4e0e\u4e0a\u6587\u4e2d\u76f8\u540c Item.java \u4e0e\u4e0a\u6587\u4e2d\u5b9e\u4f53\u7c7b\u76f8\u4f3c\uff0c\u4f46\u662f\u5728Item\u4e2d\u589e\u52a0\u4e86category\u7684\u96c6\u5408\u3002 ```java @Entity(name = \"item\") public class Item { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = \"id\", nullable = false) private Long id; @Column(name = \"name\", nullable = false) private String name; @ManyToMany(mappedBy = \"items\") private List<Category> categories; } ``` <==To be continue...","title":"1.\u5b9e\u4f53\u7c7b\u76f8\u5173\u7684\u6ce8\u89e3"},{"location":"Spring/Spring_DBs/SpringDataJpa\u7b14\u8bb0/#2springboothibernate-validate","text":"\u8be6\u89c1 https://www.jianshu.com/p/5ab860e4f25a","title":"2.\u5728SpringBoot\u4e2d\u4f7f\u7528Hibernate Validate\u6821\u9a8c\u524d\u53f0\u4f20\u5165\u7684\u5c5e\u6027"},{"location":"Spring/Spring_DBs/SpringDataJpa\u7b14\u8bb0/#3springdatajpa","text":"","title":"3.\u4f7f\u7528SpringDataJPA\u5b9e\u73b0\u6570\u636e\u5e93\u8bbf\u95ee\uff08\u9ed8\u8ba4\u89c4\u5219\u3001\u7ee7\u627f\u5173\u7cfb\u4e4b\u7c7b\uff09"},{"location":"Spring/Spring_DBs/SpringDataJpa\u7b14\u8bb0/#4jpaspecificationexecutor","text":"","title":"4.JpaSpecificationExecutor\u63a5\u53e3\uff08\u52a8\u6001\u67e5\u8be2\uff09"},{"location":"Spring/Spring_DBs/SpringDataJpa\u7b14\u8bb0/#5repositirybaserepository","text":"","title":"5.\u81ea\u5b9a\u4e49Repositiry\u5e76\u4e0e\u9ed8\u8ba4\u5b9e\u73b0\u6574\u5408\uff0c\u5c01\u88c5\u81ea\u5df1\u7684BaseRepository"},{"location":"Spring/Spring_DBs/SpringDataJpa\u7b14\u8bb0/#_1","text":"https://liuyanzhao.com/7913.html","title":"\u53c2\u8003"},{"location":"Spring/Spring_DBs/Spring\u6574\u5408Redis/","text":"Spring-boot\u96c6\u6210Redis Redis\u7b80\u4ecb Redis\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u4f7f\u7528 ANSI C\u8bed\u8a00\u7f16\u5199\uff0c\u652f\u6301\u7f51\u7edc\uff0c\u53ef\u57fa\u4e8e\u5185\u5b58\u4e5f\u53ef\u6301\u4e45\u5316\u7684\u65e5\u5fd7\u578b\uff0cKey-Value\u6570\u636e\u5e93\uff0c\u5e76\u63d0\u4f9b\u4e86\u591a\u79cd\u8bed\u8a00\u7684 API ,\u76f8\u6bd4 Memcached \u5b83\u652f\u6301\u5b58\u50a8\u7684\u7c7b\u578b\u76f8\u5bf9\u66f4\u591a (\u5b57\u7b26\uff0c\u54c8\u5e0c\uff0c\u96c6\u5408\uff0c\u6709\u5e8f\u96c6\u5408\uff0c\u5217\u8868\u7b49)\uff0c\u540c\u65f6Redis\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u3002 Redis Java Client Redis Java Client \u662f\u9762\u5411Java\u7684\u8fde\u63a5Redis Server\u7684\u5ba2\u6237\u7aef\uff0c\u63d0\u4f9bJava\u8bed\u8a00\u8c03\u7528\u63a5\u53e3\u3002\u76ee\u524d\u4e3b\u6d41\u7684Redis\u5ba2\u6237\u7aef\uff0c\u662f Lettuce \u548c Jedis\u3002 Jedis \u5728\u5b9e\u73b0\u4e0a\u662f\u76f4\u8fde redis server\uff0c\u591a\u7ebf\u7a0b\u73af\u5883\u4e0b\u975e\u7ebf\u7a0b\u5b89\u5168\uff0c\u9664\u975e\u4f7f\u7528\u8fde\u63a5\u6c60\uff0c\u4e3a\u6bcf\u4e2a redis\u5b9e\u4f8b\u589e\u52a0\u7269\u7406\u8fde\u63a5\u3002 Lettuce \u662f \u4e00\u79cd\u53ef\u4f38\u7f29\uff0c\u7ebf\u7a0b\u5b89\u5168\uff0c\u5b8c\u5168\u975e\u963b\u585e\u7684Redis\u5ba2\u6237\u7aef\uff0c\u591a\u4e2a\u7ebf\u7a0b\u53ef\u4ee5\u5171\u4eab\u4e00\u4e2aRedisConnection,\u5b83\u5229\u7528Netty NIO \u6846\u67b6\u6765\u9ad8\u6548\u5730\u7ba1\u7406\u591a\u4e2a\u8fde\u63a5\uff0c\u4ece\u800c\u63d0\u4f9b\u4e86\u5f02\u6b65\u548c\u540c\u6b65\u6570\u636e\u8bbf\u95ee\u65b9\u5f0f\uff0c\u7528\u4e8e\u6784\u5efa\u975e\u963b\u585e\u7684\u53cd\u5e94\u6027\u5e94\u7528\u7a0b\u5e8f\u3002 \u6ce8\u610f \uff1a\u5728 springboot 1.5.x\u7248\u672c\u7684\u9ed8\u8ba4\u7684Redis\u5ba2\u6237\u7aef\u662f Jedis\u5b9e\u73b0\u7684\uff0cspringboot 2.x\u7248\u672c\u4e2d\u9ed8\u8ba4\u5ba2\u6237\u7aef\u662f\u7528 lettuce\u5b9e\u73b0\u7684\u3002 Spring Data Redis Spring-data-redis\u662fspring\u5927\u5bb6\u65cf\u7684\u4e00\u90e8\u5206\uff0c\u63d0\u4f9b\u4e86\u5728srping\u5e94\u7528\u4e2d\u901a\u8fc7\u7b80\u5355\u7684\u914d\u7f6e\u8bbf\u95eeredis\u670d\u52a1\uff0c\u5bf9\u5e95\u5c42redis\u5ba2\u6237\u7aef(Lettuce \u3001Jedis)\u8fdb\u884c\u4e86\u9ad8\u5ea6\u5c01\u88c5\uff0c\u901a\u8fc7RedisTemplate\u5bf9\u8c61\u4e3aredis\u4ea4\u4e92\u63d0\u4f9b\u4e86\u9ad8\u7ea7\u62bd\u8c61\uff08\u4e3b\u8981\u8d1f\u8d23\u8fde\u63a5\u7ba1\u7406\u548c\u5e8f\u5217\u5316\u5de5\u4f5c\uff09\uff0c\u540c\u65f6\u4e5f\u901a\u8fc7RedisConnection\u5bf9\u8c61\u63d0\u4f9b\u63a5\u53d7\u548c\u8fd4\u56de\u4e8c\u8fdb\u5236\u503c\uff08\u5b57\u8282\u6570\u7ec4\uff09\u7684\u4f4e\u7ea7\u65b9\u6cd5\u3002 RedisTemplate\u901a\u8fc7\u5c06Redis\u547d\u4ee4\u5206\u7ec4\u5e76\u62bd\u8c61\u6210\u64cd\u4f5c\u89c6\u56fe\uff08operations views\uff09\uff0c\u5e76\u901a\u8fc7\u64cd\u4f5c\u89c6\u56fe\u7684\u63d0\u4f9b\u7684\u63a5\u53e3\u6765\u8c03\u7528\u5177\u4f53\u7684redis\u547d\u4ee4\uff0c\u4e0d\u540c\u7684\u64cd\u4f5c\u89c6\u56fe\u5bf9\u5e94\u4e86\u7279\u5b9a\u7684Redis\u5b58\u50a8\u7c7b\u578b\u6216\u8005\u67d0\u4e9b\u79d8\u94a5\uff08keybound\uff09\u3002\u6a21\u677f\u7684\u64cd\u4f5c\u89c6\u56fe\u5177\u4f53\u5982\u4e0b\uff1a Interface Description Key Type Operations GeoOperations Redis geospatial operations like GEOADD , GEORADIUS ,\u2026) HashOperations Redis hash operations HyperLogLogOperations Redis HyperLogLog operations like ( PFADD , PFCOUNT ,\u2026) ListOperations Redis list operations SetOperations Redis set operations ValueOperations Redis string (or value) operations ZSetOperations Redis zset (or sorted set) operations Key Bound Operations BoundGeoOperations Redis key bound geospatial operations. BoundHashOperations Redis hash key bound operations BoundKeyOperations Redis key bound operations BoundListOperations Redis list key bound operations BoundSetOperations Redis set key bound operations BoundValueOperations Redis string (or value) key bound operations BoundZSetOperations Redis zset (or sorted set) key bound operations RedisTemplate\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528\u5176 opsFor[X] \u65b9\u6cd5\u6765\u83b7\u5f97\u8be5\u6a21\u677f\u5177\u4f53\u7684\u64cd\u4f5c\u89c6\u56fe\uff1a opsForValue\uff1a \u5bf9\u5e94 String\uff08\u5b57\u7b26\u4e32\uff09 opsForZSet\uff1a \u5bf9\u5e94 ZSet\uff08\u6709\u5e8f\u96c6\u5408\uff09 opsForHash\uff1a \u5bf9\u5e94 Hash\uff08\u54c8\u5e0c\uff09 opsForList\uff1a \u5bf9\u5e94 List\uff08\u5217\u8868\uff09 opsForSet\uff1a \u5bf9\u5e94 Set\uff08\u96c6\u5408\uff09 opsForGeo\uff1a \u5bf9\u5e94 GEO\uff08\u5730\u7406\u4f4d\u7f6e\uff09 Redis \u8fde\u63a5\u6c60\u7b80\u4ecb \u5728spring-boot\u4e2d\u4f7f\u7528\u8fde\u63a5\u6c60\u6765\u7ba1\u7406redis\u8fde\u63a5\uff0c\u6240\u4ee5\u5bf9\u8fde\u63a5\u6c60\u8fdb\u884c\u7b80\u5355\u8bf4\u660e\uff1a \u5ba2\u6237\u7aef\u8fde\u63a5 Redis \u4f7f\u7528\u7684\u662f TCP\u534f\u8bae\uff0c\u76f4\u8fde\u7684\u65b9\u5f0f\u6bcf\u6b21\u9700\u8981\u5efa\u7acb TCP\u8fde\u63a5\uff0c\u800c\u8fde\u63a5\u6c60\u7684\u65b9\u5f0f\u662f\u53ef\u4ee5\u9884\u5148\u521d\u59cb\u5316\u597d\u5ba2\u6237\u7aef\u8fde\u63a5\uff0c\u6240\u4ee5\u6bcf\u6b21\u53ea\u9700\u8981\u4ece \u8fde\u63a5\u6c60\u501f\u7528\u5373\u53ef \uff0c\u800c\u501f\u7528\u548c\u5f52\u8fd8\u64cd\u4f5c\u662f\u5728\u672c\u5730\u8fdb\u884c\u7684\uff0c\u53ea\u6709\u5c11\u91cf\u7684\u5e76\u53d1\u540c\u6b65\u5f00\u9500\uff0c\u8fdc\u8fdc\u5c0f\u4e8e\u65b0\u5efaTCP\u8fde\u63a5\u7684\u5f00\u9500\u3002\u53e6\u5916\uff0c\u76f4\u8fde\u7684\u65b9\u5f0f\u65e0\u6cd5\u9650\u5236 redis\u5ba2\u6237\u7aef\u5bf9\u8c61\u7684\u4e2a\u6570\uff0c\u5728\u6781\u7aef\u60c5\u51b5\u4e0b\u53ef\u80fd\u4f1a\u9020\u6210\u8fde\u63a5\u6cc4\u6f0f\uff0c\u800c\u8fde\u63a5\u6c60\u7684\u5f62\u5f0f\u53ef\u4ee5\u6709\u6548\u7684\u4fdd\u62a4\u548c\u63a7\u5236\u8d44\u6e90\u7684\u4f7f\u7528\u3002 <==To be continue... springboot 2.0\u4f7f\u7528lettuce\u96c6\u6210Redis\u670d\u52a1 \u4f9d\u8d56 application.properties\u914d\u7f6e\u6587\u4ef6 \u81ea\u5b9a\u4e49 RedisTemplate \u5c01\u88c5Redis\u64cd\u4f5c\u63a5\u53e3 \u53c2\u8003 \u200b http://www.spring4all.com/article/1152 \u200b https://juejin.im/post/5ba0a098f265da0adb30c684 \u200b https://blog.csdn.net/weixin_42430194/article/details/80834733 \u200b https://docs.spring.io/spring-data/redis/docs/2.0.1.RELEASE/reference/html/#why-spring-redis","title":"Spring-boot\u96c6\u6210Redis"},{"location":"Spring/Spring_DBs/Spring\u6574\u5408Redis/#spring-bootredis","text":"","title":"Spring-boot\u96c6\u6210Redis"},{"location":"Spring/Spring_DBs/Spring\u6574\u5408Redis/#redis","text":"Redis\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u4f7f\u7528 ANSI C\u8bed\u8a00\u7f16\u5199\uff0c\u652f\u6301\u7f51\u7edc\uff0c\u53ef\u57fa\u4e8e\u5185\u5b58\u4e5f\u53ef\u6301\u4e45\u5316\u7684\u65e5\u5fd7\u578b\uff0cKey-Value\u6570\u636e\u5e93\uff0c\u5e76\u63d0\u4f9b\u4e86\u591a\u79cd\u8bed\u8a00\u7684 API ,\u76f8\u6bd4 Memcached \u5b83\u652f\u6301\u5b58\u50a8\u7684\u7c7b\u578b\u76f8\u5bf9\u66f4\u591a (\u5b57\u7b26\uff0c\u54c8\u5e0c\uff0c\u96c6\u5408\uff0c\u6709\u5e8f\u96c6\u5408\uff0c\u5217\u8868\u7b49)\uff0c\u540c\u65f6Redis\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u3002","title":"Redis\u7b80\u4ecb"},{"location":"Spring/Spring_DBs/Spring\u6574\u5408Redis/#redis-java-client","text":"Redis Java Client \u662f\u9762\u5411Java\u7684\u8fde\u63a5Redis Server\u7684\u5ba2\u6237\u7aef\uff0c\u63d0\u4f9bJava\u8bed\u8a00\u8c03\u7528\u63a5\u53e3\u3002\u76ee\u524d\u4e3b\u6d41\u7684Redis\u5ba2\u6237\u7aef\uff0c\u662f Lettuce \u548c Jedis\u3002 Jedis \u5728\u5b9e\u73b0\u4e0a\u662f\u76f4\u8fde redis server\uff0c\u591a\u7ebf\u7a0b\u73af\u5883\u4e0b\u975e\u7ebf\u7a0b\u5b89\u5168\uff0c\u9664\u975e\u4f7f\u7528\u8fde\u63a5\u6c60\uff0c\u4e3a\u6bcf\u4e2a redis\u5b9e\u4f8b\u589e\u52a0\u7269\u7406\u8fde\u63a5\u3002 Lettuce \u662f \u4e00\u79cd\u53ef\u4f38\u7f29\uff0c\u7ebf\u7a0b\u5b89\u5168\uff0c\u5b8c\u5168\u975e\u963b\u585e\u7684Redis\u5ba2\u6237\u7aef\uff0c\u591a\u4e2a\u7ebf\u7a0b\u53ef\u4ee5\u5171\u4eab\u4e00\u4e2aRedisConnection,\u5b83\u5229\u7528Netty NIO \u6846\u67b6\u6765\u9ad8\u6548\u5730\u7ba1\u7406\u591a\u4e2a\u8fde\u63a5\uff0c\u4ece\u800c\u63d0\u4f9b\u4e86\u5f02\u6b65\u548c\u540c\u6b65\u6570\u636e\u8bbf\u95ee\u65b9\u5f0f\uff0c\u7528\u4e8e\u6784\u5efa\u975e\u963b\u585e\u7684\u53cd\u5e94\u6027\u5e94\u7528\u7a0b\u5e8f\u3002 \u6ce8\u610f \uff1a\u5728 springboot 1.5.x\u7248\u672c\u7684\u9ed8\u8ba4\u7684Redis\u5ba2\u6237\u7aef\u662f Jedis\u5b9e\u73b0\u7684\uff0cspringboot 2.x\u7248\u672c\u4e2d\u9ed8\u8ba4\u5ba2\u6237\u7aef\u662f\u7528 lettuce\u5b9e\u73b0\u7684\u3002","title":"Redis Java Client"},{"location":"Spring/Spring_DBs/Spring\u6574\u5408Redis/#spring-data-redis","text":"Spring-data-redis\u662fspring\u5927\u5bb6\u65cf\u7684\u4e00\u90e8\u5206\uff0c\u63d0\u4f9b\u4e86\u5728srping\u5e94\u7528\u4e2d\u901a\u8fc7\u7b80\u5355\u7684\u914d\u7f6e\u8bbf\u95eeredis\u670d\u52a1\uff0c\u5bf9\u5e95\u5c42redis\u5ba2\u6237\u7aef(Lettuce \u3001Jedis)\u8fdb\u884c\u4e86\u9ad8\u5ea6\u5c01\u88c5\uff0c\u901a\u8fc7RedisTemplate\u5bf9\u8c61\u4e3aredis\u4ea4\u4e92\u63d0\u4f9b\u4e86\u9ad8\u7ea7\u62bd\u8c61\uff08\u4e3b\u8981\u8d1f\u8d23\u8fde\u63a5\u7ba1\u7406\u548c\u5e8f\u5217\u5316\u5de5\u4f5c\uff09\uff0c\u540c\u65f6\u4e5f\u901a\u8fc7RedisConnection\u5bf9\u8c61\u63d0\u4f9b\u63a5\u53d7\u548c\u8fd4\u56de\u4e8c\u8fdb\u5236\u503c\uff08\u5b57\u8282\u6570\u7ec4\uff09\u7684\u4f4e\u7ea7\u65b9\u6cd5\u3002 RedisTemplate\u901a\u8fc7\u5c06Redis\u547d\u4ee4\u5206\u7ec4\u5e76\u62bd\u8c61\u6210\u64cd\u4f5c\u89c6\u56fe\uff08operations views\uff09\uff0c\u5e76\u901a\u8fc7\u64cd\u4f5c\u89c6\u56fe\u7684\u63d0\u4f9b\u7684\u63a5\u53e3\u6765\u8c03\u7528\u5177\u4f53\u7684redis\u547d\u4ee4\uff0c\u4e0d\u540c\u7684\u64cd\u4f5c\u89c6\u56fe\u5bf9\u5e94\u4e86\u7279\u5b9a\u7684Redis\u5b58\u50a8\u7c7b\u578b\u6216\u8005\u67d0\u4e9b\u79d8\u94a5\uff08keybound\uff09\u3002\u6a21\u677f\u7684\u64cd\u4f5c\u89c6\u56fe\u5177\u4f53\u5982\u4e0b\uff1a Interface Description Key Type Operations GeoOperations Redis geospatial operations like GEOADD , GEORADIUS ,\u2026) HashOperations Redis hash operations HyperLogLogOperations Redis HyperLogLog operations like ( PFADD , PFCOUNT ,\u2026) ListOperations Redis list operations SetOperations Redis set operations ValueOperations Redis string (or value) operations ZSetOperations Redis zset (or sorted set) operations Key Bound Operations BoundGeoOperations Redis key bound geospatial operations. BoundHashOperations Redis hash key bound operations BoundKeyOperations Redis key bound operations BoundListOperations Redis list key bound operations BoundSetOperations Redis set key bound operations BoundValueOperations Redis string (or value) key bound operations BoundZSetOperations Redis zset (or sorted set) key bound operations RedisTemplate\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528\u5176 opsFor[X] \u65b9\u6cd5\u6765\u83b7\u5f97\u8be5\u6a21\u677f\u5177\u4f53\u7684\u64cd\u4f5c\u89c6\u56fe\uff1a opsForValue\uff1a \u5bf9\u5e94 String\uff08\u5b57\u7b26\u4e32\uff09 opsForZSet\uff1a \u5bf9\u5e94 ZSet\uff08\u6709\u5e8f\u96c6\u5408\uff09 opsForHash\uff1a \u5bf9\u5e94 Hash\uff08\u54c8\u5e0c\uff09 opsForList\uff1a \u5bf9\u5e94 List\uff08\u5217\u8868\uff09 opsForSet\uff1a \u5bf9\u5e94 Set\uff08\u96c6\u5408\uff09 opsForGeo\uff1a \u5bf9\u5e94 GEO\uff08\u5730\u7406\u4f4d\u7f6e\uff09","title":"Spring Data Redis"},{"location":"Spring/Spring_DBs/Spring\u6574\u5408Redis/#redis_1","text":"\u5728spring-boot\u4e2d\u4f7f\u7528\u8fde\u63a5\u6c60\u6765\u7ba1\u7406redis\u8fde\u63a5\uff0c\u6240\u4ee5\u5bf9\u8fde\u63a5\u6c60\u8fdb\u884c\u7b80\u5355\u8bf4\u660e\uff1a \u5ba2\u6237\u7aef\u8fde\u63a5 Redis \u4f7f\u7528\u7684\u662f TCP\u534f\u8bae\uff0c\u76f4\u8fde\u7684\u65b9\u5f0f\u6bcf\u6b21\u9700\u8981\u5efa\u7acb TCP\u8fde\u63a5\uff0c\u800c\u8fde\u63a5\u6c60\u7684\u65b9\u5f0f\u662f\u53ef\u4ee5\u9884\u5148\u521d\u59cb\u5316\u597d\u5ba2\u6237\u7aef\u8fde\u63a5\uff0c\u6240\u4ee5\u6bcf\u6b21\u53ea\u9700\u8981\u4ece \u8fde\u63a5\u6c60\u501f\u7528\u5373\u53ef \uff0c\u800c\u501f\u7528\u548c\u5f52\u8fd8\u64cd\u4f5c\u662f\u5728\u672c\u5730\u8fdb\u884c\u7684\uff0c\u53ea\u6709\u5c11\u91cf\u7684\u5e76\u53d1\u540c\u6b65\u5f00\u9500\uff0c\u8fdc\u8fdc\u5c0f\u4e8e\u65b0\u5efaTCP\u8fde\u63a5\u7684\u5f00\u9500\u3002\u53e6\u5916\uff0c\u76f4\u8fde\u7684\u65b9\u5f0f\u65e0\u6cd5\u9650\u5236 redis\u5ba2\u6237\u7aef\u5bf9\u8c61\u7684\u4e2a\u6570\uff0c\u5728\u6781\u7aef\u60c5\u51b5\u4e0b\u53ef\u80fd\u4f1a\u9020\u6210\u8fde\u63a5\u6cc4\u6f0f\uff0c\u800c\u8fde\u63a5\u6c60\u7684\u5f62\u5f0f\u53ef\u4ee5\u6709\u6548\u7684\u4fdd\u62a4\u548c\u63a7\u5236\u8d44\u6e90\u7684\u4f7f\u7528\u3002 <==To be continue...","title":"Redis \u8fde\u63a5\u6c60\u7b80\u4ecb"},{"location":"Spring/Spring_DBs/Spring\u6574\u5408Redis/#springboot-20lettuceredis","text":"","title":"springboot 2.0\u4f7f\u7528lettuce\u96c6\u6210Redis\u670d\u52a1"},{"location":"Spring/Spring_DBs/Spring\u6574\u5408Redis/#_1","text":"","title":"\u4f9d\u8d56"},{"location":"Spring/Spring_DBs/Spring\u6574\u5408Redis/#applicationproperties","text":"","title":"application.properties\u914d\u7f6e\u6587\u4ef6"},{"location":"Spring/Spring_DBs/Spring\u6574\u5408Redis/#redistemplate","text":"","title":"\u81ea\u5b9a\u4e49 RedisTemplate"},{"location":"Spring/Spring_DBs/Spring\u6574\u5408Redis/#redis_2","text":"","title":"\u5c01\u88c5Redis\u64cd\u4f5c\u63a5\u53e3"},{"location":"Spring/Spring_DBs/Spring\u6574\u5408Redis/#_2","text":"\u200b http://www.spring4all.com/article/1152 \u200b https://juejin.im/post/5ba0a098f265da0adb30c684 \u200b https://blog.csdn.net/weixin_42430194/article/details/80834733 \u200b https://docs.spring.io/spring-data/redis/docs/2.0.1.RELEASE/reference/html/#why-spring-redis","title":"\u53c2\u8003"},{"location":"Spring/Spring\u57fa\u7840\u77e5\u8bc6/DispatcherServlet\u6e90\u7801\u5206\u6790/","text":"\u8bf7\u6c42\u4eceDispatcherServlet\u5230\u8fbe\u5177\u4f53\u7684Controller DispatcherServlet Servlet\u7684service\u65b9\u6cd5\u662f\u54cd\u5e94\u524d\u7aef\u8bf7\u6c42\u7684\u5165\u53e3\u65b9\u6cd5\uff0cServlet \u5bb9\u5668\uff08\u5373 Web \u670d\u52a1\u5668\uff09\u8c03\u7528 service() \u65b9\u6cd5\u6765\u5904\u7406\u6765\u81ea\u5ba2\u6237\u7aef\uff08\u6d4f\u89c8\u5668\uff09\u7684\u8bf7\u6c42\uff0cservice() \u65b9\u6cd5\u68c0\u67e5 HTTP \u8bf7\u6c42\u7c7b\u578b\uff08GET\u3001POST\u3001PUT\u3001DELETE \u7b49\uff09\uff0c\u5e76\u5728\u9002\u5f53\u7684\u65f6\u5019\u8c03\u7528 doGet\u3001doPost\u3001doPut\uff0cdoDelete \u7b49\u65b9\u6cd5\u3002DispatcherServlet\u662f\u4e00\u4e2a\u6807\u51c6\u7684Servlet\uff0c\u80af\u5b9a\u5177\u6709service\u65b9\u6cd5\uff0c\u5e76\u4e14\u901a\u8fc7service\u65b9\u6cd5\u6765\u54cd\u5e94\u6240\u6709\u7684\u8bf7\u6c42\u3002 DispatherServlet\u7ee7\u627f\u81eaFrameWorkServlet\uff0cFrameWorkServlet\u662f springmvc \u7684\u57fa\u7840 Servlet\uff0c\u5b83\u7684\u4e3b\u8981\u5de5\u4f5c\u662f\u5bf9 WebApplicationContext \u5b9e\u4f8b\u8fdb\u884c\u521d\u59cb\u5316\u548c\u7ba1\u7406\uff0c\u5e76\u4e14FrameWorkServlet\u91cd\u5199\u4e86doGet\u3001doPost\u3001doPut\uff0cdoDelete \u7b49\u65b9\u6cd5\uff0c\u5c06\u6240\u6709\u7c7b\u578b\u7684\u8bf7\u6c42\u90fd\u4ea4\u7ed9processRequest\u65b9\u6cd5\u6765\u5904\u7406\u3002 protected final void processRequest(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { long startTime = System.currentTimeMillis(); Throwable failureCause = null; LocaleContext previousLocaleContext = LocaleContextHolder.getLocaleContext(); LocaleContext localeContext = buildLocaleContext(request); RequestAttributes previousAttributes = RequestContextHolder.getRequestAttributes(); ServletRequestAttributes requestAttributes = buildRequestAttributes(request, response, previousAttributes); WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request); asyncManager.registerCallableInterceptor(FrameworkServlet.class.getName(), new RequestBindingInterceptor()); initContextHolders(request, localeContext, requestAttributes); try { //\u62bd\u8c61\u65b9\u6cd5\u7531\u5b50\u7c7b\u5b9e\u73b0 doService(request, response); } catch (ServletException | IOException ex) { failureCause = ex; throw ex; } catch (Throwable ex) { failureCause = ex; throw new NestedServletException(\"Request processing failed\", ex); } finally { resetContextHolders(request, previousLocaleContext, previousAttributes); if (requestAttributes != null) { requestAttributes.requestCompleted(); } logResult(request, response, failureCause, asyncManager); publishRequestHandledEvent(request, response, startTime, failureCause); } } processRequest\u65b9\u6cd5\u4e3b\u8981\u662f\u4f5c\u7528\u662f\u521d\u59cb\u5316request\u8bf7\u6c42\u7684\u4e0a\u4e0b\u6587\u53c2\u6570\uff0c\u7136\u540e\u5c06\u8bf7\u6c42\u4ea4\u7ed9\u5b50\u7c7b\u7684doService\u65b9\u6cd5\u5904\u7406\uff0c\u8be5\u65b9\u6cd5\u7531DispatcherServlet\u5b9e\u73b0\u3002 protected void doService(HttpServletRequest request, HttpServletResponse response) throws Exception { logRequest(request); //\u4fdd\u5b58request\u8bf7\u6c42\u53c2\u6570\u7684\u5feb\u7167\uff0c\u4f7f\u5728\u540e\u7eed\u5904\u7406\u4e2d\u53ef\u4ee5\u6062\u590d\u539f\u6765\u7684\u6570\u636e Map<String, Object> attributesSnapshot = null; if (WebUtils.isIncludeRequest(request)) { attributesSnapshot = new HashMap<>(); Enumeration<?> attrNames = request.getAttributeNames(); while (attrNames.hasMoreElements()) { String attrName = (String) attrNames.nextElement(); if (this.cleanupAfterInclude || attrName.startsWith(DEFAULT_STRATEGIES_PREFIX)) { attributesSnapshot.put(attrName, request.getAttribute(attrName)); } } } // \u6dfb\u52a0\u6846\u67b6\u7684\u5185\u7f6e\u5bf9\u8c61\u5230request\u57df\u4e2d\uff0c\u4f7f\u5f97handler\u548cview\u5bf9\u8c61\u80fd\u591f\u4f7f\u7528 request.setAttribute(WEB_APPLICATION_CONTEXT_ATTRIBUTE, getWebApplicationContext()); request.setAttribute(LOCALE_RESOLVER_ATTRIBUTE, this.localeResolver); request.setAttribute(THEME_RESOLVER_ATTRIBUTE, this.themeResolver); request.setAttribute(THEME_SOURCE_ATTRIBUTE, getThemeSource()); //\u6ce8\u5165\u901a\u8fc7redirect\u4f20\u9012\u6765\u7684\uff08RedirectAttribute\uff09\u5c5e\u6027 if (this.flashMapManager != null) { FlashMap inputFlashMap = this.flashMapManager.retrieveAndUpdate(request, response); if (inputFlashMap != null) { request.setAttribute(INPUT_FLASH_MAP_ATTRIBUTE, Collections.unmodifiableMap(inputFlashMap)); } request.setAttribute(OUTPUT_FLASH_MAP_ATTRIBUTE, new FlashMap()); request.setAttribute(FLASH_MAP_MANAGER_ATTRIBUTE, this.flashMapManager); } try { //\u8fdb\u884c\u8bf7\u6c42\u5206\u53d1 doDispatch(request, response); } finally { if (!WebAsyncUtils.getAsyncManager(request).isConcurrentHandlingStarted()) { // Restore the original attribute snapshot, in case of an include. if (attributesSnapshot != null) { restoreAttributesAfterInclude(request, attributesSnapshot); } } } } \u53ef\u4ee5\u770b\u51fadoService\u65b9\u6cd5\u4e3b\u8981\u4f5c\u7528\u662f\u5bf9request\u8bf7\u6c42\u53c2\u6570\u8fdb\u884c\u5907\u4efd\uff0c\u5e76\u4e14\u5bf9request\u5fc5\u8981\u57df\u8fdb\u884c\u8d4b\u503c\u64cd\u4f5c\uff0c\u6700\u540e\u8c03\u7528doDispatch\u65b9\u6cd5\u8fdb\u884c\u8bf7\u6c42\u5206\u53d1\u3002 protected void doDispatch(HttpServletRequest request, HttpServletResponse response) throws Exception { HttpServletRequest processedRequest = request; HandlerExecutionChain mappedHandler = null; boolean multipartRequestParsed = false; WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request); try { ModelAndView mv = null; Exception dispatchException = null; try { //\u5224\u65ad\u5f53\u524d\u8bf7\u6c42\u662f\u5426\u662f\u6587\u4ef6\u8bf7\u6c42,\u5982\u679c\u662f\u7684\u8bdd\u5c31\u5c06\u8bf7\u6c42\u8f6c\u6362\u4e3a\u6587\u4ef6\u8bf7\u6c42 processedRequest = checkMultipart(request); multipartRequestParsed = (processedRequest != request); //\u627e\u5230\u80fd\u591f\u5904\u7406\u5f53\u524d\u8bf7\u6c42\u7684handler //\u8be5\u5bf9\u8c61\u6700\u7ec8\u4f1a\u88ab\u5305\u88c5\u4e3aHandlerExecutionChain\u7c7b\u578b mappedHandler = getHandler(processedRequest); ... } } } DispatcherServlet\u7684getHandler\u65b9\u6cd5\u6839\u636e\u8bf7\u6c42\u83b7\u53d6\u8bf7\u6c42\u6240\u5bf9\u5e94\u7684mappedHandler\uff08\u5373\u5177\u4f53\u5904\u7406\u8bf7\u6c42\u7684 method \u65b9\u6cd5\uff0c\u5b9e\u9645\u4e0a\u4f1a\u6700\u7ec8\u88ab\u5305\u88c5\u6210\u4e00\u4e2a HandlerExecutionChain \u5bf9\u8c61\uff09\uff0c\u8fd9\u91cc\u662f\u627e\u5230\u54cd\u5e94\u8be5\u8bf7\u6c42\u7684Controller\u65b9\u6cd5\u7684\u5173\u952e\uff0c\u8be5\u65b9\u6cd5\u7684\u5177\u4f53\u5b9e\u73b0\u5982\u4e0b\uff1a protected HandlerExecutionChain getHandler(HttpServletRequest request) throws Exception { if (this.handlerMappings != null) { //\u904d\u5386\u6240\u6709\u7684HandlerMapping\u5bf9\u8c61\uff0c\u8c03\u7528\u5176getHandler //\u5982\u679c\u8be5\u65b9\u6cd5\u8fd4\u56de\u7684handler\u4e0d\u4e3a\u7a7a\uff0c\u5219\u8fd4\u56de\u7b2c\u4e00\u4e2a\u83b7\u5f97\u7684handler for (HandlerMapping mapping : this.handlerMappings) { HandlerExecutionChain handler = mapping.getHandler(request); if (handler != null) { return handler; } } } return null; } \u4ee5\u4e0a\u7684\u903b\u8f91\uff0c\u53ea\u662f\u904d\u5386\u4e86DispatcherServlet\u7684handlerMappings\u96c6\u5408\uff0c\u7136\u540e\u8c03\u7528HandlerMapping\u7684getHandler\u65b9\u6cd5\u83b7\u5f97HandlerExecutionChain\u5bf9\u8c61\uff08\u4e3b\u8981\u662f\u5305\u62ec\u4e86\u4e00\u4e2ahandler\uff0c\u4ee5\u53ca\u4e00\u4e2a\u62e6\u622a\u5668\u5217\u8868\uff09\uff0c\u5982\u679c\u8be5\u5bf9\u8c61\u4e0d\u4e3a\u7a7a\u5219\u8fd4\u56de\u8be5\u5bf9\u8c61\u3002\u8fd9\u91cc\u95ee\u9898\u5c31\u51fa\u73b0\u4e86\uff0chandlerMappings\u96c6\u5408\u662f\u4ec0\u4e48\uff0c\u662f\u4ece\u54ea\u91cc\u83b7\u5f97\u7684\uff1f \u5b9e\u9645\u4e0ahandlerMappings\u96c6\u5408\u4e2d\u5b58\u653e\u4e86\u5b9e\u73b0\u4e86HandlerMapping\u63a5\u53e3\u7684\u5bf9\u8c61\uff0c\u5176\u4e2d\u6700\u91cd\u8981\u7684\u5bf9\u8c61\u5c31\u662f RequestMappingHandlerMapping \u5bf9\u8c61\uff0c\u5b83\u4f1a\u5728spring\u5bb9\u5668\u521d\u59cb\u5316\u4ee5\u540e\u5c06Controller\u4e2d\u6dfb\u52a0\u4e86@RequestMapping\u6ce8\u89e3\u7684\u65b9\u6cd5\u6620\u5c04\u4fe1\u606f\u7f13\u5b58\u8d77\u6765\uff0c\u65b9\u4fbf\u5728\u54cd\u5e94\u8bf7\u6c42\u65f6\u901a\u8fc7\u53cd\u5c04\u8c03\u7528\u5bf9\u5e94\u7684\u65b9\u6cd5\uff0c\u5177\u4f53\u5b9e\u73b0\u5c06\u5728\u4e0b\u6587\u8fdb\u884c\u5206\u6790\u3002\u90a3\u4e48RequestMappingHandlerMapping\u662f\u5728\u54ea\u914d\u7f6e\u7684\uff0c\u53c8\u662f\u600e\u4e48\u521d\u59cb\u5316\u7684\u5462\uff1f\u76f4\u63a5\u63d0\u8d77RequestMappingHandlerMapping\u5bf9\u8c61\u5927\u5bb6\u53ef\u80fd\u4e0d\u592a\u719f\u6089\uff0c\u4f46\u662fspring\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684 <mvc:annotation-driven/> \u914d\u7f6e\u9879\u5927\u5bb6\u5e94\u8be5\u4e0d\u964c\u751f\uff0c\u8be5\u914d\u7f6e\u9879\u9ed8\u8ba4\u6dfb\u52a0\u4e86\u4ee5\u4e0b\u914d\u7f6e\uff1a <bean class=\"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping\" /> <bean class=\"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter\" /> \u56e0\u6b64\u5728spring\u5bb9\u5668\u521d\u59cb\u5316\u65f6\uff0c\u4f1a\u5c06RequestMappingHandlerMapping\u5bf9\u8c61\u521d\u59cb\u5316\uff0c\u800c\u8be5\u5bf9\u8c61\u7684\u7236\u7c7bAbstractHandlerMethodMapping\u5b9e\u73b0\u4e86 InitializingBean \u63a5\u53e3\u5e76\u5b9e\u73b0\u5176afterPropertiesSet\u65b9\u6cd5\uff0c\u5728Bean\u4f9d\u8d56\u6ce8\u5165\u5b8c\u6210\u65f6\uff0cspring\u4f1a\u53bb\u68c0\u67e5\u8fd9\u4e2aBean\u662f\u5426\u5b9e\u73b0\u4e86InitializingBean\u63a5\u53e3\uff0c\u5982\u679c\u5b9e\u73b0\u4e86InitializingBean\u63a5\u53e3\uff0c\u5c31\u4f1a\u53bb\u8c03\u7528\u8fd9\u4e2a\u7c7b\u7684afterPropertiesSet\u65b9\u6cd5\u3002AbstractHandlerMethodMapping\u7684afterPropertiesSet\u65b9\u6cd5\u5982\u4e0b\uff1a public void afterPropertiesSet() { initHandlerMethods(); } protected void initHandlerMethods() { //\u5bf9\u6240\u6709\u7684BeanName\u8c03\u7528processCandidateBean\u65b9\u6cd5 for (String beanName : getCandidateBeanNames()) { if (!beanName.startsWith(SCOPED_TARGET_NAME_PREFIX)) { processCandidateBean(beanName); } } handlerMethodsInitialized(getHandlerMethods()); } //\u4ecespring\u4e0a\u4e0b\u6587\u4e2d\u83b7\u5f97\u6240\u6709\u7684Bean\u7684\u540d\u5b57\uff0c\u56e0\u4e3a\u8fd9\u91cc\u7684BeanType\u4e3aObject protected String[] getCandidateBeanNames() { return (this.detectHandlerMethodsInAncestorContexts ? BeanFactoryUtils.beanNamesForTypeIncludingAncestors(obtainApplicationContext(), Object.class) : obtainApplicationContext().getBeanNamesForType(Object.class)); } afterPropertiesSet\u8c03\u7528\u4e86initHandlerMethods\u65b9\u6cd5\u83b7\u5f97\u5f53\u524dspring\u4e0a\u4e0b\u6587\u4e2d\u6240\u6709bean\u7684\u540d\u5b57\uff0c\u5e76\u4e14\u5bf9\u7b26\u5408\u6761\u4ef6\u7684beanName\u8c03\u7528processCandidateBean\u65b9\u6cd5\u3002 protected void processCandidateBean(String beanName) { Class<?> beanType = null; try { beanType = obtainApplicationContext().getType(beanName); } catch (Throwable ex) { // An unresolvable bean type, probably from a lazy bean - let's ignore it. if (logger.isTraceEnabled()) { logger.trace(\"Could not resolve type for bean '\" + beanName + \"'\", ex); } } //beanType\u4e0d\u4e3a\u7a7a\u5e76\u4e14isHandler\u65b9\u6cd5\u8fd4\u56de\u503c\u4e3atrue if (beanType != null && isHandler(beanType)) { detectHandlerMethods(beanName); } } //isHandler\u65b9\u6cd5\u5728RequestMappingHandlerMapping\u7684\u5b9e\u73b0 protected boolean isHandler(Class<?> beanType) { return (AnnotatedElementUtils.hasAnnotation(beanType, Controller.class) || AnnotatedElementUtils.hasAnnotation(beanType, RequestMapping.class)); } processCandidateBean\u65b9\u6cd5\u901a\u8fc7beanName\u83b7\u5f97bean\u7684\u7c7b\u578b\uff0c\u5f53bean\u7684\u7c7b\u578b\u4e0d\u4e3a\u7a7a\u4e14\u8be5\u7c7b\u540c\u65f6\u5177\u6709@Controller\u6ce8\u89e3\u548c@RequestMapping\u6ce8\u89e3\u65f6\uff0c\u624d\u4f1a\u7ee7\u7eed\u8c03\u7528detectHandlerMethods\u65b9\u6cd5\u3002 protected void detectHandlerMethods(Object handler) { //\u6839\u636ebeanName\u83b7\u5f97\u5176class\u7c7b\u578b Class<?> handlerType = (handler instanceof String ? obtainApplicationContext().getType((String) handler) : handler.getClass()); if (handlerType != null) { Class<?> userType = ClassUtils.getUserClass(handlerType); //\u904d\u5386\u8be5\u7c7b\u5b9e\u73b0\u7684\u6240\u6709\u65b9\u6cd5\uff0c\u83b7\u53d6\u5b83\u7684\u6240\u6709\u65b9\u6cd5\u5bf9\u5e94\u7684\u5339\u914d\u4fe1\u606f(@RequestMapping\u6ce8\u89e3\u4e2d\u7684\u4fe1\u606f) //\u5e76\u4e14\u5c06\u5339\u914d\u4fe1\u606f\u4fdd\u5b58\u5728mappingRegistry\u4e2d Map<Method, T> methods = MethodIntrospector.selectMethods(userType, (MethodIntrospector.MetadataLookup<T>) method -> { try { //\u6839\u636e\u65b9\u6cd5\u5339\u914d\u4fe1\u606f\u6784\u9020RequestMappingInfo return getMappingForMethod(method, userType); } catch (Throwable ex) { throw new IllegalStateException(\"Invalid mapping on handler class [\" + userType.getName() + \"]: \" + method, ex); } }); if (logger.isTraceEnabled()) { logger.trace(formatMappings(userType, methods)); } methods.forEach((method, mapping) -> { Method invocableMethod = AopUtils.selectInvocableMethod(method, userType); //\u5c06\u65b9\u6cd5\u548c@RequestMapping\u4e2d\u7684\u4fe1\u606f\u7f13\u5b58\u5230mappingRegister registerHandlerMethod(handler, invocableMethod, mapping); }); } } //getMappingForMethod\u65b9\u6cd5\u5728RequestMappingHandlerMapping\u7684\u5b9e\u73b0 protected RequestMappingInfo getMappingForMethod(Method method, Class<?> handlerType) { //\u4ece\u65b9\u6cd5\u4e0a@RequestMapping\u6ce8\u89e3\u4e2d\u7684\u5c5e\u6027\u5c01\u88c5\u5230RequestMappingInfo\u4e2d RequestMappingInfo info = createRequestMappingInfo(method); if (info != null) { //\u540c\u6837\u7684\u4ece\u7c7b\u4e2d\u7684\u4e0a@RequestMapping\u6ce8\u89e3\u4e2d\u83b7\u5f97\u4fe1\u606f RequestMappingInfo typeInfo = createRequestMappingInfo(handlerType); if (typeInfo != null) { //\u5c06\u65b9\u6cd5\u548c\u7c7b\u4e0a\u7684\u4fe1\u606f\u8fdb\u884c\u4e00\u6b21\u5408\u5e76 info = typeInfo.combine(info); } String prefix = getPathPrefix(handlerType); if (prefix != null) { info = RequestMappingInfo.paths(prefix).build().combine(info); } } return info; } detectHandlerMethods\u7684\u4f5c\u7528\u4e3b\u8981\u662f\u83b7\u5f97\u7c7b\u6240\u6709\u7684\u5b9e\u73b0\u65b9\u6cd5\uff0c\u904d\u5386\u8fd9\u4e9b\u65b9\u6cd5\u83b7\u5f97\u65b9\u6cd5\u4e0a@ReqestMapping\u4e2d\u7684\u4fe1\u606f\uff0c\u6784\u9020\u6210RequestMappingInfo\u5bf9\u8c61\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u5728\u6784\u9020RequestMappingInfo\u65f6\u4f1a\u5c06\u7c7b\u4e0a\u7684\u6ce8\u89e3\u4fe1\u606f\u548c\u65b9\u6cd5\u4e0a\u7684\u6ce8\u89e3\u4fe1\u606f\u8fdb\u884c\u5408\u5e76\uff0c\u6bd4\u5982\u7c7b\u5bf9\u5e94\u7684path\u4e3a test,Method\u5bf9\u5e94\u7684path\u4e3a test1,\u90a3\u4e48\u6700\u540e\u5408\u5e76\u7684path\u5373\u4e3a test/test1\u3002\u6700\u540e\uff0c\u8c03\u7528registerHandlerMethod\u5c06\u83b7\u5f97\u7684\u4fe1\u606f\u7f13\u5b58\u5728mappingRegister\u4e2d\u3002 protected void registerHandlerMethod(Object handler, Method method, T mapping) { //mappingRegistry\u662fAbstractHandlerMethodMapping\u7684\u5185\u90e8\u7c7bMappingRegistry\u7684\u5b9e\u4f53\u5bf9\u8c61 //\u4e3b\u8981\u7f13\u5b58\u4e86MappingInfo\u4e0eMethod\u7684\u6620\u5c04\uff0c\u4ee5\u53caurl\u4e0eMappingInfo\u7684\u6620\u5c04 this.mappingRegistry.register(mapping, handler, method); } public void register(T mapping, Object handler, Method method) { this.readWriteLock.writeLock().lock(); try { //\u5c06handler(\u7c7b\u540d\u6216\u7c7b)\u548c\u65b9\u6cd5\u5173\u8054\u521b\u5efaHandlerMethod\u5bf9\u8c61 HandlerMethod handlerMethod = createHandlerMethod(handler, method); assertUniqueMethodMapping(handlerMethod, mapping); //\u5c06MappingInfo\u4e0eMethod\u7684\u6620\u5c04\u5b58\u5728mappingLookup\u4e2d this.mappingLookup.put(mapping, handlerMethod); List<String> directUrls = getDirectUrls(mapping); for (String url : directUrls) { //\u5c06url\u4e0eMappingInfo\u7684\u6620\u5c04\u5b58\u5728urlLookup\u4e2d this.urlLookup.add(url, mapping); } String name = null; if (getNamingStrategy() != null) { name = getNamingStrategy().getName(handlerMethod, mapping); addMappingName(name, handlerMethod); } CorsConfiguration corsConfig = initCorsConfiguration(handler, method, mapping); if (corsConfig != null) { this.corsLookup.put(handlerMethod, corsConfig); } this.registry.put(mapping, new MappingRegistration<>(mapping, handlerMethod, directUrls, name)); } finally { this.readWriteLock.writeLock().unlock(); } } \u5230\u6b64RequestMappingHandlerMapping\u5bf9\u8c61\u521d\u59cb\u5316\u57fa\u672c\u5b8c\u6210\uff0c\u5728DispatchServlet\u521d\u59cb\u5316\u65f6\u4f1a\u901a\u8fc7BeanFactory\u83b7\u5f97\u6240\u6709\u5b9e\u73b0\u4e86HandlerMapping\u7684\u7c7b\u6765\u521d\u59cb\u5316handlerMappings\u6210\u5458\u53d8\u91cf\u3002 \u73b0\u5728\u8ba9\u6211\u4eec\u56de\u5230DispatcherServlet\u7684getHandler\u65b9\u6cd5\u4e0a\uff0c\u8be5\u65b9\u6cd5\u8c03\u7528\u4e86HandlerMapping\u7684getHandler\u65b9\u6cd5\uff0c\u5177\u4f53\u5b9e\u73b0\u5728AbstractHandlerMethodMapping\u4e2d\uff1a public final HandlerExecutionChain getHandler(HttpServletRequest request) throws Exception { //\u83b7\u5f97handler\u5bf9\u8c61 Object handler = getHandlerInternal(request); if (handler == null) { handler = getDefaultHandler(); } if (handler == null) { return null; } // Bean name or resolved handler? if (handler instanceof String) { String handlerName = (String) handler; handler = obtainApplicationContext().getBean(handlerName); } ... } protected HandlerMethod getHandlerInternal(HttpServletRequest request) throws Exception { //\u4ecerequest\u4e2d\u83b7\u5f97\u8bf7\u6c42\u8def\u5f84 String lookupPath = getUrlPathHelper().getLookupPathForRequest(request); //\u52a0\u9501 this.mappingRegistry.acquireReadLock(); try { //\u83b7\u5f97\u548c\u8bf7\u6c42\u8def\u5f84\u5339\u914d\u7684HandlerMethod\u5bf9\u8c61 HandlerMethod handlerMethod = lookupHandlerMethod(lookupPath, request); return (handlerMethod != null ? handlerMethod.createWithResolvedBean() : null); } finally { //\u91ca\u653e\u9501 this.mappingRegistry.releaseReadLock(); } } AbstractHandlerMethodMapping\u7684getHandler\u65b9\u6cd5\u8c03\u7528\u4e86getHandlerInternal\u6765\u83b7\u5f97HandlerMethod\u5bf9\u8c61\uff0c\u5728getHandlerInternal\u65b9\u6cd5\u4e2d\u5148mappingRegistry\u5bf9\u8c61\u6dfb\u52a0\u8bfb\u9501\uff0c\u63a5\u7740\u8c03\u7528lookupHandlerMethod\u6765\u83b7\u5f97\u5177\u4f53\u7684HandlerMethod\uff0c\u4ece\u4e4b\u524d\u7684\u5206\u6790\u4e2d\u6211\u4eec\u77e5\u9053\u4e86HandlerMethod\u7531MappingRegister\u4e2d\u8fdb\u884c\u4e86\u7f13\u5b58\uff0c\u6240\u4ee5lookupHandlerMethod\u5f88\u53ef\u80fd\u662f\u5728\u7f13\u5b58\u4e2d\u5bfb\u627e\u5bf9\u5e94\u7684HandlerMethod\uff0c\u65b9\u6cd5\u5982\u4e0b\uff1a protected HandlerMethod lookupHandlerMethod(String lookupPath, HttpServletRequest request) throws Exception { List<Match> matches = new ArrayList<>(); //\u6839\u636eurl\u5728mappingRegistry\u7684urlLookup\u4e2d\u627e\u5230\u76f4\u63a5\u8def\u5f84\u5339\u914d\u7684MappingInfo List<T> directPathMatches = this.mappingRegistry.getMappingsByUrl(lookupPath); if (directPathMatches != null) { //\u5982\u679curl\u80fd\u591f\u76f4\u63a5\u5339\u914d //\u518d\u6839\u636e\u5177\u4f53\u4fe1\u606f\u627e\u5230\u6700\u5339\u914d\u7684\u65b9\u6cd5 addMatchingMappings(directPathMatches, matches, request); } if (matches.isEmpty()) { //\u5982\u679curl\u4e0d\u80fd\u76f4\u63a5\u5339\u914d\uff0c\u8fd9\u91cc\u8003\u8651\u901a\u914d\u7b26\u7684\u95ee\u9898 // No choice but to go through all mappings... addMatchingMappings(this.mappingRegistry.getMappings().keySet(), matches, request); } ... } \u4e0d\u51fa\u6240\u6599\uff0c\u5728lookupHandlerMethod\u65b9\u6cd5\u4e2d\u5148\u6839\u636e\u8bf7\u6c42\u7684url\u4fe1\u606f\uff0c\u5728mappingRegistry\u7684urlLookup\u4e2d\u521d\u6b65\u786e\u5b9a\u5339\u914d\u7684MappingInfo\uff0c\u7136\u540e\u8c03\u7528addMatchingMappings\u65b9\u6cd5\u4e2d\u8fdb\u884c\u8be6\u7ec6\u7684\u7b5b\u9009\uff0c\u627e\u51fa\u5339\u914d\u7684MappingInfo\uff1b\u5982\u679c\u5728\u76f4\u63a5\u8def\u5f84\u5339\u914d\u6ca1\u6709\u627e\u5230\u4efb\u4f55\u5339\u914d\u7684\u4fe1\u606f\uff08\u7531\u4e8e\u901a\u914d\u7b26\u7684\u539f\u56e0\uff09\uff0c\u53ea\u80fd\u904d\u5386mappingRegistry\u7684mappingLookup\u4e2d\u6240\u6709\u7684MappingInfo\u6765\u627e\u5230\u5339\u914d\u7684\u4fe1\u606f\u3002addMatchingMappings\u65b9\u6cd5\u5982\u4e0b\uff1a private void addMatchingMappings(Collection<T> mappings, List<Match> matches, HttpServletRequest request) { for (T mapping : mappings) { //\u8fdb\u884c\u8be6\u7ec6\u7684\u5339\u914d\u5224\u65ad T match = getMatchingMapping(mapping, request); if (match != null) { matches.add(new Match(match, this.mappingRegistry.getMappings().get(mapping))); } } } //\u5728RequestMappingInfoHandlerMapping\u5b9e\u73b0 protected RequestMappingInfo getMatchingMapping(RequestMappingInfo info, HttpServletRequest request) { return info.getMatchingCondition(request); } //\u6700\u7ec8\u8c03\u7528\u4e86RequestMappingInfo\u7684getMatchingCondition\u65b9\u6cd5 public RequestMappingInfo getMatchingCondition(HttpServletRequest request) { RequestMethodsRequestCondition methods = this.methodsCondition.getMatchingCondition(request); ParamsRequestCondition params = this.paramsCondition.getMatchingCondition(request); HeadersRequestCondition headers = this.headersCondition.getMatchingCondition(request); ConsumesRequestCondition consumes = this.consumesCondition.getMatchingCondition(request); ProducesRequestCondition produces = this.producesCondition.getMatchingCondition(request); if (methods == null || params == null || headers == null || consumes == null || produces == null) { return null; } PatternsRequestCondition patterns = this.patternsCondition.getMatchingCondition(request); if (patterns == null) { return null; } RequestConditionHolder custom = this.customConditionHolder.getMatchingCondition(request); if (custom == null) { return null; } return new RequestMappingInfo(this.name, patterns, methods, params, headers, consumes, produces, custom.getCondition()); } \u4ece\u4e0a\u9762\u7684\u4ee3\u7801\u53ef\u4ee5\u770b\u51fa\uff0c\u5728addMatchingMappings\u4e2d\u8c03\u7528getMatchingMapping\u65b9\u6cd5\u5bf9\u5339\u914d\u4fe1\u606f\u8fdb\u884c\u7cbe\u786e\u5224\u65ad\uff0c\u5982\u679c\u5224\u65ad\u901a\u8fc7\u5219\u52a0\u5165\u5230\u7ed3\u679c\u96c6\u5408\u4e2d\u3002\u6700\u7ec8\u5c06\u8c03\u7528\u5230RequestMappingInfo\u7684getMatchingCondition\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u5bf97\u4e2a\u8981\u7d20\u8fdb\u884c\u4e86\u5339\u914d\u5224\u65ad\uff1a methods : \u8bf7\u6c42\u65b9\u6cd5\u5339\u914d\uff08POST/GET/DELETE/PUT\u7b49\u7b49)\uff0c\u5bf9\u5e94RequestMapping\u6ce8\u89e3\u7684method params : \u8bf7\u6c42\u53c2\u6570\u5339\u914d \u4f8b\u5982myParam=myValue, \u5bf9\u5e94RequestMapping\u6ce8\u89e3\u7684params headers:\u8bf7\u6c42\u5934\u4fe1\u606f(\u4f8b\u5982\uff1aMy-Header!=myValue\uff09\uff0c\u5bf9\u5e94RequestMapping\u7684headers consumes:\u63d0\u4ea4\u5185\u5bb9\u7c7b\u578b(\u4f8b\u5982:application/json, text/html;),\u5bf9\u5e94RequestMapping\u7684consumes produces:\u8fd4\u56de\u7684\u5185\u5bb9\u7c7b\u578b(\u4f8b\u5982:application/json),\u5bf9\u5e94RequestMapping\u7684consumes patterns:URL\u683c\u5f0f(\u4f8b\u5982:test/testDo),\u5bf9\u5e94RequestMapping\u7684value \u81ea\u5b9a\u4e49\u6761\u4ef6 \u5168\u90e8\u8981\u7d20\u90fd\u901a\u8fc7\u5224\u65ad\u540e\u65b0\u5efa\u4e00\u4e2aRequestMappingInfo\u526f\u672c\u8fd4\u56de\u3002 \u627e\u5230\u4e00\u4e2aurl\u5339\u914d\u7684\u6240\u6709\u65b9\u6cd5\u540e\uff0c\u4f1a\u5bf9\u5339\u914d\u7684\u65b9\u6cd5\u8fdb\u4e00\u6b65\u7684\u6bd4\u8f83\uff0c\u627e\u51fa\u6700\u5339\u914d\u7684\u65b9\u6cd5\uff08bestMatch\uff09\u8fd4\u56de\uff0clookupHandlerMethod\u65b9\u6cd5\u540e\u7eed\u4ee3\u7801\u5982\u4e0b\uff1a protected HandlerMethod lookupHandlerMethod(String lookupPath, HttpServletRequest request) throws Exception { List<Match> matches = new ArrayList<>(); ... if (!matches.isEmpty()) { //\u5982\u679c\u627e\u5230\u7684\u5339\u914d\u65b9\u6cd5\u6570\u91cf\u5927\u4e8e0 //\u901a\u8fc7\u5b9a\u4e49\u7684Comparator\u8fdb\u884c\u6392\u5e8f Comparator<Match> comparator = new MatchComparator(getMappingComparator(request)); matches.sort(comparator); //\u7b2c\u4e00\u4e2a\u5373\u662f\u6700\u5339\u914d\u7684\u65b9\u6cd5 Match bestMatch = matches.get(0); if (matches.size() > 1) { if (logger.isTraceEnabled()) { logger.trace(matches.size() + \" matching mappings: \" + matches); } if (CorsUtils.isPreFlightRequest(request)) { return PREFLIGHT_AMBIGUOUS_MATCH; } Match secondBestMatch = matches.get(1); if (comparator.compare(bestMatch, secondBestMatch) == 0) { Method m1 = bestMatch.handlerMethod.getMethod(); Method m2 = secondBestMatch.handlerMethod.getMethod(); String uri = request.getRequestURI(); throw new IllegalStateException( \"Ambiguous handler methods mapped for '\" + uri + \"': {\" + m1 + \", \" + m2 + \"}\"); } } request.setAttribute(BEST_MATCHING_HANDLER_ATTRIBUTE, bestMatch.handlerMethod); handleMatch(bestMatch.mapping, lookupPath, request); return bestMatch.handlerMethod; } else { //\u5426\u5219\u8fdb\u5165\u6ca1\u6709\u5339\u914d\u65b9\u6cd5\u7684\u903b\u8f91 return handleNoMatch(this.mappingRegistry.getMappings().keySet(), lookupPath, request); } } \u627e\u5230\u6700\u6700\u5339\u914d\u7684\u65b9\u6cd5\u540e\u5219\u8fd4\u56deHandlerMethod\u5bf9\u8c61\uff0c\u8ba9\u6211\u4eec\u4eceAbstractHandlerMethodMapping\u7684getHandler\u4e2d\u5f80\u4e0b\u8d70\uff0c\u540e\u7eed\u4ee3\u7801\u5982\u4e0b\uff1a public final HandlerExecutionChain getHandler(HttpServletRequest request) throws Exception { Object handler = getHandlerInternal(request); ... //\u5c06HandlerMethod\u5305\u88c5\u4e3aHandlerExecutionChain //\u6267\u884c\u7684\u64cd\u4f5c\u5c31\u662f\u5c06\u6ce8\u518c\u4e86\u5bf9\u5e94URL\u7684\u8fc7\u6ee4\u5668\u6302\u8f7d\u5230\u8be5chain\u4e2d\uff0c\u5f62\u6210\u4e00\u6761\u65b9\u6cd5\u6267\u884c\u94fe\u3002 HandlerExecutionChain executionChain = getHandlerExecutionChain(handler, request); ... //\u5224\u65ad\u662f\u5426\u662fcors\u8bf7\u6c42\uff0c\u662f\u7684\u8bdd\u6dfb\u52a0\u5bf9\u5e94\u7684\u8fc7\u6ee4\u5668 if (CorsUtils.isCorsRequest(request)) { CorsConfiguration globalConfig = this.corsConfigurationSource.getCorsConfiguration(request); CorsConfiguration handlerConfig = getCorsConfiguration(handler, request); CorsConfiguration config = (globalConfig != null ? globalConfig.combine(handlerConfig) : handlerConfig); executionChain = getCorsHandlerExecutionChain(request, executionChain, config); } return executionChain; } \u5305\u88c5\u5b8c\u6210\u540e\u7684handler\u5c06\u88ab\u56de\u5230DispatcherServlet\u7684doDispatch\u65b9\u6cd5\u4e2d\uff0c\u7ee7\u7eed\u5f80\u4e0b\u6267\u884c\uff1a protected void doDispatch(HttpServletRequest request, HttpServletResponse response) throws Exception { ... mappedHandler = getHandler(processedRequest); //\u5982\u679c\u6ca1\u627e\u5230\u5339\u914d\u7684handler\uff0c\u8c03\u7528noHandlerFound\u65b9\u6cd5\u6839\u636e\u914d\u7f6e\u629b\u51fa\u5f02\u5e38\u6216\u8005\u8fd4\u56de404\u72b6\u6001\u7801 if (mappedHandler == null) { noHandlerFound(processedRequest, response); return; } // \u6839\u636eHandler\u83b7\u5f97\u5bf9\u5e94\u7684HandlerAdapter\u5bf9\u8c61\uff08\u5373\u914d\u7f6e\u4e2d\u7684RequestMappingHandlerAdapter\uff09 HandlerAdapter ha = getHandlerAdapter(mappedHandler.getHandler()); // \u5224\u65ad\u83b7\u5f97\u7684handler\u662f\u5426\u652f\u6301last-modified\u8bf7\u6c42\u5934 String method = request.getMethod(); boolean isGet = \"GET\".equals(method); if (isGet || \"HEAD\".equals(method)) { long lastModified = ha.getLastModified(request, mappedHandler.getHandler()); if (new ServletWebRequest(request, response).checkNotModified(lastModified) && isGet) { return; } } //\u6267\u884c\u8bf7\u6c42\u8fc7\u6ee4\u5668\u7684preHandler\u65b9\u6cd5\uff0c\u8fd4\u56deTRUE\u65f6\u7ee7\u7eed\u5411\u4e0b\u6267\u884c\uff0c\u8fd4\u56deFALSE\u4ee3\u8868\u8bf7\u6c42\u88ab\u8fc7\u6ee4\u4e86\uff0c\u8fd9\u65f6\u76f4\u63a5\u8fd4\u56de if (!mappedHandler.applyPreHandle(processedRequest, response)) { return; } // \u5f00\u59cb\u771f\u6b63\u8c03\u7528\u4e86handler\u903b\u8f91 mv = ha.handle(processedRequest, response, mappedHandler.getHandler()); if (asyncManager.isConcurrentHandlingStarted()) { return; } applyDefaultViewName(processedRequest, mv); mappedHandler.applyPostHandle(processedRequest, response, mv); ... } \u5224\u65ad\u8fd4\u56de\u7684handler\u7684\u5bf9\u8c61\u662f\u5426\u4e3a\u7a7a\uff0c\u82e5handler\u4e3a\u7a7a\u5219\u629b\u51fa\u5f02\u5e38\u6216\u8005\u8fd4\u56de404\uff1b\u82e5handler\u4e0d\u4e3a\u7a7a\uff0c\u6839\u636ehandler\u83b7\u5f97\u5bf9\u5e94\u7684HandlerAdapter\u5bf9\u8c61\uff0cHandlerAdapter\u662f\u7528\u6765\u8c03\u7528HandlerMethod\u5bf9\u5e94\u7684\u65b9\u6cd5\u7684\u9002\u914d\u5668\uff0c\u5728spring\u4e2d\u5177\u4f53\u4e3aRequestMappingHandlerAdapter\uff1b\u4e4b\u540e\u4f1a\u6267\u884c\u6267\u884c\u8fc7\u6ee4\u94fe\u4e2d\u7684\u8fc7\u6ee4\u65b9\u6cd5\uff0c\u5224\u65ad\u8bf7\u6c42\u662f\u5426\u88ab\u5e94\u8be5\u8fc7\u6ee4\uff0c\u5b8c\u6210\u8fc7\u6ee4\u903b\u8f91\u4ee5\u540e\uff0c\u624d\u4f1a\u8c03\u7528HandlerAdapter\u7684handle\u65b9\u6cd5\u5f00\u59cb\u771f\u6b63\u7684\u65b9\u6cd5\u8c03\u7528\u3002 //\u5728AbstractHandlerMethodAdapter\u7684\u5b9e\u73b0 public final ModelAndView handle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { return handleInternal(request, response, (HandlerMethod) handler); } \u5728handle\u65b9\u6cd5\u4e2d\u5c06 HandlerExecutionChain\u5f3a\u8f6c\u56de HandlerMethod \u5bf9\u8c61\uff0c\u5e76\u4f20\u9012\u7ed9\u5b50\u7c7b\uff08RequestMappingHandlerAdapter\uff09\u7684 handlerInternal \u65b9\u6cd5\u6765\u8fdb\u884c\u540e\u7eed\u5904\u7406\u3002 protected ModelAndView handleInternal(HttpServletRequest request, HttpServletResponse response, HandlerMethod handlerMethod) throws Exception { ModelAndView mav; // \u5224\u65ad\u8bf7\u6c42\u7c7b\u578b\u662f\u5426\u88ab\u652f\u6301\u4ee5\u53ca\u8bf7\u6c42\u662f\u5426\u9700\u8981session checkRequest(request); // \u5224\u65adinvokeHandlerMethod\u65b9\u6cd5\u662f\u5426\u9700\u8981\u5728\u540c\u6b65\u5757\u4e2d\u6267\u884c if (this.synchronizeOnSession) { HttpSession session = request.getSession(false); if (session != null) { Object mutex = WebUtils.getSessionMutex(session); synchronized (mutex) { mav = invokeHandlerMethod(request, response, handlerMethod); } } else { mav = invokeHandlerMethod(request, response, handlerMethod); } } else { mav = invokeHandlerMethod(request, response, handlerMethod); } if (!response.containsHeader(HEADER_CACHE_CONTROL)) { if (getSessionAttributesHandler(handlerMethod).hasSessionAttributes()) { applyCacheSeconds(response, this.cacheSecondsForSessionAttributeHandlers); } else { prepareResponse(response); } } return mav; } \u53ef\u4ee5\u770b\u51fa\u8be5\u65b9\u6cd5\u7684\u4e3b\u8981\u4f5c\u7528\u5c31\u662f\u5bf9\u5f53\u524d\u8bf7\u6c42\u8fdb\u884c\u4e00\u4e9b\u5224\u65ad\u4e0e\u5904\u7406\uff0c\u7136\u540e\u8c03\u7528\u6700\u91cd\u8981\u7684\u65b9\u6cd5invokeHandlerMethod\uff0c\u8fd9\u91cc\u5c31\u4e0d\u6df1\u5165\u8be5\u65b9\u6cd5\u7684\u903b\u8f91\u4e86\uff08\u4ee5\u540e\u6709\u65f6\u95f4\u518d\u7814\u7a76\u5427\u3002\u3002\u3002\uff09\uff0c\u53ea\u5bf9\u8be5\u65b9\u6cd5\u8fdb\u884c\u7b80\u5355\u7684\u8bf4\u660e\u3002\u5728\u540e\u7eed\u6267\u884c\u8fc7\u7a0b\u4e2d\u4f1a\u5148\u5bf9\u65b9\u6cd5\u4f20\u5165\u53c2\u6570\u8fdb\u884c\u89e3\u6790\u548c\u5339\u914d\uff0c\u5982\u679c\u6ca1\u6709\u5339\u914d\u5230\u5408\u9002\u7684\u503c\u5c31\u4f1a\u629b\u51fa\u5f02\u5e38\u3002\u4e00\u4e2a\u5178\u578b\u7684\u4f8b\u5b50\u4fbf\u662f @RequestParam \u6ce8\u89e3\uff0c\u5982\u679c\u4f60\u52a0\u4e86\u8fd9\u4e2a\u6ce8\u89e3\uff0c\u90a3\u4e48\u53c2\u6570\u540d\u5fc5\u987b\u4e0e\u8868\u5355\u540d\u4e00\u81f4\uff0c\u5426\u5219\u4f1a\u62a5\u9519\u3002\u4e4b\u540e\u4f1a\u901a\u8fc7\u53cd\u5c04\u8c03\u7528\u5230\u5177\u4f53\u7684Controller\u65b9\u6cd5\uff0c\u6700\u540e\u4f1a\u5bf9\u65b9\u6cd5\u8fd4\u56de\u7684\u7ed3\u679c\u8fdb\u884c\u5904\u7406\uff0c\u4f8b\u5982\u5bf9\u6dfb\u52a0\u4e86@ResponseBody\u6ce8\u89e3\u7684\u65b9\u6cd5\uff0c\u4f1a\u5bf9\u5176\u8fd4\u56de\u503c\u8fdb\u884cjson\u5316\u5e76\u5c06\u5176\u5199\u5165 responseBody \u4e2d\u3002 \u53c2\u8003 1. http://ddrv.cn/a/58528 2. https://www.jianshu.com/p/ef15e524458e","title":"DispatcherServlet\u6e90\u7801\u5206\u6790"},{"location":"Spring/Spring\u57fa\u7840\u77e5\u8bc6/DispatcherServlet\u6e90\u7801\u5206\u6790/#dispatcherservletcontroller","text":"","title":"\u8bf7\u6c42\u4eceDispatcherServlet\u5230\u8fbe\u5177\u4f53\u7684Controller"},{"location":"Spring/Spring\u57fa\u7840\u77e5\u8bc6/DispatcherServlet\u6e90\u7801\u5206\u6790/#dispatcherservlet","text":"Servlet\u7684service\u65b9\u6cd5\u662f\u54cd\u5e94\u524d\u7aef\u8bf7\u6c42\u7684\u5165\u53e3\u65b9\u6cd5\uff0cServlet \u5bb9\u5668\uff08\u5373 Web \u670d\u52a1\u5668\uff09\u8c03\u7528 service() \u65b9\u6cd5\u6765\u5904\u7406\u6765\u81ea\u5ba2\u6237\u7aef\uff08\u6d4f\u89c8\u5668\uff09\u7684\u8bf7\u6c42\uff0cservice() \u65b9\u6cd5\u68c0\u67e5 HTTP \u8bf7\u6c42\u7c7b\u578b\uff08GET\u3001POST\u3001PUT\u3001DELETE \u7b49\uff09\uff0c\u5e76\u5728\u9002\u5f53\u7684\u65f6\u5019\u8c03\u7528 doGet\u3001doPost\u3001doPut\uff0cdoDelete \u7b49\u65b9\u6cd5\u3002DispatcherServlet\u662f\u4e00\u4e2a\u6807\u51c6\u7684Servlet\uff0c\u80af\u5b9a\u5177\u6709service\u65b9\u6cd5\uff0c\u5e76\u4e14\u901a\u8fc7service\u65b9\u6cd5\u6765\u54cd\u5e94\u6240\u6709\u7684\u8bf7\u6c42\u3002 DispatherServlet\u7ee7\u627f\u81eaFrameWorkServlet\uff0cFrameWorkServlet\u662f springmvc \u7684\u57fa\u7840 Servlet\uff0c\u5b83\u7684\u4e3b\u8981\u5de5\u4f5c\u662f\u5bf9 WebApplicationContext \u5b9e\u4f8b\u8fdb\u884c\u521d\u59cb\u5316\u548c\u7ba1\u7406\uff0c\u5e76\u4e14FrameWorkServlet\u91cd\u5199\u4e86doGet\u3001doPost\u3001doPut\uff0cdoDelete \u7b49\u65b9\u6cd5\uff0c\u5c06\u6240\u6709\u7c7b\u578b\u7684\u8bf7\u6c42\u90fd\u4ea4\u7ed9processRequest\u65b9\u6cd5\u6765\u5904\u7406\u3002 protected final void processRequest(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { long startTime = System.currentTimeMillis(); Throwable failureCause = null; LocaleContext previousLocaleContext = LocaleContextHolder.getLocaleContext(); LocaleContext localeContext = buildLocaleContext(request); RequestAttributes previousAttributes = RequestContextHolder.getRequestAttributes(); ServletRequestAttributes requestAttributes = buildRequestAttributes(request, response, previousAttributes); WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request); asyncManager.registerCallableInterceptor(FrameworkServlet.class.getName(), new RequestBindingInterceptor()); initContextHolders(request, localeContext, requestAttributes); try { //\u62bd\u8c61\u65b9\u6cd5\u7531\u5b50\u7c7b\u5b9e\u73b0 doService(request, response); } catch (ServletException | IOException ex) { failureCause = ex; throw ex; } catch (Throwable ex) { failureCause = ex; throw new NestedServletException(\"Request processing failed\", ex); } finally { resetContextHolders(request, previousLocaleContext, previousAttributes); if (requestAttributes != null) { requestAttributes.requestCompleted(); } logResult(request, response, failureCause, asyncManager); publishRequestHandledEvent(request, response, startTime, failureCause); } } processRequest\u65b9\u6cd5\u4e3b\u8981\u662f\u4f5c\u7528\u662f\u521d\u59cb\u5316request\u8bf7\u6c42\u7684\u4e0a\u4e0b\u6587\u53c2\u6570\uff0c\u7136\u540e\u5c06\u8bf7\u6c42\u4ea4\u7ed9\u5b50\u7c7b\u7684doService\u65b9\u6cd5\u5904\u7406\uff0c\u8be5\u65b9\u6cd5\u7531DispatcherServlet\u5b9e\u73b0\u3002 protected void doService(HttpServletRequest request, HttpServletResponse response) throws Exception { logRequest(request); //\u4fdd\u5b58request\u8bf7\u6c42\u53c2\u6570\u7684\u5feb\u7167\uff0c\u4f7f\u5728\u540e\u7eed\u5904\u7406\u4e2d\u53ef\u4ee5\u6062\u590d\u539f\u6765\u7684\u6570\u636e Map<String, Object> attributesSnapshot = null; if (WebUtils.isIncludeRequest(request)) { attributesSnapshot = new HashMap<>(); Enumeration<?> attrNames = request.getAttributeNames(); while (attrNames.hasMoreElements()) { String attrName = (String) attrNames.nextElement(); if (this.cleanupAfterInclude || attrName.startsWith(DEFAULT_STRATEGIES_PREFIX)) { attributesSnapshot.put(attrName, request.getAttribute(attrName)); } } } // \u6dfb\u52a0\u6846\u67b6\u7684\u5185\u7f6e\u5bf9\u8c61\u5230request\u57df\u4e2d\uff0c\u4f7f\u5f97handler\u548cview\u5bf9\u8c61\u80fd\u591f\u4f7f\u7528 request.setAttribute(WEB_APPLICATION_CONTEXT_ATTRIBUTE, getWebApplicationContext()); request.setAttribute(LOCALE_RESOLVER_ATTRIBUTE, this.localeResolver); request.setAttribute(THEME_RESOLVER_ATTRIBUTE, this.themeResolver); request.setAttribute(THEME_SOURCE_ATTRIBUTE, getThemeSource()); //\u6ce8\u5165\u901a\u8fc7redirect\u4f20\u9012\u6765\u7684\uff08RedirectAttribute\uff09\u5c5e\u6027 if (this.flashMapManager != null) { FlashMap inputFlashMap = this.flashMapManager.retrieveAndUpdate(request, response); if (inputFlashMap != null) { request.setAttribute(INPUT_FLASH_MAP_ATTRIBUTE, Collections.unmodifiableMap(inputFlashMap)); } request.setAttribute(OUTPUT_FLASH_MAP_ATTRIBUTE, new FlashMap()); request.setAttribute(FLASH_MAP_MANAGER_ATTRIBUTE, this.flashMapManager); } try { //\u8fdb\u884c\u8bf7\u6c42\u5206\u53d1 doDispatch(request, response); } finally { if (!WebAsyncUtils.getAsyncManager(request).isConcurrentHandlingStarted()) { // Restore the original attribute snapshot, in case of an include. if (attributesSnapshot != null) { restoreAttributesAfterInclude(request, attributesSnapshot); } } } } \u53ef\u4ee5\u770b\u51fadoService\u65b9\u6cd5\u4e3b\u8981\u4f5c\u7528\u662f\u5bf9request\u8bf7\u6c42\u53c2\u6570\u8fdb\u884c\u5907\u4efd\uff0c\u5e76\u4e14\u5bf9request\u5fc5\u8981\u57df\u8fdb\u884c\u8d4b\u503c\u64cd\u4f5c\uff0c\u6700\u540e\u8c03\u7528doDispatch\u65b9\u6cd5\u8fdb\u884c\u8bf7\u6c42\u5206\u53d1\u3002 protected void doDispatch(HttpServletRequest request, HttpServletResponse response) throws Exception { HttpServletRequest processedRequest = request; HandlerExecutionChain mappedHandler = null; boolean multipartRequestParsed = false; WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request); try { ModelAndView mv = null; Exception dispatchException = null; try { //\u5224\u65ad\u5f53\u524d\u8bf7\u6c42\u662f\u5426\u662f\u6587\u4ef6\u8bf7\u6c42,\u5982\u679c\u662f\u7684\u8bdd\u5c31\u5c06\u8bf7\u6c42\u8f6c\u6362\u4e3a\u6587\u4ef6\u8bf7\u6c42 processedRequest = checkMultipart(request); multipartRequestParsed = (processedRequest != request); //\u627e\u5230\u80fd\u591f\u5904\u7406\u5f53\u524d\u8bf7\u6c42\u7684handler //\u8be5\u5bf9\u8c61\u6700\u7ec8\u4f1a\u88ab\u5305\u88c5\u4e3aHandlerExecutionChain\u7c7b\u578b mappedHandler = getHandler(processedRequest); ... } } } DispatcherServlet\u7684getHandler\u65b9\u6cd5\u6839\u636e\u8bf7\u6c42\u83b7\u53d6\u8bf7\u6c42\u6240\u5bf9\u5e94\u7684mappedHandler\uff08\u5373\u5177\u4f53\u5904\u7406\u8bf7\u6c42\u7684 method \u65b9\u6cd5\uff0c\u5b9e\u9645\u4e0a\u4f1a\u6700\u7ec8\u88ab\u5305\u88c5\u6210\u4e00\u4e2a HandlerExecutionChain \u5bf9\u8c61\uff09\uff0c\u8fd9\u91cc\u662f\u627e\u5230\u54cd\u5e94\u8be5\u8bf7\u6c42\u7684Controller\u65b9\u6cd5\u7684\u5173\u952e\uff0c\u8be5\u65b9\u6cd5\u7684\u5177\u4f53\u5b9e\u73b0\u5982\u4e0b\uff1a protected HandlerExecutionChain getHandler(HttpServletRequest request) throws Exception { if (this.handlerMappings != null) { //\u904d\u5386\u6240\u6709\u7684HandlerMapping\u5bf9\u8c61\uff0c\u8c03\u7528\u5176getHandler //\u5982\u679c\u8be5\u65b9\u6cd5\u8fd4\u56de\u7684handler\u4e0d\u4e3a\u7a7a\uff0c\u5219\u8fd4\u56de\u7b2c\u4e00\u4e2a\u83b7\u5f97\u7684handler for (HandlerMapping mapping : this.handlerMappings) { HandlerExecutionChain handler = mapping.getHandler(request); if (handler != null) { return handler; } } } return null; } \u4ee5\u4e0a\u7684\u903b\u8f91\uff0c\u53ea\u662f\u904d\u5386\u4e86DispatcherServlet\u7684handlerMappings\u96c6\u5408\uff0c\u7136\u540e\u8c03\u7528HandlerMapping\u7684getHandler\u65b9\u6cd5\u83b7\u5f97HandlerExecutionChain\u5bf9\u8c61\uff08\u4e3b\u8981\u662f\u5305\u62ec\u4e86\u4e00\u4e2ahandler\uff0c\u4ee5\u53ca\u4e00\u4e2a\u62e6\u622a\u5668\u5217\u8868\uff09\uff0c\u5982\u679c\u8be5\u5bf9\u8c61\u4e0d\u4e3a\u7a7a\u5219\u8fd4\u56de\u8be5\u5bf9\u8c61\u3002\u8fd9\u91cc\u95ee\u9898\u5c31\u51fa\u73b0\u4e86\uff0chandlerMappings\u96c6\u5408\u662f\u4ec0\u4e48\uff0c\u662f\u4ece\u54ea\u91cc\u83b7\u5f97\u7684\uff1f \u5b9e\u9645\u4e0ahandlerMappings\u96c6\u5408\u4e2d\u5b58\u653e\u4e86\u5b9e\u73b0\u4e86HandlerMapping\u63a5\u53e3\u7684\u5bf9\u8c61\uff0c\u5176\u4e2d\u6700\u91cd\u8981\u7684\u5bf9\u8c61\u5c31\u662f RequestMappingHandlerMapping \u5bf9\u8c61\uff0c\u5b83\u4f1a\u5728spring\u5bb9\u5668\u521d\u59cb\u5316\u4ee5\u540e\u5c06Controller\u4e2d\u6dfb\u52a0\u4e86@RequestMapping\u6ce8\u89e3\u7684\u65b9\u6cd5\u6620\u5c04\u4fe1\u606f\u7f13\u5b58\u8d77\u6765\uff0c\u65b9\u4fbf\u5728\u54cd\u5e94\u8bf7\u6c42\u65f6\u901a\u8fc7\u53cd\u5c04\u8c03\u7528\u5bf9\u5e94\u7684\u65b9\u6cd5\uff0c\u5177\u4f53\u5b9e\u73b0\u5c06\u5728\u4e0b\u6587\u8fdb\u884c\u5206\u6790\u3002\u90a3\u4e48RequestMappingHandlerMapping\u662f\u5728\u54ea\u914d\u7f6e\u7684\uff0c\u53c8\u662f\u600e\u4e48\u521d\u59cb\u5316\u7684\u5462\uff1f\u76f4\u63a5\u63d0\u8d77RequestMappingHandlerMapping\u5bf9\u8c61\u5927\u5bb6\u53ef\u80fd\u4e0d\u592a\u719f\u6089\uff0c\u4f46\u662fspring\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684 <mvc:annotation-driven/> \u914d\u7f6e\u9879\u5927\u5bb6\u5e94\u8be5\u4e0d\u964c\u751f\uff0c\u8be5\u914d\u7f6e\u9879\u9ed8\u8ba4\u6dfb\u52a0\u4e86\u4ee5\u4e0b\u914d\u7f6e\uff1a <bean class=\"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping\" /> <bean class=\"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter\" /> \u56e0\u6b64\u5728spring\u5bb9\u5668\u521d\u59cb\u5316\u65f6\uff0c\u4f1a\u5c06RequestMappingHandlerMapping\u5bf9\u8c61\u521d\u59cb\u5316\uff0c\u800c\u8be5\u5bf9\u8c61\u7684\u7236\u7c7bAbstractHandlerMethodMapping\u5b9e\u73b0\u4e86 InitializingBean \u63a5\u53e3\u5e76\u5b9e\u73b0\u5176afterPropertiesSet\u65b9\u6cd5\uff0c\u5728Bean\u4f9d\u8d56\u6ce8\u5165\u5b8c\u6210\u65f6\uff0cspring\u4f1a\u53bb\u68c0\u67e5\u8fd9\u4e2aBean\u662f\u5426\u5b9e\u73b0\u4e86InitializingBean\u63a5\u53e3\uff0c\u5982\u679c\u5b9e\u73b0\u4e86InitializingBean\u63a5\u53e3\uff0c\u5c31\u4f1a\u53bb\u8c03\u7528\u8fd9\u4e2a\u7c7b\u7684afterPropertiesSet\u65b9\u6cd5\u3002AbstractHandlerMethodMapping\u7684afterPropertiesSet\u65b9\u6cd5\u5982\u4e0b\uff1a public void afterPropertiesSet() { initHandlerMethods(); } protected void initHandlerMethods() { //\u5bf9\u6240\u6709\u7684BeanName\u8c03\u7528processCandidateBean\u65b9\u6cd5 for (String beanName : getCandidateBeanNames()) { if (!beanName.startsWith(SCOPED_TARGET_NAME_PREFIX)) { processCandidateBean(beanName); } } handlerMethodsInitialized(getHandlerMethods()); } //\u4ecespring\u4e0a\u4e0b\u6587\u4e2d\u83b7\u5f97\u6240\u6709\u7684Bean\u7684\u540d\u5b57\uff0c\u56e0\u4e3a\u8fd9\u91cc\u7684BeanType\u4e3aObject protected String[] getCandidateBeanNames() { return (this.detectHandlerMethodsInAncestorContexts ? BeanFactoryUtils.beanNamesForTypeIncludingAncestors(obtainApplicationContext(), Object.class) : obtainApplicationContext().getBeanNamesForType(Object.class)); } afterPropertiesSet\u8c03\u7528\u4e86initHandlerMethods\u65b9\u6cd5\u83b7\u5f97\u5f53\u524dspring\u4e0a\u4e0b\u6587\u4e2d\u6240\u6709bean\u7684\u540d\u5b57\uff0c\u5e76\u4e14\u5bf9\u7b26\u5408\u6761\u4ef6\u7684beanName\u8c03\u7528processCandidateBean\u65b9\u6cd5\u3002 protected void processCandidateBean(String beanName) { Class<?> beanType = null; try { beanType = obtainApplicationContext().getType(beanName); } catch (Throwable ex) { // An unresolvable bean type, probably from a lazy bean - let's ignore it. if (logger.isTraceEnabled()) { logger.trace(\"Could not resolve type for bean '\" + beanName + \"'\", ex); } } //beanType\u4e0d\u4e3a\u7a7a\u5e76\u4e14isHandler\u65b9\u6cd5\u8fd4\u56de\u503c\u4e3atrue if (beanType != null && isHandler(beanType)) { detectHandlerMethods(beanName); } } //isHandler\u65b9\u6cd5\u5728RequestMappingHandlerMapping\u7684\u5b9e\u73b0 protected boolean isHandler(Class<?> beanType) { return (AnnotatedElementUtils.hasAnnotation(beanType, Controller.class) || AnnotatedElementUtils.hasAnnotation(beanType, RequestMapping.class)); } processCandidateBean\u65b9\u6cd5\u901a\u8fc7beanName\u83b7\u5f97bean\u7684\u7c7b\u578b\uff0c\u5f53bean\u7684\u7c7b\u578b\u4e0d\u4e3a\u7a7a\u4e14\u8be5\u7c7b\u540c\u65f6\u5177\u6709@Controller\u6ce8\u89e3\u548c@RequestMapping\u6ce8\u89e3\u65f6\uff0c\u624d\u4f1a\u7ee7\u7eed\u8c03\u7528detectHandlerMethods\u65b9\u6cd5\u3002 protected void detectHandlerMethods(Object handler) { //\u6839\u636ebeanName\u83b7\u5f97\u5176class\u7c7b\u578b Class<?> handlerType = (handler instanceof String ? obtainApplicationContext().getType((String) handler) : handler.getClass()); if (handlerType != null) { Class<?> userType = ClassUtils.getUserClass(handlerType); //\u904d\u5386\u8be5\u7c7b\u5b9e\u73b0\u7684\u6240\u6709\u65b9\u6cd5\uff0c\u83b7\u53d6\u5b83\u7684\u6240\u6709\u65b9\u6cd5\u5bf9\u5e94\u7684\u5339\u914d\u4fe1\u606f(@RequestMapping\u6ce8\u89e3\u4e2d\u7684\u4fe1\u606f) //\u5e76\u4e14\u5c06\u5339\u914d\u4fe1\u606f\u4fdd\u5b58\u5728mappingRegistry\u4e2d Map<Method, T> methods = MethodIntrospector.selectMethods(userType, (MethodIntrospector.MetadataLookup<T>) method -> { try { //\u6839\u636e\u65b9\u6cd5\u5339\u914d\u4fe1\u606f\u6784\u9020RequestMappingInfo return getMappingForMethod(method, userType); } catch (Throwable ex) { throw new IllegalStateException(\"Invalid mapping on handler class [\" + userType.getName() + \"]: \" + method, ex); } }); if (logger.isTraceEnabled()) { logger.trace(formatMappings(userType, methods)); } methods.forEach((method, mapping) -> { Method invocableMethod = AopUtils.selectInvocableMethod(method, userType); //\u5c06\u65b9\u6cd5\u548c@RequestMapping\u4e2d\u7684\u4fe1\u606f\u7f13\u5b58\u5230mappingRegister registerHandlerMethod(handler, invocableMethod, mapping); }); } } //getMappingForMethod\u65b9\u6cd5\u5728RequestMappingHandlerMapping\u7684\u5b9e\u73b0 protected RequestMappingInfo getMappingForMethod(Method method, Class<?> handlerType) { //\u4ece\u65b9\u6cd5\u4e0a@RequestMapping\u6ce8\u89e3\u4e2d\u7684\u5c5e\u6027\u5c01\u88c5\u5230RequestMappingInfo\u4e2d RequestMappingInfo info = createRequestMappingInfo(method); if (info != null) { //\u540c\u6837\u7684\u4ece\u7c7b\u4e2d\u7684\u4e0a@RequestMapping\u6ce8\u89e3\u4e2d\u83b7\u5f97\u4fe1\u606f RequestMappingInfo typeInfo = createRequestMappingInfo(handlerType); if (typeInfo != null) { //\u5c06\u65b9\u6cd5\u548c\u7c7b\u4e0a\u7684\u4fe1\u606f\u8fdb\u884c\u4e00\u6b21\u5408\u5e76 info = typeInfo.combine(info); } String prefix = getPathPrefix(handlerType); if (prefix != null) { info = RequestMappingInfo.paths(prefix).build().combine(info); } } return info; } detectHandlerMethods\u7684\u4f5c\u7528\u4e3b\u8981\u662f\u83b7\u5f97\u7c7b\u6240\u6709\u7684\u5b9e\u73b0\u65b9\u6cd5\uff0c\u904d\u5386\u8fd9\u4e9b\u65b9\u6cd5\u83b7\u5f97\u65b9\u6cd5\u4e0a@ReqestMapping\u4e2d\u7684\u4fe1\u606f\uff0c\u6784\u9020\u6210RequestMappingInfo\u5bf9\u8c61\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u5728\u6784\u9020RequestMappingInfo\u65f6\u4f1a\u5c06\u7c7b\u4e0a\u7684\u6ce8\u89e3\u4fe1\u606f\u548c\u65b9\u6cd5\u4e0a\u7684\u6ce8\u89e3\u4fe1\u606f\u8fdb\u884c\u5408\u5e76\uff0c\u6bd4\u5982\u7c7b\u5bf9\u5e94\u7684path\u4e3a test,Method\u5bf9\u5e94\u7684path\u4e3a test1,\u90a3\u4e48\u6700\u540e\u5408\u5e76\u7684path\u5373\u4e3a test/test1\u3002\u6700\u540e\uff0c\u8c03\u7528registerHandlerMethod\u5c06\u83b7\u5f97\u7684\u4fe1\u606f\u7f13\u5b58\u5728mappingRegister\u4e2d\u3002 protected void registerHandlerMethod(Object handler, Method method, T mapping) { //mappingRegistry\u662fAbstractHandlerMethodMapping\u7684\u5185\u90e8\u7c7bMappingRegistry\u7684\u5b9e\u4f53\u5bf9\u8c61 //\u4e3b\u8981\u7f13\u5b58\u4e86MappingInfo\u4e0eMethod\u7684\u6620\u5c04\uff0c\u4ee5\u53caurl\u4e0eMappingInfo\u7684\u6620\u5c04 this.mappingRegistry.register(mapping, handler, method); } public void register(T mapping, Object handler, Method method) { this.readWriteLock.writeLock().lock(); try { //\u5c06handler(\u7c7b\u540d\u6216\u7c7b)\u548c\u65b9\u6cd5\u5173\u8054\u521b\u5efaHandlerMethod\u5bf9\u8c61 HandlerMethod handlerMethod = createHandlerMethod(handler, method); assertUniqueMethodMapping(handlerMethod, mapping); //\u5c06MappingInfo\u4e0eMethod\u7684\u6620\u5c04\u5b58\u5728mappingLookup\u4e2d this.mappingLookup.put(mapping, handlerMethod); List<String> directUrls = getDirectUrls(mapping); for (String url : directUrls) { //\u5c06url\u4e0eMappingInfo\u7684\u6620\u5c04\u5b58\u5728urlLookup\u4e2d this.urlLookup.add(url, mapping); } String name = null; if (getNamingStrategy() != null) { name = getNamingStrategy().getName(handlerMethod, mapping); addMappingName(name, handlerMethod); } CorsConfiguration corsConfig = initCorsConfiguration(handler, method, mapping); if (corsConfig != null) { this.corsLookup.put(handlerMethod, corsConfig); } this.registry.put(mapping, new MappingRegistration<>(mapping, handlerMethod, directUrls, name)); } finally { this.readWriteLock.writeLock().unlock(); } } \u5230\u6b64RequestMappingHandlerMapping\u5bf9\u8c61\u521d\u59cb\u5316\u57fa\u672c\u5b8c\u6210\uff0c\u5728DispatchServlet\u521d\u59cb\u5316\u65f6\u4f1a\u901a\u8fc7BeanFactory\u83b7\u5f97\u6240\u6709\u5b9e\u73b0\u4e86HandlerMapping\u7684\u7c7b\u6765\u521d\u59cb\u5316handlerMappings\u6210\u5458\u53d8\u91cf\u3002 \u73b0\u5728\u8ba9\u6211\u4eec\u56de\u5230DispatcherServlet\u7684getHandler\u65b9\u6cd5\u4e0a\uff0c\u8be5\u65b9\u6cd5\u8c03\u7528\u4e86HandlerMapping\u7684getHandler\u65b9\u6cd5\uff0c\u5177\u4f53\u5b9e\u73b0\u5728AbstractHandlerMethodMapping\u4e2d\uff1a public final HandlerExecutionChain getHandler(HttpServletRequest request) throws Exception { //\u83b7\u5f97handler\u5bf9\u8c61 Object handler = getHandlerInternal(request); if (handler == null) { handler = getDefaultHandler(); } if (handler == null) { return null; } // Bean name or resolved handler? if (handler instanceof String) { String handlerName = (String) handler; handler = obtainApplicationContext().getBean(handlerName); } ... } protected HandlerMethod getHandlerInternal(HttpServletRequest request) throws Exception { //\u4ecerequest\u4e2d\u83b7\u5f97\u8bf7\u6c42\u8def\u5f84 String lookupPath = getUrlPathHelper().getLookupPathForRequest(request); //\u52a0\u9501 this.mappingRegistry.acquireReadLock(); try { //\u83b7\u5f97\u548c\u8bf7\u6c42\u8def\u5f84\u5339\u914d\u7684HandlerMethod\u5bf9\u8c61 HandlerMethod handlerMethod = lookupHandlerMethod(lookupPath, request); return (handlerMethod != null ? handlerMethod.createWithResolvedBean() : null); } finally { //\u91ca\u653e\u9501 this.mappingRegistry.releaseReadLock(); } } AbstractHandlerMethodMapping\u7684getHandler\u65b9\u6cd5\u8c03\u7528\u4e86getHandlerInternal\u6765\u83b7\u5f97HandlerMethod\u5bf9\u8c61\uff0c\u5728getHandlerInternal\u65b9\u6cd5\u4e2d\u5148mappingRegistry\u5bf9\u8c61\u6dfb\u52a0\u8bfb\u9501\uff0c\u63a5\u7740\u8c03\u7528lookupHandlerMethod\u6765\u83b7\u5f97\u5177\u4f53\u7684HandlerMethod\uff0c\u4ece\u4e4b\u524d\u7684\u5206\u6790\u4e2d\u6211\u4eec\u77e5\u9053\u4e86HandlerMethod\u7531MappingRegister\u4e2d\u8fdb\u884c\u4e86\u7f13\u5b58\uff0c\u6240\u4ee5lookupHandlerMethod\u5f88\u53ef\u80fd\u662f\u5728\u7f13\u5b58\u4e2d\u5bfb\u627e\u5bf9\u5e94\u7684HandlerMethod\uff0c\u65b9\u6cd5\u5982\u4e0b\uff1a protected HandlerMethod lookupHandlerMethod(String lookupPath, HttpServletRequest request) throws Exception { List<Match> matches = new ArrayList<>(); //\u6839\u636eurl\u5728mappingRegistry\u7684urlLookup\u4e2d\u627e\u5230\u76f4\u63a5\u8def\u5f84\u5339\u914d\u7684MappingInfo List<T> directPathMatches = this.mappingRegistry.getMappingsByUrl(lookupPath); if (directPathMatches != null) { //\u5982\u679curl\u80fd\u591f\u76f4\u63a5\u5339\u914d //\u518d\u6839\u636e\u5177\u4f53\u4fe1\u606f\u627e\u5230\u6700\u5339\u914d\u7684\u65b9\u6cd5 addMatchingMappings(directPathMatches, matches, request); } if (matches.isEmpty()) { //\u5982\u679curl\u4e0d\u80fd\u76f4\u63a5\u5339\u914d\uff0c\u8fd9\u91cc\u8003\u8651\u901a\u914d\u7b26\u7684\u95ee\u9898 // No choice but to go through all mappings... addMatchingMappings(this.mappingRegistry.getMappings().keySet(), matches, request); } ... } \u4e0d\u51fa\u6240\u6599\uff0c\u5728lookupHandlerMethod\u65b9\u6cd5\u4e2d\u5148\u6839\u636e\u8bf7\u6c42\u7684url\u4fe1\u606f\uff0c\u5728mappingRegistry\u7684urlLookup\u4e2d\u521d\u6b65\u786e\u5b9a\u5339\u914d\u7684MappingInfo\uff0c\u7136\u540e\u8c03\u7528addMatchingMappings\u65b9\u6cd5\u4e2d\u8fdb\u884c\u8be6\u7ec6\u7684\u7b5b\u9009\uff0c\u627e\u51fa\u5339\u914d\u7684MappingInfo\uff1b\u5982\u679c\u5728\u76f4\u63a5\u8def\u5f84\u5339\u914d\u6ca1\u6709\u627e\u5230\u4efb\u4f55\u5339\u914d\u7684\u4fe1\u606f\uff08\u7531\u4e8e\u901a\u914d\u7b26\u7684\u539f\u56e0\uff09\uff0c\u53ea\u80fd\u904d\u5386mappingRegistry\u7684mappingLookup\u4e2d\u6240\u6709\u7684MappingInfo\u6765\u627e\u5230\u5339\u914d\u7684\u4fe1\u606f\u3002addMatchingMappings\u65b9\u6cd5\u5982\u4e0b\uff1a private void addMatchingMappings(Collection<T> mappings, List<Match> matches, HttpServletRequest request) { for (T mapping : mappings) { //\u8fdb\u884c\u8be6\u7ec6\u7684\u5339\u914d\u5224\u65ad T match = getMatchingMapping(mapping, request); if (match != null) { matches.add(new Match(match, this.mappingRegistry.getMappings().get(mapping))); } } } //\u5728RequestMappingInfoHandlerMapping\u5b9e\u73b0 protected RequestMappingInfo getMatchingMapping(RequestMappingInfo info, HttpServletRequest request) { return info.getMatchingCondition(request); } //\u6700\u7ec8\u8c03\u7528\u4e86RequestMappingInfo\u7684getMatchingCondition\u65b9\u6cd5 public RequestMappingInfo getMatchingCondition(HttpServletRequest request) { RequestMethodsRequestCondition methods = this.methodsCondition.getMatchingCondition(request); ParamsRequestCondition params = this.paramsCondition.getMatchingCondition(request); HeadersRequestCondition headers = this.headersCondition.getMatchingCondition(request); ConsumesRequestCondition consumes = this.consumesCondition.getMatchingCondition(request); ProducesRequestCondition produces = this.producesCondition.getMatchingCondition(request); if (methods == null || params == null || headers == null || consumes == null || produces == null) { return null; } PatternsRequestCondition patterns = this.patternsCondition.getMatchingCondition(request); if (patterns == null) { return null; } RequestConditionHolder custom = this.customConditionHolder.getMatchingCondition(request); if (custom == null) { return null; } return new RequestMappingInfo(this.name, patterns, methods, params, headers, consumes, produces, custom.getCondition()); } \u4ece\u4e0a\u9762\u7684\u4ee3\u7801\u53ef\u4ee5\u770b\u51fa\uff0c\u5728addMatchingMappings\u4e2d\u8c03\u7528getMatchingMapping\u65b9\u6cd5\u5bf9\u5339\u914d\u4fe1\u606f\u8fdb\u884c\u7cbe\u786e\u5224\u65ad\uff0c\u5982\u679c\u5224\u65ad\u901a\u8fc7\u5219\u52a0\u5165\u5230\u7ed3\u679c\u96c6\u5408\u4e2d\u3002\u6700\u7ec8\u5c06\u8c03\u7528\u5230RequestMappingInfo\u7684getMatchingCondition\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u5bf97\u4e2a\u8981\u7d20\u8fdb\u884c\u4e86\u5339\u914d\u5224\u65ad\uff1a methods : \u8bf7\u6c42\u65b9\u6cd5\u5339\u914d\uff08POST/GET/DELETE/PUT\u7b49\u7b49)\uff0c\u5bf9\u5e94RequestMapping\u6ce8\u89e3\u7684method params : \u8bf7\u6c42\u53c2\u6570\u5339\u914d \u4f8b\u5982myParam=myValue, \u5bf9\u5e94RequestMapping\u6ce8\u89e3\u7684params headers:\u8bf7\u6c42\u5934\u4fe1\u606f(\u4f8b\u5982\uff1aMy-Header!=myValue\uff09\uff0c\u5bf9\u5e94RequestMapping\u7684headers consumes:\u63d0\u4ea4\u5185\u5bb9\u7c7b\u578b(\u4f8b\u5982:application/json, text/html;),\u5bf9\u5e94RequestMapping\u7684consumes produces:\u8fd4\u56de\u7684\u5185\u5bb9\u7c7b\u578b(\u4f8b\u5982:application/json),\u5bf9\u5e94RequestMapping\u7684consumes patterns:URL\u683c\u5f0f(\u4f8b\u5982:test/testDo),\u5bf9\u5e94RequestMapping\u7684value \u81ea\u5b9a\u4e49\u6761\u4ef6 \u5168\u90e8\u8981\u7d20\u90fd\u901a\u8fc7\u5224\u65ad\u540e\u65b0\u5efa\u4e00\u4e2aRequestMappingInfo\u526f\u672c\u8fd4\u56de\u3002 \u627e\u5230\u4e00\u4e2aurl\u5339\u914d\u7684\u6240\u6709\u65b9\u6cd5\u540e\uff0c\u4f1a\u5bf9\u5339\u914d\u7684\u65b9\u6cd5\u8fdb\u4e00\u6b65\u7684\u6bd4\u8f83\uff0c\u627e\u51fa\u6700\u5339\u914d\u7684\u65b9\u6cd5\uff08bestMatch\uff09\u8fd4\u56de\uff0clookupHandlerMethod\u65b9\u6cd5\u540e\u7eed\u4ee3\u7801\u5982\u4e0b\uff1a protected HandlerMethod lookupHandlerMethod(String lookupPath, HttpServletRequest request) throws Exception { List<Match> matches = new ArrayList<>(); ... if (!matches.isEmpty()) { //\u5982\u679c\u627e\u5230\u7684\u5339\u914d\u65b9\u6cd5\u6570\u91cf\u5927\u4e8e0 //\u901a\u8fc7\u5b9a\u4e49\u7684Comparator\u8fdb\u884c\u6392\u5e8f Comparator<Match> comparator = new MatchComparator(getMappingComparator(request)); matches.sort(comparator); //\u7b2c\u4e00\u4e2a\u5373\u662f\u6700\u5339\u914d\u7684\u65b9\u6cd5 Match bestMatch = matches.get(0); if (matches.size() > 1) { if (logger.isTraceEnabled()) { logger.trace(matches.size() + \" matching mappings: \" + matches); } if (CorsUtils.isPreFlightRequest(request)) { return PREFLIGHT_AMBIGUOUS_MATCH; } Match secondBestMatch = matches.get(1); if (comparator.compare(bestMatch, secondBestMatch) == 0) { Method m1 = bestMatch.handlerMethod.getMethod(); Method m2 = secondBestMatch.handlerMethod.getMethod(); String uri = request.getRequestURI(); throw new IllegalStateException( \"Ambiguous handler methods mapped for '\" + uri + \"': {\" + m1 + \", \" + m2 + \"}\"); } } request.setAttribute(BEST_MATCHING_HANDLER_ATTRIBUTE, bestMatch.handlerMethod); handleMatch(bestMatch.mapping, lookupPath, request); return bestMatch.handlerMethod; } else { //\u5426\u5219\u8fdb\u5165\u6ca1\u6709\u5339\u914d\u65b9\u6cd5\u7684\u903b\u8f91 return handleNoMatch(this.mappingRegistry.getMappings().keySet(), lookupPath, request); } } \u627e\u5230\u6700\u6700\u5339\u914d\u7684\u65b9\u6cd5\u540e\u5219\u8fd4\u56deHandlerMethod\u5bf9\u8c61\uff0c\u8ba9\u6211\u4eec\u4eceAbstractHandlerMethodMapping\u7684getHandler\u4e2d\u5f80\u4e0b\u8d70\uff0c\u540e\u7eed\u4ee3\u7801\u5982\u4e0b\uff1a public final HandlerExecutionChain getHandler(HttpServletRequest request) throws Exception { Object handler = getHandlerInternal(request); ... //\u5c06HandlerMethod\u5305\u88c5\u4e3aHandlerExecutionChain //\u6267\u884c\u7684\u64cd\u4f5c\u5c31\u662f\u5c06\u6ce8\u518c\u4e86\u5bf9\u5e94URL\u7684\u8fc7\u6ee4\u5668\u6302\u8f7d\u5230\u8be5chain\u4e2d\uff0c\u5f62\u6210\u4e00\u6761\u65b9\u6cd5\u6267\u884c\u94fe\u3002 HandlerExecutionChain executionChain = getHandlerExecutionChain(handler, request); ... //\u5224\u65ad\u662f\u5426\u662fcors\u8bf7\u6c42\uff0c\u662f\u7684\u8bdd\u6dfb\u52a0\u5bf9\u5e94\u7684\u8fc7\u6ee4\u5668 if (CorsUtils.isCorsRequest(request)) { CorsConfiguration globalConfig = this.corsConfigurationSource.getCorsConfiguration(request); CorsConfiguration handlerConfig = getCorsConfiguration(handler, request); CorsConfiguration config = (globalConfig != null ? globalConfig.combine(handlerConfig) : handlerConfig); executionChain = getCorsHandlerExecutionChain(request, executionChain, config); } return executionChain; } \u5305\u88c5\u5b8c\u6210\u540e\u7684handler\u5c06\u88ab\u56de\u5230DispatcherServlet\u7684doDispatch\u65b9\u6cd5\u4e2d\uff0c\u7ee7\u7eed\u5f80\u4e0b\u6267\u884c\uff1a protected void doDispatch(HttpServletRequest request, HttpServletResponse response) throws Exception { ... mappedHandler = getHandler(processedRequest); //\u5982\u679c\u6ca1\u627e\u5230\u5339\u914d\u7684handler\uff0c\u8c03\u7528noHandlerFound\u65b9\u6cd5\u6839\u636e\u914d\u7f6e\u629b\u51fa\u5f02\u5e38\u6216\u8005\u8fd4\u56de404\u72b6\u6001\u7801 if (mappedHandler == null) { noHandlerFound(processedRequest, response); return; } // \u6839\u636eHandler\u83b7\u5f97\u5bf9\u5e94\u7684HandlerAdapter\u5bf9\u8c61\uff08\u5373\u914d\u7f6e\u4e2d\u7684RequestMappingHandlerAdapter\uff09 HandlerAdapter ha = getHandlerAdapter(mappedHandler.getHandler()); // \u5224\u65ad\u83b7\u5f97\u7684handler\u662f\u5426\u652f\u6301last-modified\u8bf7\u6c42\u5934 String method = request.getMethod(); boolean isGet = \"GET\".equals(method); if (isGet || \"HEAD\".equals(method)) { long lastModified = ha.getLastModified(request, mappedHandler.getHandler()); if (new ServletWebRequest(request, response).checkNotModified(lastModified) && isGet) { return; } } //\u6267\u884c\u8bf7\u6c42\u8fc7\u6ee4\u5668\u7684preHandler\u65b9\u6cd5\uff0c\u8fd4\u56deTRUE\u65f6\u7ee7\u7eed\u5411\u4e0b\u6267\u884c\uff0c\u8fd4\u56deFALSE\u4ee3\u8868\u8bf7\u6c42\u88ab\u8fc7\u6ee4\u4e86\uff0c\u8fd9\u65f6\u76f4\u63a5\u8fd4\u56de if (!mappedHandler.applyPreHandle(processedRequest, response)) { return; } // \u5f00\u59cb\u771f\u6b63\u8c03\u7528\u4e86handler\u903b\u8f91 mv = ha.handle(processedRequest, response, mappedHandler.getHandler()); if (asyncManager.isConcurrentHandlingStarted()) { return; } applyDefaultViewName(processedRequest, mv); mappedHandler.applyPostHandle(processedRequest, response, mv); ... } \u5224\u65ad\u8fd4\u56de\u7684handler\u7684\u5bf9\u8c61\u662f\u5426\u4e3a\u7a7a\uff0c\u82e5handler\u4e3a\u7a7a\u5219\u629b\u51fa\u5f02\u5e38\u6216\u8005\u8fd4\u56de404\uff1b\u82e5handler\u4e0d\u4e3a\u7a7a\uff0c\u6839\u636ehandler\u83b7\u5f97\u5bf9\u5e94\u7684HandlerAdapter\u5bf9\u8c61\uff0cHandlerAdapter\u662f\u7528\u6765\u8c03\u7528HandlerMethod\u5bf9\u5e94\u7684\u65b9\u6cd5\u7684\u9002\u914d\u5668\uff0c\u5728spring\u4e2d\u5177\u4f53\u4e3aRequestMappingHandlerAdapter\uff1b\u4e4b\u540e\u4f1a\u6267\u884c\u6267\u884c\u8fc7\u6ee4\u94fe\u4e2d\u7684\u8fc7\u6ee4\u65b9\u6cd5\uff0c\u5224\u65ad\u8bf7\u6c42\u662f\u5426\u88ab\u5e94\u8be5\u8fc7\u6ee4\uff0c\u5b8c\u6210\u8fc7\u6ee4\u903b\u8f91\u4ee5\u540e\uff0c\u624d\u4f1a\u8c03\u7528HandlerAdapter\u7684handle\u65b9\u6cd5\u5f00\u59cb\u771f\u6b63\u7684\u65b9\u6cd5\u8c03\u7528\u3002 //\u5728AbstractHandlerMethodAdapter\u7684\u5b9e\u73b0 public final ModelAndView handle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { return handleInternal(request, response, (HandlerMethod) handler); } \u5728handle\u65b9\u6cd5\u4e2d\u5c06 HandlerExecutionChain\u5f3a\u8f6c\u56de HandlerMethod \u5bf9\u8c61\uff0c\u5e76\u4f20\u9012\u7ed9\u5b50\u7c7b\uff08RequestMappingHandlerAdapter\uff09\u7684 handlerInternal \u65b9\u6cd5\u6765\u8fdb\u884c\u540e\u7eed\u5904\u7406\u3002 protected ModelAndView handleInternal(HttpServletRequest request, HttpServletResponse response, HandlerMethod handlerMethod) throws Exception { ModelAndView mav; // \u5224\u65ad\u8bf7\u6c42\u7c7b\u578b\u662f\u5426\u88ab\u652f\u6301\u4ee5\u53ca\u8bf7\u6c42\u662f\u5426\u9700\u8981session checkRequest(request); // \u5224\u65adinvokeHandlerMethod\u65b9\u6cd5\u662f\u5426\u9700\u8981\u5728\u540c\u6b65\u5757\u4e2d\u6267\u884c if (this.synchronizeOnSession) { HttpSession session = request.getSession(false); if (session != null) { Object mutex = WebUtils.getSessionMutex(session); synchronized (mutex) { mav = invokeHandlerMethod(request, response, handlerMethod); } } else { mav = invokeHandlerMethod(request, response, handlerMethod); } } else { mav = invokeHandlerMethod(request, response, handlerMethod); } if (!response.containsHeader(HEADER_CACHE_CONTROL)) { if (getSessionAttributesHandler(handlerMethod).hasSessionAttributes()) { applyCacheSeconds(response, this.cacheSecondsForSessionAttributeHandlers); } else { prepareResponse(response); } } return mav; } \u53ef\u4ee5\u770b\u51fa\u8be5\u65b9\u6cd5\u7684\u4e3b\u8981\u4f5c\u7528\u5c31\u662f\u5bf9\u5f53\u524d\u8bf7\u6c42\u8fdb\u884c\u4e00\u4e9b\u5224\u65ad\u4e0e\u5904\u7406\uff0c\u7136\u540e\u8c03\u7528\u6700\u91cd\u8981\u7684\u65b9\u6cd5invokeHandlerMethod\uff0c\u8fd9\u91cc\u5c31\u4e0d\u6df1\u5165\u8be5\u65b9\u6cd5\u7684\u903b\u8f91\u4e86\uff08\u4ee5\u540e\u6709\u65f6\u95f4\u518d\u7814\u7a76\u5427\u3002\u3002\u3002\uff09\uff0c\u53ea\u5bf9\u8be5\u65b9\u6cd5\u8fdb\u884c\u7b80\u5355\u7684\u8bf4\u660e\u3002\u5728\u540e\u7eed\u6267\u884c\u8fc7\u7a0b\u4e2d\u4f1a\u5148\u5bf9\u65b9\u6cd5\u4f20\u5165\u53c2\u6570\u8fdb\u884c\u89e3\u6790\u548c\u5339\u914d\uff0c\u5982\u679c\u6ca1\u6709\u5339\u914d\u5230\u5408\u9002\u7684\u503c\u5c31\u4f1a\u629b\u51fa\u5f02\u5e38\u3002\u4e00\u4e2a\u5178\u578b\u7684\u4f8b\u5b50\u4fbf\u662f @RequestParam \u6ce8\u89e3\uff0c\u5982\u679c\u4f60\u52a0\u4e86\u8fd9\u4e2a\u6ce8\u89e3\uff0c\u90a3\u4e48\u53c2\u6570\u540d\u5fc5\u987b\u4e0e\u8868\u5355\u540d\u4e00\u81f4\uff0c\u5426\u5219\u4f1a\u62a5\u9519\u3002\u4e4b\u540e\u4f1a\u901a\u8fc7\u53cd\u5c04\u8c03\u7528\u5230\u5177\u4f53\u7684Controller\u65b9\u6cd5\uff0c\u6700\u540e\u4f1a\u5bf9\u65b9\u6cd5\u8fd4\u56de\u7684\u7ed3\u679c\u8fdb\u884c\u5904\u7406\uff0c\u4f8b\u5982\u5bf9\u6dfb\u52a0\u4e86@ResponseBody\u6ce8\u89e3\u7684\u65b9\u6cd5\uff0c\u4f1a\u5bf9\u5176\u8fd4\u56de\u503c\u8fdb\u884cjson\u5316\u5e76\u5c06\u5176\u5199\u5165 responseBody \u4e2d\u3002","title":"DispatcherServlet"},{"location":"Spring/Spring\u57fa\u7840\u77e5\u8bc6/DispatcherServlet\u6e90\u7801\u5206\u6790/#_1","text":"1. http://ddrv.cn/a/58528 2. https://www.jianshu.com/p/ef15e524458e","title":"\u53c2\u8003"},{"location":"Web/Servlet\u6982\u8ff0/","text":"Servlet\u7b14\u8bb0 1.1\u4ec0\u4e48\u662fservlet Servlet\u662fsun\u516c\u53f8\u5236\u5b9a\u7684\u4e00\u79cd\u7528\u6765\u6269\u5c55web\u670d\u52a1\u5668\u529f\u80fd\u7684\u7ec4\u4ef6\u6807\u51c6\uff08\u670d\u52a1\u5668\u7aef\u7684Java\u5e94\u7528\u7a0b\u5e8f\uff09\u3002\u72ed\u4e49\u7684Servlet\u662f\u6307Java\u63a5\u53e3\uff0c\u5e7f\u4e49\u7684Servlet\u662f\u6307\u4efb\u4f55\u5b9e\u73b0\u4e86\u8fd9\u4e2aServlet\u63a5\u53e3\u7684\u7c7b\uff0c\u5b83\u8fd0\u884c\u5728 Web \u670d\u52a1\u5668\u6216\u5e94\u7528\u670d\u52a1\u5668\u4e0a\uff0c\u4f5c\u4e3a\u6765\u81ea Web \u6d4f\u89c8\u5668\u6216\u5176\u4ed6 HTTP \u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u548c HTTP \u670d\u52a1\u5668\u4e0a\u7684\u6570\u636e\u5e93\u6216\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u7684\u4e2d\u95f4\u5c42\u3002 1.2Servlet\u4e0eServlet\u5bb9\u5668\u7684\u5173\u7cfb Servlet\u4e0eServlet\u5bb9\u5668\u7684\u5173\u7cfb\u5c31\u50cf\u67aa\u4e0e\u5b50\u5f39\u7684\u5173\u7cfb\uff0cServlet\u5bb9\u5668\u662f\u4e3aServlet\u800c\u8bbe\u8ba1\u7684\uff0c\u4f7fServlet\u66f4\u52a0\u6613\u7528\u548c\u5f3a\u5927\uff1b\u4e24\u8005\u76f8\u4e92\u4f9d\u5b58\u53c8\u72ec\u7acb\u53d1\u5c55\uff0c\u8fd9\u4e00\u5207\u90fd\u662f\u4e3a\u4e86\u9002\u5e94\u5de5\u4e1a\u5316\u751f\u4ea7\u7684\u7ed3\u679c\u3002\u4ece\u6280\u672f\u89d2\u5ea6\u6765\u8bf4\u662f\u4e3a\u4e86\u89e3\u8026\uff0c\u901a\u8fc7\u6807\u51c6\u5316\u63a5\u53e3\u6765\u76f8\u4e92\u534f\u4f5c\u3002Servlet\u5bb9\u5668\u7684\u4f5c\u7528\u4e3b\u8981\u5305\u62ec\u4ee5\u4e0b\u51e0\u70b9\uff1a \u4f5c\u4e3aWeb\u5de5\u7a0b\u7684\u5165\u53e3\uff0c\u52a0\u8f7d\u548c\u542f\u52a8WEB\u7a0b\u5e8f \u5728\u542f\u52a8WEB\u9879\u76ee\u8fc7\u7a0b\u4e2d\u89e3\u6790\u548c\u52a0\u8f7dweb.xml\u4e2d\u914d\u7f6e\u7684Servlet\u5bf9\u8c61 \u5c06\u5ba2\u6237\u7aef\u8bf7\u6c42\u5206\u914d\u5230\u6307\u5b9a\u7684Servlet \u7ba1\u7406Servlet\u7684\u751f\u547d\u5468\u671f Servlet \u5bb9\u5668\u4f5c\u4e3a\u4e00\u4e2a\u72ec\u7acb\u53d1\u5c55\u7684\u6807\u51c6\u5316\u4ea7\u54c1\uff0c\u76ee\u524d\u5b83\u7684\u79cd\u7c7b\u5f88\u591a\uff0c\u4f46\u662f\u5b83\u4eec\u90fd\u6709\u81ea\u5df1\u7684\u5e02\u573a\u5b9a\u4f4d\uff0c\u5f88\u96be\u8bf4\u8c01\u4f18\u8c01\u52a3\uff0c\u5404\u6709\u7279\u70b9\u3002\u4e0b\u6587\u5c06\u4ee5\u5927\u5bb6\u6bd4\u8f83\u719f\u6089\u7684Servlet\u5bb9\u5668Tomcat\u4e3a\u4f8b\u8bf4\u660eServlet\u5bb9\u5668\u5982\u4f55\u5bf9Servlet\u8fdb\u884c\u7ba1\u7406\u3002 \u5728Tomcat\u5bb9\u5668\u5bb9\u5668\u7b49\u7ea7\u4e2d\uff0cServlet\u88ab\u5c01\u88c5\u5728\u5305\u88c5\u7c7b Wrapper \u4e2d\u7531Context\u5bb9\u5668\u6765\u76f4\u63a5\u7ba1\u7406\uff0c\u4e00\u4e2aContext\u5bf9\u5e94\u4e00\u4e2aWEB\u5de5\u7a0b\u56e0\u6b64Context\u5bb9\u5668\u7684\u5982\u4f55\u8fd0\u884c\u5c06\u76f4\u63a5\u5f71\u54cdServlet\u7684\u5de5\u4f5c\u65b9\u5f0f\u3002 ![Tomcat \u5bb9\u5668\u6a21\u578b](images/tomcatmodel.png)Tomcat \u5bb9\u5668\u6a21\u578b 1.2Servlet\u5bb9\u5668\u7684\u542f\u52a8 \u672c\u8282\u4ee5\u5927\u5bb6\u6bd4\u8f83\u719f\u6089\u7684Servlet\u5bb9\u5668Tomcat\u4e3a\u4f8b\uff0c\u4ecb\u7ecdTomcat\u7684\u542f\u52a8\u65b9\u5f0f\u4ee5\u53ca\u542f\u52a8\u8fc7\u7a0b\u3002 1.2.1Tomcat\u7684\u542f\u52a8\u65b9\u5f0f \u6267\u884cTomcat\u811a\u672c \u5728\u672c\u5730\u5b89\u88c5\u597dTomcat\u4ee5\u540e\uff0c\u5c06WEB\u5de5\u7a0b\u751f\u6210\u7684war\u5305\u653e\u5728Tomcat\u5b89\u88c5\u76ee\u5f55\u7684 webapps \u76ee\u5f55\u4e0b\uff0c\u8fd0\u884c bin \u76ee\u5f55\u4e0b\u7684startup.bat\u6216startup.sh\u811a\u672c\u3002Tomcat\u4f1a\u6839\u636e conf \u76ee\u5f55\u4e0b\u7684xml\u914d\u7f6e\u6587\u4ef6\uff08\u4e3b\u8981\u662fserver.xml\uff09\u6765\u542f\u52a8web\u5bb9\u5668\uff0c\u89e3\u538b webapps \u76ee\u4e0b\u7684tar\u5305\uff0c\u5e76\u52a0\u8f7d\u548c\u7ba1\u7406\u76f8\u5e94\u7684\u9879\u76ee\u3002 \u5d4c\u5165\u5f0f Tomcat7\u5f00\u59cb\u652f\u6301\u5d4c\u5165\u5f0f\u529f\u80fd\uff0c\u589e\u52a0\u4e86\u4e00\u4e2a\u542f\u52a8\u7c7b org.apache.catalina.startup.Tomcat \u3002\u521b\u5efa\u5e76\u8c03\u7528 Tomcat \u5bf9\u8c61\u7684start\u65b9\u6cd5\u5c31\u80fd\u5bb9\u6613\u5730\u542f\u52a8\u4e00\u4e2atomcat\u9879\u76ee\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u5bf9\u8c61\u6765\u589e\u52a0\u548c\u4fee\u6539 Tomcat \u7684\u914d\u7f6e\u53c2\u6570\u3002\u4e0b\u6587\u5c06\u4f1a\u8be6\u7ec6\u5730\u4ecb\u7ecd\u6b64\u65b9\u5f0f\u3002 maven\u63d2\u4ef6 \u53ef\u4ee5\u5728maven\u4e2d\u4f7f\u7528Tomcat\u63d2\u4ef6\u6765\u542f\u52a8Tomcat\uff0c\u914d\u7f6e\u5982\u4e0b\uff1a xml <plugin> <groupId>org.apache.tomcat.maven</groupId> <artifactId>tomcat7-maven-plugin</artifactId> <version>2.2</version> <configuration> <port>8080</port> <path>/${project.artifactId}</path> <uriEncoding>UTF-8</uriEncoding> </configuration> </plugin> \u63a5\u7740\u5728\u547d\u4ee4\u884c\u6267\u884c mvn tomcat7:run \u542f\u52a8Tomcat\u3002 \u8bf4\u660e \u4f7f\u7528maven\u63d2\u4ef6\u542f\u52a8\u867d\u7136\u6bd4\u8f83\u65b9\u4fbf\uff0c\u4f46\u662f\u53ea\u652f\u6301\u8f83\u4f4e\u7248\u672c\u7684Tomcat\u3002 1.2.2Tomcat\u7684\u542f\u52a8\u8fc7\u7a0b \u53c2\u8003 https://www.cnblogs.com/whgk/p/6399262.html https://www.ibm.com/developerworks/cn/java/j-lo-servlet/ https://www.cnblogs.com/zhouyuqin/p/5143121.html <==To be continue...","title":"Servlet\u7b14\u8bb0"},{"location":"Web/Servlet\u6982\u8ff0/#servlet","text":"","title":"Servlet\u7b14\u8bb0"},{"location":"Web/Servlet\u6982\u8ff0/#11servlet","text":"Servlet\u662fsun\u516c\u53f8\u5236\u5b9a\u7684\u4e00\u79cd\u7528\u6765\u6269\u5c55web\u670d\u52a1\u5668\u529f\u80fd\u7684\u7ec4\u4ef6\u6807\u51c6\uff08\u670d\u52a1\u5668\u7aef\u7684Java\u5e94\u7528\u7a0b\u5e8f\uff09\u3002\u72ed\u4e49\u7684Servlet\u662f\u6307Java\u63a5\u53e3\uff0c\u5e7f\u4e49\u7684Servlet\u662f\u6307\u4efb\u4f55\u5b9e\u73b0\u4e86\u8fd9\u4e2aServlet\u63a5\u53e3\u7684\u7c7b\uff0c\u5b83\u8fd0\u884c\u5728 Web \u670d\u52a1\u5668\u6216\u5e94\u7528\u670d\u52a1\u5668\u4e0a\uff0c\u4f5c\u4e3a\u6765\u81ea Web \u6d4f\u89c8\u5668\u6216\u5176\u4ed6 HTTP \u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u548c HTTP \u670d\u52a1\u5668\u4e0a\u7684\u6570\u636e\u5e93\u6216\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u7684\u4e2d\u95f4\u5c42\u3002","title":"1.1\u4ec0\u4e48\u662fservlet"},{"location":"Web/Servlet\u6982\u8ff0/#12servletservlet","text":"Servlet\u4e0eServlet\u5bb9\u5668\u7684\u5173\u7cfb\u5c31\u50cf\u67aa\u4e0e\u5b50\u5f39\u7684\u5173\u7cfb\uff0cServlet\u5bb9\u5668\u662f\u4e3aServlet\u800c\u8bbe\u8ba1\u7684\uff0c\u4f7fServlet\u66f4\u52a0\u6613\u7528\u548c\u5f3a\u5927\uff1b\u4e24\u8005\u76f8\u4e92\u4f9d\u5b58\u53c8\u72ec\u7acb\u53d1\u5c55\uff0c\u8fd9\u4e00\u5207\u90fd\u662f\u4e3a\u4e86\u9002\u5e94\u5de5\u4e1a\u5316\u751f\u4ea7\u7684\u7ed3\u679c\u3002\u4ece\u6280\u672f\u89d2\u5ea6\u6765\u8bf4\u662f\u4e3a\u4e86\u89e3\u8026\uff0c\u901a\u8fc7\u6807\u51c6\u5316\u63a5\u53e3\u6765\u76f8\u4e92\u534f\u4f5c\u3002Servlet\u5bb9\u5668\u7684\u4f5c\u7528\u4e3b\u8981\u5305\u62ec\u4ee5\u4e0b\u51e0\u70b9\uff1a \u4f5c\u4e3aWeb\u5de5\u7a0b\u7684\u5165\u53e3\uff0c\u52a0\u8f7d\u548c\u542f\u52a8WEB\u7a0b\u5e8f \u5728\u542f\u52a8WEB\u9879\u76ee\u8fc7\u7a0b\u4e2d\u89e3\u6790\u548c\u52a0\u8f7dweb.xml\u4e2d\u914d\u7f6e\u7684Servlet\u5bf9\u8c61 \u5c06\u5ba2\u6237\u7aef\u8bf7\u6c42\u5206\u914d\u5230\u6307\u5b9a\u7684Servlet \u7ba1\u7406Servlet\u7684\u751f\u547d\u5468\u671f Servlet \u5bb9\u5668\u4f5c\u4e3a\u4e00\u4e2a\u72ec\u7acb\u53d1\u5c55\u7684\u6807\u51c6\u5316\u4ea7\u54c1\uff0c\u76ee\u524d\u5b83\u7684\u79cd\u7c7b\u5f88\u591a\uff0c\u4f46\u662f\u5b83\u4eec\u90fd\u6709\u81ea\u5df1\u7684\u5e02\u573a\u5b9a\u4f4d\uff0c\u5f88\u96be\u8bf4\u8c01\u4f18\u8c01\u52a3\uff0c\u5404\u6709\u7279\u70b9\u3002\u4e0b\u6587\u5c06\u4ee5\u5927\u5bb6\u6bd4\u8f83\u719f\u6089\u7684Servlet\u5bb9\u5668Tomcat\u4e3a\u4f8b\u8bf4\u660eServlet\u5bb9\u5668\u5982\u4f55\u5bf9Servlet\u8fdb\u884c\u7ba1\u7406\u3002 \u5728Tomcat\u5bb9\u5668\u5bb9\u5668\u7b49\u7ea7\u4e2d\uff0cServlet\u88ab\u5c01\u88c5\u5728\u5305\u88c5\u7c7b Wrapper \u4e2d\u7531Context\u5bb9\u5668\u6765\u76f4\u63a5\u7ba1\u7406\uff0c\u4e00\u4e2aContext\u5bf9\u5e94\u4e00\u4e2aWEB\u5de5\u7a0b\u56e0\u6b64Context\u5bb9\u5668\u7684\u5982\u4f55\u8fd0\u884c\u5c06\u76f4\u63a5\u5f71\u54cdServlet\u7684\u5de5\u4f5c\u65b9\u5f0f\u3002 ![Tomcat \u5bb9\u5668\u6a21\u578b](images/tomcatmodel.png)Tomcat \u5bb9\u5668\u6a21\u578b","title":"1.2Servlet\u4e0eServlet\u5bb9\u5668\u7684\u5173\u7cfb"},{"location":"Web/Servlet\u6982\u8ff0/#12servlet","text":"\u672c\u8282\u4ee5\u5927\u5bb6\u6bd4\u8f83\u719f\u6089\u7684Servlet\u5bb9\u5668Tomcat\u4e3a\u4f8b\uff0c\u4ecb\u7ecdTomcat\u7684\u542f\u52a8\u65b9\u5f0f\u4ee5\u53ca\u542f\u52a8\u8fc7\u7a0b\u3002","title":"1.2Servlet\u5bb9\u5668\u7684\u542f\u52a8"},{"location":"Web/Servlet\u6982\u8ff0/#121tomcat","text":"\u6267\u884cTomcat\u811a\u672c \u5728\u672c\u5730\u5b89\u88c5\u597dTomcat\u4ee5\u540e\uff0c\u5c06WEB\u5de5\u7a0b\u751f\u6210\u7684war\u5305\u653e\u5728Tomcat\u5b89\u88c5\u76ee\u5f55\u7684 webapps \u76ee\u5f55\u4e0b\uff0c\u8fd0\u884c bin \u76ee\u5f55\u4e0b\u7684startup.bat\u6216startup.sh\u811a\u672c\u3002Tomcat\u4f1a\u6839\u636e conf \u76ee\u5f55\u4e0b\u7684xml\u914d\u7f6e\u6587\u4ef6\uff08\u4e3b\u8981\u662fserver.xml\uff09\u6765\u542f\u52a8web\u5bb9\u5668\uff0c\u89e3\u538b webapps \u76ee\u4e0b\u7684tar\u5305\uff0c\u5e76\u52a0\u8f7d\u548c\u7ba1\u7406\u76f8\u5e94\u7684\u9879\u76ee\u3002 \u5d4c\u5165\u5f0f Tomcat7\u5f00\u59cb\u652f\u6301\u5d4c\u5165\u5f0f\u529f\u80fd\uff0c\u589e\u52a0\u4e86\u4e00\u4e2a\u542f\u52a8\u7c7b org.apache.catalina.startup.Tomcat \u3002\u521b\u5efa\u5e76\u8c03\u7528 Tomcat \u5bf9\u8c61\u7684start\u65b9\u6cd5\u5c31\u80fd\u5bb9\u6613\u5730\u542f\u52a8\u4e00\u4e2atomcat\u9879\u76ee\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u5bf9\u8c61\u6765\u589e\u52a0\u548c\u4fee\u6539 Tomcat \u7684\u914d\u7f6e\u53c2\u6570\u3002\u4e0b\u6587\u5c06\u4f1a\u8be6\u7ec6\u5730\u4ecb\u7ecd\u6b64\u65b9\u5f0f\u3002 maven\u63d2\u4ef6 \u53ef\u4ee5\u5728maven\u4e2d\u4f7f\u7528Tomcat\u63d2\u4ef6\u6765\u542f\u52a8Tomcat\uff0c\u914d\u7f6e\u5982\u4e0b\uff1a xml <plugin> <groupId>org.apache.tomcat.maven</groupId> <artifactId>tomcat7-maven-plugin</artifactId> <version>2.2</version> <configuration> <port>8080</port> <path>/${project.artifactId}</path> <uriEncoding>UTF-8</uriEncoding> </configuration> </plugin> \u63a5\u7740\u5728\u547d\u4ee4\u884c\u6267\u884c mvn tomcat7:run \u542f\u52a8Tomcat\u3002 \u8bf4\u660e \u4f7f\u7528maven\u63d2\u4ef6\u542f\u52a8\u867d\u7136\u6bd4\u8f83\u65b9\u4fbf\uff0c\u4f46\u662f\u53ea\u652f\u6301\u8f83\u4f4e\u7248\u672c\u7684Tomcat\u3002","title":"1.2.1Tomcat\u7684\u542f\u52a8\u65b9\u5f0f"},{"location":"Web/Servlet\u6982\u8ff0/#122tomcat","text":"","title":"1.2.2Tomcat\u7684\u542f\u52a8\u8fc7\u7a0b"},{"location":"Web/Servlet\u6982\u8ff0/#_1","text":"https://www.cnblogs.com/whgk/p/6399262.html https://www.ibm.com/developerworks/cn/java/j-lo-servlet/ https://www.cnblogs.com/zhouyuqin/p/5143121.html <==To be continue...","title":"\u53c2\u8003"},{"location":"Work-related/Ovirt/[OvirtEngine]Dao\u5c42\u6d4b\u8bd5/","text":"1.Ovirt\u4e2d\u7684Dao\u5c42\u6d4b\u8bd5\u76f8\u5173 engine\u4e2d BaseDaoTestCase \u7c7b\u662fdao\u5c42\u5355\u5143\u6d4b\u8bd5\u7684\u57fa\u7840\u7236\u7c7b\uff0c\u901a\u8fc7Spring TestContext\u6846\u67b6\u4e3a\u5355\u5143\u6d4b\u8bd5\u7c7b\u63d0\u4f9b\u4e86\u4e0a\u4e0b\u6587\u73af\u5883\uff08dao\u5c42\u5bf9\u8c61\u3001datasource\u7b49\uff09\u5e76\u4e14\u4f7f\u7528Dbunit\u4eceXml\u6587\u4ef6\u4e2d\u52a0\u8f7d\u521d\u59cb\u6570\u636e\u5230\u6570\u636e\u5e93\uff0c\u4f7f\u6570\u636e\u5e93\u7684\u503c\u8fbe\u5230\u4e00\u4e2a\u5df2\u77e5\u72b6\u6001\u3002 1.1 Spring TestContext\u6846\u67b6 Spring\u6d4b\u8bd5\u6846\u67b6\u53ef\u4ee5\u5728\u6d4b\u8bd5\u7c7b\u4e0a\u4f7f\u7528@RunWith\u6ce8\u89e3\u6765\u6307\u5b9aRunner\uff0c\u5e76\u4e14\u914d\u5408Spring\u5176\u4ed6\u6ce8\u89e3\u6765\u4f7f\u7528\uff0c BaseDaoTestCase \u7c7b\u4f7f\u7528\u4e86\u5982\u4e0b\u6ce8\u89e3\uff1a @RunWith(SpringJUnit4ClassRunner.class) @TestExecutionListeners({ TransactionalTestExecutionListener.class, DependencyInjectionTestExecutionListener.class }) @ContextConfiguration(locations = { \"classpath:/test-beans.xml\" }) @Transactional public abstract class BaseDaoTestCase { ... } \u5404\u6ce8\u89e3\u7684\u4f5c\u7528\u8bf4\u660e\uff1a @RunWith \u6ce8\u89e3\u6307\u5b9a\u4e86 SpringJUnit4ClassRunner \u4f5c\u4e3a\u6d4b\u8bd5\u8fd0\u884c\u5668\uff0c\u8be5\u8fd0\u884c\u5668\u8d1f\u8d23\u603b\u88c5Spring TestContext\u6d4b\u8bd5\u6846\u67b6\u5e76\u5c06\u5176\u7edf\u4e00\u5230 JUnit 4.4 \u6846\u67b6\u4e2d\u3002 @TestExecutionListeners \u6ce8\u89e3\u7528\u4e8e\u914d\u7f6e\u6d4b\u8bd5\u76d1\u542c\u5668\uff08TestExecutionListener\uff09\uff0c\u6d4b\u8bd5\u76d1\u542c\u5668\u7684\u4f5c\u7528\u662f\u5728\u5bf9\u5e94\u6d4b\u8bd5\u4e8b\u4ef6\u53d1\u751f\u65f6\u8d77\u4f5c\u7528\u3002 DependencyInjectionTestExecutionListener.class \u8d1f\u8d23\u89e3\u6790\u81ea\u52a8\u6ce8\u5165\u76f8\u5173\u7684\u6ce8\u89e3\uff08@Autowire\u3001@Inject\uff09\uff0c\u4e3a\u4f9d\u8d56\u6ce8\u5165\u548c\u6d4b\u8bd5\u5b9e\u4f8b\u7684\u521d\u59cb\u5316\u63d0\u4f9b\u652f\u6301\u3002 TransactionalTestExecutionListener.class \u8d1f\u8d23\u89e3\u6790\u4e8b\u52a1\u76f8\u5173\u7684\u6ce8\u89e3\uff08@Transactional\u3001@Rollback\uff09\uff0c\u786e\u4fdd\u6240\u6709\u7684\u6d4b\u8bd5\u7528\u4f8b\u5728\u4e8b\u52a1\u5185\u6267\u884c\uff0c\u5e76\u5728\u4e8b\u52a1\u5b8c\u6210\u65f6\u81ea\u52a8\u56de\u6eda\u6d4b\u8bd5\u3002 @ContextConfiguration \u6ce8\u89e3\u7528\u4e8e\u52a0\u8f7d\u6307\u5b9a\u7684Spring\u914d\u7f6e\u6587\u4ef6\u3002 @Transactional \u4f7f\u6240\u6709\u7684\u6d4b\u8bd5\u7528\u4f8b\u5728\u4e8b\u52a1\u4e2d\u6267\u884c\u3002 1.2 \u521d\u59cb\u5316\u6d4b\u8bd5\u6761\u4ef6 BaseDaoTestCase \u4f5c\u4e3a\u6240\u6709dao\u5c42\u6d4b\u8bd5\u7c7b\u7684\u7236\u7c7b\u4e3b\u8981\u8d1f\u8d23\u521d\u59cb\u5316\u5de5\u4f5c\uff0c\u5305\u62ec\u521b\u5efa\u6570\u636e\u6e90\u3001\u6839\u636exml\u6587\u4ef6\u521d\u59cb\u5316\u6d4b\u8bd5\u6570\u636e\u5e93\u4ee5\u53ca\u4f7f\u7528JNDI\u7ed1\u5b9a\u6570\u636e\u6e90\u3002 @BeforeClass public static void initTestCase() throws Exception { if(dataSource == null) { try { //\u901a\u8fc7\u8bfb\u53d6properties\u6587\u4ef6\u6765\u83b7\u5f97\u8fde\u63a5\u53c2\u6570 dataSource = createDataSource(); //\u4f7f\u7528Dbunit\u6765\u521d\u59cb\u5316\u6570\u636e\u5e93 final IDataSet dataset = initDataSet(); DatabaseOperation.CLEAN_INSERT.execute(getConnection(), dataset); //\u5c06dataSource\u7ed1\u5b9a\u5230JDNI SimpleNamingContextBuilder builder = new SimpleNamingContextBuilder(); builder.bind(\"java:/ENGINEDataSource\", dataSource); builder.activate(); initialized = true; } catch (Exception e) { LoggerFactory.getLogger(BaseDaoTestCase.class).error(\"Unable to init tests\", e); throw new AssertionError(\"Unable to init tests\", e); } } } @Before public void setUp() throws Exception { } \u5176\u4e2d\u9700\u8981\u6ce8\u610f\u4ee5\u4e0b\u51e0\u70b9\uff1a @BeforeClass\u6ce8\u89e3\u5728\u6574\u4e2a\u6d4b\u8bd5\u8fc7\u7a0b\u4e2d\u53ea\u6267\u884c\u4e00\u6b21\uff0c\u5e76\u4e14\u88ab\u8be5\u6ce8\u89e3\u6807\u8bb0\u7684\u65b9\u6cd5\u53ea\u80fd\u88ab static void \u4fee\u9970\uff1b \u6d4b\u8bd5\u7a0b\u5e8f\u521d\u59cb\u5316\u548c\u6267\u884c\u7684\u987a\u5e8f\u4e3a\uff1a\u6267\u884c@BeforeClass\u6ce8\u89e3\u6807\u8bb0\u7684\u65b9\u6cd5->\u52a0\u8f7d@ContextConfiguration\u6307\u5b9a\u6587\u4ef6\u4e2d\u7684bean\u5bf9\u8c61->\u6267\u884c@Test\u6ce8\u89e3\u6807\u8bb0\u7684\u6d4b\u8bd5\u7528\u4f8b\uff0c\u6240\u4ee5\u5728@BeforeClass\u6807\u8bb0\u7684\u65b9\u6cd5\u4e2d\u4e0d\u80fd\u4f7f\u7528\u6ce8\u5165\u7684\u5bf9\u8c61\uff0c\u5426\u5219\u4f1a\u62a5\u7a7a\u6307\u9488\u5f02\u5e38\uff1b @Before\u6ce8\u89e3\u6807\u8bb0\u7684\u65b9\u6cd5\u5c06\u4f1a\u5728\u6bcf\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u6267\u884c\u524d\u8fd0\u884c\u4e00\u6b21\uff0c\u8be5\u65b9\u6cd5\u5728 BaseDaoTestCase \u4e3a\u7a7a\u5b9e\u73b0\uff0c\u5f53\u5b50\u7c7b\u6709\u9700\u8981\u65f6\u53ef\u4ee5\u91cd\u5199\u8be5\u65b9\u6cd5\u3002 1.3DbFacade\u5728\u6d4b\u8bd5\u4e2d\u7684\u521d\u59cb\u5316 DbFacade \u5728engine\u4f5c\u4e3adao\u5c42\u5bf9\u8c61\u7684\u5bb9\u5668\uff0c\u8d1f\u8d23\u63d0\u4f9b\u5404\u79cddao\u5bf9\u8c61\u3002\u73b0\u5728\u5b58\u5728\u7684\u95ee\u9898\u662fengine\u6e90\u7801\u4e2d\u4f9d\u8d56\u6ce8\u5165\u4f7f\u7528\u7684\u662fCDI\uff08 JBoss Weld \uff09\uff0c\u4f46\u662f\u6d4b\u8bd5\u73af\u5883\u4f7f\u7528\u7684\u662fspring\u73af\u5883\u800cspring\u5e76\u4e0d\u652f\u6301CDI\uff0c\u53ea\u652f\u6301JSR330\uff08CDI\u517c\u5bb9JSR330\uff09\u3002 DbFacade \u5728\u6e90\u7801\u4e2d\u6ce8\u5165dao\u5bf9\u8c61\u7684\u65b9\u5f0f\u5982\u4e0b\uff1a @Inject private Instance<Dao> daos; DbFacade() { init(); } private void init() { log.info(\"Initializing the DbFacade\"); instance = this; } \u5728CDI\u4e2d@Inject\u6ce8\u89e3\u914d\u5408 Instance \u63a5\u53e3\u53ef\u4ee5\u52a8\u6001\u5730\u5c06\u6240\u6709\u5b9e\u73b0 Dao \u63a5\u53e3\u7684\u5bf9\u8c61\u4e00\u8d77\u6ce8\u5165\u3002 \u7531\u4e8e Spring \u5e76\u4e0d\u652f\u6301CDI\uff0c\u6240\u4ee5\u5728\u6d4b\u8bd5\u73af\u5883\u4e2d\u4e0d\u80fd\u901a\u8fc7\u4ee5\u4e0a\u65b9\u5f0f\u6765\u6ce8\u5165bean\uff0c\u6240\u4ee5\u53ea\u80fd\u901a\u8fc7@Configuration\u6ce8\u89e3\u7c7b\u6765\u914d\u7f6edaos\uff0c\u63d0\u4f9b DbFacade \u6240\u9700\u8981\u7684\u4f9d\u8d56\u3002 @Configuration class CdiIntegration implements BeanDefinitionRegistryPostProcessor { private ConfigurableListableBeanFactory beanFactory; @Bean public Instance<Dao> daos() { //\u901a\u8fc7spring\u7684beanFactory\u6765\u83b7\u5f97\u6240\u6709\u5b9e\u73b0Dao\u63a5\u53e3\u7684\u5bf9\u8c61 Map<String, Dao> daoMap = beanFactory.getBeansOfType(Dao.class); return new InstanceImpl(daoMap.values()); } //\u5b9e\u73b0BeanDefinitionRegistryPostProcessor\u63a5\u53e3\u540e\uff0cspring\u5bb9\u5668\u5728\u542f\u52a8\u65f6\u4f1a\u8be5\u7c7b\u88c5\u914dbeanFactory public void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) throws BeansException { this.beanFactory = beanFactory; } @Override public void postProcessBeanDefinitionRegistry(BeanDefinitionRegistry registry) throws BeansException { } private static class InstanceImpl implements Instance<Dao> { private Iterable<Dao> daos; public InstanceImpl(Iterable<Dao> daos) { super(); this.daos = daos; } @Override public Dao get() { return daos.iterator().next(); } @Override public Iterator<Dao> iterator() { return daos.iterator(); } ... } } \u4e0a\u9762\u7684\u7c7b\u901a\u8fc7@Bean\u6ce8\u89e3\u5728spring\u5bb9\u5668\u4e2d\u521b\u5efa\u4e86\u540d\u4e3adaos\u7684bean\u5bf9\u8c61\uff0c\u8fdb\u800c\u5728spring\u7684xml\u6587\u4ef6\u4e2d\u914d\u7f6e DbFacade \uff0c\u5982\u4e0b\uff1a <?xml version=\"1.0\" encoding=\"UTF-8\"?> <beans> ... <!-- depends-on\u5c5e\u6027\u6307\u5b9a\u7684Bean\u8981\u5148\u521d\u59cb\u5316\u5b8c\u6bd5\u540e\u624d\u521d\u59cb\u5316\u5f53\u524dBean --> <bean id=\"dbFacade\" class=\"org.ovirt.engine.core.dal.dbbroker.DbFacade\" depends-on=\"daos\"/> ... </beans> \u53c2\u8003 https://blog.csdn.net/beijicy/article/details/47441231?utm_source=blogxgwz2 https://blog.csdn.net/weixin_33753003/article/details/87765826","title":"[OvirtEngine]Dao\u5c42\u6d4b\u8bd5"},{"location":"Work-related/Ovirt/[OvirtEngine]Dao\u5c42\u6d4b\u8bd5/#1ovirtdao","text":"engine\u4e2d BaseDaoTestCase \u7c7b\u662fdao\u5c42\u5355\u5143\u6d4b\u8bd5\u7684\u57fa\u7840\u7236\u7c7b\uff0c\u901a\u8fc7Spring TestContext\u6846\u67b6\u4e3a\u5355\u5143\u6d4b\u8bd5\u7c7b\u63d0\u4f9b\u4e86\u4e0a\u4e0b\u6587\u73af\u5883\uff08dao\u5c42\u5bf9\u8c61\u3001datasource\u7b49\uff09\u5e76\u4e14\u4f7f\u7528Dbunit\u4eceXml\u6587\u4ef6\u4e2d\u52a0\u8f7d\u521d\u59cb\u6570\u636e\u5230\u6570\u636e\u5e93\uff0c\u4f7f\u6570\u636e\u5e93\u7684\u503c\u8fbe\u5230\u4e00\u4e2a\u5df2\u77e5\u72b6\u6001\u3002","title":"1.Ovirt\u4e2d\u7684Dao\u5c42\u6d4b\u8bd5\u76f8\u5173"},{"location":"Work-related/Ovirt/[OvirtEngine]Dao\u5c42\u6d4b\u8bd5/#11spring-testcontext","text":"Spring\u6d4b\u8bd5\u6846\u67b6\u53ef\u4ee5\u5728\u6d4b\u8bd5\u7c7b\u4e0a\u4f7f\u7528@RunWith\u6ce8\u89e3\u6765\u6307\u5b9aRunner\uff0c\u5e76\u4e14\u914d\u5408Spring\u5176\u4ed6\u6ce8\u89e3\u6765\u4f7f\u7528\uff0c BaseDaoTestCase \u7c7b\u4f7f\u7528\u4e86\u5982\u4e0b\u6ce8\u89e3\uff1a @RunWith(SpringJUnit4ClassRunner.class) @TestExecutionListeners({ TransactionalTestExecutionListener.class, DependencyInjectionTestExecutionListener.class }) @ContextConfiguration(locations = { \"classpath:/test-beans.xml\" }) @Transactional public abstract class BaseDaoTestCase { ... } \u5404\u6ce8\u89e3\u7684\u4f5c\u7528\u8bf4\u660e\uff1a @RunWith \u6ce8\u89e3\u6307\u5b9a\u4e86 SpringJUnit4ClassRunner \u4f5c\u4e3a\u6d4b\u8bd5\u8fd0\u884c\u5668\uff0c\u8be5\u8fd0\u884c\u5668\u8d1f\u8d23\u603b\u88c5Spring TestContext\u6d4b\u8bd5\u6846\u67b6\u5e76\u5c06\u5176\u7edf\u4e00\u5230 JUnit 4.4 \u6846\u67b6\u4e2d\u3002 @TestExecutionListeners \u6ce8\u89e3\u7528\u4e8e\u914d\u7f6e\u6d4b\u8bd5\u76d1\u542c\u5668\uff08TestExecutionListener\uff09\uff0c\u6d4b\u8bd5\u76d1\u542c\u5668\u7684\u4f5c\u7528\u662f\u5728\u5bf9\u5e94\u6d4b\u8bd5\u4e8b\u4ef6\u53d1\u751f\u65f6\u8d77\u4f5c\u7528\u3002 DependencyInjectionTestExecutionListener.class \u8d1f\u8d23\u89e3\u6790\u81ea\u52a8\u6ce8\u5165\u76f8\u5173\u7684\u6ce8\u89e3\uff08@Autowire\u3001@Inject\uff09\uff0c\u4e3a\u4f9d\u8d56\u6ce8\u5165\u548c\u6d4b\u8bd5\u5b9e\u4f8b\u7684\u521d\u59cb\u5316\u63d0\u4f9b\u652f\u6301\u3002 TransactionalTestExecutionListener.class \u8d1f\u8d23\u89e3\u6790\u4e8b\u52a1\u76f8\u5173\u7684\u6ce8\u89e3\uff08@Transactional\u3001@Rollback\uff09\uff0c\u786e\u4fdd\u6240\u6709\u7684\u6d4b\u8bd5\u7528\u4f8b\u5728\u4e8b\u52a1\u5185\u6267\u884c\uff0c\u5e76\u5728\u4e8b\u52a1\u5b8c\u6210\u65f6\u81ea\u52a8\u56de\u6eda\u6d4b\u8bd5\u3002 @ContextConfiguration \u6ce8\u89e3\u7528\u4e8e\u52a0\u8f7d\u6307\u5b9a\u7684Spring\u914d\u7f6e\u6587\u4ef6\u3002 @Transactional \u4f7f\u6240\u6709\u7684\u6d4b\u8bd5\u7528\u4f8b\u5728\u4e8b\u52a1\u4e2d\u6267\u884c\u3002","title":"1.1Spring TestContext\u6846\u67b6"},{"location":"Work-related/Ovirt/[OvirtEngine]Dao\u5c42\u6d4b\u8bd5/#12","text":"BaseDaoTestCase \u4f5c\u4e3a\u6240\u6709dao\u5c42\u6d4b\u8bd5\u7c7b\u7684\u7236\u7c7b\u4e3b\u8981\u8d1f\u8d23\u521d\u59cb\u5316\u5de5\u4f5c\uff0c\u5305\u62ec\u521b\u5efa\u6570\u636e\u6e90\u3001\u6839\u636exml\u6587\u4ef6\u521d\u59cb\u5316\u6d4b\u8bd5\u6570\u636e\u5e93\u4ee5\u53ca\u4f7f\u7528JNDI\u7ed1\u5b9a\u6570\u636e\u6e90\u3002 @BeforeClass public static void initTestCase() throws Exception { if(dataSource == null) { try { //\u901a\u8fc7\u8bfb\u53d6properties\u6587\u4ef6\u6765\u83b7\u5f97\u8fde\u63a5\u53c2\u6570 dataSource = createDataSource(); //\u4f7f\u7528Dbunit\u6765\u521d\u59cb\u5316\u6570\u636e\u5e93 final IDataSet dataset = initDataSet(); DatabaseOperation.CLEAN_INSERT.execute(getConnection(), dataset); //\u5c06dataSource\u7ed1\u5b9a\u5230JDNI SimpleNamingContextBuilder builder = new SimpleNamingContextBuilder(); builder.bind(\"java:/ENGINEDataSource\", dataSource); builder.activate(); initialized = true; } catch (Exception e) { LoggerFactory.getLogger(BaseDaoTestCase.class).error(\"Unable to init tests\", e); throw new AssertionError(\"Unable to init tests\", e); } } } @Before public void setUp() throws Exception { } \u5176\u4e2d\u9700\u8981\u6ce8\u610f\u4ee5\u4e0b\u51e0\u70b9\uff1a @BeforeClass\u6ce8\u89e3\u5728\u6574\u4e2a\u6d4b\u8bd5\u8fc7\u7a0b\u4e2d\u53ea\u6267\u884c\u4e00\u6b21\uff0c\u5e76\u4e14\u88ab\u8be5\u6ce8\u89e3\u6807\u8bb0\u7684\u65b9\u6cd5\u53ea\u80fd\u88ab static void \u4fee\u9970\uff1b \u6d4b\u8bd5\u7a0b\u5e8f\u521d\u59cb\u5316\u548c\u6267\u884c\u7684\u987a\u5e8f\u4e3a\uff1a\u6267\u884c@BeforeClass\u6ce8\u89e3\u6807\u8bb0\u7684\u65b9\u6cd5->\u52a0\u8f7d@ContextConfiguration\u6307\u5b9a\u6587\u4ef6\u4e2d\u7684bean\u5bf9\u8c61->\u6267\u884c@Test\u6ce8\u89e3\u6807\u8bb0\u7684\u6d4b\u8bd5\u7528\u4f8b\uff0c\u6240\u4ee5\u5728@BeforeClass\u6807\u8bb0\u7684\u65b9\u6cd5\u4e2d\u4e0d\u80fd\u4f7f\u7528\u6ce8\u5165\u7684\u5bf9\u8c61\uff0c\u5426\u5219\u4f1a\u62a5\u7a7a\u6307\u9488\u5f02\u5e38\uff1b @Before\u6ce8\u89e3\u6807\u8bb0\u7684\u65b9\u6cd5\u5c06\u4f1a\u5728\u6bcf\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u6267\u884c\u524d\u8fd0\u884c\u4e00\u6b21\uff0c\u8be5\u65b9\u6cd5\u5728 BaseDaoTestCase \u4e3a\u7a7a\u5b9e\u73b0\uff0c\u5f53\u5b50\u7c7b\u6709\u9700\u8981\u65f6\u53ef\u4ee5\u91cd\u5199\u8be5\u65b9\u6cd5\u3002","title":"1.2 \u521d\u59cb\u5316\u6d4b\u8bd5\u6761\u4ef6"},{"location":"Work-related/Ovirt/[OvirtEngine]Dao\u5c42\u6d4b\u8bd5/#13dbfacade","text":"DbFacade \u5728engine\u4f5c\u4e3adao\u5c42\u5bf9\u8c61\u7684\u5bb9\u5668\uff0c\u8d1f\u8d23\u63d0\u4f9b\u5404\u79cddao\u5bf9\u8c61\u3002\u73b0\u5728\u5b58\u5728\u7684\u95ee\u9898\u662fengine\u6e90\u7801\u4e2d\u4f9d\u8d56\u6ce8\u5165\u4f7f\u7528\u7684\u662fCDI\uff08 JBoss Weld \uff09\uff0c\u4f46\u662f\u6d4b\u8bd5\u73af\u5883\u4f7f\u7528\u7684\u662fspring\u73af\u5883\u800cspring\u5e76\u4e0d\u652f\u6301CDI\uff0c\u53ea\u652f\u6301JSR330\uff08CDI\u517c\u5bb9JSR330\uff09\u3002 DbFacade \u5728\u6e90\u7801\u4e2d\u6ce8\u5165dao\u5bf9\u8c61\u7684\u65b9\u5f0f\u5982\u4e0b\uff1a @Inject private Instance<Dao> daos; DbFacade() { init(); } private void init() { log.info(\"Initializing the DbFacade\"); instance = this; } \u5728CDI\u4e2d@Inject\u6ce8\u89e3\u914d\u5408 Instance \u63a5\u53e3\u53ef\u4ee5\u52a8\u6001\u5730\u5c06\u6240\u6709\u5b9e\u73b0 Dao \u63a5\u53e3\u7684\u5bf9\u8c61\u4e00\u8d77\u6ce8\u5165\u3002 \u7531\u4e8e Spring \u5e76\u4e0d\u652f\u6301CDI\uff0c\u6240\u4ee5\u5728\u6d4b\u8bd5\u73af\u5883\u4e2d\u4e0d\u80fd\u901a\u8fc7\u4ee5\u4e0a\u65b9\u5f0f\u6765\u6ce8\u5165bean\uff0c\u6240\u4ee5\u53ea\u80fd\u901a\u8fc7@Configuration\u6ce8\u89e3\u7c7b\u6765\u914d\u7f6edaos\uff0c\u63d0\u4f9b DbFacade \u6240\u9700\u8981\u7684\u4f9d\u8d56\u3002 @Configuration class CdiIntegration implements BeanDefinitionRegistryPostProcessor { private ConfigurableListableBeanFactory beanFactory; @Bean public Instance<Dao> daos() { //\u901a\u8fc7spring\u7684beanFactory\u6765\u83b7\u5f97\u6240\u6709\u5b9e\u73b0Dao\u63a5\u53e3\u7684\u5bf9\u8c61 Map<String, Dao> daoMap = beanFactory.getBeansOfType(Dao.class); return new InstanceImpl(daoMap.values()); } //\u5b9e\u73b0BeanDefinitionRegistryPostProcessor\u63a5\u53e3\u540e\uff0cspring\u5bb9\u5668\u5728\u542f\u52a8\u65f6\u4f1a\u8be5\u7c7b\u88c5\u914dbeanFactory public void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) throws BeansException { this.beanFactory = beanFactory; } @Override public void postProcessBeanDefinitionRegistry(BeanDefinitionRegistry registry) throws BeansException { } private static class InstanceImpl implements Instance<Dao> { private Iterable<Dao> daos; public InstanceImpl(Iterable<Dao> daos) { super(); this.daos = daos; } @Override public Dao get() { return daos.iterator().next(); } @Override public Iterator<Dao> iterator() { return daos.iterator(); } ... } } \u4e0a\u9762\u7684\u7c7b\u901a\u8fc7@Bean\u6ce8\u89e3\u5728spring\u5bb9\u5668\u4e2d\u521b\u5efa\u4e86\u540d\u4e3adaos\u7684bean\u5bf9\u8c61\uff0c\u8fdb\u800c\u5728spring\u7684xml\u6587\u4ef6\u4e2d\u914d\u7f6e DbFacade \uff0c\u5982\u4e0b\uff1a <?xml version=\"1.0\" encoding=\"UTF-8\"?> <beans> ... <!-- depends-on\u5c5e\u6027\u6307\u5b9a\u7684Bean\u8981\u5148\u521d\u59cb\u5316\u5b8c\u6bd5\u540e\u624d\u521d\u59cb\u5316\u5f53\u524dBean --> <bean id=\"dbFacade\" class=\"org.ovirt.engine.core.dal.dbbroker.DbFacade\" depends-on=\"daos\"/> ... </beans>","title":"1.3DbFacade\u5728\u6d4b\u8bd5\u4e2d\u7684\u521d\u59cb\u5316"},{"location":"Work-related/Ovirt/[OvirtEngine]Dao\u5c42\u6d4b\u8bd5/#_1","text":"https://blog.csdn.net/beijicy/article/details/47441231?utm_source=blogxgwz2 https://blog.csdn.net/weixin_33753003/article/details/87765826","title":"\u53c2\u8003"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/","text":"Engine\u63a5\u53e3\u6574\u7406 EngineApi\u63a5\u53e3\u7684\u6839\u8def\u5f84\u4e3a IP:PORT/acloudageks/api 1.\u670d\u52a1\u63a5\u53e3 1.1.\u865a\u62df\u673a 1.1.1. \u6dfb\u52a0\u865a\u62df\u673a \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e clone Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u65b0\u5efa\u7684\u865a\u62df\u673a\u662f\u5426\u72ec\u7acb\u4e8e\u6a21\u677f\u3002\u4ece\u6a21\u677f\u521b\u5efa\u865a\u62df\u673a\u65f6\uff0c\u865a\u62df\u673a\u7684\u78c1\u76d8\u53d6\u51b3\u4e8e\u6a21\u677f\u7684\u78c1\u76d8\uff0c\u5b83\u4eec\u4f7f\u7528\u5199\u65f6\u590d\u5236\u673a\u5236\uff0c\u56e0\u6b64\u53ea\u6709\u4e0e\u6a21\u677f\u4e4b\u95f4\u7684\u5dee\u5f02\u624d\u5360\u7528\u5b9e\u9645\u5b58\u50a8\u7a7a\u95f4\u3002 \u5982\u679c\u6307\u5b9a\u4e86\u6b64\u53c2\u6570\u4e14\u503c\u4e3atrue\uff0c\u5219\u5c06\u514b\u9686\u521b\u5efa\u7684\u865a\u62df\u673a\u7684\u78c1\u76d8\uff0c\u5e76\u4e14\u4e0e\u6a21\u677f\u65e0\u5173\u3002 clone_permissions Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u6a21\u677f\u6743\u9650\u662f\u5426\u590d\u5236\u5230\u65b0\u5efa\u7684\u865a\u62df\u673a name String body \u5fc5\u8981\u53c2\u6570\uff0c\u865a\u62df\u673a\u540d cluster ClusterModel body \u5fc5\u8981\u53c2\u6570\uff0c\u6307\u5b9a\u865a\u62df\u673a\u6240\u5c5e\u7684\u96c6\u7fa4\uff0c\u9700\u8981\u6307\u5b9a\u96c6\u7fa4\u7684id\u6216\u8005name\u5b57\u6bb5 template TemplateModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u901a\u8fc7\u6a21\u677f\u521b\u5efa\u865a\u62df\u673a\u65f6\u9009\u62e9\u7684\u865a\u62df\u673a\u6a21\u677f\uff0c\u9700\u8981\u6307\u5b9aid\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\u3002 snapshots Snapshots body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u901a\u8fc7\u5feb\u7167\u521b\u5efa\u865a\u62df\u673a\u65f6\uff0c\u6307\u5b9a\u7684\u865a\u62df\u673a\u5feb\u7167\u3002Snapshots\u662fSnapshot\u96c6\u5408\u7684\u6620\u5c04\uff0c\u53ea\u6301\u6709\u4e00\u4e2asnapshots\u5b57\u6bb5\u662fSnapshot\u96c6\u5408\u7684\u5f15\u7528\uff0c\u53ea\u9700\u8981\u6307\u5b9aSnapshot\u5bf9\u8c61\u7684id\u5b57\u6bb5\u3002Snapshot\u96c6\u5408\u4e2d\u53ea\u8981\u4e00\u4e2aSnapshot\u5bf9\u8c61\u5373\u53ef\uff0c\u5373\u4f7f\u4f20\u5165\u591a\u4e2a\u4e5f\u53ea\u4f1a\u4f7f\u7528\u7b2c\u4e00Snapshot\u5bf9\u8c61\u3002 initialization InitializationModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u51e0\u4e2a\u65b9\u9762\uff1a1.\u901a\u8fc7\u914d\u7f6e\u521b\u5efa\u865a\u62df\u673a\u65f6\uff0c\u6307\u5b9a\u914d\u7f6e\u7684\u5185\u5bb9\u3002\u9700\u8981\u6307\u5b9aInitializationModel\u7684configuration\u5b57\u6bb5\uff0cconfiguration\u5b57\u6bb5\u662fConfigurationModel\u7684\u5f15\u7528\uff0c\u5b83\u75312\u4e2a\u5b57\u6bb5\u7ec4\u6210\uff1atype\u5b57\u6bb5\u4ee3\u8868\u914d\u7f6e\u7684\u7c7b\u578b\uff0c\u53ea\u6709\u552f\u4e00\u7684\u503cOVF\uff1bdata\u5b57\u6bb5\u4ee3\u8868\u914d\u7f6e\u7684\u5185\u5bb9\uff0c\u5373\u865a\u62df\u673a\u7684xml\u4fe1\u606f\u3002\u53e6\u5916\u53ef\u4ee5\u6307\u5b9aInitializationModel\u7684regenerateIds\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u4e3a\u521b\u5efa\u7684\u865a\u62df\u673a\u751f\u6210\u65b0\u7684id\u30022.\u865a\u62df\u673a\u521d\u59cb\u5316\u76f8\u5173\u7684\u5185\u5bb9\uff0c\u8fd9\u4e00\u90e8\u5206\u5185\u5bb9\u592a\u591a\u4e86\uff0c\u6682\u65f6\u5148\u4e0d\u5c55\u5f00\u3002 memory Long body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u7684\u5185\u5b58\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3ab\u3002\u5f53\u8be5\u503c\u4e3a\u7a7a\u6216\u8005\u4e3a0\u65f6\uff0c\u4f7f\u7528\u9ed8\u8ba4\u5927\u5c0f10240MB\u53731G\u3002 NumOfIoThreads Integer body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u7684IO\u7ebf\u7a0b\u6570\u91cf description String body \u53ef\u9009\u53c2\u6570\uff0c\u865a\u62df\u673a\u63cf\u8ff0 cpu CpuModel body \u53ef\u9009\u53c2\u6570\uff0cCpuModel\u6709\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\uff1a1.topology\u5b57\u6bb5\u662fCpuTopologyModel\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u4e86cpu\u7684\u62d3\u6251\u7ed3\u6784\u3002CpuTopologyModel\u7684\u51e0\u4e2a\u5b57\u6bb5\uff1acores\u5b57\u6bb5\u4ee3\u8868\u4e86\u6bcf\u4e2a\u865a\u62df\u673a\u63d2\u69fd\u7684\u5185\u6838\u6570\uff1bsockets\u5b57\u6bb5\u4ee3\u8868\u4e86\u865a\u62df\u673acpu\u63d2\u69fd\u6570\u91cf\uff1bthreads\u5b57\u6bb5\u4ee3\u8868\u6bcf\u4e2a\u5185\u6838\u7684cpu\u5185\u6838\u7684\u7ebf\u7a0b\u6570\u91cf\uff0c\u53ef\u9009\u503c\u53ea\u67091\u548c2\u30022.architecture\u5b57\u6bb5\uff0c\u4ee3\u8868\u96c6\u7fa4cpu\u67b6\u6784\u3002\u53ef\u9009\u7684cpu\u67b6\u6784\u6709x86_64\u548cppc64\u30023.mode\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673acpu\u6a21\u5f0f\uff0c\u53ef\u9009\u503c\u6709CUSTOM\u3001HOST_MODEL\u3001HOST_PASSTHROUGH\u3002mode\u5b57\u6bb5\u4e3aHOST_PASSTHROUGH\u65f6\uff0c\u8868\u793a\u542f\u7528PASSTHROUGH\u4e3b\u673aCPU\u30024.cpuTune\u5b57\u6bb5\uff0c\u4ee3\u8868cpu\u56fa\u5b9a\u62d3\u6251\u7ed3\u6784\u53c2\u6570\uff0c\u662fCpuTuneModel\u5bf9\u8c61\u7684\u5f15\u7528\u3002CpuTuneModel\u53ea\u6301\u6709vcpuPins\u5b57\u6bb5\uff0c\u662fVcpuPins\u5bf9\u8c61\u7684\u5f15\u7528\u3002VcpuPins\u5bf9\u8c61\u662fVcpuPin\u96c6\u5408\u7684\u6620\u5c04\uff0c\u5176vcpuPins\u5b57\u6bb5\u662fVcpuPin\u5bf9\u8c61\u5217\u8868\u7684\u5f15\u7528\u3002VcpuPin\u6709\u4ee5\u4e0b2\u4e2a\u5b57\u6bb5\uff1acpuSet\u5b57\u6bb5\uff0c\u4e3aString\u683c\u5f0f\uff0c\u4f5c\u7528\u672a\u77e5\uff1bvcpu\u5b57\u6bb5\uff0c\u4e3aInteger\u683c\u5f0f\uff0c\u4f5c\u7528\u672a\u77e5\u3002 highAvailability HighAvailabilityModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u9ad8\u53ef\u7528\u76f8\u5173\u7684\u914d\u7f6e\uff0c\u5176\u4e2denabled\u5b57\u6bb5\u8868\u793a\u662f\u5426\u5f00\u542f\u865a\u62df\u673a\u9ad8\u53ef\u7528\uff1bpriority\u5b57\u6bb5\u8868\u793a\u865a\u62df\u673a\u8fc1\u79fb\u7684\u4f18\u5148\u7ea7\uff0c\u4e3aInterge\u7c7b\u578b\u3002 display DisplayModel body \u53ef\u9009\u53c2\u6570\uff0cDisplayModel\u4ee3\u8868\u865a\u62df\u673a\u7684\u663e\u793a\u6a21\u578b\uff0c\u6709\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\uff1a1.type\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u4f7f\u7528\u7684\u56fe\u5f62\u534f\u8bae\uff0c\u53ef\u9009\u7684\u56fe\u5f62\u534f\u8bae\u9009\u9879\u6709VNC\u548cSPICE\uff0c\u5f53\u8bbe\u7f6e\u4e86\u8be5\u5b57\u6bb5\u865a\u62df\u7684\u89c6\u9891\u7c7b\u578b\uff08defaultDisplayType\uff09\u4f1a\u88ab\u7f6e\u4e3a\u7a7a\uff0c\u7531\u540e\u53f0\u51b3\u5b9a\u30022.monitors\u5b57\u6bb5\uff0c\u4ee3\u8868\u76d1\u89c6\u5668\u6570\u91cf\u30023.singleQxlPci\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u4e3a\u5355\u4e2aPCI\u63a5\u53e3\u30024.smartcardEnabled\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u542f\u7528\u667a\u80fd\u5361\u30025.allowOverride\u5b57\u6bb5\uff0c\u4ee3\u8868\u662f\u5426\u5141\u8bb8\u63a7\u5236\u53f0\u91cd\u8fde\uff08\u4e0d\u77e5\u9053\u5565\u610f\u601d\uff09\u3002\u5728\u754c\u9762\u4e2d\u6ca1\u6709\u5bf9\u5e94\u7684\u9009\u9879\uff0c\u4e0e\u865a\u62df\u673a\u662f\u670d\u52a1\u5668\u8fd8\u662f\u684c\u9762\u76f8\u5173\uff0c\u5f53\u865a\u62df\u673a\u4e3a\u670d\u52a1\u5668\u65f6\u8be5\u4f1a\u88ab\u8bbe\u4e3atrue\u30026.keyboardLayout\u5b57\u6bb5\uff0c\u4ee3\u8868vnc\u952e\u76d8\u5e03\u5c40\uff08\u4f5c\u7528\u672a\u77e5\uff09\uff0c\u5728\u754c\u9762\u4e2d\u8be5\u9009\u9879\u88ab\u9690\u85cf\uff0c\u53ef\u9009\u5185\u5bb9\u89c1 vdc_options \u8868\u7684 VncKeyboardLayoutValidValues \u9009\u9879\u30027.fileTransferEnabled\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u542f\u7528SPICE\u6587\u4ef6\u8f6c\u6362\uff08\u4f5c\u7528\u672a\u77e5\uff09\uff0c\u5728\u754c\u9762\u4e2d\u8be5\u9009\u9879\u88ab\u9690\u85cf\u30028.copyPasteEnabled\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u542f\u7528SPICE\u526a\u8d34\u677f\u590d\u5236\u548c\u7c98\u8d34\uff08\u4f5c\u7528\u672a\u77e5\uff09\uff0c\u5728\u754c\u9762\u4e2d\u8be5\u9009\u9879\u88ab\u9690\u85cf\u30029.disconnectAction\u5b57\u6bb5\uff0c\u4ee3\u8868\u63a7\u5236\u53f0\u8fde\u63a5\u4e2d\u65ad\u4ee5\u540e\u865a\u62df\u673a\u7684\u884c\u4e3a\uff0c\u53ef\u9009\u503c\u6709\uff1aNONE\uff08\u65e0\u64cd\u4f5c\uff09\u3001LOCK_SCREEN\uff08\u9501\u5b9a\u5c4f\u5e55\uff09\u3001LOGOUT\uff08\u7528\u6237\u767b\u51fa\uff09\u3001REBOOT\uff08\u91cd\u542f\u865a\u62df\u673a\uff09\u3001SHUTDOWN\uff08\u5173\u95ed\u865a\u62df\u673a\uff09\u3002 migrationDowntime Integer body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u81ea\u5b9a\u4e49\u7684\u8fc1\u79fb\u4e0b\u7ebf\u65f6\u95f4\uff0c\u4e3aInterge\u7c7b\u578b\u3002 migration MigrationOptionsModel body \u53ef\u9009\u53c2\u6570\uff0cMigrationOptionsModel\u7684\u51e0\u4e2a\u5c5e\u6027\u6620\u5c04\u4e86\u96c6\u7fa4\u865a\u62df\u673a\u8fc1\u79fb\u7b56\u7565\u76843\u4e2a\u65b9\u9762\u30021. policy \u5b57\u6bb5\u662fMigrationPolicyModel\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u96c6\u7fa4\u7684\u8fc1\u79fb\u7b56\u7565\uff0c\u96c6\u7fa4\u53ef\u9009\u7684\u8fc1\u79fb\u7b56\u7565\u4e00\u5171\u67093\u79cd\uff1aLegacy\uff08id\u4e3a00000000-0000-0000-0000-000000000000\uff09\u3001Minimal downtime\uff08id\u4e3a80554327-0569-496b-bdeb-fcbbf52b827b\uff09\u548cSuspend workload if needed\uff08id\u4e3a80554327-0569-496b-bdeb-fcbbf52b827c\uff09\uff0c\u5176\u4e2dLegacy\u53ea\u8bbe\u7f6e\u4e86\u6700\u5927\u7684\u8fc1\u79fb\u6570\u91cf\u4e3a2\uff0c\u800c\u53e6\u59162\u79cd\u9009\u9879\u7684\u8be6\u7ec6\u914d\u7f6e\u89c1 vdc_optins \u8868\u7684 MigrationPolicies \u9009\u9879\uff0c\u8fc1\u79fb\u7b56\u7565\u9700\u8981\u8bbe\u7f6eMigrationPolicyModel\u5bf9\u8c61\u7684id\u5b57\u6bb5\uff0c\u9ed8\u8ba4\u503c\u4e3anull\uff1b2. autoConverge \u5b57\u6bb5\u548c compressed \u5b57\u6bb5\uff0c\u5206\u522b\u8868\u793a\u662f\u5426\u81ea\u52a8\u805a\u5408\u8fc1\u79fb\u4ee5\u53ca\u662f\u5426\u542f\u7528\u8fc1\u79fb\u538b\u7f29\u3002\u53ea\u6709\u5728\u8fc1\u79fb\u7b56\u7565\u4e3a Legacy \u65f6\uff0c\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u5728\u865a\u62df\u673a\u8fc1\u79fb\u8fc7\u7a0b\u4e2d\u624d\u4f1a\u751f\u6548\uff0c\u5b83\u4eec\u7684\u53ef\u9009\u503c\u6709\u4e09\u79cd\uff1aTRUE\u3001FALSE\u3001INHERIT\uff08\u8868\u793a\u4ece\u5168\u5c40\u8bbe\u7f6e\u7ee7\u627f\uff09\uff0c\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u4e3anull\u3002 customCpuModel String body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7684cpu\u7c7b\u578b\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u865a\u62df\u673acpu\u7c7b\u578b\uff0c\u5fc5\u987b\u4e0e\u865a\u62df\u673a\u6240\u5728\u96c6\u7fa4\u7684cpu\u7c7b\u578b\u4e3a\u540c\u4e00\u4ea7\u5546\uff0c\u4e14\u4ee3\u6570\u5fc5\u987b\u7b49\u4e8e\u6216\u4f4e\u4e8e\u96c6\u7fa4cpu\u7c7b\u578b\u3002 customEmulatedMachine String body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7684\u4eff\u771f\u673a\u3002 memoryPolicy MemoryPolicyModel body \u53ef\u9009\u53c2\u6570\uff0cMemoryPolicyModel\u5bf9\u8c61\u4ee3\u8868\u865a\u62df\u673a\u7684\u5185\u5b58\u7b56\u7565\uff0c\u5176guaranteed\u5b57\u6bb5\u4ee3\u8868\u865a\u62df\u673a\u4fdd\u8bc1\u7684\u7269\u7406\u5185\u5b58\uff0c\u5355\u4f4d\u4e3ab\u3002 os OperatingSystemModel body \u53ef\u9009\u53c2\u6570\uff0cOperatingSystemModel\u5bf9\u8c61\u4ee3\u8868\u4e0e\u7cfb\u7edf\u5f15\u5bfc\u6709\u5173\u7684\u53c2\u6570\u3002\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\u4f1a\u5f71\u54cd\u6a21\u677f\u7684\u521b\u5efa\uff1a1.boot\u5b57\u6bb5\u662fBootModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u5f15\u5bfc\u8bbe\u5907\u5e8f\u5217\u3002BootModel\u53ea\u6301\u6709devices\u5b57\u6bb5\uff0c\u662fBootDeviceValues\u5bf9\u8c61\u7684\u5f15\u7528\u3002BootDeviceValues\u5bf9\u8c61\u662fBootDevice\u7684\u96c6\u5408\u6620\u5c04\uff0c\u53ea\u6301\u6709BootDevice\u96c6\u5408\u7684\u5f15\u7528bootDevice\u5b57\u6bb5\u3002BootDevice\u4ee3\u8868\u865a\u62df\u673a\u7684\u5f15\u5bfc\u8bbe\u5907\u5e8f\u5217\uff0c\u53ef\u9009\u503c\u6709\uff1aCDROM\uff08\u5149\u9a71\uff09\u3001HD\uff08\u786c\u76d8\uff09\u548cNETWORK\uff08\u7f51\u7edc\uff09\u3002\u5217\u8868\u4e2dBootDevice\u5404\u4e2a\u503c\u7684\u6392\u5217\u987a\u5e8f\uff0c\u4ee3\u8868\u865a\u62df\u673a\u5f15\u5bfc\u8bbe\u5907\u987a\u5e8f\uff0c\u5982\u679c\u51fa\u73b0\u91cd\u590d\u7684\u503c\uff0c\u4f1a\u5148\u53bb\u91cd\u30022.type\u5b57\u6bb5\uff0c\u4ee3\u8868\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\uff0c\u4f8b\u5982other_linux\uff0cwindows_7x64\u7b49\uff0c\u53ef\u9009\u503c\u53c2\u8003 share/ovirt-engine/conf/osinfo-defaults.properties \u6587\u4ef6\u4e2d\u7684\u914d\u7f6e\u30023.kernel\u5b57\u6bb5\uff0c\u4ee3\u8868Linux\u5f15\u5bfc\u9009\u9879\u4e2d\u7684\u5185\u6838\u8def\u5f84\uff0c\u56e0\u6b64\u53ea\u6709\u5728\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u662flinux\u65f6\u624d\u4f1a\u751f\u6548\uff0c\u8be5\u5b57\u6bb5\u586b\u5199\u7684\u662flinux\u5185\u6838\u5728iso\u57df\u7684\u8def\u5f84\u30024.initrd\u5b57\u6bb5\uff0c\u4ee3\u8868Linux\u5f15\u5bfc\u9009\u9879\u4e2d\u7684initrd\u8def\u5f84\uff0c\u56e0\u6b64\u53ea\u6709\u5728\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u662flinux\u65f6\u624d\u4f1a\u751f\u6548\uff0c\u8be5\u5b57\u6bb5\u586b\u5199\u7684\u662finitrd\u5728iso\u57df\u7684\u8def\u5f84\u30025.cmdline\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u81ea\u5b9a\u4e49\u7684\u5185\u6838\u53c2\u6570\uff0c\u683c\u5f0f\u76ee\u524d\u4e0d\u77e5\u9053\u3002 bootMenuEnabled Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u542f\u7528\u5f15\u5bfc\u83dc\u5355\u3002 timeZone TimeZoneModel body \u53ef\u9009\u53c2\u6570\uff0cTimeZoneModel\u5bf9\u8c61\u4ee3\u8868\u4e86\u865a\u62df\u673a\u7684\u65f6\u533a\u8bbe\u7f6e\u3002\u5176name\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u65f6\u533a\uff0c\u53ef\u9009\u503c\u8be6\u89c1 TimeZoneType \u679a\u4e3e\u7c7b\u7684 initializeTimeZoneList \u65b9\u6cd5\u8fd4\u56de\u7684map\u7684key\u503c\u3002 origin String body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u6765\u6e90\uff08\u4e0d\u4f1a\u624b\u52a8\u8bbe\u7f6e\u5427\uff1f\uff09\uff0c\u53ef\u9009\u503c\u6709VMWARE\u3001XEN\u3001OVIRT\u3001EXTERNAL\u3001KVM\u3002 stateless Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u662f\u5426\u4e3a\u65e0\u72b6\u6001\u3002 deleteProtected Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u662f\u5426\u542f\u7528\u5220\u9664\u4fdd\u62a4\u3002 ssoEnabled Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u662f\u5426\u542f\u7528\u5355\u70b9\u767b\u5165\uff08\u5373\u662f\u5426\u4f7f\u7528GuestAgent\uff09\u3002 type String body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7c7b\u578b\uff0c\u53ef\u9009\u503c\u6709\uff1aDESKTOP\uff08\u684c\u9762\uff09\u3001SERVER\uff08\u670d\u52a1\u5668\uff09\u3002 tunnelMigration Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u662f\u5426\u542f\u7528\u901a\u9053\u8fc1\u79fb\uff08\u4f5c\u7528\u672a\u77e5\uff09\uff0c\u754c\u9762\u6ca1\u627e\u5230\u4e0e\u4e4b\u5bf9\u5e94\u7684\u9009\u9879\u3002 startPaused Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u662f\u5426\u4ee5\u6682\u505c\u6a21\u5f0f\u542f\u52a8\u3002 customProperties CustomProperties body \u53ef\u9009\u53c2\u6570\uff0cCustomProperties\u662f\u865a\u62df\u673a\u81ea\u5b9a\u4e49\u53c2\u6570\u96c6\u5408\u7684\u6620\u5c04\uff0c\u6301\u6709\u552f\u4e00\u7684customProperties\u5b57\u6bb5\u662fCustomPropertyModel\u5217\u8868\u7684\u5f15\u7528\u3002CustomPropertyModel\u4ee3\u8868\u4e86\u6bcf\u4e00\u4e2a\u81ea\u5b9a\u4e49\u53c2\u6570\uff0c\u5176\u4e2dname\u5b57\u6bb5\u4ee3\u8868\u53c2\u6570\u540d\uff0cvalue\u5b57\u6bb5\u4ee3\u8868\u53c2\u6570\u503c\uff0cregexp\u4ee3\u8868\u6b63\u5219\u8868\u8fbe\u5f0f\u3002 quota QuotaModel body \u53ef\u9009\u53c2\u6570\uff0cQuotaModel\u4ee3\u8868\u4e86\u865a\u62df\u673a\u7684\u914d\u989d\uff0c\u914d\u989d\u5177\u4f53\u7684\u4f5c\u7528\u4e0d\u6e05\u695a\uff0c\u754c\u9762\u4e0a\u4e5f\u6ca1\u627e\u5230\u5bf9\u5e94\u7684\u5185\u5bb9\uff0c\u8fd9\u91cc\u53ea\u9700\u8981\u6307\u5b9aid\u5b57\u6bb5\u5373\u53ef\u3002 useLatestTemplateVersion Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u901a\u8fc7\u6a21\u677f\u521b\u5efa\u865a\u62df\u673a\u65f6\u662f\u5426\u4f7f\u7528\u6a21\u677f\u7684\u6700\u65b0\u5b50\u7248\u672c\u3002 placementPolicy VmPlacementPolicy body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7684\u5b89\u7f6e\u7b56\u7565\uff08\u5373\u865a\u62df\u673a\u4e0e\u4e3b\u673a\u4e4b\u95f4\u7684\u5173\u7cfb\uff09\uff0cVmPlacementPolicy\u6709\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\uff1a1.affinity\u5b57\u6bb5\uff0c\u4ee3\u8868\u4e3b\u673a\u7684\u8fc1\u79fb\u6a21\u5f0f\uff0c\u53ef\u9009\u503c\u6709MIGRATABLE\uff08\u5141\u8bb8\u624b\u52a8\u8fc1\u79fb\u548c\u81ea\u52a8\u8fc1\u79fb\uff09\u3001USER_MIGRATABLE\uff08\u5141\u8bb8\u624b\u52a8\u8fc1\u79fb\uff09\u3001PINNED\uff08\u4e0d\u8fd0\u884c\u8fc1\u79fb\uff09\u30022.hosts\u5b57\u6bb5\uff0c\u662fHosts\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u865a\u62df\u673a\u53ef\u7528\u7684\u4e3b\u673a\u5217\u8868\u3002Hosts\u5bf9\u8c61\u662f\u7684HostModel\u96c6\u5408\u6620\u5c04\uff0c\u53ea\u6301\u6709\u4e00\u4e2aHostModel\u96c6\u5408\u7684\u5f15\u7528hosts\u5b57\u6bb5\u3002\u8fd9\u91cc\u53ea\u9700\u8981\u6307\u5b9aHostModel\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\uff0chost\u5fc5\u987b\u4e3a\u865a\u62df\u673a\u6240\u5728\u96c6\u7fa4\u7684\u4e3b\u673a\u3002\u5f53HostModel\u96c6\u5408\u4e3a\u7a7a\uff08\u6216\u8005null\uff09\u65f6\uff0c\u8868\u793a\u865a\u62df\u673a\u80fd\u8fd0\u884c\u5728\u4efb\u4e00\u4e3b\u673a\u4e0a\u3002 usb UsbModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u6a21\u677f\u7684usb\u7b56\u7565\uff0cUsbModel\u5177\u67092\u4e2a\u5b57\u6bb5\uff1a1.enabled\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u542f\u7528usb\u7b56\u7565\uff0c\u53ea\u6709\u8be5\u5b57\u6bb5\u4e3atrue\u65f6\uff0c\u5176\u4ed6\u5b57\u6bb5\u624d\u80fd\u751f\u6548\u30022.type\u5b57\u6bb5\uff0c\u4ee3\u8868usb\u7b56\u7565\u7c7b\u578b\uff0c\u53ef\u9009\u503c\u6709LEGACY\u548cNATIVE\u3002\u5728\u521b\u5efa\u65b9\u5f0f\u4e3a\u865a\u62df\u673a\u6a21\u677f\u65f6\u6709\u6548\u3002 numaTuneMode NumaTuneMode body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868Numa\u7684Tune\u6a21\u5f0f\uff0c\u53ef\u9009\u503c\u6709\uff1aSTRICT\uff08\u4e25\u683c\uff09\u3001INTERLEAVE\uff08\u4ea4\u9519\uff09\u3001PREFERRED\uff08\u9996\u9009\uff09\u3002 diskAttachments DiskAttachments body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u5bf9\u6307\u5b9a\u7684\u6a21\u677f\u6216\u8005\u5feb\u7167\u4e2d\u539f\u6709\u7684\u78c1\u76d8\u4fe1\u606f\u8fdb\u884c\u4fee\u6539\u3002DiskAttachments\u5bf9\u8c61\u4ee3\u8868\u865a\u62df\u673a\u9644\u52a0\u78c1\u76d8\u5217\u8868\uff0cDiskAttachments\u53ea\u62e5\u6709diskAttachments\u4e00\u4e2a\u5b57\u6bb5\uff0c\u662fDiskAttachment\u96c6\u5408\u7684\u5f15\u7528\uff0cDiskAttachment\u5bf9\u8c61\u7684disk\u5b57\u6bb5\u6240\u6307\u5411\u7684DiskModel\u624d\u662f\u771f\u6b63\u7684\u78c1\u76d8\u4fe1\u606f\u3002\u5f53\u9700\u8981\u4fee\u6539\u78c1\u76d8\u4fe1\u606f\u65f6\u5fc5\u987b\u6307\u5b9a\u7684\u5b57\u6bb5\u4e0e\u521b\u5efa\u65b9\u5f0f\u6709\u5173\uff0c\u5f53\u901a\u8fc7\u6a21\u677f\u521b\u5efa\u865a\u62df\u673a\u65f6\u9700\u8981\u6307\u5b9aDiskModel\u7684id\u5b57\u6bb5\u6765\u6307\u5b9a\u8981\u4fee\u6539\u7684\u78c1\u76d8\uff0c\u4f46\u662f\u5982\u679c\u901a\u8fc7\u5feb\u7167\u521b\u5efa\u865a\u62df\u673a\u65f6\u9700\u8981\u6307\u5b9aDiskModel\u7684imageId\u5b57\u6bb5\u3002\u53ef\u4fee\u6539\u78c1\u76d8\u4fe1\u606f\uff0c\u4f8b\u5982DiskModel\u7684name\u5b57\u6bb5\u8868\u793a\u8981\u4fee\u6539\u7684\u78c1\u76d8\u540d\uff1bDiskModel\u7684format\u5b57\u6bb5\u8868\u793a\u8981\u4fee\u6539\u7684\u78c1\u76d8\u683c\u5f0f\uff0c\u53ef\u9009\u503c\u5305\u62ecCOW\u548cRAW\uff1bDiskModel\u7684storageDomains\u5b57\u6bb5\u662fStorageDomains\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u8868\u793a\u6307\u5b9a\u78c1\u76d8\u7684\u5b58\u50a8\u57df\uff0cStorageDomains\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aStorageDomainModel\u96c6\u5408\u7684\u5f15\u7528storageDomains\u5b57\u6bb5\uff0c\u6307\u5b9a\u78c1\u76d8\u5b58\u50a8\u57df\u65f6\u53ea\u9700\u8981\u6307\u5b9a\u96c6\u5408\u4e2d\u4e00\u4e2aStorageDomainModel\u7684id\u5b57\u6bb5\u5373\u53ef\u3002 \u8bf4\u660e\uff1a\u521b\u5efa\u865a\u62df\u673a\u63a5\u53e3\uff0c\u53ef\u4ee5\u901a\u8fc7\u6a21\u677f\u3001\u5feb\u7167\u6216\u8005xml\u4fe1\u606f\u521b\u5efa\u865a\u62df\u673a\uff0c\u540c\u65f6\u4e5f\u53ef\u4ee5\u6307\u5b9a\u5176\u4ed6\u53c2\u6570\u5bf9\u76f8\u5e94\u6a21\u677f\u6216\u8005\u5feb\u7167\u4fe1\u606f\u8fdb\u884c\u4fee\u6539\u3002\u8fd9\u4e09\u8005\u7684\u4f18\u5148\u7ea7\u4e3a\uff1a xml > \u5feb\u7167 > \u6a21\u677f \u3002 \u901a\u8fc7\u6a21\u677f\u521b\u5efa\u865a\u62df\u673a\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5fc5\u987b\u63d0\u4f9b\u6a21\u677f\u7684 id \u6216\u8005\u540d\u5b57\uff1a \u8bf7\u6c42\uff1a POST /acloudageks/api/vms Body: { \"name\": \"myvm\", \"template\": { \"name\": \"Blank\" }, \"cluster\": { \"name\": \"Default\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"VmModel [cluster.id|name] required for add\", \"reason\": \"Incomplete parameters\" } \u901a\u8fc7\u5feb\u7167\u521b\u5efa\u865a\u62df\u673a\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5fc5\u987b\u63d0\u4f9b\u5feb\u7167id \u8bf7\u6c42\uff1a POST /acloudageks/api/vms Body: { \"name\": \"myvm\", \"snapshots\": { \"snapshots\": [ { \"id\": \"bc6ccc8b-278c-4d87-a945-5728b45690d5\" } ] }, \"cluster\": { \"name\": \"Default\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"VmModel [cluster.id|name] required for add\", \"reason\": \"Incomplete parameters\" } \u4ece\u6a21\u677f\u6216\u5feb\u7167\u521b\u5efa\u865a\u62df\u673a\u65f6\uff0c\u901a\u5e38\u901a\u5e38\u8981\u660e\u786e\u6307\u51fa\u8981\u5728\u54ea\u4e2a\u5b58\u50a8\u57df\u4e2d\u521b\u5efa\u865a\u62df\u673a\u78c1\u76d8\u3002 \u5982\u679c\u865a\u62df\u673a\u662f\u4ece\u6a21\u677f\u521b\u5efa\u7684\uff0c\u5219\u53ef\u4ee5\u901a\u8fc7\u6dfb\u52a0diskAttachment\u53c2\u6570\u6765\u8bf4\u660e\u6620\u5c04\u5173\u7cfb\uff1a { ... \"diskAttachments\": { \"diskAttachments\": [ \"disk\": { \"id\": \"bc6ccc8b-1234-4d87-a945-5728b45690d1\", \"storageDomains\": { \"storageDomains\": [ { \"id\": \"9cb6cb0a-cf1d-41c2-92ca-5a6d665649c9\" } ] } } ] } } \u4ece\u5feb\u7167\u521b\u5efa\u865a\u62df\u673a\u65f6\u78c1\u76d8\u914d\u7f6e\u7565\u5fae\u6709\u4e9b\u4e0d\u540c\uff0c\u8fd9\u65f6\u9700\u8981\u4f7f\u7528imageId\u5c5e\u6027\u6765\u66ff\u6362id\u5c5e\u6027 { ... \"diskAttachments\": { \"diskAttachments\": [ \"disk\": { \"imageId\": \"bc6ccc8b-1234-4d87-a945-5728b45690d1\", \"storageDomains\": { \"storageDomains\": [ { \"id\": \"9cb6cb0a-cf1d-41c2-92ca-5a6d665649c9\" } ] } } ] } } \u53ef\u4ee5\u5728\u8bf7\u6c42\u53c2\u6570\u4e2d\u6307\u5b9a\u5176\u4ed6\u865a\u62df\u673a\u53c2\u6570\uff0c\u4f8b\u5982\u53ef\u4ee5\u6dfb\u52a0\u5177\u67092 GiB RAM\u548c\u9644\u52a0\u8bf4\u660e\u7684\u684c\u9762\u578b\u865a\u62df\u673a\uff0c\u53ef\u4ee5\u6dfb\u52a0\u4ee5\u4e0b\u53c2\u6570\uff1a { \"name\": \"myvm\", \"description\": \"My Desktop Virtual Machine\", \"type\": \"desktop\" \"memory\": 2147483648 ... } 1.1.2.\u83b7\u5f97\u865a\u62df\u673a\u5217\u8868 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e all_content Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u662f\u5426\u5728response\u662f\u5426\u5e94\u8be5\u5305\u62ec\u6240\u6709\u7684\u865a\u62df\u673a\u5c5e\u6027\uff08\u8c8c\u4f3c\u6ca1\u4f5c\u7528\uff09 case_sensitive Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u4e0esearch\u53c2\u6570\u4e00\u8d77\u4f7f\u7528\uff0c\u6307\u5b9a\u5728\u6267\u884csearch\u53c2\u6570\u65f6\u662f\u5426\u8003\u8651\u5927\u5c0f\u5199 filter Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u865a\u62df\u673a\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u865a\u62df\u673a\u6570\u91cf search String url \u53ef\u9009\u53c2\u6570\uff0c\u67e5\u8be2\u7ea6\u675f\u6761\u4ef6\u7ea6\u675f\u8fd4\u56de\u4fe1\u606f\uff0c\u4f8b\u5982name=\"myname\" \u8bf7\u6c42\uff1a GET /acloudageks/api/vms \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.1.3.\u53d6\u6d88\u8fc1\u79fb\u865a\u62df\u673a \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/cancelmigration Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 1.1.4.\u514b\u9686\u865a\u62df\u673a \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 vm VmModel body \u5fc5\u8981\u53c2\u6570\uff0c\u9700\u8981\u6307\u5b9a\u514b\u9686\u7684\u65b0\u865a\u62df\u673a\u7684\u540d\u5b57 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/clone Body: { \"vm\": { \"name\": \"myClone\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"ActionModel [vm.name] required for doClone\", \"reason\": \"Incomplete parameters\" } 1.1.5.\u63d0\u4ea4\u9884\u89c8\u955c\u50cf \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/commitsnapshot Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 1.1.6.\u4ece\u865a\u62df\u673a\u6c60\u4e2d\u5206\u79bb\u865a\u62df\u673a \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/detach Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.1.7.\u5bfc\u51fa\u865a\u62df\u673a\u5230\u5b58\u50a8\u57df \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 discardSnapshots Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u5bfc\u51fa\u865a\u62df\u673a\u5230\u5bfc\u51fa\u57df\u65f6\u662f\u5426\u9700\u8981\u6298\u53e0\u865a\u62df\u673a\u6240\u6709\u7684\u5feb\u7167 exclusive Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u5bfc\u51fa\u865a\u62df\u673a\u5230\u5bfc\u51fa\u57df\u65f6\u5982\u679c\u8be5\u865a\u62df\u673a\u5df2\u7ecf\u5728\u5bfc\u51fa\u57df\u5b58\u5728\uff0c\u662f\u5426\u8986\u76d6\u5df2\u7ecf\u5b58\u5728\u5bfc\u51fa\u57df\u7684\u865a\u62df\u673a storageDomain StorageDomainModel body \u5fc5\u8981\u53c2\u6570\uff0c\u9700\u8981\u6307\u5b9a\u5b58\u50a8\u57df\u7684id\u5b57\u6bb5\u6216\u8005id\u5b57\u6bb5 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/export Body: { \"storageDomain\": { \"name\": \"myexport\" }, \"exclusive\": true, \"discardSnapshots\": true } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 1.1.8.\u51bb\u7ed3\u865a\u62df\u673a\u6587\u4ef6\u7cfb\u7edf \u5f53\u4e3a\u6b63\u5728\u8fd0\u884c\u7684\u865a\u62df\u673a\u62cd\u6444\u6d3b\u52a8\u5feb\u7167\u65f6\uff0c QEMU guest agent \u4f1a\u51bb\u7ed3\u865a\u62df\u673a\u7684\u6587\u4ef6\u7cfb\u7edf\u3002\u901a\u5e38\uff0c\u8fd9\u4e2a\u662f\u7531\u7ba1\u7406\u7cfb\u7edf\u81ea\u52a8\u5b8c\u6210\u7684\uff0c\u4f46\u865a\u62df\u673a\u5728\u4f7f\u7528 OpenStack Volume(Cinder) \u78c1\u76d8\u65f6\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u5fc5\u987b\u8fdb\u884c\u624b\u52a8\u8c03\u7528\u3002 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/freezefilesystems Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 1.1.9.\u83b7\u5f97\u6307\u5b9a\u7684\u865a\u62df\u673a\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e all_content Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u662f\u5426\u5728response\u662f\u5426\u5e94\u8be5\u5305\u62ec\u6240\u6709\u7684\u865a\u62df\u673a\u5c5e\u6027\uff08\u8c8c\u4f3c\u6ca1\u4f5c\u7528\uff09 filter Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u865a\u62df\u673a\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 next_run Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u7ed3\u679c\u662f\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u865a\u62df\u673a\u7684\u865a\u62df\u673a\u4fe1\u606f\uff0c\u8fd8\u662f\u5df2\u7ecf\u6267\u884c\u4e86\u4fee\u6539\uff0c\u4f46\u662f\u5728\u865a\u62df\u673a\u4e0b\u6b21\u91cd\u542f\u624d\u751f\u6548\u7684\u865a\u62df\u673a\u4fe1\u606f \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.1.10.\u542f\u7528\u7528\u6237\u81ea\u52a8\u767b\u5165\u865a\u62df\u673a \u542f\u52a8\u81ea\u52a8\u7528\u6237\u767b\u5f55\u4ee5\u4ece\u5916\u90e8\u63a7\u5236\u53f0\u8bbf\u95ee\u865a\u62df\u673a\u3002\u7528\u6237\u9700\u8981\u865a\u62df\u673a\u7684\u9002\u5f53\u7528\u6237\u6743\u9650\uff0c\u624d\u80fd\u4ece\u5916\u90e8\u63a7\u5236\u53f0\u8bbf\u95ee\u865a\u62df\u673a\u3002 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/logon Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.1.11.\u7ef4\u62a4\u865a\u62df\u673a \u5728ovirt\u4e2d\u6b64\u63a5\u53e3\u7528\u4e8e\u5c06\u4f5c\u4e3a\u4e3b\u673a\u7684\u865a\u62df\u673a\u6267\u884c\u7ef4\u62a4\u64cd\u4f5c\uff08\u5d4c\u5957\u865a\u62df\u5316\uff09\uff0c\u5728\u6211\u4eec\u7684\u7cfb\u7edf\u4e2d\u4e0d\u652f\u6301\uff0c\u6240\u4ee5\u8c03\u7528\u8be5\u63a5\u53e3\u4f1a\u76f4\u63a5\u629b\u51fa\u5f02\u5e38\u3002 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/maintenance Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5e9f\u5f03\u7684\u63a5\u53e3 1.1.12.\u865a\u62df\u673a\u8fc1\u79fb \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 cluster ClusterModel body \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u865a\u62df\u673a\u8981\u8fc1\u79fb\u5230\u7684\u96c6\u7fa4\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u7cfb\u7edf\u4f1a\u5c06\u865a\u62df\u673a\u8fc1\u79fb\u5230\u540c\u4e00\u96c6\u7fa4\u4e2d\u7684\u53e6\u4e00\u53f0\u4e3b\u673a\u4e0a\u3002\u9700\u8981\u901a\u8fc7id\u5b57\u6bb5\u6765\u6307\u5b9a\u96c6\u7fa4\u3002 force Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u5f3a\u5236\u8fc1\u79fb\u865a\u62df\u673a\uff0c\u5373\u4f7f\u865a\u62df\u673a\u53ef\u80fd\u88ab\u5b9a\u4e49\u4e3a\u4e0d\u53ef\u8fc1\u79fb host HostModel body \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u865a\u62df\u673a\u8fc1\u79fb\u5230\u7684\u4e3b\u673a\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u7cfb\u7edf\u4f1a\u5c06\u865a\u62df\u673a\u8fc1\u79fb\u5230\u540c\u4e00\u96c6\u7fa4\u4e2d\u7684\u53e6\u4e00\u53f0\u4e3b\u673a\u4e0a\u3002\u9700\u8981\u901a\u8fc7name\u5b57\u6bb5\u6216\u8005id\u5b57\u6bb5\u6765\u6307\u5b9a\u4e3b\u673a\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/migrate Body: { \"host\": { \"id\": \"2ab5e1da-b726-4274-bbf7-0a42b16a0fc3\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 1.1.13.\u5feb\u7167\u9884\u89c8 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 disks Disks body \u53ef\u9009\u53c2\u6570\uff0c\u7528\u4e8e\u6307\u5b9a\u6267\u884c\u5feb\u7167\u9884\u89c8\u7684\u78c1\u76d8\uff0cDisks\u5bf9\u8c61\u4e3aDiskModel\u96c6\u5408\u7684\u6620\u5c04\uff0cDisks\u5bf9\u8c61\u53ea\u6301\u6709DiskModel\u96c6\u5408\u7684\u5f15\u7528disks\u5b57\u6bb5\uff0c\u9700\u8981DiskModel\u7684\u5b8c\u6574\u7684\u4fe1\u606f\uff0c\u9ed8\u8ba4\u5bf9\u6240\u6709\u78c1\u76d8\u8fdb\u884c\u5feb\u7167\u9884\u89c8\u3002 restoreMemory Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u662f\u5426\u6062\u590d\u5feb\u7167\u7684\u5185\u5b58\u4fe1\u606f\uff0c\u9ed8\u8ba4\u4e3afalse snapshot SnapshotModel body \u5fc5\u8981\u53c2\u6570\uff0c\u8868\u793a\u8981\u8fdb\u884c\u9884\u89c8\u7684\u5feb\u7167\uff0c\u9700\u8981\u6307\u5b9a\u5feb\u7167id\u3002 \u8bf4\u660e\uff1a\u53c2\u6570\u4e2dDiskModel\u7684\u5b8c\u6574\u7684\u4fe1\u606f\u4e0d\u662f\u5f88\u5408\u7406\uff0c\u8fd9\u91cc\u5e94\u8be5\u6539\u4e3a\u53ea\u9700\u8981\u6307\u5b9aid\u5b57\u6bb5\u548cimageId\u5b57\u6bb5\u3002 ovirt4.3 \u4e2d\u7684\u903b\u8f91\u4e5f\u662f\u5982\u6b64\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/previewsnapshot Body: { \"snapshot\": { \"id\": \"2ab5e1da-b726-4274-bbf7-0a42b16a0fc3\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 1.1.14.\u91cd\u542f\u865a\u62df\u673a \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/reboot Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.1.15.\u5220\u9664\u865a\u62df\u673a \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e detach_only Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u5220\u9664\u865a\u62df\u673a\u65f6\uff0c\u662f\u5426\u53ea\u5206\u79bb\u865a\u62df\u673a\u7684\u9644\u52a0\u78c1\u76d8\uff0c\u800c\u4e0d\u662f\u5220\u9664\u78c1\u76d8\u3002 force Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u662f\u5426\u5f3a\u5236\u5220\u9664\u865a\u62df\u673a \u9501\u5b9a\u7684\u865a\u62df\u673a\u548c\u9644\u52a0\u4e86\u9501\u5b9a\u78c1\u76d8\u7684\u865a\u62df\u673a\u5728\u6ca1\u6709\u9644\u52a0fore\u53c2\u6570\u65f6\u65e0\u6cd5\u88ab\u5220\u9664\u3002 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/vms/{id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.1.16.mac\u5730\u5740\u91cd\u6392 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/reordermacaddresses Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.1.17.\u5173\u95ed\u865a\u62df\u673a \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/shutdown Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.1.18.\u542f\u52a8\u865a\u62df\u673a \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 pause Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u662f\u5426\u4ee5\u6682\u505c\u6a21\u5f0f\u542f\u52a8\uff0c\u9ed8\u8ba4\u503c\u4e3afalse useSysprep Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u4ec5\u5728RunVmOnce\u6a21\u5f0f\u6709\u6548\uff0c\u8868\u793a\u865a\u62df\u673a\u662f\u5426\u4ee5sysprep\u65b9\u5f0f\u542f\u52a8\uff08\u4ec5\u652f\u6301windows\uff09\uff0c\u4e0euseCloudInit\u53c2\u6570\u51b2\u7a81\uff0c\u9ed8\u8ba4\u503c\u4e3afalse useCloudInit Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u4ec5\u5728RunVmOnce\u6a21\u5f0f\u6709\u6548\uff0c\u8868\u793a\u865a\u62df\u673a\u662f\u5426\u4ee5clouldinit\u65b9\u5f0f\u542f\u52a8\uff08\u4ec5\u652f\u6301linux\uff09\uff0c\u4e0euseCloudInit\u53c2\u6570\u51b2\u7a81\uff0c\u9ed8\u8ba4\u503c\u4e3afalse vm VmModel body \u529f\u80fd\u533a\u5206\u53c2\u6570\uff0c\u7528\u4e8e\u542f\u7528RunVmOnce\u6a21\u5f0f\uff0c\u5f53\u6307\u5b9a\u8be5\u53c2\u6570\u65f6\uff0c\u8868\u793a\u4ee5RunVmOnce\u6a21\u5f0f\u542f\u52a8\u865a\u62df\u673a\u3002VmModel\u5bf9\u8c61\u4e2d\u5bf9RunVmOnce\u6a21\u5f0f\u4ea7\u751f\u5f71\u54cd\u7684\u5b57\u6bb5\u6709\u4ee5\u4e0b\u51e0\u4e2a\uff1a1.stateless\u5b57\u6bb5\uff0c\u8868\u793a\u865a\u62df\u673a\u662f\u5426\u4e3a\u65e0\u72b6\u6001\u30022.display\u5b57\u6bb5\uff0c\u662fDisplayModel\u5bf9\u8c61\u7684\u5f15\u7528\u4ee3\u8868\u865a\u62df\u673a\u7684\u663e\u793a\u6a21\u578b\uff0c\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\u5f71\u54cd\u865a\u62df\u673a\u542f\u52a8\uff1akeyboardLayout\u5b57\u6bb5\uff0c\u4ee3\u8868vnc\u952e\u76d8\u5e03\u5c40\uff08\u4f5c\u7528\u672a\u77e5\uff09\uff0c\u5728\u754c\u9762\u4e2d\u8be5\u9009\u9879\u88ab\u9690\u85cf\uff0c\u53ef\u9009\u5185\u5bb9\u89c1 vdc_options \u8868\u7684 VncKeyboardLayoutValidValues \u9009\u9879\uff1btype\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u542f\u52a8\u4f7f\u7528\u7684\u56fe\u5f62\u534f\u8bae\uff0c\u53ef\u9009\u7684\u56fe\u5f62\u534f\u8bae\u9009\u9879\u6709VNC\u548cSPICE\u30023.os\u5b57\u6bb5\uff0c\u662fOperatingSystemModel\u5bf9\u8c61\u7684\u5f15\u7528\u4ee3\u8868\u4e0e\u7cfb\u7edf\u5f15\u5bfc\u6709\u5173\u7684\u53c2\u6570\uff0c\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\u5f71\u54cd\u865a\u62df\u673a\u542f\u52a8\uff1a boot \u5b57\u6bb5\u662fBootModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u5f15\u5bfc\u8bbe\u5907\u5e8f\u5217\u3002BootModel\u53ea\u6301\u6709devices\u5b57\u6bb5\uff0c\u662fBootDeviceValues\u5bf9\u8c61\u7684\u5f15\u7528\u3002BootDeviceValues\u5bf9\u8c61\u662fBootDevice\u7684\u96c6\u5408\u6620\u5c04\uff0c\u53ea\u6301\u6709BootDevice\u96c6\u5408\u7684\u5f15\u7528bootDevice\u5b57\u6bb5\u3002BootDevice\u4ee3\u8868\u865a\u62df\u673a\u7684\u5f15\u5bfc\u8bbe\u5907\u5e8f\u5217\uff0c\u53ef\u9009\u503c\u6709\uff1aCDROM\uff08\u5149\u9a71\uff09\u3001HD\uff08\u786c\u76d8\uff09\u548cNETWORK\uff08\u7f51\u7edc\uff09\u3002\u5217\u8868\u4e2dBootDevice\u5404\u4e2a\u503c\u7684\u6392\u5217\u987a\u5e8f\uff0c\u4ee3\u8868\u865a\u62df\u673a\u5f15\u5bfc\u8bbe\u5907\u987a\u5e8f\uff0c\u5982\u679c\u51fa\u73b0\u91cd\u590d\u7684\u503c\uff0c\u4f1a\u5148\u53bb\u91cd\uff1b kernel \u5b57\u6bb5\uff0c\u4ee3\u8868Linux\u5f15\u5bfc\u9009\u9879\u4e2d\u7684\u5185\u6838\u8def\u5f84\uff0c\u56e0\u6b64\u53ea\u6709\u5728\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u662flinux\u65f6\u624d\u4f1a\u751f\u6548\uff0c\u8be5\u5b57\u6bb5\u586b\u5199\u7684\u662flinux\u5185\u6838\u5728iso\u57df\u7684\u8def\u5f84\uff1b initrd \u5b57\u6bb5\uff0c\u4ee3\u8868Linux\u5f15\u5bfc\u9009\u9879\u4e2d\u7684initrd\u8def\u5f84\uff0c\u56e0\u6b64\u53ea\u6709\u5728\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u662flinux\u65f6\u624d\u4f1a\u751f\u6548\uff0c\u8be5\u5b57\u6bb5\u586b\u5199\u7684\u662finitrd\u5728iso\u57df\u7684\u8def\u5f84\uff1b cmdline \u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u81ea\u5b9a\u4e49\u7684\u5185\u6838\u53c2\u6570\uff0c\u683c\u5f0f\u76ee\u524d\u4e0d\u77e5\u9053\u30024.cdroms\u5b57\u6bb5\uff0c\u662fCdroms\u5bf9\u8c61\u662fCdromModel\u96c6\u5408\u6620\u5c04\uff0c\u53ea\u6301\u6709CdromModel\u96c6\u5408\u7684\u5f15\u7528cdroms\u5b57\u6bb5\u3002CdromModel\u5bf9\u8c61\u4ee3\u8868\u865a\u62df\u673a\u5149\u76d8\uff0c\u53ea\u6709\u4e00\u4e2afile\u5b57\u6bb5\uff0cfile\u5b57\u6bb5\u662fFileModel\u7684\u5f15\u7528\uff0c\u9700\u8981\u6307\u5b9aFileModel\u5bf9\u8c61\u7684id\u5b57\u6bb5\u6765\u6307\u5b9a\u5149\u76d8\u6587\u4ef6\u7684\u8def\u5f84\u30025.floppies\u5b57\u6bb5\uff0c\u662fFloppies\u5bf9\u8c61\u662fFloppyModel\u96c6\u5408\u6620\u5c04\uff0c\u53ea\u6301\u6709FloppyModel\u96c6\u5408\u7684\u5f15\u7528floppies\u5b57\u6bb5\u3002FloppyModel\u5bf9\u8c61\u4ee3\u8868\u865a\u62df\u673a\u8f6f\u76d8\uff0c\u53ea\u6709\u4e00\u4e2afile\u5b57\u6bb5\uff0cfile\u5b57\u6bb5\u662fFileModel\u7684\u5f15\u7528\uff0c\u9700\u8981\u6307\u5b9aFileModel\u5bf9\u8c61\u7684id\u5b57\u6bb5\u6765\u6307\u5b9a\u8f6f\u76d8\u6587\u4ef6\u7684\u8def\u5f84\u30026.customProperties\u5b57\u6bb5\uff0c\u662fCustomProperties\u5bf9\u8c61\u7684\u5f15\u7528\u4ee3\u8868\u865a\u62df\u673a\u81ea\u5b9a\u4e49\u53c2\u6570\u96c6\u5408\u7684\u6620\u5c04\uff0c\u6301\u6709\u552f\u4e00\u7684customProperties\u5b57\u6bb5\u662fCustomPropertyModel\u5217\u8868\u7684\u5f15\u7528\u3002CustomPropertyModel\u4ee3\u8868\u4e86\u6bcf\u4e00\u4e2a\u81ea\u5b9a\u4e49\u53c2\u6570\uff0c\u5176\u4e2dname\u5b57\u6bb5\u4ee3\u8868\u53c2\u6570\u540d\uff0cvalue\u5b57\u6bb5\u4ee3\u8868\u53c2\u6570\u503c\uff0cregexp\u4ee3\u8868\u6b63\u5219\u8868\u8fbe\u5f0f\u30027.bootMenuEnabled\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u542f\u7528\u5f15\u5bfc\u83dc\u5355\u30028.domain\u5b57\u6bb5\uff0cDomainModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u57df\u76f8\u5173\u7684\u4fe1\u606f\uff0c\u53ea\u5728SysPrep\u6a21\u5f0f\u751f\u6548\u3002DomainModel\u5bf9\u8c61\u7684name\u5b57\u6bb5\u4ee3\u8868\u8fdb\u884c\u8ba4\u8bc1\u7684\u57df\u7684\u57df\u540d\uff1bDomainModel\u5bf9\u8c61\u7684user\u5b57\u6bb5\uff0c\u662fUserModel\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u57df\u7528\u6237\u4fe1\u606f\u3002UserModel\u7684name\u5b57\u6bb5\u4ee3\u8868\u57df\u7528\u6237\u540d\uff0cUserModel\u7684password\u5b57\u6bb5\u4ee3\u8868\u57df\u7528\u6237\u5bc6\u7801\u30029.customCpuModel\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7684cpu\u7c7b\u578b\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u865a\u62df\u673acpu\u7c7b\u578b\uff0c\u5fc5\u987b\u4e0e\u865a\u62df\u673a\u6240\u5728\u96c6\u7fa4\u7684cpu\u7c7b\u578b\u4e3a\u540c\u4e00\u4ea7\u5546\uff0c\u4e14\u4ee3\u6570\u5fc5\u987b\u7b49\u4e8e\u6216\u4f4e\u4e8e\u96c6\u7fa4cpu\u7c7b\u578b\u300210.customEmulatedMachine\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7684\u4eff\u771f\u673a\u300211.placementPolicy\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7684\u5b89\u7f6e\u7b56\u7565\uff08\u5373\u865a\u62df\u673a\u4e0e\u4e3b\u673a\u4e4b\u95f4\u7684\u5173\u7cfb\uff09\uff0c\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\u5f71\u54cd\u865a\u62df\u673a\u542f\u52a8\uff1ahosts\u5b57\u6bb5\uff0c\u662fHosts\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u865a\u62df\u673a\u53ef\u7528\u7684\u4e3b\u673a\u5217\u8868\u3002Hosts\u5bf9\u8c61\u662f\u7684HostModel\u96c6\u5408\u6620\u5c04\uff0c\u53ea\u6301\u6709\u4e00\u4e2aHostModel\u96c6\u5408\u7684\u5f15\u7528hosts\u5b57\u6bb5\u3002\u8fd9\u91cc\u53ea\u9700\u8981\u6307\u5b9aHostModel\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\uff0chost\u5fc5\u987b\u4e3a\u865a\u62df\u673a\u6240\u5728\u96c6\u7fa4\u7684\u4e3b\u673a\u3002\u5f53HostModel\u96c6\u5408\u4e3a\u7a7a\uff08\u6216\u8005null\uff09\u65f6\uff0c\u8868\u793a\u865a\u62df\u673a\u53ea\u80fd\u8fd0\u884c\u5728\u56fa\u5b9a\u4e3b\u673a\u4e0a\u300212.initialization\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u521d\u59cb\u5316\u76f8\u5173\u7684\u4fe1\u606f\uff0c\u53c2\u6570\u592a\u591a\u4e86\uff0c\u6682\u65f6\u5148\u4e0d\u6df1\u5165\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/start Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.1.19.\u865a\u62df\u673a\u65ad\u7535 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/stop Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.1.20.\u6302\u8d77\u865a\u62df\u673a \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/suspend Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.1.21.\u89e3\u51bb\u865a\u62df\u673a\u6587\u4ef6\u7cfb\u7edf \u5f53\u4e3a\u6b63\u5728\u8fd0\u884c\u7684\u865a\u62df\u673a\u62cd\u6444\u6d3b\u52a8\u5feb\u7167\u65f6\uff0c QEMU guest agent \u4f1a\u51bb\u7ed3\u548c\u89e3\u51bb\u865a\u62df\u673a\u7684\u6587\u4ef6\u7cfb\u7edf\u3002\u901a\u5e38\uff0c\u8fd9\u4e2a\u662f\u7531\u7ba1\u7406\u7cfb\u7edf\u81ea\u52a8\u5b8c\u6210\u7684\uff0c\u4f46\u865a\u62df\u673a\u5728\u4f7f\u7528 OpenStack Volume(Cinder) \u78c1\u76d8\u65f6\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u5fc5\u987b\u8fdb\u884c\u624b\u52a8\u8c03\u7528\u3002 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/thawfilesystems Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 1.1.22.\u751f\u6210\u663e\u793a\u4ee4\u724c \u7528\u4e8e\u751f\u6210\u6709\u65f6\u6548\u6027\u7684\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c\u6765\u8bbf\u95ee\u542f\u52a8\u72b6\u6001\u7684\u865a\u62df\u673a\u663e\u793a\u7a97\u53e3\u3002 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 ticket TicketModel body \u53ef\u9009\u53c2\u6570\uff0c\u5305\u62ecvalue\u503c\u548c\u6709\u6548\u65f6\u95f4\u4e24\u4e2a\u5b57\u6bb5\uff0c\u800c\u4e24\u4e2a\u5b57\u6bb5\u90fd\u662f\u53ef\u9009\u7684\uff0c\u5176\u4e2d\u8fc7\u671f\u65f6\u95f4\u7684\u9ed8\u8ba4\u503c\u4e3a2\u4e2a\u5c0f\u65f6\uff0cvalue\u503c\u9ed8\u8ba4\u503c\u4e3a\u968f\u673a\u5b57\u7b26\u4e32 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/ticket Body: { \"ticket\": { \"value\": \"abcd12345\", \"expiry\": 120 } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.1.23.\u64a4\u9500\u9884\u89c8\u955c\u50cf \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/undosnapshot Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 1.1.24.\u66f4\u65b0\u865a\u62df\u673a \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e filter Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u865a\u62df\u673a\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 next_run Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u66f4\u65b0\u7684\u4fe1\u606f\u662f\u5728\u865a\u62df\u673a\u4e0b\u6b21\u542f\u52a8\u65f6\u518d\u751f\u6548\uff0c\u8fd8\u662f\u5bf9\u865a\u62df\u673a\u7acb\u5373\u751f\u6548\uff0c\u8be5\u53c2\u6570\u7684\u9ed8\u8ba4\u503c\u4e3afalse\uff0c\u6240\u4ee5\u66f4\u65b0\u7684\u4fe1\u606f\u4f1a\u7acb\u5373\u751f\u6548 .. ... body \u9700\u8981\u66f4\u65b0\u7684\u865a\u62df\u673a\u4fe1\u606f\uff0c\u4e0e1.1.1\u4e2d\u65b0\u5efa\u865a\u62df\u673a\u53c2\u6570\u5927\u81f4\u76f8\u540c \u8bf7\u6c42\uff1a PUT /acloudageks/api/vms/{id} Body: { \"description\": \"\u6d4b\u8bd5\u66f4\u65b0\u865a\u62df\u673a\u4fe1\u606f\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 1.2.\u865a\u62df\u673a\u5e94\u7528 1.2.1.\u83b7\u5f97\u865a\u62df\u673a\u5df2\u5b89\u88c5\u5e94\u7528\u7a0b\u5e8f\u5217\u8868 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e filter Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u5e94\u7528\u7a0b\u5e8f\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u5e94\u7528\u7a0b\u5e8f\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{id}/applications \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.2.2.\u83b7\u5f97\u865a\u62df\u673a\u6307\u5b9a\u7684\u5df2\u5b89\u88c5\u5e94\u7528\u7a0b\u5e8f\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e filter Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u5e94\u7528\u7a0b\u5e8f\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/applications/{appid} \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 1.3.\u865a\u62df\u673a\u5149\u76d8 1.3.1.\u83b7\u5f97\u865a\u62df\u673a\u7684\u5149\u76d8\u8bbe\u5907\u5217\u8868 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u5149\u76d8\u8bbe\u5907\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{id}/cdroms \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.3.2.\u83b7\u5f97\u6307\u5b9a\u7684\u5149\u76d8\u8bbe\u5907\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e current Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u7531\u4e8e\u5bf9\u5149\u76d8\u4fe1\u606f\u7684\u4fee\u6539\u53ef\u4ee5\u7acb\u5373\u751f\u6548\uff0c\u4e5f\u53ef\u4ee5\u5728\u865a\u62df\u673a\u4e0b\u6b21\u542f\u52a8\u65f6\u751f\u6548\uff0c\u6240\u4ee5\u8be5\u503c\u8868\u793a\u83b7\u5f97\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684\u865a\u62df\u673a\u5149\u76d8\u4fe1\u606f\uff0c\u8fd8\u662f\u865a\u62df\u673a\u4e0b\u6b21\u542f\u52a8\u65f6\u7684\u5149\u76d8\u4fe1\u606f\uff0c\u9ed8\u8ba4\u503c\u4e3afalse \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/cdroms/{cdid} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.3.3.\u66f4\u65b0\u865a\u62df\u673a\u5149\u76d8\u4fe1\u606f \u66f4\u6539\u548c\u5f39\u51fa\u5149\u76d8\u90fd\u4f7f\u7528\u8be5\u63a5\u53e3\u8fdb\u884c\u64cd\u4f5c\uff0c\u901a\u8fc7\u8bbe\u7f6e\u7684 FileModel \u5bf9\u8c61\u7684id\u503c\u6765\u6267\u884c\u66f4\u6539\u548c\u5f39\u51fa\u5149\u76d8\u64cd\u4f5c\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e file FileModel body \u5fc5\u8981\u53c2\u6570\uff0c\u901a\u8fc7\u8bbe\u7f6efile\u5bf9\u8c61\u7684id\u503c\uff0c\u6765\u66f4\u6539\u6216\u5f39\u51fa\u78c1\u76d8\u3002ISO\u57df\u4e2d\u5fc5\u987b\u5b58\u5728\u4e0efile\u5bf9\u8c61id\u76f8\u5bf9\u5e94\u7684\u6587\u4ef6\uff0c\u5f53file\u5bf9\u8c61id\u4e0d\u4e3a\u7a7a\u65f6\uff0c\u6302\u8f7d\u76f8\u5e94\u7684iso\u6587\u4ef6\uff1b\u5f53id\u4e3a\u7a7a\u5219\u8868\u793a\u5f39\u51fa\u5149\u76d8\u3002 current Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u5bf9\u5149\u76d8\u4fe1\u606f\u7684\u4fee\u6539\u662f\u7acb\u5373\u5e94\u7528\u5230\u5f53\u524d\u8fd0\u884c\u7684\u865a\u62df\u673a\u4e0a\uff0c\u8fd8\u662f\u5728\u865a\u62df\u673a\u4e0b\u6b21\u542f\u52a8\u65f6\u751f\u6548\uff0c\u9ed8\u8ba4\u503c\u4e3afalse \u8bf7\u6c42\uff1a PUT /acloudageks/api/vms/{vmid}/cdroms/{cdid}?current=true Body: { \"file\": { \"id\": \"boot2docker.iso\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"CdromModel [file] required for update\", \"reason\": \"Incomplete parameters\" } 1.4.\u865a\u62df\u673a\u78c1\u76d8 \u4e0e\u865a\u62df\u673a\u78c1\u76d8\u76f8\u5173\u7684\u63a5\u53e3\u5728\u6574\u7406\u65f6\u4e22\u5931\u4e86\uff0c\u6240\u4ee5\u9700\u8981\u5728 VmResource \u63a5\u53e3\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u63a5\u53e3\u65b9\u6cd5\u624d\u80fd\u4f7f\u865a\u62df\u673a\u78c1\u76d8\u63a5\u53e3\u751f\u6548\u3002\u5728 ovirt3.0 \u865a\u62df\u673a\u78c1\u76d8\u76f8\u5173\u7684\u64cd\u4f5c\u5728\u6b64\u63a5\u53e3\u4e0b\u6267\u884c\uff0c\u4f46\u662f\u5728 ovirt4.0 \u4ee5\u540e\u7684\u865a\u62df\u673a\u78c1\u76d8\u76f8\u5173\u63a5\u53e3\u5728\u78c1\u76d8\u9644\u52a0\uff08DiskAttachments\uff09\u63a5\u53e3\u4e0b\u6267\u884c\uff0c\u4f46\u662f\u78c1\u76d8\u9644\u52a0\u63a5\u53e3\u7f3a\u5c11\u90e8\u5206\u64cd\u4f5c\uff08\u4f8b\u5982\u78c1\u76d8\u7684\u6fc0\u6d3b\u548c\u53d6\u6d88\u6fc0\u6d3b\u64cd\u4f5c\uff09\uff0c\u5e76\u4e14\u63a5\u53e3\u53c2\u6570\u4ee5\u53ca\u8fd4\u56de\u5bf9\u8c61\u7684\u5c5e\u6027\u4e5f\u53d1\u751f\u4e86\u6539\u53d8\uff0c\u5c06\u4f1a\u5728 1.5 \u8be6\u7ec6\u4ecb\u7ecd\u3002 @Path(\"disks\") VmDisksResource getDisksResource(); 1.4.1.\u6dfb\u52a0\u865a\u62df\u673a\u78c1\u76d8 \u6dfb\u52a0\u78c1\u76d8\u63a5\u53e3\u5b9e\u9645\u4e0a\u67092\u4e2a\u529f\u80fd\uff0c\u4e00\u4e2a\u662f\u9644\u52a0\u73b0\u6709\u78c1\u76d8\u5230\u6307\u5b9a\u865a\u62df\u673a\uff0c\u53e6\u4e00\u4e2a\u662f\u4e3a\u865a\u62df\u673a\u6dfb\u52a0\u78c1\u76d8\u3002\u4e24\u4e2a\u529f\u80fd\u901a\u8fc7\u662f\u5426\u4f20\u5165 diskId \u8fdb\u884c\u533a\u5206\u3002 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e id String body \u529f\u80fd\u533a\u5206\u53c2\u6570\uff0c\u5f53\u4f20\u5165\u6b64\u53c2\u6570\u65f6\uff0c\u8868\u793a\u8c03\u7528\u78c1\u76d8\u9644\u52a0\u529f\u80fd\uff0c\u5426\u5219\u8c03\u7528\u865a\u62df\u673a\u6dfb\u52a0\u78c1\u76d8\u529f\u80fd\u3002 bootable Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u4f5c\u4e3a\u5c06\u78c1\u76d8\u4f5c\u4e3a\u53ef\u5f15\u5bfc\u78c1\u76d8\uff0c\u9ed8\u8ba4\u503c\u4e3afalse\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6bcf\u4e2a\u865a\u62df\u673a\u53ea\u80fd\u6709\u4e00\u4e2a\u53ef\u5f15\u5bfc\u78c1\u76d8 interface String body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u78c1\u76d8\u63a5\u53e3\u7c7b\u578b\uff0c\u78c1\u76d8\u63a5\u53e3\u7c7b\u578b\u4e00\u5171\u6709\u4e09\u79cd\uff1aIDE\u3001VIRTIO_SCSI\u3001VIRTIO\uff1b\u9ed8\u8ba4\u7684\u63a5\u53e3\u7c7b\u578b\u4e3aVIRTIO active Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u6fc0\u6d3b\u78c1\u76d8\uff0c\u9ed8\u8ba4\u503c\u4e3afalse readOnly Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u78c1\u76d8\u662f\u5426\u53ea\u8bfb\uff0c\u9ed8\u8ba4\u503c\u4e3afalse snapshot SnapshotModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ec5\u5728\u78c1\u76d8\u9644\u52a0\u65f6\u6709\u6548\uff0c\u53ea\u9700\u8981\u6307\u5b9aSnapshotModel\u7684id\u53c2\u6570\uff0c\u6765\u6307\u5b9a\u78c1\u76d8\u5feb\u7167id\u3002 lunStorage HostStorageModel body \u4ec5\u5728\u78c1\u76d8\u521b\u5efa\u65f6\u6709\u6548\uff0c\u521b\u5efa\u5757\u8bbe\u5907\uff08lun\uff09\u7684\u78c1\u76d8\u65f6\uff0c\u5fc5\u987b\u4f20\u5165\u6b64\u53c2\u6570\uff0c\u5e76\u4e14\u5fc5\u987b\u6307\u5b9aHostStorageModel\u7684 logicalUnits \u5b57\u6bb5\u548c type \u5b57\u6bb5\u3002logicalUnits\u5b57\u6bb5\u7684\u7c7b\u578b\u4e3aLogicalUnits\u5bf9\u8c61\uff0cLogicalUnits\u5bf9\u8c61\u53ea\u6709\u4e00\u4e2alogicalUnits\u5b57\u6bb5\uff0c\u662f\u7531LogicalUnitModel\u5bf9\u8c61\u7ec4\u6210\u7684\u5217\u8868\uff1btype\u662f\u78c1\u76d8\u7684\u5b58\u50a8\u7c7b\u578b\uff0c\u5728\u521b\u5efalun\u65f6\uff0c\u53ef\u9009\u7684\u5b58\u50a8\u7c7b\u578b\u6709ISCSI\u548cFCP\u3002\u5f53type\u4e3aISCSI\u65f6\uff0cLogicalUnitModel\u5bf9\u8c61\u7684address\u3001target\u3001port\u3001id\u5b57\u6bb5\u4e0d\u80fd\u4e3a\u7a7a format String body \u4ec5\u5728\u78c1\u76d8\u521b\u5efa\u65f6\u6709\u6548\uff0c\u6307\u5b9a\u78c1\u76d8\u683c\u5f0f\uff0c\u521b\u5efa\u975e\u5757\u8bbe\u5907\u78c1\u76d8\u65f6\uff0c\u5fc5\u987b\u6307\u5b9a\u6b64\u53c2\u6570\uff0c\u53ef\u9009\u7684\u78c1\u76d8\u683c\u5f0f\u6709RAW\u548cCOW\u3002 provisionedSize Long body \u4ec5\u5728\u78c1\u76d8\u521b\u5efa\u65f6\u6709\u6548\uff0c\u6307\u5b9a\u78c1\u76d8\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3ab\uff0c\u521b\u5efa\u975e\u5757\u8bbe\u5907\u78c1\u76d8\u65f6\uff0c\u5fc5\u987b\u6307\u5b9a\u6b64\u53c2\u6570\u3002 storageDomains StorageDomains body \u7528\u4e8e\u6307\u5b9a\u78c1\u76d8\u7684\u5b58\u50a8\u57df\uff0c\u5728\u65b0\u5efa\u78c1\u76d8\u65f6\u5fc5\u987b\u6307\u5b9a\u6b64\u53c2\u6570\u3002StorageDomains\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aStorageDomainModel\u96c6\u5408\u7684\u5f15\u7528storageDomains\u5b57\u6bb5\uff0c\u6307\u5b9a\u78c1\u76d8\u5b58\u50a8\u57df\u65f6\u53ea\u9700\u8981\u6307\u5b9a\u96c6\u5408\u4e2d\u4e00\u4e2aStorageDomainModel\u7684id\u5b57\u6bb5\u5373\u53ef\uff0c\u5e76\u4e14\u540e\u53f0\u4f1a\u6839\u636eid\u83b7\u5f97\u6307\u5b9a\u5b58\u50a8\u57df\u5e76\u5c06\u78c1\u76d8\u7684\u5b58\u50a8\u57df\u7c7b\u578b\u8bbe\u7f6e\u4e3a\u4e0e\u6307\u5b9a\u5b58\u50a8\u57df\u76f8\u540c\u3002 name String body \u53ef\u9009\u53c2\u6570\uff0c\u78c1\u76d8\u522b\u540d\uff0c\u5df2\u5e9f\u5f03\u7684\u5b57\u6bb5\uff0c\u76ee\u524d\u4f7f\u7528alias\u5b57\u6bb5\u4ee3\u66ff\u3002 alias String body \u53ef\u9009\u53c2\u6570\uff0c\u78c1\u76d8\u522b\u540d\u3002 propagateErrors Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u4f20\u64ad\u9519\u8bef\u5230Guest\uff0c\u4f5c\u7528\u672a\u77e5\u3002 wipeAfterDelete Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u5728\u5220\u9664\u540e\u6e05\u7406\u3002 logicalName String body \u53ef\u9009\u53c2\u6570\uff0c\u78c1\u76d8\u903b\u8f91\u540d\uff0c\u4f5c\u7528\u672a\u77e5\u3002 description String body \u53ef\u9009\u53c2\u6570\uff0c\u78c1\u76d8\u63cf\u8ff0\u3002 lunStorage HostStorageModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ec5\u5728\u78c1\u76d8\u7c7b\u578b\u4e3alun\u65f6\u6709\u6548\uff0c\u8fd9\u91cc\u5148\u4e0d\u5c55\u5f00\u3002 usesScsiReservation Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u4ec5\u5728\u78c1\u76d8\u7c7b\u578b\u4e3alun\u65f6\u6709\u6548\uff0c\u4f5c\u7528\u672a\u77e5\u3002 sgio ScsiGenericIO body \u53ef\u9009\u53c2\u6570\uff0c\u4ec5\u5728\u78c1\u76d8\u7c7b\u578b\u4e3alun\u65f6\u6709\u6548\uff0c\u53ef\u9009\u503c\u6709FILTERED\u548cUNFILTERED\uff0c\u4f5c\u7528\u672a\u77e5\u3002 imageId String body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u78c1\u76d8\u6240\u5728\u5377\u7684id\u3002 sparse Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u78c1\u76d8\u662f\u5426\u4e3a\u7cbe\u7b80\u5206\u914d\uff0ctrue\u4e3a\u7cbe\u7b80\u5206\u914d\uff0cfalse\u4e3a\u9884\u5206\u914d\u3002 quota QuotaModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u78c1\u76d8\u914d\u989d\uff0c\u53ea\u9700\u8981\u6307\u5b9aQuotaModel\u7684id\u5b57\u6bb5\u5373\u53ef\u3002 diskProfile DiskProfile body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u78c1\u76d8\u914d\u7f6e\u96c6\uff0c\u53ea\u9700\u8981\u6307\u5b9aDiskProfile\u7684id\u5b57\u6bb5\u5373\u53ef\u3002 \u8bf7\u6c42\uff1a \u9644\u52a0\u78c1\u76d8 POST /acloudageks/api/vms/{vmid}/disks/ Body: { \"id\": \"3c0433b5-14b5-41ac-b2d5-3319b534b05e\", \"bootable\": true, \"interface\": \"IDE\", \"active\": true, \"readOnly\": false, \"snapshot\": { \"id\": \"d764f497-85a7-4585-b6f7-6fa3e4f8b085\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a \u672a\u6dfb\u52a0 snapshot \u53c2\u6570\u65f6\u8bf7\u6c42\u6210\u529f\uff0c\u6dfb\u52a0\u540e\u8bf7\u6c42\u5931\u8d25\u3002 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"DiskModel [snapshot.id] required for attachDiskToVm\", \"reason\": \"Incomplete parameters\" } \u65b0\u5efa\u78c1\u76d8\u5e76\u9644\u52a0\u5230\u865a\u62df\u673a \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/disks/ Body: { \"bootable\": true, \"interface\": \"IDE\", \"active\": false, \"readOnly\": true, \"format\": \"RAW\", \"provisionedSize\": 1073741824 } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"DiskModel [provisionedSize|size, format] required for invoke0\", \"reason\": \"Incomplete parameters\" } 1.4.2.\u5217\u51fa\u865a\u62df\u673a\u6240\u6709\u78c1\u76d8 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u865a\u62df\u673a\u78c1\u76d8\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/disks?max=1 \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.4.3.\u6fc0\u6d3b\u865a\u62df\u673a\u78c1\u76d8 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/disks/{diskId}/activate Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.4.4.\u53d6\u6d88\u6fc0\u6d3b\u865a\u62df\u673a\u78c1\u76d8 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/disks/{diskId}/deactivate Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.4.5.\u83b7\u5f97\u865a\u62df\u673a\u6307\u5b9a\u78c1\u76d8\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/disks/{diskId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.4.6.\u79fb\u52a8\u865a\u62df\u673a\u78c1\u76d8 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 filter Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u78c1\u76d8\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 storageDomain StorageDomainModel body \u5fc5\u8981\u53c2\u6570\uff0c\u9700\u8981\u6307\u5b9aStorageDomainModel\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/disks/{diskId}/move Body: { \"storageDomain\": { \"id\": \"263612f2-d67b-4ce3-9c3e-af05fd4795bf\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 1.4.7.\u5206\u79bb\u865a\u62df\u673a\u78c1\u76d8 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/vms/{vmid}/disks/{diskId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.4.8.\u66f4\u65b0\u865a\u62df\u673a\u78c1\u76d8\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 bootable Boolean body \u78c1\u76d8\u662f\u5426\u4f5c\u4e3a\u53ef\u5f15\u5bfc\u78c1\u76d8\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6bcf\u4e2a\u865a\u62df\u673a\u53ea\u80fd\u6709\u4e00\u4e2a\u53ef\u5f15\u5bfc\u78c1\u76d8 interface String body \u78c1\u76d8\u63a5\u53e3\u7c7b\u578b\uff0c\u78c1\u76d8\u63a5\u53e3\u7c7b\u578b\u4e00\u5171\u6709\u4e09\u79cd\uff1aIDE\u3001VIRTIO_SCSI\u3001VIRTIO readOnly Boolean body \u78c1\u76d8\u662f\u5426\u53ea\u8bfb\u3002 name String body \u78c1\u76d8\u522b\u540d\uff0c\u5df2\u5e9f\u5f03\u7684\u5b57\u6bb5\uff0c\u76ee\u524d\u4f7f\u7528alias\u5b57\u6bb5\u4ee3\u66ff\u3002 provisionedSize Long body \u78c1\u76d8\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3ab\u3002 alias String body \u78c1\u76d8\u522b\u540d\u3002 format String body \u5b9a\u78c1\u76d8\u683c\u5f0f\uff0c\u53ef\u9009\u7684\u78c1\u76d8\u683c\u5f0f\u6709RAW\u548cCOW\u3002 propagateErrors Boolean body \u662f\u5426\u4f20\u64ad\u9519\u8bef\u5230Guest\uff0c\u4f5c\u7528\u672a\u77e5\u3002 wipeAfterDelete Boolean body \u8868\u793a\u662f\u5426\u5728\u5220\u9664\u540e\u6e05\u7406\u3002 logicalName String body \u78c1\u76d8\u903b\u8f91\u540d\uff0c\u4f5c\u7528\u672a\u77e5\u3002 description String body \u78c1\u76d8\u63cf\u8ff0\u3002 lunStorage HostStorageModel body \u4ec5\u5728\u78c1\u76d8\u7c7b\u578b\u4e3alun\u65f6\u6709\u6548\uff0c\u8fd9\u91cc\u5148\u4e0d\u5c55\u5f00\u3002 usesScsiReservation Boolean body \u4ec5\u5728\u78c1\u76d8\u7c7b\u578b\u4e3alun\u65f6\u6709\u6548\uff0c\u4f5c\u7528\u672a\u77e5\u3002 sgio String body \u4ec5\u5728\u78c1\u76d8\u7c7b\u578b\u4e3alun\u65f6\u6709\u6548\uff0c\u53ef\u9009\u503c\u6709FILTERED\u548cUNFILTERED\uff0c\u4f5c\u7528\u672a\u77e5\u3002 imageId String body \u78c1\u76d8\u6240\u5728\u5377\u7684id\u3002 snapshot SnapshotModel body \u78c1\u76d8\u5feb\u7167\uff0c\u53ea\u9700\u8981\u6307\u5b9aSnapshotModel\u7684id\u5b57\u6bb5\uff0c\u6765\u6307\u5b9a\u78c1\u76d8\u5feb\u7167id\u3002 sparse Boolean body \u78c1\u76d8\u662f\u5426\u4e3a\u7cbe\u7b80\u5206\u914d\uff0ctrue\u4e3a\u7cbe\u7b80\u5206\u914d\uff0cfalse\u4e3a\u9884\u5206\u914d\u3002 storageDomains StorageDomains body \u4ee3\u8868\u78c1\u76d8\u6240\u5728\u7684\u5b58\u50a8\u57df\uff0cStorageDomains\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aStorageDomainModel\u96c6\u5408\u7684\u5f15\u7528storageDomains\u5b57\u6bb5\uff0c\u6307\u5b9a\u78c1\u76d8\u5b58\u50a8\u57df\u65f6\u53ea\u9700\u8981\u6307\u5b9a\u96c6\u5408\u4e2d\u4e00\u4e2aStorageDomainModel\u7684id\u5b57\u6bb5\u5373\u53ef\u3002 quota QuotaModel body \u78c1\u76d8\u914d\u989d\u6a21\u5f0f\uff0c\u53ea\u9700\u8981\u6307\u5b9aQuotaModel\u7684id\u5b57\u6bb5\u5373\u53ef\u3002 diskProfile DiskProfile body \u78c1\u76d8\u914d\u7f6e\u96c6\uff0c\u53ea\u9700\u8981\u6307\u5b9aDiskProfile\u7684id\u5b57\u6bb5\u5373\u53ef\u3002 \u8bf7\u6c42\uff1a PUT /acloudageks/api/vms/{vmid}/disks/{diskId} Body: { \"interface\": \"VIRTIO\", \"readOnly\": false, \"provisionedSize\": 2147483648, \"name\": \"update\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.5.\u865a\u62df\u673a\u9644\u52a0\u78c1\u76d8 \u4e0e 1.4 \u4e2d\u7684\u63a5\u53e3\u533a\u522b\u5728\u4e8e\u8fd4\u56de\u5bf9\u8c61\u7684\u5c5e\u6027\u4e0d\u540c\uff0c\u662f ovirt3.0 \u5230 ovirt4.0 \u7248\u672c\u53d8\u8fc1\u7684\u7ed3\u679c\uff0c\u4e0e 2.8 \u4e2d\u63a5\u53e3\u76f8\u6bd4\u7f3a\u5c11\u4e86\u90e8\u5206\u7684\u63a5\u53e3\u3002 1.5.1.\u6dfb\u52a0\u865a\u62df\u673a\u9644\u52a0\u78c1\u76d8 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e bootable Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u4f5c\u4e3a\u5c06\u78c1\u76d8\u4f5c\u4e3a\u53ef\u5f15\u5bfc\u78c1\u76d8\uff0c\u9ed8\u8ba4\u503c\u4e3afalse\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6bcf\u4e2a\u865a\u62df\u673a\u53ea\u80fd\u6709\u4e00\u4e2a\u53ef\u5f15\u5bfc\u78c1\u76d8 interface String body \u5fc5\u8981\u53c2\u6570\uff0c\u8868\u793a\u78c1\u76d8\u63a5\u53e3\u7c7b\u578b\uff0c\u78c1\u76d8\u63a5\u53e3\u7c7b\u578b\u4e00\u5171\u6709\u4e09\u79cd\uff1aIDE\u3001VIRTIO_SCSI\u3001VIRTIO\uff1b active Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u6fc0\u6d3b\u78c1\u76d8\uff0c\u9ed8\u8ba4\u503c\u4e3afalse disk DiskModel body \u5c01\u88c51.4.1\u4e2d\u7684\u5176\u4ed6\u53c2\u6570 \u8bf7\u6c42\uff1a \u9644\u52a0\u78c1\u76d8 POST /acloudageks/api/vms/{vmid}/diskattachments/ Body: { \"bootable\": false, \"interface\": \"IDE\", \"active\": true, \"disk\": { \"id\": \"220b052e-b0fe-4d6e-9412-a232d42342a9\", \"readOnly\": false, \"snapshot\": { \"id\": \"d764f497-85a7-4585-b6f7-6fa3e4f8b085\" } } } \u8bf7\u6c42\u7ed3\u679c\uff1a \u672a\u6dfb\u52a0 snapshot \u53c2\u6570\u65f6\u8bf7\u6c42\u6210\u529f\uff0c\u6dfb\u52a0\u540e\u8bf7\u6c42\u5931\u8d25\u3002 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"DiskModel [snapshot.id] required for attachDiskToVm\", \"reason\": \"Incomplete parameters\" } \u65b0\u5efa\u78c1\u76d8\u5e76\u9644\u52a0\u5230\u865a\u62df\u673a \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/diskattachments/ Body: { \"bootable\": false, \"interface\": \"IDE\", \"active\": false, \"disk\": { \"readOnly\": true, \"format\": \"RAW\", \"provisionedSize\": 1073741824 } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"DiskModel [provisionedSize|size, format] required for invoke0\", \"reason\": \"Incomplete parameters\" } 1.5.2.\u5217\u51fa\u865a\u62df\u673a\u6240\u6709\u9644\u52a0\u78c1\u76d8 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/diskattachments \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.5.3.\u83b7\u5f97\u865a\u62df\u673a\u6307\u5b9a\u7684\u9644\u52a0\u78c1\u76d8\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/diskattachments/{diskId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.5.4.\u5220\u9664\u6216\u5206\u79bb\u865a\u62df\u673a\u9644\u52a0\u78c1\u76d8 1.4.7\u7684\u5220\u9664\u63a5\u53e3 \u53ea\u80fd\u6267\u884c\u78c1\u76d8\u5206\u79bb\u64cd\u4f5c\uff0c\u4f46\u8be5\u63a5\u53e3\u53ef\u4ee5\u901a\u8fc7 detach_only \u53c2\u6570\u6765\u9009\u62e9\u5206\u79bb\u78c1\u76d8\u8fd8\u662f\u76f4\u63a5\u5220\u9664\u78c1\u76d8\u3002 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e detach_only Boolean url \u53ef\u9009\uff0c\u8868\u793a\u4ece\u865a\u62df\u673a\u5206\u79bb\u78c1\u76d8\u8fd8\u662f\u76f4\u63a5\u4ece\u7cfb\u7edf\u5220\u9664\u78c1\u76d8\uff0c\u9ed8\u8ba4\u503c\u4e3atrue \u8bf7\u6c42\uff1a DELETE /acloudageks/api/vms/{vmid}/disksattachments/{diskId}?detach_only=false \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.5.5.\u66f4\u65b0\u865a\u62df\u673a\u9644\u52a0\u78c1\u76d8\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e bootable Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u4f5c\u4e3a\u5c06\u78c1\u76d8\u4f5c\u4e3a\u53ef\u5f15\u5bfc\u78c1\u76d8\uff0c\u9ed8\u8ba4\u503c\u4e3afalse\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6bcf\u4e2a\u865a\u62df\u673a\u53ea\u80fd\u6709\u4e00\u4e2a\u53ef\u5f15\u5bfc\u78c1\u76d8 interface String body \u5fc5\u8981\u53c2\u6570\uff0c\u8868\u793a\u78c1\u76d8\u63a5\u53e3\u7c7b\u578b\uff0c\u78c1\u76d8\u63a5\u53e3\u7c7b\u578b\u4e00\u5171\u6709\u4e09\u79cd\uff1aIDE\u3001VIRTIO_SCSI\u3001VIRTIO\uff1b active Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u6fc0\u6d3b\u78c1\u76d8\uff0c\u9ed8\u8ba4\u503c\u4e3afalse disk DiskModel body \u5c01\u88c51.4.1\u4e2d\u7684\u5176\u4ed6\u53c2\u6570 \u8bf7\u6c42\uff1a PUT /acloudageks/api/vms/{vmid}/disksattachments/{diskId} Body: { \"interface\": \"IDE\", \"disk\": { \"name\": \"update2\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.6.\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3 1.6.1.\u6dfb\u52a0\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u5fc5\u8981\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u540d\u3002 vnicProfile VnicProfileModel body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u7684\u914d\u7f6e\u96c6\uff0c\u8be5\u53c2\u6570\u53ea\u9700\u8981\u6307\u5b9aVnicProfileModel\u7684id\u5b57\u6bb5\uff0c\u9ed8\u8ba4\u503c\u4e3anull interface String body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u7f51\u5361\u7684\u63a5\u53e3\u7c7b\u578b\uff0c\u53ef\u9009\u7684\u503c\u4e00\u5171\u67096\u79cd\uff1aE1000\u3001VIRTIO\u3001RTL8139\u3001RTL8139_VIRTIO\u3001SPAPR_VLAN\u3001PCI_PASSTHROUGH\u3002\u9ed8\u8ba4\u503c\u4e3aRTL8139_VIRTIO\uff0c\u4f46\u662f\u8be5\u503c\u5728\u540e\u53f0\u6807\u8bb0\u4e3a\u5e9f\u5f03\u72b6\u6001\uff0c\u56e0\u6b64\u5efa\u8bae\u624b\u52a8\u8bbe\u7f6e\u8be5\u503c\uff1b\u53e6\u5916\u8be5\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u6709\u5173\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u7cfb\u7edf\u90fd\u80fd\u591f\u8bbe\u7f6e6\u79cd\u53ef\u9009\u503c mac MacModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7684mac\u5730\u5740\uff0c\u9700\u8981\u6307\u5b9aMacModel\u7684address\u5b57\u6bb5\u3002\u82e5\u672a\u8bbe\u7f6e\u6b64\u503c\uff0c\u540e\u53f0\u4f1a\u4ecemac\u5730\u5740\u6c60\u5206\u914d\u5408\u9002\u7684mac\u5730\u5740 linked Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u662f\u5426\u8fde\u63a5\u7f51\u7ebf\uff0c\u9ed8\u8ba4\u503c\u4e3afalse plugged Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u7684\u7f51\u5361\u662f\u5df2\u63d2\u5165\u8fd8\u662f\u62d4\u51fa\u72b6\u6001\uff0c\u9ed8\u8ba4\u503c\u4e3afalse \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/nics/ Body: { \"name\": \"test_nic\", \"vnicProfile\": { \"id\": \"86684825-e8f8-43bb-97b0-6972e99eaf47\" }, \"interface\": \"VIRTIO\", \"linked\": true, \"plugged\": true } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"NicModel [name] required for add\", \"reason\": \"Incomplete parameters\" } 1.6.2.\u5217\u51fa\u865a\u62df\u673a\u6240\u6709\u7684\u7f51\u7edc\u63a5\u53e3 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/nics?max=1 \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.6.3.\u5c06\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u7f51\u5361\u8bbe\u7f6e\u4e3a\u63d2\u5165\u72b6\u6001 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/nics/{nicId}/activate Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.6.4.\u5c06\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u7f51\u5361\u8bbe\u7f6e\u4e3a\u62d4\u51fa\u72b6\u6001 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/nics/{nicId}/deactivate Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.6.5.\u83b7\u5f97\u865a\u62df\u673a\u6307\u5b9a\u7684\u7f51\u7edc\u63a5\u53e3\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/nics/{nicId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.6.6.\u5220\u9664\u6307\u5b9a\u7684\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/vms/{vmid}/nics/{nicId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.6.7.\u66f4\u65b0\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 name String body \u4fee\u6539\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u540d\u3002 vnicProfile VnicProfileModel body \u4fee\u6539\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u7684\u914d\u7f6e\u96c6\uff0c\u8be5\u53c2\u6570\u53ea\u9700\u8981\u6307\u5b9aVnicProfileModel\u7684id\u5b57\u6bb5 interface String body \u4fee\u6539\u7f51\u5361\u7684\u63a5\u53e3\u7c7b\u578b\uff0c\u53ef\u9009\u7684\u503c\u4e00\u5171\u67096\u79cd\uff1aE1000\u3001VIRTIO\u3001RTL8139\u3001RTL8139_VIRTIO\u3001SPAPR_VLAN\u3001PCI_PASSTHROUGH\u3002\u9ed8\u8ba4\u503c\u4e3aRTL8139_VIRTIO\uff0c\u4f46\u662f\u8be5\u503c\u5728\u540e\u53f0\u6807\u8bb0\u4e3a\u5e9f\u5f03\u72b6\u6001\uff0c\u56e0\u6b64\u5efa\u8bae\u624b\u52a8\u8bbe\u7f6e\u8be5\u503c\uff1b\u53e6\u5916\u8be5\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u6709\u5173\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u7cfb\u7edf\u90fd\u80fd\u591f\u8bbe\u7f6e6\u79cd\u53ef\u9009\u503c mac MacModel body \u4fee\u6539\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u7684mac\u5730\u5740\uff0c\u9700\u8981\u6307\u5b9aMacModel\u7684address\u5b57\u6bb5\u3002 linked Boolean body \u4fee\u6539\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u662f\u5426\u8fde\u63a5\u7f51\u7ebf plugged Boolean body \u4fee\u6539\u865a\u62df\u673a\u7684\u7f51\u5361\u662f\u5df2\u63d2\u5165\u8fd8\u662f\u62d4\u51fa\u72b6\u6001 \u8bf7\u6c42\uff1a PUT /acloudageks/api/vms/{vmid}/nics/{nicId} Body: { \"name\": \"updated_nic\", \"vnicProfile\": { \"id\": \"86684825-e8f8-43bb-97b0-6972e99eaf47\" }, \"interface\": \"RTL8139\", \"linked\": false, \"plugged\": false } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f \u6ce8\u610f \u865a\u62df\u673a\u7f51\u5361\u867d\u7136\u652f\u6301\u70ed\u63d2\u62d4\u529f\u80fd\uff0c\u4f46\u70ed\u63d2\u62d4\u529f\u80fd\u4ec5\u652f\u6301\u5177\u6709\u70ed\u63d2\u62d4\u64cd\u4f5c\u7684\u865a\u62df\u673a\u64cd\u4f5c\u7cfb\u7edf\u3002 \u793a\u4f8b\u64cd\u4f5c\u7cfb\u7edf\u5305\u62ec\uff1a Red Hat Enterprise Linux 6 Red Hat Enterprise Linux 5 Windows Server 2008 and Windows Server 2003 1.7.\u865a\u62df\u673a\u5feb\u7167 1.7.1.\u521b\u5efa\u865a\u62df\u673a\u5feb\u7167 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e description String body \u5fc5\u8981\u53c2\u6570\uff0c\u5feb\u7167\u63cf\u8ff0\u3002 persistMemorystate Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u662f\u5426\u4fdd\u5b58\u865a\u62df\u673a\u5185\u5b58\u72b6\u6001\u4f5c\u4e3a\u5feb\u7167\u7684\u4e00\u90e8\u5206\uff0c\u9ed8\u8ba4\u503c\u4e3afalse diskAttachments DiskAttachments body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u9700\u8981\u521b\u5efa\u5feb\u7167\u7684\u78c1\u76d8\u5217\u8868\uff0cDiskAttachments\u5bf9\u8c61\u4e3aDiskAttachmentModel\u96c6\u5408\u7684\u6620\u5c04\u53ea\u6301\u6709DiskAttachment\u96c6\u5408\u7684\u5f15\u7528diskAttachments\u5b57\u6bb5\uff0c\u800cDiskAttachment\u5bf9\u8c61\u53c8\u6301\u6709DiskModel\u5bf9\u8c61\u7684\u5f15\u7528disk\u5b57\u6bb5\uff0c\u8be5\u53c2\u6570\u5e94\u8be5\u662f\u7528\u6765\u6307\u5b9a\u9700\u8981\u6253\u5feb\u7167\u78c1\u76d8\uff0c\u53ea\u8981\u8bbe\u7f6eDiskModel\u5bf9\u8c61\u7684id\u5b57\u6bb5\u5373\u53ef\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/snapshots Body: { \"description\": \"My snapshot\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"SnapshotModel [description] required for doAdd\", \"reason\": \"Incomplete parameters\" } 1.7.2.\u5217\u51fa\u865a\u62df\u673a\u7684\u5feb\u7167 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u865a\u62df\u673a\u5feb\u7167\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/snapshots?max=1 \u8bf7\u6c42\u7ed3\u679c\uff1a\u672a\u521b\u5efa\u5feb\u7167\u65f6\uff0c\u8c03\u7528\u6210\u529f\uff1b\u5f53\u521b\u5efa\u5feb\u7167\u4ee5\u540e SecurityLevelMapper \u7684map\u65b9\u6cd5\u6267\u884c\u5931\u8d25\uff0c\u9700\u8981\u8fdb\u884c\u4ee5\u4e0b\u6539\u52a8\uff1a @Mapping(from = org.ovirt.engine.core.common.businessentities.SecurityLevel.class, to = SecurityLevel.class) public static SecurityLevel map(org.ovirt.engine.core.common.businessentities.SecurityLevel level) { if (level == null) { return com.phy.vms.api.model.SecurityLevel.NONE; } switch (level) { case LEVEL3: return com.phy.vms.api.model.SecurityLevel.LEVEL3; case LEVEL2: return com.phy.vms.api.model.SecurityLevel.LEVEL2; case LEVEL1: return com.phy.vms.api.model.SecurityLevel.LEVEL1; case LEVEL0: return com.phy.vms.api.model.SecurityLevel.LEVEL0; default: return com.phy.vms.api.model.SecurityLevel.NONE; } } 1.7.3.\u83b7\u5f97\u865a\u62df\u673a\u6307\u5b9a\u7684\u5feb\u7167\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/snapshots/{snapshotId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.7.4.\u5220\u9664\u865a\u62df\u673a\u6307\u5b9a\u7684\u5feb\u7167 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/vms/{vmid}/snapshots/{snapshotId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.7.5.\u5c06\u865a\u62df\u673a\u6062\u590d\u5230\u6307\u5b9a\u5feb\u7167 \u8be5\u63a5\u53e3\u5b9e\u9645\u4e0a\u6267\u884c\u4e86\u4e24\u6b65\u64cd\u4f5c\u3002\u9996\u5148\uff0c\u8fdb\u884c\u5feb\u7167\u9884\u89c8\uff0c\u5982\u679c\u672a\u51fa\u73b0\u5f02\u5e38\uff0c\u5219\u63a5\u7740\u8fdb\u884c\u9884\u89c8\u63d0\u4ea4\u64cd\u4f5c\uff1b\u5426\u5219\u8fd4\u56de\u5f02\u5e38\u4fe1\u606f\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e restoreMemory Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u6062\u590d\u5feb\u7167\u7684\u5185\u5b58\u72b6\u6001\uff0c\u9ed8\u8ba4\u503c\u4e3afalse disks Disks body \u53ef\u9009\u53c2\u6570\uff0cDisks\u5bf9\u8c61\u4e3aDiskModel\u96c6\u5408\u7684\u6620\u5c04\uff0cDisks\u5bf9\u8c61\u53ea\u6301\u6709DiskModel\u96c6\u5408\u7684\u5f15\u7528disks\u5b57\u6bb5\uff0c\u9700\u8981DiskModel\u7684\u5b8c\u6574\u7684\u4fe1\u606f\uff0c\u9ed8\u8ba4\u5bf9\u6240\u6709\u78c1\u76d8\u8fdb\u884c\u5feb\u7167\u9884\u89c8\u3002 \u8bf4\u660e\uff1a\u53c2\u6570\u4e2dDiskModel\u7684\u5b8c\u6574\u7684\u4fe1\u606f\u4e0d\u662f\u5f88\u5408\u7406\uff0c\u8fd9\u91cc\u5e94\u8be5\u6539\u4e3a\u53ea\u9700\u8981\u6307\u5b9aid\u5b57\u6bb5\u548cimageId\u5b57\u6bb5\u3002 ovirt4.3 \u4e2d\u7684\u903b\u8f91\u4e5f\u662f\u5982\u6b64\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/snapshots/{snapshotId}/restore Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.8\u6570\u636e\u4e2d\u5fc3 1.8.1.\u65b0\u5efa\u6570\u636e\u4e2d\u5fc3 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u5fc5\u8981\u53c2\u6570\uff0c\u6570\u636e\u4e2d\u5fc3\u540d local Boolean body \u5fc5\u8981\u53c2\u6570\uff0c\u8868\u793a\u6570\u636e\u4e2d\u5fc3\u4f7f\u7528\u672c\u5730\u5b58\u50a8\u8fd8\u662f\u5171\u4eab\u5b58\u50a8\u3002 description String body \u53ef\u9009\u53c2\u6570\uff0c\u6570\u636e\u4e2d\u5fc3\u63cf\u8ff0\uff0c\u9ed8\u8ba4\u4e3a\u7a7a\uff08\"\"\uff09 quotaMode String body \u53ef\u9009\u53c2\u6570\uff0c\u6570\u636e\u4e2d\u5fc3\u7684\u914d\u989d\u7c7b\u578b\uff0c\u53ef\u9009\u7684\u914d\u989d\u7c7b\u578b\u4e00\u5171\u67093\u79cd\uff1aENABLED\uff08\u542f\u52a8\uff09\u3001DISABLED\uff08\u7981\u7528\uff09\u3001AUDIT\uff08\u5ba1\u8ba1\uff09\uff0c\u9ed8\u8ba4\u7684\u914d\u989d\u7c7b\u578b\u4e3aDISABLED macPool MacPoolModel body \u53ef\u9009\u53c2\u6570\uff0c\u6570\u636e\u4e2d\u5fc3\u7684mac\u5730\u5740\u6c60\u5bf9\u8c61\uff0c\u9700\u8981\u6307\u5b9aMacPoolModel\u7684id\u5b57\u6bb5 \u8bf7\u6c42\uff1a POST /acloudageks/api/datacenters Body: { \"name\": \"mydc\", \"local\": false, \"description\": \"test dc\", \"quotaMode\": \"DISABLED\", \"macPool\": { \"id\": \"5dd7d3e9-00ef-0112-03e6-0000000002cb\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"DataCenterModel [name] required for add\", \"reason\": \"Incomplete parameters\" } 1.8.2.\u83b7\u5f97\u6240\u6709\u6570\u636e\u4e2d\u5fc3\u5217\u8868 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e case_sensitive Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u4e0esearch\u53c2\u6570\u4e00\u8d77\u4f7f\u7528\uff0c\u6307\u5b9a\u5728\u6267\u884csearch\u53c2\u6570\u65f6\u662f\u5426\u8003\u8651\u5927\u5c0f\u5199 filter Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6570\u636e\u4e2d\u5fc3\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u6570\u636e\u4e2d\u5fc3\u6570\u91cf search String url \u53ef\u9009\u53c2\u6570\uff0c\u67e5\u8be2\u7ea6\u675f\u6761\u4ef6\u7ea6\u675f\u8fd4\u56de\u4fe1\u606f\uff0c\u4f8b\u5982name=\"myname\" \u8bf7\u6c42\uff1a GET /acloudageks/api/datacenters \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.8.3.\u83b7\u5f97\u6307\u5b9a\u7684\u6570\u636e\u4e2d\u5fc3\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/datacenters/{datacenterId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.8.4\u5220\u9664\u6570\u636e\u4e2d\u5fc3 \u5220\u9664\u6570\u636e\u4e2d\u5fc3\u65f6\u5982\u679c\u6ca1\u6709\u6dfb\u52a0\u4efb\u4f55\u53c2\u6570\uff0c\u90a3\u4e48\u8fde\u63a5\u5230\u6570\u636e\u4e2d\u5fc3\u7684\u5b58\u50a8\u57df\u5c06\u88ab\u5206\u79bb\uff0c\u7136\u540e\u4ece\u5b58\u50a8\u4e2d\u5220\u9664\u3002\u5982\u679c\u6267\u884c\u6b64\u64cd\u4f5c\u65f6\u67d0\u4e9b\u64cd\u4f5c\u5931\u8d25\uff0c\u4f8b\u5982\uff0c\u5982\u679c\u6ca1\u6709\u4e3b\u673a\u53ef\u7528\u4e8e\u4ece\u5b58\u50a8\u4e2d\u5220\u9664\u5b58\u50a8\u57df\uff0c\u5219\u6574\u4e2a\u64cd\u4f5c\u5c06\u5931\u8d25\u3002 \u5982\u679cforce\u53c2\u6570\u4e3atrue\uff0c\u5219\u5220\u9664\u64cd\u4f5c\u65e0\u8bba\u5982\u4f55\u90fd\u4f1a\u6210\u529f\uff0c\u4f8b\u5982\uff0c\u5373\u4f7f\u5728\u5220\u9664\u4e00\u4e2a\u5b58\u50a8\u57df\u65f6\u67d0\u4e9b\u64cd\u4f5c\u5931\u8d25\u3002\u5931\u8d25\u7684\u64cd\u4f5c\u4f1a\u88ab\u5ffd\u7565\u8be5\uff0c\u5e76\u4e14\u4ece\u6570\u636e\u5e93\u4e2d\u5220\u9664\u6570\u636e\u4e2d\u5fc3\u7684\u4fe1\u606f\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e force Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u5f3a\u5236\u4ece\u6570\u636e\u5e93\u5220\u9664\u6570\u636e\u4e2d\u5fc3\u4fe1\u606f\uff0c\u5373\u4f7f\u5728\u5220\u9664\u8fc7\u7a0b\u4e2d\uff0c\u67d0\u4e9b\u64cd\u4f5c\u5931\u8d25\u4e86\uff0c\u9ed8\u8ba4\u503c\u4e3afalse \u8bf7\u6c42\uff1a DELETE /acloudageks/api/vms/{vmid}/datacenters/{datacenterId}?force=false \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.8.5.\u66f4\u65b0\u6570\u636e\u4e2d\u5fc3\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u6570\u636e\u4e2d\u5fc3\u540d local Boolean body \u8bbe\u7f6e\u6570\u636e\u4e2d\u5fc3\u4f7f\u7528\u672c\u5730\u5b58\u50a8\u8fd8\u662f\u5171\u4eab\u5b58\u50a8\uff0c\u4f46\u662f\u4e00\u65e6\u6570\u636e\u4e2d\u5fc3\u9644\u52a0\u4e86\u5b58\u50a8\u57df\uff0c\u5c31\u65e0\u6cd5\u4fee\u6539\u8be5\u503c\u3002 description String body \u6570\u636e\u4e2d\u5fc3\u63cf\u8ff0 quotaMode String body \u914d\u989d\u7c7b\u578b\uff0c\u53ef\u9009\u7684\u914d\u989d\u7c7b\u578b\u4e00\u5171\u67093\u79cd\uff1aENABLED\uff08\u542f\u52a8\uff09\u3001DISABLED\uff08\u7981\u7528\uff09\u3001AUDIT\uff08\u5ba1\u8ba1\uff09 macPool MacPoolModel body \u6570\u636e\u4e2d\u5fc3\u7684mac\u5730\u5740\u6c60\u5bf9\u8c61\uff0c\u9700\u8981\u6307\u5b9aMacPoolModel\u7684id\u5b57\u6bb5 \u8bf7\u6c42\uff1a PUT /acloudageks/api/datacenters/{datacenterId} Body: { \"name\": \"updateDefault\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.9\u6570\u636e\u4e2d\u5fc3\u5b58\u50a8 1.9.1.\u9644\u52a0\u5b58\u50a8\u57df\u5230\u6570\u636e\u4e2d\u5fc3 \u53ef\u4ee5\u901a\u8fc7\u8be5\u63a5\u53e3\u9644\u52a0\u6240\u6709\u7c7b\u578b\u7684\u5b58\u50a8\u57df\uff0c\u5373\u6570\u636e\u57df\u3001iso\u57df\u548c\u5bfc\u51fa\u57df\uff1b\u4f46\u524d\u63d0\u6761\u4ef6\u662f\u8981\u9644\u52a0\u7684\u5b58\u50a8\u57df\u672a\u9644\u52a0\u5230\u4efb\u4f55\u6570\u636e\u4e2d\u5fc3\uff0c\u5e76\u4e14\u4e0e\u88ab\u9644\u52a0\u7684\u6570\u636e\u4e2d\u5fc3\u7684\u5b58\u50a8\u7c7b\u578b\u4ee5\u53ca\u5b58\u50a8\u683c\u5f0f\u5411\u5339\u914d\u3002 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e id String body \u53ef\u9009\u5fc5\u8981\u53c2\u6570\uff0c\u8981\u9644\u52a0\u5230\u6570\u636e\u4e2d\u5fc3\u7684\u5b58\u50a8\u57dfid\uff0c\u5fc5\u987b\u6307\u5b9aid\u6216\u8005name\u5b57\u6bb5\u4e2d\u7684\u4e00\u4e2a\uff0c\u82e5\u4e24\u8005\u90fd\u6307\u5b9a\uff0cid\u5b57\u6bb5\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8ename\u5b57\u6bb5\u3002 name String body \u53ef\u9009\u5fc5\u8981\u53c2\u6570\uff0c\u8981\u9644\u52a0\u5230\u6570\u636e\u4e2d\u5fc3\u7684\u5b58\u50a8\u57df\u540d\u5b57\uff0c\u5fc5\u987b\u6307\u5b9aid\u6216\u8005name\u5b57\u6bb5\u4e2d\u7684\u4e00\u4e2a\uff0c\u82e5\u4e24\u8005\u90fd\u6307\u5b9a\uff0cid\u5b57\u6bb5\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8ename\u5b57\u6bb5\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/datacenters/{datacenterId}/storagedomains Body: { \"name\": \"data\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 1.9.2.\u83b7\u5f97\u6570\u636e\u4e2d\u5fc3\u6240\u6709\u7684\u9644\u52a0\u5b58\u50a8\u57df \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u5b58\u50a8\u57df\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/datacenters/{datacenterId}/storagedomains?max=1 \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.9.3.\u5c06\u6570\u636e\u4e2d\u5fc3\u6307\u5b9a\u7684\u5b58\u50a8\u57df\u8bbe\u7f6e\u4e3a\u7ef4\u62a4\u72b6\u6001 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/datacenters/{datacenterId}/storagedomains/{storagedomainId}/deactivate Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.9.4.\u5c06\u6570\u636e\u4e2d\u5fc3\u6307\u5b9a\u7684\u5b58\u50a8\u57df\u8bbe\u7f6e\u4e3a\u6fc0\u6d3b\u72b6\u6001 \u53ea\u80fd\u6fc0\u6d3b\u72b6\u6001\u4e3a\u7ef4\u62a4\u7684\u5b58\u50a8\u57df\u3002 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/datacenters/{datacenterId}/storagedomains/{storagedomainId}/activate Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.9.5.\u83b7\u5f97\u6570\u636e\u4e2d\u5fc3\u4fe1\u606f\u6307\u5b9a\u7684\u5b58\u50a8\u57df\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/datacenters/{datacenterId}/storagedomains/{storagedomainId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 1.9.6.\u4ece\u6570\u636e\u4e2d\u5fc3\u5206\u79bb\u5b58\u50a8\u57df \u8981\u5206\u79bb\u6570\u636e\u4e2d\u5fc3\u7684\u5b58\u50a8\u57df\uff0c\u5fc5\u987b\u5148\u5c06\u5b58\u50a8\u57df\u7684\u8bbe\u7f6e\u4e3a\u7ef4\u62a4\u72b6\u6001\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/vms/{vmid}/datacenters/{datacenterId}/storagedomains/{storagedomainId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 2.0\u6570\u636e\u4e2d\u5fc3\u903b\u8f91\u7f51\u7edc 2.0.1.\u4e3a\u6570\u636e\u4e2d\u5fc3\u521b\u5efa\u903b\u8f91\u7f51\u7edc \u5f53\u521b\u5efa\u903b\u8f91\u7f51\u7edc\u65f6\uff0c\u662f\u5fc5\u987b\u6307\u5b9a\u5176\u6240\u5c5e\u7684\u6570\u636e\u4e2d\u5fc3\u7684\uff1b\u901a\u8fc7\u8be5\u63a5\u53e3\u8c03\u7528\u903b\u8f91\u7f51\u7edc\u521b\u5efa\u63a5\u53e3\uff0c\u5b9e\u9645\u4e0a\u662f\u628a\u9700\u8981\u7684\u6570\u636e\u4e2d\u5fc3\u53c2\u6570\u653e\u5728url\u8fdb\u884c\u4f20\u9012\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u5fc5\u8981\u53c2\u6570\uff0c\u903b\u8f91\u7f51\u7edc\u540d description String body \u53ef\u9009\u53c2\u6570\uff0c\u903b\u8f91\u7f51\u7edc\u63cf\u8ff0 vlan VlanModel body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u8be5\u7f51\u7edc\u662f\u5426\u4e3avlan\uff0c\u53ea\u9700\u8981\u8bbe\u7f6evlan\u6807\u8bc6id\uff0cid\u4e3aInteger\u7c7b\u578b ip IpModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u903b\u8f91\u7f51\u7edc\u7684ip\u914d\u7f6e\uff0c\u62e5\u6709address\u5b57\u6bb5\u548cgateway\u5b57\u6bb5\uff0c\u76ee\u524d\u8fd8\u4e0d\u77e5\u9053\u8be5\u53c2\u6570\u6709\u4ec0\u4e48\u4f5c\u7528\uff0c\u901a\u8fc7ui\u754c\u9762\u65b0\u5efa\u903b\u8f91\u7f51\u7edc\u65f6\uff0c\u8fd9\u4e9b\u5b57\u6bb5\u90fd\u4e3a\u7a7a\u3002 usages NetworkUsageValues body \u53ef\u9009\u53c2\u6570\uff0c\u8be5\u5bf9\u8c61\u4e3aNetworkUsage\u96c6\u5408\u7684\u6620\u5c04\uff0c\u53ea\u6301\u6709NetworkUsage\u679a\u4e3e\u96c6\u5408\u7684\u5f15\u7528networkUsage\uff0c\u8be5\u53c2\u6570\u7528\u4e8e\u6307\u5b9a\u65b0\u5efa\u7684\u903b\u8f91\u7f51\u7edc\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u54ea\u4e9b\u7f51\u7edc\u4f7f\u7528\uff0c\u5305\u62ec\u4ee5\u4e0b\u56db\u79cd\uff1aDISPLAY\uff08\u663e\u793a\u7f51\u7edc\uff09\u3001MANAGEMENT\uff08\u7ba1\u7406\u7f51\u7edc\uff09\u3001MIGRATION\uff08\u8fc1\u79fb\u7f51\u7edc\uff09\u3001VM\uff08\u865a\u62df\u673a\u7f51\u7edc\uff09\u3002\u5176\u4e2d\u524d\u4e09\u79cd\u662f\u76f8\u5bf9\u4e8e\u96c6\u7fa4\u7684\uff08\u8fd9\u4e09\u79cd\u7f51\u7edc\u5bf9\u4e8e\u96c6\u7fa4\u6765\u8bf4\u90fd\u662f\u5fc5\u987b\u7684\uff0c\u8bbe\u7f6e\u7684\u76ee\u7684\u662f\u662f\u5426\u628a\u5f53\u524d\u7684\u903b\u8f91\u7f51\u7edc\u4f5c\u4e3a\u96c6\u7fa4\u7684\u67d0\u79cd\u6216\u591a\u79cd\u7f51\u7edc\uff09\uff0c\u6700\u540e\u4e00\u79cd\u662f\u76f8\u5bf9\u4e8e\u865a\u62df\u673a\u7684\uff08\u5373\u8be5\u7f51\u7edc\u662f\u5426\u80fd\u4f5c\u4e3a\u865a\u62df\u673a\u7684\u901a\u4fe1\u7f51\u7edc\uff09\u3002\u7531\u4e8e\u5728\u6570\u636e\u4e2d\u5fc3\u65e0\u6cd5\u8bbe\u7f6e\u96c6\u7fa4\u76f8\u5173\u5185\u5bb9\uff0c\u53ea\u80fd\u8bbe\u7f6e\u8be5\u7f51\u7edc\u662f\u5426\u4e3a\u865a\u62df\u673a\u7f51\u7edc\uff1b\u8bbe\u7f6e\u975e\u865a\u62df\u673a\u7f51\u7edc\u7684\u65b9\u6cd5\u4e3a\u5728NetworkUsageValues\u5217\u8868\u4e2d\u6dfb\u52a0\u4efb\u4e00\u975eVM\u7f51\u7edc\u5373\u53ef\uff1b\u4e0d\u8bbe\u7f6e\u8be5\u503c\u65f6\uff0c\u9ed8\u8ba4\u8be5\u7f51\u7edc\u4e3a\u865a\u62df\u673a\u7f51\u7edc\u3002 mtu Integer body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u903b\u8f91\u7f51\u7edc\u7684\u6700\u5927\u4f20\u8f93\u5355\u5143\uff0c\u9ed8\u8ba4\u503c\u4e3a0\uff0c\u8be5\u503c\u6709\u8303\u56f4\u8981\u6c42\u5fc5\u987b\u7b49\u4e8e0\u6216\u8005\u5927\u4e8e\u7b49\u4e8e68\u4e14\u5c0f\u4e8e\u7b49\u4e8e4094 profileRequired Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u9700\u8981\u521b\u5efa\u9ed8\u8ba4\u7684\u7f51\u7edc\u914d\u7f6e\u96c6\uff0c\u9ed8\u8ba4\u503c\u4e3afalse qos QosModel body \u53ef\u9009\u53c2\u6570\uff0c\u8bbe\u7f6e\u903b\u8f91\u7f51\u7edc\u7684\u8d28\u91cf\u670d\u52a1\uff0c\u9700\u8981\u6307\u5b9aQosModel\u7684id\u5b57\u6bb5 \u8bf7\u6c42\uff1a POST /acloudageks/api/datacenters/{datacenterId}/networks Body: { \"name\": \"mynetwork\", \"description\": \"test dc network\", \"vlan\": { \"id\": 6342 }, \"usages\": { \"networkUsage\": [ \"DISPLAY\" ] }, \"mtu\": 1500, \"profileRequired\": false } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"NetworkModel [name] required for add\", \"reason\": \"Incomplete parameters\" } 2.0.2.\u5217\u51fa\u6570\u636e\u4e2d\u5fc3\u6240\u6709\u7684\u903b\u8f91\u7f51\u7edc \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/datacenters/{datacenterId}/networks \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.0.3.\u83b7\u5f97\u6570\u636e\u4e2d\u5fc3\u6307\u5b9a\u7684\u903b\u8f91\u7f51\u7edc \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/datacenters/{datacenterId}/networks/{networkId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.0.4.\u5220\u9664\u6570\u636e\u4e2d\u5fc3\u6307\u5b9a\u7684\u903b\u8f91\u7f51\u7edc \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/datacenters/{datacenterId}/networks/{networkId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.0.5.\u66f4\u65b0\u6570\u636e\u4e2d\u5fc3\u6307\u5b9a\u7684\u903b\u8f91\u7f51\u7edc\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u903b\u8f91\u7f51\u7edc\u540d description String body \u903b\u8f91\u7f51\u7edc\u63cf\u8ff0 vlan VlanModel body \u8bbe\u7f6e\u8be5\u7f51\u7edc\u662f\u5426\u4e3avlan\uff0c\u53ea\u9700\u8981\u8bbe\u7f6evlan\u6807\u8bc6id\uff0cid\u4e3aInteger\u7c7b\u578b usages NetworkUsageValues body \u8be5\u5bf9\u8c61\u4e3aNetworkUsage\u96c6\u5408\u7684\u6620\u5c04\uff0c\u53ea\u6301\u6709NetworkUsage\u679a\u4e3e\u96c6\u5408\u7684\u5f15\u7528networkUsage\uff0c\u8be5\u53c2\u6570\u7528\u4e8e\u6307\u5b9a\u65b0\u5efa\u7684\u903b\u8f91\u7f51\u7edc\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u54ea\u4e9b\u7f51\u7edc\u4f7f\u7528\uff0c\u5305\u62ec\u4ee5\u4e0b\u56db\u79cd\uff1aDISPLAY\uff08\u663e\u793a\u7f51\u7edc\uff09\u3001MANAGEMENT\uff08\u7ba1\u7406\u7f51\u7edc\uff09\u3001MIGRATION\uff08\u8fc1\u79fb\u7f51\u7edc\uff09\u3001VM\uff08\u865a\u62df\u673a\u7f51\u7edc\uff09\u3002\u5176\u4e2d\u524d\u4e09\u79cd\u662f\u76f8\u5bf9\u4e8e\u96c6\u7fa4\u7684\uff08\u8fd9\u4e09\u79cd\u7f51\u7edc\u5bf9\u4e8e\u96c6\u7fa4\u6765\u8bf4\u90fd\u662f\u5fc5\u987b\u7684\uff0c\u8bbe\u7f6e\u7684\u76ee\u7684\u662f\u662f\u5426\u628a\u5f53\u524d\u7684\u903b\u8f91\u7f51\u7edc\u4f5c\u4e3a\u96c6\u7fa4\u7684\u67d0\u79cd\u6216\u591a\u79cd\u7f51\u7edc\uff09\uff0c\u6700\u540e\u4e00\u79cd\u662f\u76f8\u5bf9\u4e8e\u865a\u62df\u673a\u7684\uff08\u5373\u8be5\u7f51\u7edc\u662f\u5426\u80fd\u4f5c\u4e3a\u865a\u62df\u673a\u7684\u901a\u4fe1\u7f51\u7edc\uff09\u3002\u7531\u4e8e\u5728\u6570\u636e\u65e0\u6cd5\u8bbe\u7f6e\u96c6\u7fa4\u76f8\u5173\u5185\u5bb9\uff0c\u53ea\u80fd\u8bbe\u7f6e\u8be5\u7f51\u7edc\u662f\u5426\u4e3a\u865a\u62df\u673a\u7f51\u7edc\uff1b\u8bbe\u7f6e\u975e\u865a\u62df\u673a\u7f51\u7edc\u7684\u65b9\u6cd5\u4e3a\u5728NetworkUsageValues\u5217\u8868\u4e2d\u6dfb\u52a0\u4efb\u4e00\u975eVM\u7f51\u7edc\u5373\u53ef\uff1b\u4e0d\u8bbe\u7f6e\u8be5\u503c\u65f6\uff0c\u9ed8\u8ba4\u8be5\u7f51\u7edc\u4e3a\u865a\u62df\u673a\u7f51\u7edc\u3002 mtu Integer body \u903b\u8f91\u7f51\u7edc\u7684\u6700\u5927\u4f20\u8f93\u5355\u5143\uff0c\u9ed8\u8ba4\u503c\u4e3a0\uff0c\u8be5\u503c\u6709\u8303\u56f4\u8981\u6c42\u5fc5\u987b\u7b49\u4e8e0\u6216\u8005\u5927\u4e8e\u7b49\u4e8e68\u4e14\u5c0f\u4e8e\u7b49\u4e8e4094 qos QosModel body \u8bbe\u7f6e\u903b\u8f91\u7f51\u7edc\u7684\u8d28\u91cf\u670d\u52a1\uff0c\u9700\u8981\u6307\u5b9aQosModel\u7684id\u5b57\u6bb5 \u8bf7\u6c42\uff1a PUT /acloudageks/api/datacenters/{datacenterId}/networks/{networkId} Body: { \"name\": \"mynetwork\", \"description\": \"test dc network update\", \"vlan\": { \"id\": null }\uff0c \"usages\": { \"networkUsage\": [ \"DISPLAY\" ] }, \"mtu\": 68 } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.1\u8d28\u91cf\u670d\u52a1\uff08qos\uff09 \u670d\u52a1\u8d28\u91cf\u76f8\u5173\u7684\u63a5\u53e3\u5df2\u7ecf\u88ab\u5220\u9664\uff0c\u63a8\u6d4b\u53ef\u80fd\u662f\u5220quota\u76f8\u5173\u7684\u63a5\u53e3\u65f6\uff0c\u9519\u5220\u4e86qos\u63a5\u53e3\uff0c\u7559\u4e0b\u4e86quota\u63a5\u53e3\u3002 2.2\u96c6\u7fa4 2.2.1.\u521b\u5efa\u96c6\u7fa4 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u5fc5\u8981\u53c2\u6570\uff0c\u96c6\u7fa4\u540d dataCenter DataCenterModel body \u5fc5\u8981\u53c2\u6570\uff0c\u8868\u793a\u96c6\u7fa4\u6240\u5c5e\u7684\u6570\u636e\u4e2d\u5fc3\uff0c\u9700\u8981\u6307\u5b9a\u6570\u636e\u4e2d\u5fc3name\u6216\u8005id\u5b57\u6bb5 cpu CpuModel body \u5fc5\u8981\u53c2\u6570\uff0c\u53ef\u4ee5\u8bbe\u7f6e architecture \u5b57\u6bb5\uff08\u4ee3\u8868\u96c6\u7fa4cpu\u67b6\u6784\uff09\u548c type \u5b57\u6bb5\uff08\u4ee3\u8868\u96c6\u7fa4\u7684cpu\u7c7b\u578b\uff09\uff0c\u901a\u5e38\u53ea\u9700\u8981\u8bbe\u7f6etype\u5373\u53ef\uff0c\u56e0\u4e3acpu\u67b6\u6784\u4f1a\u6839\u636e\u8bbe\u7f6e\u7684cpu\u7c7b\u578b\u8fdb\u884c\u8bbe\u7f6e\uff0c\u5373\u4f7f\u8bbe\u7f6e\u4e86\u9519\u8befcpu\u67b6\u6784\uff0c\u4e5f\u4f1a\u6839\u636ecpu\u7c7b\u578b\u8fdb\u884c\u7ea0\u6b63\u3002\u53ef\u9009\u7684cpu\u67b6\u6784\u6709x86_64\u548cppc64\u3002ppc64\u4e0b\u53ef\u9009\u7684cpu\u7c7b\u578b\u53ea\u6709 IBM POWER8 \uff1b\u800cx86_64\u67b6\u6784\u4e0bcpu\u7c7b\u578b\u8f83\u591a\uff0c\u5305\u62ecAMD\u548c\u56e0\u7279\u5c14CPU\u5bb6\u65cf\uff0c\u5e38\u89c1\u7684\u6709 Intel SandyBridge Family \u3001 AMD Opteron G2 \u7b49\u3002 managementNetwork NetworkModel body \u5fc5\u8981\u53c2\u6570\uff0c\u7528\u4e8e\u8bbe\u7f6e\u96c6\u7fa4\u7684\u7ba1\u7406\u7f51\u7edc\uff0c\u9700\u8981\u6307\u5b9a\u903b\u8f91\u7f51\u7edc\u7684id\u6216\u8005name\u5b57\u6bb5 description String body \u53ef\u9009\u53c2\u6570\uff0c\u96c6\u7fa4\u63cf\u8ff0 switchType String body \u53ef\u9009\u53c2\u6570\uff0c\u96c6\u7fa4\u4ea4\u6362\u673a\u7c7b\u578b\uff0c\u53ef\u9009\u7684\u4ea4\u6362\u673a\u7c7b\u578b\u67092\u79cd\uff1aLEGACY\u3001OVS\uff0c\u9ed8\u8ba4\u503c\u4e3aLEGACY threadsAsCores Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u96c6\u7fa4\u4f18\u5316\u7b56\u7565\uff0c\u662f\u5426\u5c06\u4e3b\u673a\u7ebf\u7a0b\u4f5c\u4e3a\u865a\u62df\u673acpu\u5185\u6838\uff0c\u9ed8\u8ba4\u503c\u4e3afalse migration MigrationOptionsModel body \u53ef\u9009\u53c2\u6570\uff0cMigrationOptionsModel\u7684\u51e0\u4e2a\u5c5e\u6027\u6620\u5c04\u4e86\u96c6\u7fa4\u865a\u62df\u673a\u8fc1\u79fb\u7b56\u7565\u76843\u4e2a\u65b9\u9762\u30021. policy \u5b57\u6bb5\u662fMigrationPolicyModel\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u96c6\u7fa4\u7684\u8fc1\u79fb\u7b56\u7565\uff0c\u96c6\u7fa4\u53ef\u9009\u7684\u8fc1\u79fb\u7b56\u7565\u4e00\u5171\u67093\u79cd\uff1aLegacy\uff08id\u4e3a00000000-0000-0000-0000-000000000000\uff09\u3001Minimal downtime\uff08id\u4e3a80554327-0569-496b-bdeb-fcbbf52b827b\uff09\u548cSuspend workload if needed\uff08id\u4e3a80554327-0569-496b-bdeb-fcbbf52b827c\uff09\uff0c\u5176\u4e2dLegacy\u53ea\u8bbe\u7f6e\u4e86\u6700\u5927\u7684\u8fc1\u79fb\u6570\u91cf\u4e3a2\uff0c\u800c\u53e6\u59162\u79cd\u9009\u9879\u7684\u8be6\u7ec6\u914d\u7f6e\u89c1 vdc_optins \u8868\u7684 MigrationPolicies \u9009\u9879\uff0c\u8fc1\u79fb\u7b56\u7565\u9700\u8981\u8bbe\u7f6eMigrationPolicyModel\u5bf9\u8c61\u7684id\u5b57\u6bb5\uff0c\u9ed8\u8ba4\u503c\u4e3anull\uff1b2. bandwidth \u5b57\u6bb5\u662fMigrationBandwidthModel\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u96c6\u7fa4\u8fc1\u79fb\u5e26\u5bbd\u9650\u5236\uff0c\u7531MigrationBandwidthModel\u7684 assignmentMethod \u5b57\u6bb5\u8bbe\u7f6e\uff0c\u53ef\u9009\u7684\u9650\u5236\u67093\u79cd\uff1aAUTO\u3001HYPERVISOR_DEFAULT\u4ee5\u53caCUSTOM\uff0c\u9ed8\u8ba4\u503c\u4e3aAUTO\u3002\u5f53\u9009\u62e9\u7684\u9650\u5236\u4e3aCUSTOM\u65f6\uff0c\u9700\u8981\u8bbe\u7f6eMigrationBandwidthModel\u7684 customValue \u5b57\u6bb5\u5bf9\u5e26\u5bbd\u8fdb\u884c\u9650\u5236\uff08\u5355\u4f4d\u4e3aMbps\uff09\uff0c\u8be5\u503c\u53ef\u4ee5\u8bbe\u7f6e\u7684\u6700\u5c0f\u503c\u4e3a1\u30023. autoConverge \u5b57\u6bb5\u548c compressed \u5b57\u6bb5\uff0c\u5206\u522b\u8868\u793a\u662f\u5426\u81ea\u52a8\u805a\u5408\u8fc1\u79fb\u4ee5\u53ca\u662f\u5426\u542f\u7528\u8fc1\u79fb\u538b\u7f29\u3002\u53ea\u6709\u5728\u8fc1\u79fb\u7b56\u7565\u4e3a Legacy \u65f6\uff0c\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u5728\u865a\u62df\u673a\u8fc1\u79fb\u8fc7\u7a0b\u4e2d\u624d\u4f1a\u751f\u6548\uff0c\u5b83\u4eec\u7684\u53ef\u9009\u503c\u6709\u4e09\u79cd\uff1aTRUE\u3001FALSE\u3001INHERIT\uff08\u8868\u793a\u4ece\u5168\u5c40\u8bbe\u7f6e\u7ee7\u627f\uff09\uff0c\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u4e3anull\u3002 errorHandling ErrorHandlingModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u96c6\u7fa4\u865a\u62df\u673a\u8fc1\u79fb\u7684\u5f39\u6027\u7b56\u7565\uff0c\u5373\u5f53\u67d0\u53f0\u4e3b\u673a\u5b95\u673a\uff0c\u4e3b\u673a\u4e0a\u7684\u865a\u62df\u673a\u5982\u4f55\u5904\u7406\u7684\u7b56\u7565\u3002ErrorHandlingModel\u7684 onError \u5b57\u6bb5\u4ee3\u8868\u4e86\u5f39\u6027\u7b56\u7565\uff0c\u53ef\u9009\u503c\u67093\u79cd\uff1aMIGRATE\uff08\u8fc1\u79fb\u6240\u6709\u7684\u865a\u62df\u673a\uff09\u3001DO_NOT_MIGRATE\uff08\u4e0d\u8fc1\u79fb\u865a\u62df\u673a\uff09\u3001MIGRATE_HIGHLY_AVAILABLE\uff08\u53ea\u8fc1\u79fb\u9ad8\u53ef\u7528\u865a\u62df\u673a\uff09\u3002\u5982\u679c\u4e0d\u8bbe\u7f6e\u8be5\u503c\uff0c\u90a3\u4e48\u4f1a\u6839\u636e\u96c6\u7fa4\u7684cpu\u67b6\u6784\u662f\u5426\u652f\u6301\u8fc1\u79fb\u81ea\u52a8\u8bbe\u7f6e\u4e3a\u8fc1\u79fb\u6240\u6709\u7684\u865a\u62df\u673a\u6216\u4e0d\u8fc1\u79fb\u865a\u62df\u673a\u3002 schedulingPolicy SchedulingPolicyModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u96c6\u7fa4\u7684\u8c03\u5ea6\u7b56\u7565\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u8c03\u5ea6\u7b56\u7565\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\uff0cid\u5b57\u6bb5\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8ename\u5b57\u6bb5\u3002\u5185\u7f6e\u7684\u8c03\u5ea6\u7b56\u7565\u6709\u4ee5\u4e0b\u51e0\u79cd\uff0c\u683c\u5f0f\u4e3a name(id) \uff1a\u5e38\u89c4\u6a21\u5f0f\uff08b4ed2332-a7ac-4d5f-9596-99a439cb2812\uff09\u3001\u8282\u7535\u6a21\u5f0f\uff085a2b0939-7d46-4b73-a469-e9c2c7fc6a53\uff09\u3001\u865a\u62df\u673a\u5747\u5300\u5206\u5e03\u6a21\u5f0f\uff088d5d7bec-68de-4a67-b53e-0ac54686d579\uff09\u3001\u8d44\u6e90\u5747\u5300\u5206\u5e03\u6a21\u5f0f\uff0820d25257-b4bd-4589-92a6-c4c5c5d3fd1a\uff09\uff0c\u5177\u4f53\u914d\u7f6e\u6211\u4e5f\u770b\u4e0d\u61c2\uff0c\u5177\u4f53\u4fe1\u606f\u5b9a\u4e49\u5728 InternalClusterPolicies \u7c7b\u4e2d\u3002\u5982\u679c\u901a\u8fc7id\u548cname\u90fd\u6ca1\u627e\u5230\u5339\u914d\u7684\u8c03\u5ea6\u7b56\u7565\u5219\u4f7f\u7528\u9ed8\u8ba4\u7684\u8c03\u5ea6\u7b56\u7565\uff0c\u9ed8\u8ba4\u8c03\u5ea6\u7b56\u7565\u4e3a\u5e38\u89c4\u6a21\u5f0f\u3002 customSchedulingPolicyProperties Properties body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u8c03\u5ea6\u7b56\u7565\u7684\u53ef\u8986\u76d6\u5c5e\u6027\uff0c\u53ef\u4ee5\u5bf9\u8c03\u5ea6\u7b56\u7565\u7684\u5c5e\u6027\u8fdb\u884c\u8986\u76d6\u3002Properties\u5bf9\u8c61\u662fPropertyModel\u5bf9\u8c61\u96c6\u5408\u7684\u6620\u5c04\uff0c\u8be5\u5bf9\u8c61\u53ea\u6301\u6709\u96c6\u5408\u5f15\u7528\u5b57\u6bb5properties\uff0c\u9700\u8981\u8986\u76d6\u7684\u5c5e\u6027\u53ef\u4ee5\u8bbe\u7f6ePropertyModel\u5bf9\u8c61\u7684name\u548cvalue\u5b57\u6bb5\u3002 trustedService Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u542f\u52a8\u53ef\u4fe1\u670d\u52a1\uff0c\u9ed8\u8ba4\u503c\u4e3afalse haReservation Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u542f\u52a8\u9ad8\u53ef\u7528\u6027\u8d44\u6e90\u9884\u7559\uff0c\u9ed8\u8ba4\u503c\u4e3afalse fencingPolicy FencingPolicyModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u96c6\u7fa4\u9694\u79bb\u7b56\u7565\u7684\u51e0\u4e2a\u65b9\u9762\u30021. enabled \u5b57\u6bb5\u8868\u793a\u662f\u5426\u5f00\u542f\u96c6\u7fa4\u9694\u79bb\u7b56\u7565\uff0c\u53ea\u6709\u5f00\u542f\u96c6\u7fa4\u7b56\u7565\u4ee5\u540e\u5176\u4ed6\u5b57\u6bb5\u624d\u80fd\u751f\u6548\u30022. skipIfSdActive \u5b57\u6bb5\u662fSkipIfSdActive\u5bf9\u8c61\u7684\u5f15\u7528\uff0cSkipIfSdActive\u5bf9\u8c61\u7684 enable \u5b57\u6bb5\u8868\u793a\u662f\u5426\u5728\u4e3b\u673a\u50a8\u5b58\u4e0a\u6709\u5b9e\u65f6\u79df\u7ea6\u65f6\uff0c\u5ffd\u7565\u9694\u79bb\u64cd\u4f5c\u30023. skipIfConnectivityBroken \u5b57\u6bb5\u662fSkipIfConnectivityBroken\u5bf9\u8c61\u5f15\u7528\uff0c\u8be5\u5bf9\u8c61\u62e5\u6709 enable \u5b57\u6bb5\u548c threshold \u5b57\u6bb5\uff0cenable\u5b57\u6bb5\u8868\u793a\u662f\u5426\u5728\u4e3b\u673a\u5b58\u5728\u95ee\u9898\u7684\u8fde\u63a5\u8fbe\u5230\u9608\u503c\u65f6\u5ffd\u7565\u9694\u79bb\u64cd\u4f5c\uff0c\u800cthreshold\u5219\u662f\u5bf9\u9608\u503c\u8fdb\u884c\u8bbe\u7f6e\u3002\u5f53\u672a\u8bbe\u7f6eFencingPolicyModel\u5bf9\u8c61\u65f6\uff0c\u96c6\u7fa4\u9ed8\u8ba4\u542f\u52a8\u9694\u79bb\u7b56\u7565\uff0c\u5e76\u4e14\u5173\u95ed2\u548c3\u4e24\u4e2a\u8bbe\u7f6e\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/clusters Body: { \"name\": \"cluster\", \"dataCenter\": { \"name\": \"Default\" }, \"cpu\": { \"type\": \"Intel Penryn Family\" }, \"managementNetwork\": { \"id\": \"00000000-0000-0000-0000-000000000009\" }, \"description\": \"test creat cluster\", \"switchType\": \"LEGACY\", \"migration\": { \"policy\": { \"id\": \"80554327-0569-496b-bdeb-fcbbf52b827b\" }, \"bandwidth\": { \"assignmentMethod\": \"CUSTOM\", \"customValue\": 1234 } }, \"errorHandling\": { \"onError\": \"MIGRATE_HIGHLY_AVAILABLE\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"ClusterModel [name, dataCenter.name|id] required for add\", \"reason\": \"Incomplete parameters\" } 2.2.2.\u83b7\u5f97\u6240\u6709\u7684\u96c6\u7fa4\u5217\u8868 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e case_sensitive Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u4e0esearch\u53c2\u6570\u4e00\u8d77\u4f7f\u7528\uff0c\u6307\u5b9a\u5728\u6267\u884csearch\u53c2\u6570\u65f6\u662f\u5426\u8003\u8651\u5927\u5c0f\u5199 filter Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u96c6\u7fa4\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u96c6\u7fa4\u6570\u91cf search String url \u53ef\u9009\u53c2\u6570\uff0c\u67e5\u8be2\u7ea6\u675f\u6761\u4ef6\u7ea6\u675f\u8fd4\u56de\u4fe1\u606f\uff0c\u4f8b\u5982name=\"myname\" \u8bf7\u6c42\uff1a GET /acloudageks/api/clusters \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.2.3.\u83b7\u5f97\u6307\u5b9a\u7684\u96c6\u7fa4\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e filter Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u96c6\u7fa4\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 \u8bf7\u6c42\uff1a GET /acloudageks/api/clusters/{clustersId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.2.4.\u5220\u9664\u6307\u5b9a\u7684\u96c6\u7fa4 \u5220\u9664\u96c6\u7fa4\u524d\uff0c\u5fc5\u987b\u4fdd\u8bc1\u96c6\u7fa4\u4e2d\u4e0d\u5b58\u5728\u865a\u62df\u673a\u548c\u4e3b\u673a \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/clusters/{clustersId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.2.5.\u5f3a\u5236\u91cd\u7f6e\u4eff\u771f\u673a \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/clusters/{clustersId}/resetemulatedmachine Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.2.6.\u66f4\u65b0\u96c6\u7fa4\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u5fc5\u8981\u53c2\u6570\uff0c\u96c6\u7fa4\u540d cpu CpuModel body \u53ef\u4ee5\u4fee\u6539 architecture \u5b57\u6bb5\uff08\u4ee3\u8868\u96c6\u7fa4cpu\u67b6\u6784\uff09\u548c type \u5b57\u6bb5\uff08\u4ee3\u8868\u96c6\u7fa4\u7684cpu\u7c7b\u578b\uff09\uff0c\u901a\u5e38\u53ea\u9700\u8981\u8bbe\u7f6etype\u5373\u53ef\uff0c\u56e0\u4e3acpu\u67b6\u6784\u4f1a\u6839\u636e\u8bbe\u7f6e\u7684cpu\u7c7b\u578b\u8fdb\u884c\u8bbe\u7f6e\uff0c\u5373\u4f7f\u8bbe\u7f6e\u4e86\u9519\u8befcpu\u67b6\u6784\uff0c\u4e5f\u4f1a\u6839\u636ecpu\u7c7b\u578b\u8fdb\u884c\u7ea0\u6b63\u3002\u53ef\u9009\u7684cpu\u67b6\u6784\u6709x86_64\u548cppc64\u3002ppc64\u4e0b\u53ef\u9009\u7684cpu\u7c7b\u578b\u53ea\u6709 IBM POWER8 \uff1b\u800cx86_64\u67b6\u6784\u4e0bcpu\u7c7b\u578b\u8f83\u591a\uff0c\u5305\u62ecAMD\u548c\u56e0\u7279\u5c14CPU\u5bb6\u65cf\uff0c\u5e38\u89c1\u7684\u6709 Intel SandyBridge Family \u3001 AMD Opteron G2 \u7b49\u3002 description String body \u96c6\u7fa4\u63cf\u8ff0 switchType String body \u96c6\u7fa4\u4ea4\u6362\u673a\u7c7b\u578b\uff0c\u53ef\u9009\u7684\u4ea4\u6362\u673a\u7c7b\u578b\u67092\u79cd\uff1aLEGACY\u3001OVS\uff0c\u9ed8\u8ba4\u503c\u4e3aLEGACY threadsAsCores Boolean body \u96c6\u7fa4\u4f18\u5316\u7b56\u7565\uff0c\u662f\u5426\u5c06\u4e3b\u673a\u7ebf\u7a0b\u4f5c\u4e3a\u865a\u62df\u673acpu\u5185\u6838 migration MigrationOptionsModel body MigrationOptionsModel\u7684\u51e0\u4e2a\u5c5e\u6027\u6620\u5c04\u4e86\u96c6\u7fa4\u865a\u62df\u673a\u8fc1\u79fb\u7b56\u7565\u76843\u4e2a\u65b9\u9762\u30021. policy \u5b57\u6bb5\u662fMigrationPolicyModel\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u96c6\u7fa4\u7684\u8fc1\u79fb\u7b56\u7565\uff0c\u96c6\u7fa4\u53ef\u9009\u7684\u8fc1\u79fb\u7b56\u7565\u4e00\u5171\u67093\u79cd\uff1aLegacy\uff08id\u4e3a00000000-0000-0000-0000-000000000000\uff09\u3001Minimal downtime\uff08id\u4e3a80554327-0569-496b-bdeb-fcbbf52b827b\uff09\u548cSuspend workload if needed\uff08id\u4e3a80554327-0569-496b-bdeb-fcbbf52b827c\uff09\uff0c\u5176\u4e2dLegacy\u53ea\u8bbe\u7f6e\u4e86\u6700\u5927\u7684\u8fc1\u79fb\u6570\u91cf\u4e3a2\uff0c\u800c\u53e6\u59162\u79cd\u9009\u9879\u7684\u8be6\u7ec6\u914d\u7f6e\u89c1 vdc_optins \u8868\u7684 MigrationPolicies \u9009\u9879\uff0c\u8fc1\u79fb\u7b56\u7565\u9700\u8981\u8bbe\u7f6eMigrationPolicyModel\u5bf9\u8c61\u7684id\u5b57\u6bb5\u30022. bandwidth \u5b57\u6bb5\u662fMigrationBandwidthModel\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u96c6\u7fa4\u8fc1\u79fb\u5e26\u5bbd\u9650\u5236\uff0c\u7531MigrationBandwidthModel\u7684 assignmentMethod \u5b57\u6bb5\u8bbe\u7f6e\uff0c\u53ef\u9009\u7684\u9650\u5236\u67093\u79cd\uff1aAUTO\u3001HYPERVISOR_DEFAULT\u4ee5\u53caCUSTOM\u3002\u5f53\u9009\u62e9\u7684\u9650\u5236\u4e3aCUSTOM\u65f6\uff0c\u9700\u8981\u8bbe\u7f6eMigrationBandwidthModel\u7684 customValue \u5b57\u6bb5\u5bf9\u5e26\u5bbd\u8fdb\u884c\u9650\u5236\uff08\u5355\u4f4d\u4e3aMbps\uff09\uff0c\u8be5\u503c\u53ef\u4ee5\u8bbe\u7f6e\u7684\u6700\u5c0f\u503c\u4e3a1\u30023. autoConverge \u5b57\u6bb5\u548c compressed \u5b57\u6bb5\uff0c\u5206\u522b\u8868\u793a\u662f\u5426\u81ea\u52a8\u805a\u5408\u8fc1\u79fb\u4ee5\u53ca\u662f\u5426\u542f\u7528\u8fc1\u79fb\u538b\u7f29\u3002\u53ea\u6709\u5728\u8fc1\u79fb\u7b56\u7565\u4e3a Legacy \u65f6\uff0c\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u5728\u865a\u62df\u673a\u8fc1\u79fb\u8fc7\u7a0b\u4e2d\u624d\u4f1a\u751f\u6548\uff0c\u5b83\u4eec\u7684\u53ef\u9009\u503c\u6709\u4e09\u79cd\uff1aTRUE\u3001FALSE\u3001INHERIT\uff08\u8868\u793a\u4ece\u5168\u5c40\u8bbe\u7f6e\u7ee7\u627f\uff09\u3002 errorHandling ErrorHandlingModel body \u4ee3\u8868\u96c6\u7fa4\u865a\u62df\u673a\u8fc1\u79fb\u7684\u5f39\u6027\u7b56\u7565\uff0c\u5373\u5f53\u67d0\u53f0\u4e3b\u673a\u5b95\u673a\uff0c\u4e3b\u673a\u4e0a\u7684\u865a\u62df\u673a\u5982\u4f55\u5904\u7406\u7684\u7b56\u7565\u3002ErrorHandlingModel\u7684 onError \u5b57\u6bb5\u4ee3\u8868\u4e86\u5f39\u6027\u7b56\u7565\uff0c\u53ef\u9009\u503c\u67093\u79cd\uff1aMIGRATE\uff08\u8fc1\u79fb\u6240\u6709\u7684\u865a\u62df\u673a\uff09\u3001DO_NOT_MIGRATE\uff08\u4e0d\u8fc1\u79fb\u865a\u62df\u673a\uff09\u3001MIGRATE_HIGHLY_AVAILABLE\uff08\u53ea\u8fc1\u79fb\u9ad8\u53ef\u7528\u865a\u62df\u673a\uff09\u3002 schedulingPolicy SchedulingPolicyModel body \u4ee3\u8868\u96c6\u7fa4\u7684\u8c03\u5ea6\u7b56\u7565\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u8c03\u5ea6\u7b56\u7565\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\uff0cid\u5b57\u6bb5\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8ename\u5b57\u6bb5\u3002\u5185\u7f6e\u7684\u8c03\u5ea6\u7b56\u7565\u6709\u4ee5\u4e0b\u51e0\u79cd\uff0c\u683c\u5f0f\u4e3a name(id) \uff1a\u5e38\u89c4\u6a21\u5f0f\uff08b4ed2332-a7ac-4d5f-9596-99a439cb2812\uff09\u3001\u8282\u7535\u6a21\u5f0f\uff085a2b0939-7d46-4b73-a469-e9c2c7fc6a53\uff09\u3001\u865a\u62df\u673a\u5747\u5300\u5206\u5e03\u6a21\u5f0f\uff088d5d7bec-68de-4a67-b53e-0ac54686d579\uff09\u3001\u8d44\u6e90\u5747\u5300\u5206\u5e03\u6a21\u5f0f\uff0820d25257-b4bd-4589-92a6-c4c5c5d3fd1a\uff09\uff0c\u5177\u4f53\u914d\u7f6e\u6211\u4e5f\u770b\u4e0d\u61c2\uff0c\u5177\u4f53\u4fe1\u606f\u5b9a\u4e49\u5728 InternalClusterPolicies \u7c7b\u4e2d\u3002 customSchedulingPolicyProperties Properties body \u4ee3\u8868\u8c03\u5ea6\u7b56\u7565\u7684\u53ef\u8986\u76d6\u5c5e\u6027\uff0c\u53ef\u4ee5\u5bf9\u8c03\u5ea6\u7b56\u7565\u7684\u5c5e\u6027\u8fdb\u884c\u8986\u76d6\u3002Properties\u5bf9\u8c61\u662fPropertyModel\u5bf9\u8c61\u96c6\u5408\u7684\u6620\u5c04\uff0c\u8be5\u5bf9\u8c61\u53ea\u6301\u6709\u96c6\u5408\u5f15\u7528\u5b57\u6bb5properties\uff0c\u9700\u8981\u8986\u76d6\u7684\u5c5e\u6027\u53ef\u4ee5\u8bbe\u7f6ePropertyModel\u5bf9\u8c61\u7684name\u548cvalue\u5b57\u6bb5\u3002 trustedService Boolean body \u8868\u793a\u662f\u5426\u542f\u52a8\u53ef\u4fe1\u670d\u52a1 haReservation Boolean body \u8868\u793a\u662f\u5426\u542f\u52a8\u9ad8\u53ef\u7528\u6027\u8d44\u6e90\u9884\u7559 fencingPolicy FencingPolicyModel body \u4ee3\u8868\u96c6\u7fa4\u9694\u79bb\u7b56\u7565\u7684\u51e0\u4e2a\u65b9\u9762\u30021. enabled \u5b57\u6bb5\u8868\u793a\u662f\u5426\u5f00\u542f\u96c6\u7fa4\u9694\u79bb\u7b56\u7565\uff0c\u53ea\u6709\u5f00\u542f\u96c6\u7fa4\u7b56\u7565\u4ee5\u540e\u5176\u4ed6\u5b57\u6bb5\u624d\u80fd\u751f\u6548\u30022. skipIfSdActive \u5b57\u6bb5\u662fSkipIfSdActive\u5bf9\u8c61\u7684\u5f15\u7528\uff0cSkipIfSdActive\u5bf9\u8c61\u7684 enable \u5b57\u6bb5\u8868\u793a\u662f\u5426\u5728\u4e3b\u673a\u50a8\u5b58\u4e0a\u6709\u5b9e\u65f6\u79df\u7ea6\u65f6\uff0c\u5ffd\u7565\u9694\u79bb\u64cd\u4f5c\u30023. skipIfConnectivityBroken \u5b57\u6bb5\u662fSkipIfConnectivityBroken\u5bf9\u8c61\u5f15\u7528\uff0c\u8be5\u5bf9\u8c61\u62e5\u6709 enable \u5b57\u6bb5\u548c threshold \u5b57\u6bb5\uff0cenable\u5b57\u6bb5\u8868\u793a\u662f\u5426\u5728\u4e3b\u673a\u5b58\u5728\u95ee\u9898\u7684\u8fde\u63a5\u8fbe\u5230\u9608\u503c\u65f6\u5ffd\u7565\u9694\u79bb\u64cd\u4f5c\uff0c\u800cthreshold\u5219\u662f\u5bf9\u9608\u503c\u8fdb\u884c\u8bbe\u7f6e\u3002 \u8bf7\u6c42\uff1a PUT /acloudageks/api/clusters/{clustersId} Body: { \"name\": \"cluster_updated\", \"cpu\": { \"type\": \"Intel Penryn Family\" }, \"description\": \"test update cluster\", \"switchType\": \"LEGACY\", \"migration\": { \"policy\": { \"id\": \"80554327-0569-496b-bdeb-fcbbf52b827b\" }, \"bandwidth\": { \"assignmentMethod\": \"CUSTOM\", \"customValue\": 1234 } }, \"errorHandling\": { \"onError\": \"MIGRATE_HIGHLY_AVAILABLE\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.3.\u96c6\u7fa4\u903b\u8f91\u7f51\u7edc 2.3.1.\u5206\u914d\u96c6\u7fa4\u903b\u8f91\u7f51\u7edc \u5728\u96c6\u7fa4\u6240\u5728\u7684\u6570\u636e\u4e2d\u5fc3\u62e5\u6709\u7684\u903b\u8f91\u7f51\u7edc\u5206\u914d\u7ed9\u6307\u5b9a\u96c6\u7fa4\uff0c\u5e76\u4e14\u4e5f\u53ef\u4ee5\u5bf9\u7f51\u7edc\u8fdb\u884c\u4ee5\u4e0b\u8bbe\u7f6e\uff1a \u8bbe\u7f6e\u903b\u8f91\u7f51\u7edc\u662f\u5426\u662f\u8be5\u96c6\u7fa4\u5fc5\u987b\u7684 \u8bbe\u7f6e\u903b\u8f91\u7f51\u7edc\u662f\u5426\u4f5c\u4e3a\u8be5\u96c6\u7fa4\u7684\u663e\u793a\u7f51\u7edc \u8bbe\u7f6e\u903b\u8f91\u7f51\u7edc\u662f\u5426\u4f5c\u4e3a\u8be5\u96c6\u7fa4\u7684\u8fc1\u79fb\u7f51\u7edc \u9700\u8981\u6ce8\u610f\u7684\u662f\u5206\u914d\u7f51\u7edc\u65f6\uff0c\u4e0d\u80fd\u5c06\u8be5\u7f51\u7edc\u8bbe\u7f6e\u4e3a\u96c6\u7fa4\u7ba1\u7406\u7f51\u7edc\uff0c\u539f\u56e0\u53ef\u80fd\u662f\uff0c\u53ea\u6709\u7f51\u7edc\u4e3a\u96c6\u7fa4\u7684\u5fc5\u987b\u7f51\u7edc\u624d\u80fd\u88ab\u8bbe\u7f6e\u4e3a\u7ba1\u7406\u7f51\u7edc\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u5fc5\u8981\u53c2\u6570\uff0c\u7531\u4e8e\u540e\u53f0\u9a8c\u8bc1\u7684\u539f\u56e0\u8fd9\u91cc\u5fc5\u987b\u6307\u5b9a\uff1b\u903b\u8f91\u7f51\u7edc\u540d display Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u662f\u5426\u5c06\u8be5\u7f51\u7edc\u4f5c\u4e3a\u96c6\u7fa4\u7684\u663e\u793a\u7f51\u7edc\uff0c\u65b9\u4fbf\u5feb\u901f\u8bbe\u7f6e\u6307\u5b9a\u7f51\u7edc\u4e3a\u663e\u793a\u7f51\u7edc usages NetworkUsageValues body \u53ef\u9009\u53c2\u6570\uff0c\u8be5\u5bf9\u8c61\u4e3aNetworkUsage\u96c6\u5408\u7684\u6620\u5c04\uff0c\u53ea\u6301\u6709NetworkUsage\u679a\u4e3e\u96c6\u5408\u7684\u5f15\u7528networkUsage\uff0c\u8be5\u53c2\u6570\u7528\u4e8e\u6307\u5b9a\u65b0\u5efa\u7684\u903b\u8f91\u7f51\u7edc\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u54ea\u4e9b\u7f51\u7edc\u4f7f\u7528\uff0c\u5305\u62ec\u4ee5\u4e0b\u56db\u79cd\uff1aDISPLAY\uff08\u663e\u793a\u7f51\u7edc\uff09\u3001MANAGEMENT\uff08\u7ba1\u7406\u7f51\u7edc\uff09\u3001MIGRATION\uff08\u8fc1\u79fb\u7f51\u7edc\uff09\u3001VM\uff08\u865a\u62df\u673a\u7f51\u7edc\uff09\u3002\u5176\u4e2d\u524d\u4e09\u79cd\u662f\u76f8\u5bf9\u4e8e\u96c6\u7fa4\u7684\uff08\u8fd9\u4e09\u79cd\u7f51\u7edc\u5bf9\u4e8e\u96c6\u7fa4\u6765\u8bf4\u90fd\u662f\u5fc5\u987b\u7684\uff0c\u8bbe\u7f6e\u7684\u76ee\u7684\u662f\u662f\u5426\u628a\u5f53\u524d\u7684\u903b\u8f91\u7f51\u7edc\u4f5c\u4e3a\u96c6\u7fa4\u7684\u67d0\u79cd\u6216\u591a\u79cd\u7f51\u7edc\uff09\uff0c\u6700\u540e\u4e00\u79cd\u662f\u76f8\u5bf9\u4e8e\u865a\u62df\u673a\u7684\uff08\u5373\u8be5\u7f51\u7edc\u662f\u5426\u80fd\u4f5c\u4e3a\u865a\u62df\u673a\u7684\u901a\u4fe1\u7f51\u7edc\uff09\u3002\u7531\u4e8e\u8be5\u63a5\u53e3\u53ea\u80fd\u5206\u914d\u6570\u636e\u4e2d\u5fc3\u5df2\u6709\u7684\u903b\u8f91\u7f51\u7edc\u5230\u6307\u5b9a\u96c6\u7fa4\uff0c\u6240\u4ee5\u53ea\u80fd\u5bf9\u96c6\u7fa4\u76f8\u5173\u7684\u5185\u5bb9\uff08\u9664\u4e86\u7ba1\u7406\u7f51\u7edc\u4ee5\u5916\uff09\u8fdb\u884c\u64cd\u4f5c\u3002 required Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u662f\u5426\u5c06\u8be5\u7f51\u7edc\u4f5c\u4e3a\u96c6\u7fa4\u7684\u5fc5\u987b\u7f51\u7edc \u8bf7\u6c42\uff1a POST /acloudageks/api/clusters/{clustersId}/networks Body: { \"name\": \"re0\", \"usages\": { \"networkUsage\": [ \"MIGRATION\", \"DISPLAY\" ] }, \"required\": false } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"NetworkModel [id|name] required for add\", \"reason\": \"Incomplete parameters\" } 2.3.2.\u83b7\u5f97\u96c6\u7fa4\u7684\u7f51\u7edc\u63a5\u53e3\u5217\u8868 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u96c6\u7fa4\u903b\u8f91\u7f51\u7edc\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/clusters/{clusterId}/networks \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.3.3.\u66f4\u65b0\u96c6\u7fa4\u7f51\u7edc\u4fe1\u606f \u8be5\u63a5\u53e3\u53ef\u4ee5\u66f4\u65b0\u903b\u8f91\u7f51\u7edc\u4e0e\u96c6\u7fa4\u76f8\u5173\u7684\u5185\u5bb9\uff0c\u4e0e2.3.1\u7684\u5dee\u5f02\u5728\u4e8e\uff0c\u8be5\u63a5\u53e3\u4e0d\u80fd\u5206\u914d\u7f51\u7edc\u7ed9\u96c6\u7fa4\uff0c\u4f46\u662f\u53ef\u4ee5\u8bbe\u7f6e\u903b\u8f91\u7f51\u7edc\u662f\u5426\u4e3a\u7ba1\u7406\u7f51\u7edc\uff0c\u800c\u4e14\u4e0d\u9700\u8981\u5728\u8bf7\u6c42\u4f53\u4f20\u9012\u903b\u8f91\u7f51\u7edc\u7684id\u6216\u8005name\u5b57\u6bb5\uff0c\u5c06id\u4f5c\u4e3aurl\u7684\u4e00\u90e8\u5206\u5728url\u4f20\u9012\u3002 \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4e0d\u80fd\u5728\u4e00\u4e2a\u975e\u7a7a\u96c6\u7fa4\uff08\u6709\u4e3b\u673a\u548c\u865a\u62df\u673a\u7684\u96c6\u7fa4\uff09\u8fdb\u884c\u7ba1\u7406\u7f51\u7edc\u7684\u4fee\u6539\uff0c\u800c\u4e14\u5bf9\u5e94\u7684\u7f51\u7edc\u5728\u4e3b\u673a\u4e0a\u5fc5\u987b\u8981\u62e5\u6709ip\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e display Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u662f\u5426\u5c06\u8be5\u7f51\u7edc\u4f5c\u4e3a\u96c6\u7fa4\u7684\u663e\u793a\u7f51\u7edc\uff0c\u65b9\u4fbf\u5feb\u901f\u8bbe\u7f6e\u6307\u5b9a\u7f51\u7edc\u4e3a\u663e\u793a\u7f51\u7edc usages NetworkUsageValues body \u53ef\u9009\u53c2\u6570\uff0c\u8be5\u5bf9\u8c61\u4e3aNetworkUsage\u96c6\u5408\u7684\u6620\u5c04\uff0c\u53ea\u6301\u6709NetworkUsage\u679a\u4e3e\u96c6\u5408\u7684\u5f15\u7528networkUsage\uff0c\u8be5\u53c2\u6570\u7528\u4e8e\u6307\u5b9a\u65b0\u5efa\u7684\u903b\u8f91\u7f51\u7edc\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u54ea\u4e9b\u7f51\u7edc\u4f7f\u7528\uff0c\u5305\u62ec\u4ee5\u4e0b\u56db\u79cd\uff1aDISPLAY\uff08\u663e\u793a\u7f51\u7edc\uff09\u3001MANAGEMENT\uff08\u7ba1\u7406\u7f51\u7edc\uff09\u3001MIGRATION\uff08\u8fc1\u79fb\u7f51\u7edc\uff09\u3001VM\uff08\u865a\u62df\u673a\u7f51\u7edc\uff09\u3002\u5176\u4e2d\u524d\u4e09\u79cd\u662f\u76f8\u5bf9\u4e8e\u96c6\u7fa4\u7684\uff08\u8fd9\u4e09\u79cd\u7f51\u7edc\u5bf9\u4e8e\u96c6\u7fa4\u6765\u8bf4\u90fd\u662f\u5fc5\u987b\u7684\uff0c\u8bbe\u7f6e\u7684\u76ee\u7684\u662f\u662f\u5426\u628a\u5f53\u524d\u7684\u903b\u8f91\u7f51\u7edc\u4f5c\u4e3a\u96c6\u7fa4\u7684\u67d0\u79cd\u6216\u591a\u79cd\u7f51\u7edc\uff09\uff0c\u6700\u540e\u4e00\u79cd\u662f\u76f8\u5bf9\u4e8e\u865a\u62df\u673a\u7684\uff08\u5373\u8be5\u7f51\u7edc\u662f\u5426\u80fd\u4f5c\u4e3a\u865a\u62df\u673a\u7684\u901a\u4fe1\u7f51\u7edc\uff09\u3002\u7531\u4e8e\u8be5\u63a5\u53e3\u53ea\u80fd\u5206\u914d\u6570\u636e\u4e2d\u5fc3\u5df2\u6709\u7684\u903b\u8f91\u7f51\u7edc\u5230\u6307\u5b9a\u96c6\u7fa4\uff0c\u6240\u4ee5\u53ea\u80fd\u5bf9\u96c6\u7fa4\u76f8\u5173\u7684\u5185\u5bb9\u8fdb\u884c\u64cd\u4f5c\u3002 required Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u662f\u5426\u5c06\u8be5\u7f51\u7edc\u4f5c\u4e3a\u96c6\u7fa4\u7684\u5fc5\u987b\u7f51\u7edc \u8bf7\u6c42\uff1a PUT /acloudageks/api/clusters/{clustersId}/networks/{networkId} Body: { \"usages\": { \"networkUsage\": [ \"MIGRATION\", \"DISPLAY\", \"MANAGEMENT\" ] }, \"required\": true } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.3.4.\u83b7\u5f97\u6307\u5b9a\u7684\u96c6\u7fa4\u903b\u8f91\u7f51\u7edc \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/clusters/{clustersId}/networks/{networkId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 2.3.5.\u5206\u79bb\u6307\u5b9a\u7684\u96c6\u7fa4\u7f51\u7edc \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/clusters/{clustersId}/networks/{networkId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 2.4\u96c6\u7fa4CPU\u914d\u7f6e\u96c6 2.4.1.\u6dfb\u52a0\u96c6\u7fa4CPU\u914d\u7f6e\u96c6 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u5fc5\u8981\u53c2\u6570\uff0cCPU\u914d\u7f6e\u96c6\u540d\u79f0 description String body \u53ef\u9009\u53c2\u6570\uff0cCPU\u914d\u7f6e\u96c6\u63cf\u8ff0 qos QosModel body \u53ef\u9009\u53c2\u6570\uff0c\u9700\u8981\u8bbe\u7f6ecpu\u8d28\u91cf\u670d\u52a1id\uff0c\u9ed8\u8ba4\u503c\u4e3anull\uff0c\u8868\u793aqos\u4e3a\u65e0\u9650 \u8bf7\u6c42\uff1a POST /acloudageks/api/clusters/{clustersId}/cpuprofiles Body: { \"name\": \"test cpu profile\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"CpuProfileModel [name] required for validateParameters\", \"reason\": \"Incomplete parameters\" } 2.4.2.\u83b7\u5f97\u96c6\u7fa4CPU\u914d\u7f6e\u96c6\u5217\u8868 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u5b58\u50a8\u57df\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/clusters/{clustersId}/cpuprofiles \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.4.3.\u83b7\u5f97\u96c6\u7fa4\u6307\u5b9a\u7684CPU\u914d\u7f6e\u96c6\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/clusters/{clustersId}/cpuprofiles/{cpuprofileId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.4.4.\u5220\u9664\u96c6\u7fa4\u6307\u5b9aCPU\u914d\u7f6e\u96c6 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/clusters/{clustersId}/cpuprofiles/{cpuprofileId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.5.\u4e3b\u673a 2.5.1.\u65b0\u5efa\u4e3b\u673a \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u5fc5\u8981\u53c2\u6570\uff0c\u4e3b\u673a\u540d address String body \u5fc5\u8981\u53c2\u6570\uff0c\u4e3b\u673a\u57df\u540d\u6216\u8005ip cluster ClusterModel body \u5fc5\u8981\u53c2\u6570\uff0c\u6307\u5b9a\u4e3b\u673a\u6240\u5c5e\u7684\u96c6\u7fa4\uff0c\u9700\u8981\u6307\u5b9a\u96c6\u7fa4\u7684id\u6216\u8005name\u5b57\u6bb5 ssh SshModel body \u53ef\u9009\u5fc5\u8981\u53c2\u6570\uff0cSshModel\u5bf9\u8c61\u4ee3\u8868\u4e86\u4e0e\u4e3b\u673a\u8fdb\u884cssh\u8fde\u63a5\u7684\u51e0\u4e2a\u9009\u9879\u3002\u5176\u4e2dauthenticationMethod\u5b57\u6bb5\u8868\u793a\u8fdb\u884cssh\u8ba4\u8bc1\u7684\u65b9\u5f0f\uff0c\u4e00\u5171\u6709\u4e24\u79cd\u9009\u62e9\uff1aPASSWORD\uff08\u901a\u8fc7\u7528\u6237\u540d\u548c\u5bc6\u7801\u8ba4\u8bc1\uff09\uff0cPUBLICKEY\uff08\u901a\u8fc7ssh\u516c\u94a5\u8ba4\u8bc1\uff09\uff0c\u9ed8\u8ba4\u503c\u4e3aPASSWORD\uff0c\u65b0\u5efa\u4e3b\u673a\u65f6\u53ea\u80fd\u4f7f\u7528PASSWORD\u65b9\u5f0f\uff1bfingerprint\u5b57\u6bb5\u4ee3\u8868\u4e3b\u673a\u6307\u7eb9\uff0c\u5177\u4f53\u4f5c\u7528\u4e0d\u592a\u6e05\u695a\uff1bport\u5b57\u6bb5\u4ee3\u8868\u4e3b\u673assh\u670d\u52a1\u7684\u7aef\u53e3\u53f7\uff0c\u9ed8\u8ba4\u503c\u4e3a22\uff1buser\u5b57\u6bb5\u662fUserModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u4e86\u8fde\u63a5\u4e3b\u673a\u7684\u7528\u6237\u4fe1\u606f\uff0c\u901a\u5e38\u53ea\u9700\u8981\u6307\u5b9a\u5176userName\uff08\u7528\u6237\u540d\uff09\u5b57\u6bb5\u548cpassword\uff08\u5bc6\u7801\uff09\u5b57\u6bb5\uff0cUserModel\u5bf9\u8c61\u53ea\u5728\u8ba4\u8bc1\u65b9\u5f0f\u4e3aPASSWORD\u6709\u6548\u3002\u8be5\u53c2\u6570\u4e0erootPassword\u53c2\u6570\u5fc5\u987b\u6709\u4e00\u4e2a\u6b63\u786e\u586b\u5199\u3002 rootPassword String body \u53ef\u9009\u5fc5\u8981\u53c2\u6570\uff0c\u56e0\u4e3a\u65b0\u5efa\u4e3b\u673a\u65f6\u53ea\u80fd\u4f7f\u7528\u7528\u6237\u540d\u548c\u5bc6\u7801\u8fdb\u884c\u8ba4\u8bc1\uff0c\u6240\u4ee5\u63d0\u4f9b\u4e86\uff0c\u4e00\u79cd\u4fbf\u5229\u7684\u65b9\u5f0f\uff0c\u9ed8\u8ba4\u4f7f\u7528root\u7528\u6237\u8fdb\u884c\u8ba4\u8bc1\uff0c\u56e0\u6b64\u53ea\u9700\u8981\u6307\u5b9aroot\u7528\u6237\u5bc6\u7801\u5373\u53ef\u3002\u8be5\u53c2\u6570\u4e0essh\u53c2\u6570\u5fc5\u987b\u6709\u4e00\u4e2a\u6b63\u786e\u586b\u5199\u3002 spm SpmModel body \u53ef\u9009\u53c2\u6570\uff0cSpmModel\u4ee3\u8868\u4e86\u4e3b\u673aspm\u76f8\u5173\u5c5e\u6027\uff0c\u5305\u62ec\u4e3b\u673a\u7684spm\u72b6\u6001\uff08status\uff09\u548cspm\u4f18\u5148\u7ea7\uff08priority\uff09\u3002\u65b0\u5efa\u4e3b\u673a\u65f6\uff0c\u53ef\u4ee5\u6307\u5b9a\u4e3b\u673a\u7684spm\u4f18\u5148\u7ea7\uff0c\u53ef\u9009\u8303\u56f4\u4e3a-1~10\uff0c\u9ed8\u8ba4\u503c\u4e3a0\u3002 os OperatingSystemModel body \u53ef\u9009\u53c2\u6570\uff0cOperatingSystemModel\u5bf9\u8c61\u4ee3\u8868\u4e0e\u7cfb\u7edf\u5f15\u5bfc\u6709\u5173\u7684\u53c2\u6570\u3002\u5b83\u7684customKernelCmdline\u5b57\u6bb5\uff0c\u8868\u793a\u5728\u4e3b\u673a\u5b89\u88c5\u65f6\u66f4\u6539\u4e3b\u673a\u7684\u5185\u6838\u5f15\u5bfc\u53c2\u6570\uff0c\u53ef\u4ee5\u9009\u62e9\u7684\u9ed8\u8ba4\u5f15\u5bfc\u53c2\u6570\u67094\u4e2a\uff1aintel_iommu=on\u3001 kvm-intel.nested=1\u3001vfio_iommu_type1.allow_unsafe_interrupts=1\u3001pci=realloc\uff0c\u5f53\u6dfb\u52a0\u591a\u4e2a\u5f15\u5bfc\u53c2\u6570\u65f6\uff0c\u9700\u8981\u5728\u5f15\u5bfc\u53c2\u6570\u95f4\u7528\u7a7a\u683c\u9694\u5f00\u3002 powerManagement PowerManagementModel body \u53ef\u9009\u53c2\u6570\uff0cPowerManagementModel\u4ee3\u8868\u4e86\u4e3b\u673a\u7684\u7535\u6e90\u7ba1\u7406\u7b56\u7565\u4e2d\u7684\u51e0\u4e2a\u9009\u9879\u3002\u5176\u4e2denabled\u5b57\u6bb5\u8868\u793a\u662f\u5426\u542f\u7528\u7535\u6e90\u7ba1\u7406\uff0c\u9ed8\u8ba4\u503c\u4e3afalse\uff0c\u53ea\u6709\u542f\u7528\u4e86\u7535\u6e90\u7ba1\u7406\u5176\u4ed6\u53c2\u6570\u624d\u80fd\u8d77\u4f5c\u7528\uff1bautomaticPmEnabled\u5b57\u6bb5\u8868\u793a\uff0c\u662f\u5426\u7981\u7528\u7535\u6e90\u7ba1\u7406\u7b56\u7565\u63a7\u5236\uff0c\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662ffalse\u8868\u793a\u7981\u7528\uff0c\u800ctrue\u8868\u793a\u542f\u7528\uff0c\u9ed8\u8ba4\u503c\u4e3afalse\uff1bpmProxies\u5b57\u6bb5\u662fPmProxies\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u4e86\u7535\u6e90\u7ba1\u7406\u4ee3\u7406\u7684\u96c6\u5408\u6620\u5c04\uff0cPmProxies\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aPmProxyModel\u5bf9\u8c61\u96c6\u5408\u7684\u5f15\u7528\u5b57\u6bb5pmProxies\uff0cPmProxyModel\u53ea\u6709\u4e00\u4e2atype\u5b57\u6bb5\u7528\u4e8e\u6307\u5b9a\u4ee3\u7406\u7c7b\u578b\uff0c\u53ef\u9009\u7684\u7535\u6e90\u7ba1\u7406\u4ee3\u7406\u7c7b\u578b\u6709\u4e09\u79cd\uff1aCLUSTER\u3001DC\u3001OTHER_DC\uff1bkdumpDetection\u5b57\u6bb5\u8868\u793a\u662f\u5426\u96c6\u6210KDump\uff0c\u9ed8\u8ba4\u503c\u4e3afalse port Integer body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u4e3b\u673avdsm\u670d\u52a1\u7684\u7aef\u53e3\u53f7\uff0c\u9ed8\u8ba4\u503c\u4e3a54321\uff0c\u4e00\u822c\u4e0d\u4f1a\u4f7f\u7528\u8fd9\u4e2a\u503c\u3002 protocol String body \u53ef\u9009\u53c2\u6570\uff0c\u8bbe\u7f6e\u4e0e\u4e3b\u673a\u7684\u901a\u4fe1\u534f\u8bae\uff0c\u53ef\u9009\u503c\u6709\uff1aXML\u3001STOMP\uff0c\u9ed8\u8ba4\u503c\u4e3aSTOMP\uff0c\u56e0\u4e3a\u76ee\u524d\u4f7f\u7528\u7684\u90fd\u662fSTOMP\u534f\u8bae\uff0c\u8fd9\u4e2a\u503c\u4e5f\u4e0d\u9700\u8981\u8bbe\u7f6e\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts Body: { \"name\": \"myhost\", \"address\": \"172.16.2.242\", \"rootPassword\": \"adcd1234\", \"spm\": { \"priority\": 5 }, \"powerManagement\": { \"enabled\": true, \"automaticPmEnabled\": false, \"pmProxies\": { \"pmProxies\": [ {\"type\": \"CLUSTER\"}, {\"type\": \"DC\"} ] } } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"HostModel [name, address] required for add\", \"reason\": \"Incomplete parameters\" } 2.5.2.\u83b7\u5f97\u4e3b\u673a\u5217\u8868 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e case_sensitive Boolean url \u53ef\u9009\uff0c\u4e0esearch\u53c2\u6570\u4e00\u8d77\u4f7f\u7528\uff0c\u6307\u5b9a\u5728\u6267\u884csearch\u53c2\u6570\u65f6\u662f\u5426\u8003\u8651\u5927\u5c0f\u5199 filter Boolean url \u53ef\u9009\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u4e3b\u673a\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 max Integer url \u53ef\u9009\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u4e3b\u673a\u6570\u91cf search String url \u53ef\u9009\uff0c\u67e5\u8be2\u7ea6\u675f\u6761\u4ef6\u7ea6\u675f\u8fd4\u56de\u4fe1\u606f\uff0c\u4f8b\u5982name=\"myname\" \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.5.3.\u6fc0\u6d3b\u4e3b\u673a \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/activate Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 2.5.4.\u6279\u51c6\u4e3b\u673a \u6279\u51c6\u9884\u5b89\u88c5\u7684Hypervisor\u4e3b\u673a\u4ee5\u5728\u865a\u62df\u5316\u73af\u5883\u4e2d\u4f7f\u7528\u3002 \u6b64\u64cd\u4f5c\u8fd8\u63a5\u53d7\u53ef\u9009\u7684cluster\u5143\u7d20\uff0c\u4ee5\u4e3a\u6b64\u4e3b\u673a\u5b9a\u4e49\u76ee\u6807\u96c6\u7fa4\u3002 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 cluster ClusterModel body \u53ef\u9009\u53c2\u6570\uff0c\u9700\u8981\u6307\u5b9a\u96c6\u7fa4\u7684name\u6216\u8005id\u5b57\u6bb5 ssh SshModel body \u53ef\u9009\u53c2\u6570\uff0cSshModel\u5bf9\u8c61\u4ee3\u8868\u4e86\u4e0e\u4e3b\u673a\u8fdb\u884cssh\u8fde\u63a5\u7684\u51e0\u4e2a\u9009\u9879\u3002\u5176\u4e2dauthenticationMethod\u5b57\u6bb5\u8868\u793a\u8fdb\u884cssh\u8ba4\u8bc1\u7684\u65b9\u5f0f\uff0c\u4e00\u5171\u6709\u4e24\u79cd\u9009\u62e9\uff1aPASSWORD\uff08\u901a\u8fc7\u7528\u6237\u540d\u548c\u5bc6\u7801\u8ba4\u8bc1\uff09\uff0cPUBLICKEY\uff08\u901a\u8fc7ssh\u516c\u94a5\u8ba4\u8bc1\uff09\uff1buser\u5b57\u6bb5\u662fUserModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u4e86\u8fde\u63a5\u4e3b\u673a\u7684\u7528\u6237\u4fe1\u606f\uff0c\u901a\u5e38\u53ea\u9700\u8981\u6307\u5b9a\u5176userName\uff08\u7528\u6237\u540d\uff09\u5b57\u6bb5\u548cpassword\uff08\u5bc6\u7801\uff09\u5b57\u6bb5\uff0cUserModel\u5bf9\u8c61\u53ea\u5728\u8ba4\u8bc1\u65b9\u5f0f\u4e3aPASSWORD\u6709\u6548\u3002\u6279\u51c6\u4e3b\u673a\u9ed8\u8ba4\u4f7f\u7528\u7684\u8ba4\u8bc1\u65b9\u5f0f\u662fPUBLICKEY\uff0c\u5728\u4e0d\u60f3\u4f7f\u7528\u9ed8\u8ba4\u7684ssh\u65b9\u5f0f\u65f6\uff0c\u53ef\u4ee5\u9009\u62e9\u3002 rootPassword String body \u53ef\u9009\u53c2\u6570\uff0c\u4f7f\u7528root\u7528\u6237\u8fdb\u884c\u8ba4\u8bc1\uff0c\u56e0\u6b64\u53ea\u9700\u8981\u6307\u5b9aroot\u7528\u6237\u5bc6\u7801\u5373\u53ef\u3002\u5728\u4e0d\u60f3\u4f7f\u7528\u9ed8\u8ba4\u7684ssh\u65b9\u5f0f\u65f6\uff0c\u53ef\u4ee5\u9009\u62e9\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/approve Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 2.5.5.\u4fdd\u5b58\u4e3b\u673a\u7f51\u7edc\u914d\u7f6e \u5c06\u7f51\u7edc\u914d\u7f6e\u6807\u8bb0\u4e3a\u826f\u597d\uff0c\u5e76\u6301\u4e45\u5316\u5230\u4e3b\u673a\u4e0a\u3002\uff08\u628a\u7f51\u7edc\u4fe1\u606f\u4fdd\u5b58\u5230 /var/lib/vdsm/persistence/netconf/nets/ovirtmgmt \u76ee\u5f55\u4e0b\uff1f\uff1f\uff1f\uff1f\uff09 \u7528\u6237\u53ef\u4ee5\u63d0\u4ea4\u7f51\u7edc\u914d\u7f6e\u7528\u4e8e\u6301\u4e45\u5316\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7684\u9644\u52a0\u6216\u5206\u79bb\uff0c\u6216\u6301\u4e45\u5316\u7ed1\u5b9a\u63a5\u53e3\u7684\u521b\u5efa\u548c\u5220\u9664\u3002 \u4ec5\u5728\u5f15\u64ce\u786e\u5b9a\u4e3b\u673a\u8fde\u63a5\u4e0d\u4f1a\u7531\u4e8e\u914d\u7f6e\u66f4\u6539\u800c\u4e22\u5931\u540e\uff0c\u624d\u63d0\u4ea4\u7f51\u7edc\u914d\u7f6e\u3002 \u5982\u679c\u4e3b\u673a\u8fde\u63a5\u4e22\u5931\uff0c\u5219\u4e3b\u673a\u9700\u8981\u91cd\u65b0\u542f\u52a8\u5e76\u81ea\u52a8\u6062\u590d\u4e3a\u4ee5\u524d\u7684\u7f51\u7edc\u914d\u7f6e\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/commitnetconfig Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 2.5.6.\u4f7f\u4e3b\u673a\u8fdb\u5165\u7ef4\u62a4\u72b6\u6001 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 reason String body \u53ef\u9009\u53c2\u6570\uff0c\u8bbe\u7f6e\u7ef4\u62a4\u4e3b\u673a\u7684\u539f\u56e0 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/deactivate Body: { \"reason\": \"test deactivate host\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 2.5.7.\u6ce8\u518c\u4e3b\u673a\u8bc1\u4e66 \u5f53\u4e3b\u673a\u8bc1\u4e66\u5feb\u8981\u8fc7\u671f\u65f6\u4f7f\u7528\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/enrollcertificate Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 2.5.8.\u4e3b\u673a\u7535\u6e90\u7ba1\u7406 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 fenceType String body \u5fc5\u8981\u53c2\u6570\uff0c\u7528\u4e8e\u63a7\u5236\u4e3b\u673a\u7684\u7535\u6e90\u7ba1\u7406\u8bbe\u5907\uff0c\u53ef\u9009\u7684\u53c2\u6570\u6709\uff1aMANUAL\u3001RESTART\u3001START\u3001STOP\u3001STATUS \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/fence Body: { \"fenceType\": \"RESTART\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 2.5.9.\u5c06\u4e3b\u673a\u4f5c\u4e3aSpm \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/forceselectspm Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 2.5.10.\u83b7\u5f97\u6307\u5b9a\u7684\u4e3b\u673a\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts/{hostId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.5.11.\u91cd\u65b0\u5b89\u88c5\u4e3b\u673a \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 ssh SshModel body \u53ef\u9009\u5fc5\u8981\u53c2\u6570\uff0cSshModel\u5bf9\u8c61\u4ee3\u8868\u4e86\u4e0e\u4e3b\u673a\u8fdb\u884cssh\u8fde\u63a5\u7684\u51e0\u4e2a\u9009\u9879\u3002\u5176\u4e2dauthenticationMethod\u5b57\u6bb5\u8868\u793a\u8fdb\u884cssh\u8ba4\u8bc1\u7684\u65b9\u5f0f\uff0c\u4e00\u5171\u6709\u4e24\u79cd\u9009\u62e9\uff1aPASSWORD\uff08\u901a\u8fc7\u7528\u6237\u540d\u548c\u5bc6\u7801\u8ba4\u8bc1\uff09\uff0cPUBLICKEY\uff08\u901a\u8fc7ssh\u516c\u94a5\u8ba4\u8bc1\uff09\uff0c\u9ed8\u8ba4\u503c\u4e3aPASSWORD\uff1bfingerprint\u5b57\u6bb5\u4ee3\u8868\u4e3b\u673a\u6307\u7eb9\uff0c\u5177\u4f53\u4f5c\u7528\u4e0d\u592a\u6e05\u695a\uff1bport\u5b57\u6bb5\u4ee3\u8868\u4e3b\u673assh\u670d\u52a1\u7684\u7aef\u53e3\u53f7\uff0c\u9ed8\u8ba4\u503c\u4e3a22\uff1buser\u5b57\u6bb5\u662fUserModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u4e86\u8fde\u63a5\u4e3b\u673a\u7684\u7528\u6237\u4fe1\u606f\uff0c\u901a\u5e38\u53ea\u9700\u8981\u6307\u5b9a\u5176userName\uff08\u7528\u6237\u540d\uff09\u5b57\u6bb5\u548cpassword\uff08\u5bc6\u7801\uff09\u5b57\u6bb5\uff0cUserModel\u5bf9\u8c61\u53ea\u5728\u8ba4\u8bc1\u65b9\u5f0f\u4e3aPASSWORD\u6709\u6548\u3002\u8be5\u53c2\u6570\u4e0erootPassword\u53c2\u6570\u5fc5\u987b\u6709\u4e00\u4e2a\u6b63\u786e\u586b\u5199\u3002 rootPassword String body \u53ef\u9009\u5fc5\u8981\u53c2\u6570\uff0c\u63d0\u4f9b\u4e86\u4e00\u79cd\u4fbf\u5229\u7684\u65b9\u5f0f\uff0c\u9ed8\u8ba4\u4f7f\u7528root\u7528\u6237\u8fdb\u884c\u8ba4\u8bc1\uff0c\u56e0\u6b64\u53ea\u9700\u8981\u6307\u5b9aroot\u7528\u6237\u5bc6\u7801\u5373\u53ef\u3002\u8be5\u53c2\u6570\u4e0essh\u53c2\u6570\u5fc5\u987b\u6709\u4e00\u4e2a\u6b63\u786e\u586b\u5199\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/install Body: { \"ssh\": { \"authenticationMethod\": \"PUBLICKEY\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 2.5.12.\u66f4\u65b0\u4e3b\u673a\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u4e3b\u673a\u540d cluster ClusterModel body \u6307\u5b9a\u4e3b\u673a\u6240\u5c5e\u7684\u96c6\u7fa4\uff0c\u9700\u8981\u6307\u5b9a\u96c6\u7fa4\u7684id\u6216\u8005name\u5b57\u6bb5\uff0c\u53ea\u6709\u4e3b\u673a\u5728\u7ef4\u62a4\u72b6\u6001\u4e0b\u624d\u80fd\u4fee\u6539\u4e3b\u673a\u6240\u5c5e\u96c6\u7fa4 ssh SshModel body \u53ef\u9009\u5fc5\u8981\u53c2\u6570\uff0cSshModel\u5bf9\u8c61\u4ee3\u8868\u4e86\u4e0e\u4e3b\u673a\u8fdb\u884cssh\u8fde\u63a5\u7684\u51e0\u4e2a\u9009\u9879\u3002\u5176\u4e2dauthenticationMethod\u5b57\u6bb5\u8868\u793a\u8fdb\u884cssh\u8ba4\u8bc1\u7684\u65b9\u5f0f\uff0c\u4e00\u5171\u6709\u4e24\u79cd\u9009\u62e9\uff1aPASSWORD\uff08\u901a\u8fc7\u7528\u6237\u540d\u548c\u5bc6\u7801\u8ba4\u8bc1\uff09\uff0cPUBLICKEY\uff08\u901a\u8fc7ssh\u516c\u94a5\u8ba4\u8bc1\uff09\uff0c\u9ed8\u8ba4\u503c\u4e3aPASSWORD\uff1buser\u5b57\u6bb5\u662fUserModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u4e86\u8fde\u63a5\u4e3b\u673a\u7684\u7528\u6237\u4fe1\u606f\uff0c\u901a\u5e38\u53ea\u9700\u8981\u6307\u5b9a\u5176userName\uff08\u7528\u6237\u540d\uff09\u5b57\u6bb5\u548cpassword\uff08\u5bc6\u7801\uff09\u5b57\u6bb5\uff0cUserModel\u5bf9\u8c61\u53ea\u5728\u8ba4\u8bc1\u65b9\u5f0f\u4e3aPASSWORD\u6709\u6548\u3002\u8be5\u53c2\u6570\u4e0erootPassword\u53c2\u6570\u5fc5\u987b\u6709\u4e00\u4e2a\u6b63\u786e\u586b\u5199\u3002 rootPassword String body \u53ef\u9009\u5fc5\u8981\u53c2\u6570\uff0c\u63d0\u4f9b\u4e86\u4e00\u79cd\u4fbf\u5229\u7684\u65b9\u5f0f\uff0c\u9ed8\u8ba4\u4f7f\u7528root\u7528\u6237\u8fdb\u884c\u8ba4\u8bc1\uff0c\u56e0\u6b64\u53ea\u9700\u8981\u6307\u5b9aroot\u7528\u6237\u5bc6\u7801\u5373\u53ef\u3002\u8be5\u53c2\u6570\u4e0essh\u53c2\u6570\u5fc5\u987b\u6709\u4e00\u4e2a\u6b63\u786e\u586b\u5199\u3002 spm SpmModel body SpmModel\u4ee3\u8868\u4e86\u4e3b\u673aspm\u76f8\u5173\u5c5e\u6027\uff0c\u5305\u62ec\u4e3b\u673a\u7684spm\u72b6\u6001\uff08status\uff09\u548cspm\u4f18\u5148\u7ea7\uff08priority\uff09\u3002\u65b0\u5efa\u4e3b\u673a\u65f6\uff0c\u53ef\u4ee5\u6307\u5b9a\u4e3b\u673a\u7684spm\u4f18\u5148\u7ea7\uff0c\u53ef\u9009\u8303\u56f4\u4e3a-1~10\uff0c\u9ed8\u8ba4\u503c\u4e3a0\u3002 os OperatingSystemModel body OperatingSystemModel\u5bf9\u4ee3\u8868\u4e0e\u7cfb\u7edf\u5f15\u5bfc\u6709\u5173\u7684\u53c2\u6570\u3002\u5b83\u7684customKernelCmdline\u5b57\u6bb5\uff0c\u8868\u793a\u5728\u4e3b\u673a\u5b89\u88c5\u65f6\u66f4\u6539\u4e3b\u673a\u7684\u5185\u6838\u5f15\u5bfc\u53c2\u6570\uff0c\u53ef\u4ee5\u9009\u62e9\u7684\u9ed8\u8ba4\u5f15\u5bfc\u53c2\u6570\u67094\u4e2a\uff1aintel_iommu=on\u3001 kvm-intel.nested=1\u3001vfio_iommu_type1.allow_unsafe_interrupts=1\u3001pci=realloc\uff0c\u5f53\u6dfb\u52a0\u591a\u4e2a\u5f15\u5bfc\u53c2\u6570\u65f6\uff0c\u9700\u8981\u5728\u5f15\u5bfc\u53c2\u6570\u95f4\u7528\u7a7a\u683c\u9694\u5f00\u3002 powerManagement PowerManagementModel body PowerManagementModel\u4ee3\u8868\u4e86\u4e3b\u673a\u7684\u7535\u6e90\u7ba1\u7406\u7b56\u7565\u4e2d\u7684\u51e0\u4e2a\u9009\u9879\u3002\u5176\u4e2denabled\u5b57\u6bb5\u8868\u793a\u662f\u5426\u542f\u7528\u7535\u6e90\u7ba1\u7406\uff0c\u9ed8\u8ba4\u503c\u4e3afalse\uff0c\u53ea\u6709\u542f\u7528\u4e86\u7535\u6e90\u7ba1\u7406\u5176\u4ed6\u53c2\u6570\u624d\u80fd\u8d77\u4f5c\u7528\uff1bautomaticPmEnabled\u5b57\u6bb5\u8868\u793a\uff0c\u662f\u5426\u7981\u7528\u7535\u6e90\u7ba1\u7406\u7b56\u7565\u63a7\u5236\uff0c\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662ffalse\u8868\u793a\u7981\u7528\uff0c\u800ctrue\u8868\u793a\u542f\u7528\uff0c\u9ed8\u8ba4\u503c\u4e3afalse\uff1bpmProxies\u5b57\u6bb5\u662fPmProxies\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u4e86\u7535\u6e90\u7ba1\u7406\u4ee3\u7406\u7684\u96c6\u5408\u6620\u5c04\uff0cPmProxies\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aPmProxyModel\u5bf9\u8c61\u96c6\u5408\u7684\u5f15\u7528\u5b57\u6bb5pmProxies\uff0cPmProxyModel\u53ea\u6709\u4e00\u4e2atype\u5b57\u6bb5\u7528\u4e8e\u6307\u5b9a\u4ee3\u7406\u7c7b\u578b\uff0c\u53ef\u9009\u7684\u7535\u6e90\u7ba1\u7406\u4ee3\u7406\u7c7b\u578b\u6709\u4e09\u79cd\uff1aCLUSTER\u3001DC\u3001OTHER_DC\uff1bkdumpDetection\u5b57\u6bb5\u8868\u793a\u662f\u5426\u96c6\u6210KDump\uff0c\u9ed8\u8ba4\u503c\u4e3afalse \u8bf7\u6c42\uff1a PUT /acloudageks/api/hosts/{hostId} Body: { \"spm\": { \"priority\": 7 }, \"ssh\": { \"authenticationMethod\": \"PUBLICKEY\" }\uff0c \"powerManagement\": { \"enabled\": false } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 2.5.13.\u5237\u65b0\u4e3b\u673a\u80fd\u529b \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/refresh Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 2.5.14\u5220\u9664\u4e3b\u673a \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/hosts/{hostId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 2.5.15.\u83b7\u5f97\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u5217\u8868 \u8be5\u63a5\u53e3\u4f1a\u8fd4\u56de\u4e3b\u673a\u7684\u4e0a\u7684\u6240\u6709\u7f51\u7edc\u63a5\u53e3\u4fe1\u606f\uff0c\u5305\u62ec\u865a\u62df\u7f51\u7edc\u63a5\u53e3\uff08vlan\uff09\u4e5f\u4f1a\u88ab\u89c6\u4e3a\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts/{hostId}/nics \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.5.15.\u83b7\u5f97\u6307\u5b9a\u7684\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts/{hostId}/nics/{nicId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.5.15.\u83b7\u5f97\u6307\u5b9a\u7684\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7684\u7f51\u7edc\u9644\u4ef6\u5217\u8868 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts/{hostId}/nics/{nicId}/networkattachments \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.5.15.\u83b7\u5f97\u4e3b\u673a\u7f51\u7edc\u9644\u4ef6\u5217\u8868 \u4e3b\u673a\u7f51\u7edc\u9644\u4ef6\u5373\u5206\u914d\u7ed9\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7684engine\u903b\u8f91\u7f51\u7edc\u7684\u914d\u7f6e\u4fe1\u606f\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts/{hostId}/networkattachments \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.5.16.\u6dfb\u52a0\u4e3b\u673a\u7f51\u7edc\u9644\u4ef6 \u76f8\u5f53\u4e8e\u628aengine\u903b\u8f91\u7f51\u7edc\u5206\u914d\u7ed9\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\uff0c\u8fd9\u91cc\u7684\u7f51\u7edc\u63a5\u53e3\u4e0d\u80fd\u662f\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\uff08vlan\uff09\uff0c\u800c\u4e14\u7f51\u7edc\u914d\u7f6e\u4e0d\u80fd\u5b58\u5728\u51b2\u7a81\uff08\u591a\u4e2a\u7f51\u5361\u5728\u540c\u4e00\u4e2a\u7f51\u6bb5\uff09\uff0c\u4e0d\u7136\u4f1a\u5bfc\u81f4\u7f51\u7edc\u51b2\u7a81\u4f7f\u4e3b\u673a\u7f51\u7edc\u5931\u6548\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 network NetworkModel body \u5fc5\u8981\u53c2\u6570\uff0c\u4ee3\u8868\u4e86NetworkAttachment\u6240\u5c5e\u7684\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\uff0chostNic\u5fc5\u987b\u6307\u5b9aHostNicModel\u7684name\u5b57\u6bb5\u6216\u8005id\u5b57\u6bb5\u3002 hostNic HostNicModel body \u5fc5\u8981\u53c2\u6570\uff0c\u4ee3\u8868NetworkAttachment\u6240\u5c5e\u7684\u903b\u8f91\u7f51\u7edc\uff0cnetwork\u5fc5\u987b\u6307\u5b9aHostNicModel\u7684name\u5b57\u6bb5\u6216\u8005id\u5b57\u6bb5\u3002 properties Properties body \u53ef\u9009\u53c2\u6570\uff0cProperties\u5bf9\u8c61\u53ea\u6301\u6709\u96c6\u5408\u5f15\u7528\uff0c\u662fPropertyModel\u5bf9\u8c61\u96c6\u5408\u7684\u6620\u5c04\uff0c\u901a\u8fc7\u8bbe\u7f6ePropertyModel\u5bf9\u8c61\u7684name\u548cvalue\u5b57\u6bb5\u6765\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u5c5e\u6027\uff0c\u76ee\u524d\u53ef\u9009\u7684name\u53ea\u6709 bridge_opts \u3002properties\u5b57\u6bb5\u5b57\u6bb5\u53ef\u4ee5\u4e3a\u7a7a ipAddressAssignments IpAddressAssignments body \u53ef\u9009\u53c2\u6570\uff0cIpAddressAssignments\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aIpAddressAssignmentModel\u5217\u8868\u7684\u5f15\u7528ipAddressAssignments\u3002IpAddressAssignmentModel\u6709\u4e24\u4e2a\u5b57\u6bb5\uff0c\u5176\u4e2dassignmentMethod\u5b57\u6bb5\u8868\u793a\u7f51\u7edc\u542f\u52a8\u534f\u8bae\uff0c\u53ef\u9009\u7684\u503c\u6709\uff1aDHCP\u3001STATIC\u3001AUTOCONF\u3001NONE\u3002ip\u5b57\u6bb5\u662fIpModel\u7684\u5f15\u7528\u8868\u793a\u7f51\u7edc\u914d\u7f6e\u4fe1\u606f\uff0cIP\u67094\u4e2a\u5b57\u6bb5\uff0caddress\u5b57\u6bb5\u8868\u793a\u7f51\u5740\uff1bnetmask\u8868\u793a\u5b50\u7f51\u63a9\u7801\uff1bgateway\u8868\u793a\u7f51\u5173\uff1bversion\u8868\u793a\u7f51\u7edc\u534f\u8bae\u7248\u672c\uff0c\u7f51\u7edc\u534f\u8bae\u7248\u672c\u5fc5\u987b\u6307\u5b9a\uff0c\u53ef\u9009\u503c\u6709\uff1aV4\u3001V6\uff0c\u5206\u522b\u4ee3\u8868IPv4\u548cIPv6\u534f\u8bae\u3002\u56e0\u6b64IpAddressAssignments\u7684\u5217\u8868\u4e2d\u6700\u591a\u53ea\u80fd\u6709\u4ee3\u8868IPv4\u548cIPv6\u76842\u4e2aIpAddressAssignmentModel\u5bf9\u8c61\uff0c\u5f53\u66f4\u65b0\u65f6\u5373\u4f7f\u4e0d\u53ea\u66f4\u65b0V6\u6216V4\u4e2d\u7684\u4e00\u4e2a\uff0c\u4e5f\u8981\u540c\u65f6\u63d0\u4ea4\u672a\u66f4\u65b0\u7684\u5185\u5bb9\uff0c\u5426\u5219\u89c6\u4e3a\u7f6e\u7a7a\u3002 qos QosModel body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u5bf9\u4e3b\u673a\u7f51\u7edcqos\u7684\u8986\u76d6\u3002\u9996\u5148QosModel\u5fc5\u987b\u8bbe\u7f6etype\u5b57\u6bb5\uff0c\u4e14\u5fc5\u987b\u4e3aHOSTNETWORK\uff1bQosModel\u53ef\u4ee5\u8bbe\u7f6e\u7684\u5b57\u6bb5\u6709outboundAverageLinkshare\uff08\u52a0\u6743\u91cd\u7684\u5171\u4eab\uff09\u3001outboundAverageRealtime\uff08\u5b9e\u73b0\u7684\u901f\u7387\uff09\u4ee5\u53caoutboundAverageUpperlimit\uff08\u901f\u7387\u9650\u5236\uff09\uff0cqos\u5b57\u6bb5\u53ef\u4ee5\u4e3a\u7a7a\u3002\u8bbe\u7f6eqos\u65f6\uff0c\u6240\u6709\u7684\u7f51\u7edc\u63a5\u53e3\u90fd\u5fc5\u987b\u8bbe\u7f6e\uff0c\u4e0d\u80fd\u53ea\u8bbe\u7f6e\u90e8\u5206\u7f51\u7edc\u63a5\u53e3\u7684qos\u3002 override_configuration String url \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u662f\u5426\u4fdd\u5b58\u4e3b\u673a\u7f51\u7edc\u914d\u7f6e\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/networkattachments Body: { \"hostNic\": { \"name\": \"ens33\" }, \"network\": { \"name\": \"re0\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.5.16.\u83b7\u5f97\u6307\u5b9a\u7684\u4e3b\u673a\u7f51\u7edc\u9644\u4ef6 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts/{hostId}/networkattachments/{networkattachmentId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.5.16.\u66f4\u65b0\u4e3b\u673a\u7f51\u7edc\u9644\u4ef6 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 network NetworkModel body \u4ee3\u8868\u4e86NetworkAttachment\u6240\u5c5e\u7684\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\uff0chostNic\u5fc5\u987b\u6307\u5b9aHostNicModel\u7684name\u5b57\u6bb5\u6216\u8005id\u5b57\u6bb5\u3002 hostNic HostNicModel body \u4ee3\u8868NetworkAttachment\u6240\u5c5e\u7684\u903b\u8f91\u7f51\u7edc\uff0cnetwork\u5fc5\u987b\u6307\u5b9aHostNicModel\u7684name\u5b57\u6bb5\u6216\u8005id\u5b57\u6bb5\u3002 properties Properties body Properties\u5bf9\u8c61\u53ea\u6301\u6709\u96c6\u5408\u5f15\u7528\uff0c\u662fPropertyModel\u5bf9\u8c61\u96c6\u5408\u7684\u6620\u5c04\uff0c\u901a\u8fc7\u8bbe\u7f6ePropertyModel\u5bf9\u8c61\u7684name\u548cvalue\u5b57\u6bb5\u6765\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u5c5e\u6027\uff0c\u76ee\u524d\u53ef\u9009\u7684name\u53ea\u6709 bridge_opts \u3002properties\u5b57\u6bb5\u5b57\u6bb5\u53ef\u4ee5\u4e3a\u7a7a ipAddressAssignments IpAddressAssignments body IpAddressAssignments\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aIpAddressAssignmentModel\u5217\u8868\u7684\u5f15\u7528ipAddressAssignments\u3002IpAddressAssignmentModel\u6709\u4e24\u4e2a\u5b57\u6bb5\uff0c\u5176\u4e2dassignmentMethod\u5b57\u6bb5\u8868\u793a\u7f51\u7edc\u542f\u52a8\u534f\u8bae\uff0c\u53ef\u9009\u7684\u503c\u6709\uff1aDHCP\u3001STATIC\u3001AUTOCONF\u3001NONE\u3002ip\u5b57\u6bb5\u662fIpModel\u7684\u5f15\u7528\u8868\u793a\u7f51\u7edc\u914d\u7f6e\u4fe1\u606f\uff0cIP\u67094\u4e2a\u5b57\u6bb5\uff0caddress\u5b57\u6bb5\u8868\u793a\u7f51\u5740\uff1bnetmask\u8868\u793a\u5b50\u7f51\u63a9\u7801\uff1bgateway\u8868\u793a\u7f51\u5173\uff1bversion\u8868\u793a\u7f51\u7edc\u534f\u8bae\u7248\u672c\uff0c\u7f51\u7edc\u534f\u8bae\u7248\u672c\u5fc5\u987b\u6307\u5b9a\uff0c\u53ef\u9009\u503c\u6709\uff1aV4\u3001V6\uff0c\u5206\u522b\u4ee3\u8868IPv4\u548cIPv6\u534f\u8bae\u3002\u56e0\u6b64IpAddressAssignments\u7684\u5217\u8868\u4e2d\u6700\u591a\u53ea\u80fd\u6709\u4ee3\u8868IPv4\u548cIPv6\u76842\u4e2aIpAddressAssignmentModel\u5bf9\u8c61\uff0c\u5f53\u66f4\u65b0\u65f6\u5373\u4f7f\u4e0d\u53ea\u66f4\u65b0V6\u6216V4\u4e2d\u7684\u4e00\u4e2a\uff0c\u4e5f\u8981\u540c\u65f6\u63d0\u4ea4\u672a\u66f4\u65b0\u7684\u5185\u5bb9\uff0c\u5426\u5219\u89c6\u4e3a\u7f6e\u7a7a\u3002 qos QosModel body QosModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u5f53\u8be5\u5b57\u6bb5\u4e0d\u4e3a\u7a7a\u65f6\u8868\u793a\u5bf9\u4e3b\u673a\u7f51\u7edcqos\u7684\u8986\u76d6\u3002\u9996\u5148QosModel\u5fc5\u987b\u8bbe\u7f6etype\u5b57\u6bb5\uff0c\u4e14\u5fc5\u987b\u4e3aHOSTNETWORK\uff1bQosModel\u53ef\u4ee5\u8bbe\u7f6e\u7684\u5b57\u6bb5\u6709outboundAverageLinkshare\uff08\u52a0\u6743\u91cd\u7684\u5171\u4eab\uff09\u3001outboundAverageRealtime\uff08\u5b9e\u73b0\u7684\u901f\u7387\uff09\u4ee5\u53caoutboundAverageUpperlimit\uff08\u901f\u7387\u9650\u5236\uff09\uff0cqos\u5b57\u6bb5\u53ef\u4ee5\u4e3a\u7a7a\u3002\u8bbe\u7f6eqos\u65f6\uff0c\u6240\u6709\u7684\u7f51\u7edc\u63a5\u53e3\u90fd\u5fc5\u987b\u8bbe\u7f6e\uff0c\u4e0d\u80fd\u53ea\u8bbe\u7f6e\u90e8\u5206\u7f51\u7edc\u63a5\u53e3\u7684qos\u3002 override_configuration String url \u4ee3\u8868\u662f\u5426\u8986\u76d6\u4e3b\u673a\u7f51\u7edc\u914d\u7f6e\u6587\u4ef6\u7684\u5185\u5bb9\u3002 \u8bf7\u6c42\uff1a PUT /acloudageks/api/hosts/{hostId}/networkattachments/{networkattachmentId} Body: { \"ipAddressAssignments\": { \"ipAddressAssignments\": [ { \"assignmentMethod\": \"DHCP\", \"ip\": { \"version\": \"V6\" } } ] } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.5.16.\u5220\u9664\u4e3b\u673a\u7f51\u7edc\u9644\u4ef6 \u5220\u9664\u4e3b\u673a\u7f51\u7edc\u9644\u4ef6\u76f8\u5f53\u4e8e\u5c06engine\u903b\u8f91\u7f51\u7edc\u4ece\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u4e0a\u5206\u79bb\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/hosts/{hostId}/networkattachments/{networkattachmentId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.5.15.\u8bbe\u7acb\u4e3b\u673a\u7f51\u7edc \u8bbe\u7acb\u4e3b\u673a\u7f51\u7edc\u8fd9\u4e2a\u90e8\u5206\u6bd4\u8f83\u590d\u6742\uff0c\u6d89\u53ca\u7684\u5bf9\u8c61\u5f88\u591a\uff0c\u8fd9\u91cc\u6839\u636e\u6211\u4e2a\u4eba\u7684\u7406\u89e3\u5bf9\u51e0\u4e2a\u5bf9\u8c61\u8fdb\u884c\u8bf4\u660e\u3002 LogicalNetworkModel \u8be5\u5bf9\u8c61\u4ee3\u8868\u4e86Engine\u903b\u8f91\u7f51\u7edc\u548c\u5916\u90e8\u903b\u8f91\u7f51\u7edc\uff08\u6ca1\u7528\u8fc7\uff09\uff0c\u5bf9\u5e94\u7684\u9875\u9762\u4fe1\u606f\u5982\u4e0b\uff1a \u5728\u9875\u9762\u4e0a\u53ef\u4ee5\u901a\u8fc7\u62d6\u52a8\u903b\u8f91\u7f51\u7edc\u5c06Engine\u903b\u8f91\u7f51\u7edc\u5206\u914d\u7ed9\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\uff0c\u4f46\u662f\u4e00\u4e2a\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u4e0a\u53ea\u80fd\u6709\u4e00\u4e2a\u975eVlan\u7f51\u7edc\u3002 NetworkAttachments \u8be5\u5bf9\u8c61\u4ee3\u8868\u5206\u914d\u7ed9\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7684 Engine\u903b\u8f91\u7f51\u7edc \u7684\u5c5e\u6027\u4fe1\u606f\uff08\u4e00\u4e2aEngine\u903b\u8f91\u7f51\u7edc\u5728\u4e0d\u540c\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u4e0a\u7684\u5c5e\u6027\u4fe1\u606f\u4e0d\u540c\uff09\uff0c\u76f8\u5f53\u4e8e\u4fee\u6539\u7269\u7406\u4e3b\u673a\u4e0a\u7684\u7f51\u7edc\u914d\u7f6e\u6587\u4ef6\uff0c\u5305\u62ecIPv4\u548cIPv6\u4fe1\u606f\u3001qos\u4fe1\u606f\u4ee5\u53ca\u81ea\u5b9a\u4e49\u5c5e\u6027\uff0c\u6ce8\u610f\u53ea\u6709\u5c06Engine\u903b\u8f91\u7f51\u7edc\u5206\u914d\u7ed9\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u4ee5\u540e\uff0cEngine\u903b\u8f91\u7f51\u7edc\u624d\u80fd\u62e5\u6709\u5bf9\u5e94\u7684NetworkAttachments\u3002\u5bf9\u5e94\u9875\u9762\u4fe1\u606f\u5982\u4e0b\uff1a \u4f46\u662f\uff0c\u8be5\u5bf9\u8c61\u7684\u4fe1\u606f\u5e76\u4e0d\u4e00\u5b9a\u4e0e\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7684 Engine\u903b\u8f91\u7f51\u7edc \u7684\u5c5e\u6027\u4fe1\u606f\u4e00\u81f4\uff0c\u53ef\u4ee5\u901a\u8fc7\u540c\u6b65\u7f51\u7edc\u7684\u65b9\u5f0f\uff0c\u5c06\u8be5\u5bf9\u8c61\u8bbe\u7f6e\u7684\u5c5e\u6027\u5e94\u7528\u5230\u5206\u914d\u7ed9\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7684 Engine\u903b\u8f91\u7f51\u7edc \u4e0a\u3002 NetworkLabelModel \u8be5\u5bf9\u8c61\u4ee3\u8868\u903b\u8f91\u7f51\u7edc\u6807\u7b7e\uff0c\u903b\u8f91\u7f51\u7edc\u6807\u7b7e\u5206\u914d\u7ed9\u7f51\u7edc\u63a5\u53e3\u4ee5\u540e\u53ef\u4ee5\u4e0e\u5206\u914d\u7ed9\u540c\u4e00\u7f51\u7edc\u63a5\u53e3\u7684\u903b\u8f91\u7f51\u7edc\u8fdb\u884c\u7ed1\u5b9a\uff08\u901a\u8fc7\u7f16\u8f91\u6216\u4fee\u6539\u903b\u8f91\u7f51\u7edc\uff09\uff0c\u8fd9\u6837\u53ea\u5bf9\u6807\u7b7e\u8fdb\u884c\u64cd\u4f5c\u5c31\u53ef\u4ee5\u540c\u65f6\u5bf9\u4e0e\u6807\u7b7e\u7ed1\u5b9a\u7684\u6240\u6709\u903b\u8f91\u540c\u65f6\u8fdb\u884c\u64cd\u4f5c\u3002\u5bf9\u5e94\u7684\u9875\u9762\u4fe1\u606f\u5982\u4e0b\uff1a \u5728\u9875\u9762\u4e0a\u53ef\u4ee5\u901a\u8fc7\u62d6\u52a8\u6807\u7b7e\u5c06\u6807\u7b7e\u5206\u914d\u7ed9\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\uff0c\u4e00\u4e2a\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u53ef\u4ee5\u6709\u591a\u4e2a\u6807\u7b7e\u3002 NetworkInterfaceModel \u8be5\u5bf9\u8c61\u4ee3\u8868\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\uff0c\u5305\u62ec\u4e86Engine\u903b\u8f91\u7f51\u7edc\u3001\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7684Engine\u903b\u8f91\u7f51\u7edc\u5c5e\u6027\u4fe1\u606f\u4ee5\u53ca\u7f51\u7edc\u6807\u7b7e\u3002\u5bf9\u5e94\u7684\u9875\u9762\u4fe1\u606f\u5982\u4e0b\uff1a \u8be5\u5bf9\u8c61\u5728\u540e\u53f0\u5bf9\u5e94\u7684\u5b9e\u4f53\u5bf9\u8c61\u4e3aVdsNetworkInteface\uff0cVdsNetworkInteface\u5bf9\u8c61\u5b9e\u9645\u4e0a\u662f\u5c06Engine\u903b\u8f91\u7f51\u7edc\u3001\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7684Engine\u903b\u8f91\u7f51\u7edc\u5c5e\u6027\u4fe1\u606f\u4ee5\u53ca\u7f51\u7edc\u6807\u7b7e\u7b49\u4fe1\u606f\u5e94\u7528\u5230\u7269\u7406\u4e3b\u673a\u7684\u7f51\u7edc\u63a5\u53e3\u4ee5\u540e\u7684\u751f\u6210\u7684\u4fe1\u606f\u62bd\u8c61\u5bf9\u8c61\u3002 Bond \u8be5\u5bf9\u8c61\u662f\u591a\u4e2a\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7ed1\u5b9a\u7684\u62bd\u8c61\uff0c\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7ed1\u5b9a\u5373\u591a\u4e2a\u7f51\u7edc\u63a5\u53e3\u5171\u7528\u591a\u4e2a\u903b\u8f91\u7f51\u7edc\uff0c\u5b9e\u9645\u4e0aBond\u5bf9\u8c61\u540d\u5b57\uff08name\uff09\u3001\u7ed1\u5b9a\u6a21\u5f0f\uff08bondOptions\uff09\u4ee5\u53ca\u7ed1\u5b9a\u7684\u63a5\u53e3\u540d\u5b57\u96c6\u5408\uff08slaves\uff09\u7528\u4e8e\u4ee3\u8868\u4e24\u8005\u7684\u7ed1\u5b9a\u5173\u7cfb\u3002\u7ed1\u5b9a\u5173\u7cfb\u5728\u6570\u636e\u5e93\u5e76\u6ca1\u6709\u5bf9\u5e94\u7684\u6620\u5c04\u8868\uff0c\u800c\u662f\u5728VdsNetworkInteface\u4ee5isbond\u5b57\u6bb5\u4ee3\u8868\u662f\u5426\u7ed1\u5b9a\uff0c\u5e76\u4e14\u901a\u8fc7\u5171\u6709\u7684bondName\u8fdb\u884c\u805a\u5408\uff0cVdsNetworkInteface\u7684\u4fe1\u606f\u662f\u5728\u4e3b\u673anetwork\u4fe1\u606f\u66f4\u65b0\u540e\uff0c\u4ecevdsm\u91cd\u65b0\u83b7\u5f97\u4e3b\u673a\u4fe1\u606f\uff0c\u4e4b\u540e\u518d\u66f4\u65b0VdsNetworkInteface\u7684\u6570\u636e\u5e93\u4fe1\u606f\u3002\u5bf9\u5e94\u7684\u9875\u9762\u4fe1\u606f\u5982\u4e0b\uff1a \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 modifiedNetworkAttachments NetworkAttachments body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u4e86\u4fee\u6539\u6216\u8005\u589e\u52a0\u7684NetworkAttachment\u5bf9\u8c61\u7684\u96c6\u5408\u6620\u5c04\uff0c\u8be5\u5bf9\u53ea\u6301\u6709\u4e00\u4e2aNetworkAttachmentModel\u5bf9\u8c61\u96c6\u5408\u7684\u5f15\u7528networkAttachments\u3002NetworkAttachmentModel\u5bf9\u8c61\u5728\u65b0\u5efa\u6216\u8005\u66f4\u65b0\u65f6\uff0c\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\u53ef\u4ee5\u8bbe\u7f6e\uff1a1.id\u5b57\u6bb5\uff0c\u8bbe\u7f6eid\u5b57\u6bb5\u8868\u793a\u66f4\u65b0\uff0c\u672a\u8bbe\u7f6e\u8868\u793a\u65b0\u5efa\u30022.ipAddressAssignments\u5b57\u6bb5\u662fIpAddressAssignments\u5bf9\u8c61\u7684\u5f15\u7528\uff0cIpAddressAssignments\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aIpAddressAssignmentModel\u5217\u8868\u7684\u5f15\u7528ipAddressAssignments\u3002IpAddressAssignmentModel\u6709\u4e24\u4e2a\u5b57\u6bb5\uff0c\u5176\u4e2dassignmentMethod\u5b57\u6bb5\u8868\u793a\u7f51\u7edc\u542f\u52a8\u534f\u8bae\uff0c\u53ef\u9009\u7684\u503c\u6709\uff1aDHCP\u3001STATIC\u3001AUTOCONF\u3001NONE\u3002ip\u5b57\u6bb5\u662fIpModel\u7684\u5f15\u7528\u8868\u793a\u7f51\u7edc\u914d\u7f6e\u4fe1\u606f\uff0cIP\u67094\u4e2a\u5b57\u6bb5\uff0caddress\u5b57\u6bb5\u8868\u793a\u7f51\u5740\uff1bnetmask\u8868\u793a\u5b50\u7f51\u63a9\u7801\uff1bgateway\u8868\u793a\u7f51\u5173\uff1bversion\u8868\u793a\u7f51\u7edc\u534f\u8bae\u7248\u672c\uff0c\u7f51\u7edc\u534f\u8bae\u7248\u672c\u5fc5\u987b\u6307\u5b9a\uff0c\u53ef\u9009\u503c\u6709\uff1aV4\u3001V6\uff0c\u5206\u522b\u4ee3\u8868IPv4\u548cIPv6\u534f\u8bae\u3002\u56e0\u6b64IpAddressAssignments\u7684\u5217\u8868\u4e2d\u6700\u591a\u53ea\u80fd\u6709\u4ee3\u8868IPv4\u548cIPv6\u76842\u4e2aIpAddressAssignmentModel\u5bf9\u8c61\uff0cIpAddressAssignmentModel\u53ef\u4ee5\u4e3a\u7a7a\uff0cIPv4\u548cIPv6\u7684\u6240\u6709\u9ed8\u8ba4\u5c5e\u6027\u90fd\u4e3a\u7a7a\uff0c\u4e5f\u53ef\u4ee5\u53ea\u6dfb\u52a0\u5176\u4e2d\u4e00\u4e2a\uff0c\u90a3\u4e48\u53e6\u4e00\u4e2a\u7684\u6240\u6709\u5c5e\u6027\u5219\u9ed8\u8ba4\u4e3a\u7a7a\u30023.qos\u5b57\u6bb5\u662fQosModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u5f53\u8be5\u5b57\u6bb5\u4e0d\u4e3a\u7a7a\u65f6\u8868\u793a\u5bf9\u4e3b\u673a\u7f51\u7edcqos\u7684\u8986\u76d6\u3002\u9996\u5148QosModel\u5fc5\u987b\u8bbe\u7f6etype\u5b57\u6bb5\uff0c\u4e14\u5fc5\u987b\u4e3aHOSTNETWORK\uff1bQosModel\u53ef\u4ee5\u8bbe\u7f6e\u7684\u5b57\u6bb5\u6709outboundAverageLinkshare\uff08\u52a0\u6743\u91cd\u7684\u5171\u4eab\uff09\u3001outboundAverageRealtime\uff08\u5b9e\u73b0\u7684\u901f\u7387\uff09\u4ee5\u53caoutboundAverageUpperlimit\uff08\u901f\u7387\u9650\u5236\uff09\uff0cqos\u5b57\u6bb5\u53ef\u4ee5\u4e3a\u7a7a\u30024.properties\u5b57\u6bb5\u662fProperties\u5bf9\u8c61\u7684\u5f15\u7528\u4ee3\u8868\u4e86\u81ea\u5b9a\u4e49\u5c5e\u6027\uff0cProperties\u5bf9\u8c61\u53ea\u6301\u6709\u96c6\u5408\u5f15\u7528\uff0c\u662fPropertyModel\u5bf9\u8c61\u96c6\u5408\u7684\u6620\u5c04\uff0c\u901a\u8fc7\u8bbe\u7f6ePropertyModel\u5bf9\u8c61\u7684name\u548cvalue\u5b57\u6bb5\u6765\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u5c5e\u6027\uff0c\u76ee\u524d\u53ef\u9009\u7684name\u53ea\u6709 bridge_opts \u3002properties\u5b57\u6bb5\u5b57\u6bb5\u53ef\u4ee5\u4e3a\u7a7a5.hostNic\u5b57\u6bb5\u662fHostNicModel\u5f15\u7528\uff0c\u4ee3\u8868\u4e86NetworkAttachment\u6240\u5c5e\u7684\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\uff0chostNic\u5fc5\u987b\u6307\u5b9aHostNicModel\u7684name\u5b57\u6bb5\u6216\u8005id\u5b57\u6bb5\u30026.network\u5b57\u6bb5\u4ee3\u8868\u4e86NetworkAttachment\u6240\u5c5e\u7684\u903b\u8f91\u7f51\u7edc\uff0cnetwork\u5fc5\u987b\u6307\u5b9aHostNicModel\u7684name\u5b57\u6bb5\u6216\u8005id\u5b57\u6bb5\u3002\u5f535.6\u7ed3\u5408\u5728\u4e00\u8d77\u65f6\uff0c\u5c31\u53ef\u4ee5\u8868\u793a\u628a\u903b\u8f91\u7f51\u7edc\u5206\u914d\u7ed9\u4e86\u6307\u5b9a\u7684\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u3002 synchronizedNetworkAttachments NetworkAttachments body \u53ef\u9009\u53c2\u6570\uff0c\u8be5\u5bf9\u8c61\u7684networkAttachments\u5b57\u6bb5\u8868\u793a\u9700\u8981\u7acb\u5373\u540c\u6b65\uff08\u7acb\u5373\u5e94\u7528\uff09NetworkAttachment\u7684\u7f51\u7edc\u914d\u7f6e\u4fe1\u606f\u5230\u7269\u7406\u4e3b\u673a\u7684\u7f51\u7edc\u63a5\u53e3\u7684NetworkAttachment\u96c6\u5408\uff0c\u8be5\u96c6\u5408\u4e2d\u7684NetworkAttachment\u5bf9\u8c61\u53ea\u9700\u8981\u8bbe\u7f6eid\u5b57\u6bb5\u5373\u53ef\uff0c\u8be5\u96c6\u5408NetworkAttachment\u65e2\u53ef\u4ee5\u662fmodifiedNetworkAttachments\u4e2d\u4fee\u6539\u4e86\u7684\u5bf9\u8c61\uff0c\u4e5f\u53ef\u4ee5\u662f\u540e\u53f0\u6570\u636e\u5e93\u5df2\u7ecf\u5b58\u5728\u7684\u5bf9\u8c61\uff0c\u4f46\u662f\u4e0d\u80fd\u662f\u65b0\u5efa\u7684NetworkAttachment\u5bf9\u8c61\uff0c\u56e0\u4e3a\u65b0\u5efa\u7684\u5bf9\u8c61\u4e0d\u80fd\u8bbe\u7f6eid\u5b57\u6bb5\u3002 removedNetworkAttachments NetworkAttachments body \u53ef\u9009\u53c2\u6570\uff0cNetworkAttachments\u7684networkAttachments\u5b57\u6bb5\u8868\u793a\u9700\u8981\u5220\u9664\u7684NetworkAttachment\u5bf9\u8c61\u96c6\u5408\uff0c\u53ea\u9700\u8981\u6307\u5b9aNetworkAttachment\u5bf9\u8c61\u7684id\u5b57\u6bb5\u5373\u53ef\u3002\u5f53NetworkAttachment\u88ab\u76f4\u63a5\u5220\u9664\uff0cNetworkAttachment\u9644\u52a0\u5230\u7684\u903b\u8f91\u7f51\u7edc\u4e5f\u4f1a\u4ece\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u5206\u79bb\u3002 modifiedLabels NetworkLabels body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u4e86\u65b0\u589e\u7684NetworkLabel\u5bf9\u8c61\u7684\u96c6\u5408\u6620\u5c04\uff0c\u8be5\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aNetworkLabelModel\u5bf9\u8c61\u96c6\u5408\u7684\u5f15\u7528networkLabels\u3002\u5728\u65b0\u589e\u7f51\u7edc\u63a5\u53e3\u6807\u7b7e\u65f6\uff0cNetworkLabelModel\u9700\u8981\u6307\u5b9a\u4e24\u4e2a\u5b57\u6bb51.hostNic\u5b57\u6bb5\uff0chostNic\u5b57\u6bb5\u662f\u7f51\u7edc\u63a5\u53e3\u6807\u7b7e\u6240\u9644\u52a0\u5230\u7684\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3HostNicModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u81f3\u5c11\u9700\u8981\u6307\u5b9aHostNicModel\u5bf9\u8c61\u7684id\u5b57\u6bb5\u6216name\u5b57\u6bb5\u30022.id\u5b57\u6bb5\uff0c\u4ee3\u8868\u6807\u7b7e\u540d\uff0c\u5373\u4e3a\u6807\u7b7e\u53d6\u4e00\u4e2a\u540d\u5b57\u3002 removedLabels NetworkLabels body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u9700\u8981\u4ece\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u89e3\u7ed1\u7684\u7f51\u7edc\u63a5\u53e3\u6807\u7b7e\u96c6\u5408\uff0c\u8be5\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aNetworkLabelModel\u5bf9\u8c61\u96c6\u5408\u7684\u5f15\u7528networkLabels\u3002\u5728\u6307\u5b9a\u8981\u89e3\u7ed1\u7684\u7f51\u7edc\u6807\u7b7e\u5bf9\u8c61\u65f6\uff0c\u53ea\u9700\u8981\u6307\u5b9aNetworkLabelModel\u7684id\u5b57\u6bb5\u3002 modifiedBonds HostNics body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u5bf9\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7ed1\u5b9a\u5173\u7cfb\u7684\u4fee\u6539\uff08\u4ece\u591a\u4e2a\u7ed1\u5b9a\u4e2d\u53bb\u6389\u67d0\u4e2a\u7ed1\u5b9a\u3001\u5408\u5e76\u7ed1\u5b9a\u3001\u5728\u7ed1\u5b9a\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3\u7b49\uff09\u548c\u65b0\u589e\uff08\u5c06\u4e24\u4e2a\u6216\u4e24\u4e2a\u4ee5\u4e0a\u7684\u63a5\u53e3\u7ec4\u5408\u4e00\u4e2a\u7ed1\u5b9a\uff09\u64cd\u4f5c\u7684HostNic\u5bf9\u8c61\u7684\u96c6\u5408\u6620\u5c04\uff0cHostNics\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aHostNic\u5bf9\u8c61\u96c6\u5408\u7684\u5f15\u7528hostNics\uff0c\u4e00\u4e2aHostNic\u5bf9\u8c61\u4ee3\u8868\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3\u7ed1\u5b9a\u3002HostNic\u5bf9\u8c61\u5728\u65b0\u5efa\u6216\u8005\u4fee\u6539\u65f6\uff0c\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\u53ef\u4ee5\u8bbe\u7f6e\uff1a1.id\u5b57\u6bb5\uff0c\u5f53\u8bbe\u7f6eid\u65f6\u8868\u793a\u5bf9\u5df2\u7ecf\u5b58\u5728\u7684\u7f51\u7edc\u63a5\u53e3\u7ed1\u5b9a\u8fdb\u884c\u4fee\u6539\uff0c\u672a\u8bbe\u7f6eid\u65f6\u8868\u793a\u65b0\u5efa\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3\u7ed1\u5b9a\u30022.name\u5b57\u6bb5\uff0cname\u5b57\u6bb5\u4e0d\u80fd\u4e3a\u7a7a\u4e14\u5fc5\u987b\u662f bond +\u6570\u5b57\u7684\u5f62\u5f0f\uff0c\u5982\u679cname\u5df2\u7ecf\u5b58\u5728\u5219\u8868\u793a\u5bf9\u5df2\u6709\u7ed1\u5b9a\u8fdb\u884c\u4fee\u6539\uff0c\u5426\u5219\u8868\u793a\u65b0\u5efa\u4e00\u4e2a\u7ed1\u5b9a\u30023.bonding\u5b57\u6bb5\uff0c\u8be5\u5b57\u6bb5\u4ee3\u8868\u9700\u8981\u7ed1\u5b9a\u5728\u4e00\u8d77\u7684\u7f51\u7edc\u63a5\u53e3\u96c6\u5408BondingModel\u5bf9\u8c61\uff0cBondingModel\u6709\u4e24\u4e2a\u5b57\u6bb5\u53ef\u4ee5\u5f71\u54cd\u7f51\u7edc\u63a5\u53e3\u7684\u7ed1\u5b9a\u5c5e\u6027\u30024.slaves\u5b57\u6bb5\uff0cslaves\u662fHostNics\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u9700\u8981\u7ed1\u5b9a\u5728\u4e00\u8d77\u7684\u7f51\u7edc\u63a5\u53e3\u96c6\u5408\u6620\u5c04\uff0cHostNics\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aHostNic\u5bf9\u8c61\u96c6\u5408\u7684\u5f15\u7528hostNics\uff0c\u8fd9\u91cc\u7684\u4e00\u4e2aHostNic\u5bf9\u8c61\u4ee3\u8868\u4e00\u4e2a\u9700\u8981\u88ab\u7ed1\u5b9a\u7684\u7f51\u7edc\u63a5\u53e3\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6307\u5b9aHostNic\u5bf9\u8c61\u7684id\u5b57\u6bb5\u5373\u53ef\u30025.options\u5b57\u6bb5\uff0c\u662fOptions\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u7ed1\u5b9a\u7f51\u7edc\u63a5\u53e3\u7684\u7ed1\u5b9a\u6a21\u5f0f\uff0cOptions\u5bf9\u8c61\u53ea\u6301\u6709OptionModel\u96c6\u5408\u7684\u5f15\u7528\u5b57\u6bb5options\uff0c\u9700\u8981\u8bbe\u7f6e\u7684\u5c5e\u6027\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6eOptionModel\u5bf9\u8c61\u7684name\u548cvalue\u5b57\u6bb5\u6765\u8d4b\u503c\uff1b\u76ee\u524d\u7ed1\u5b9a\u6a21\u5f0f\u80fd\u591f\u8bbe\u7f6e2\u4e2a\u53c2\u6570\uff0c\u5176\u4e00\u662fmode\u53ef\u9009\u503c\u7684\u8303\u56f4\u4e3a0-6\uff0c\u53e6\u4e00\u4e2a\u662fmiimon\u53ef\u586b\u7684\u503c\u76ee\u524d\u53ea\u77e5\u9053\u540e\u53f0\u7684\u9ed8\u8ba4\u503c\u4e3a100\u3002 removedBonds HostNics body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u5bf9\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7ed1\u5b9a\u5173\u7cfb\u7684\u5220\u9664\u64cd\u4f5c\u7684HostNic\u5bf9\u8c61\u7684\u96c6\u5408\u6620\u5c04\uff0cHostNics\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aHostNic\u5bf9\u8c61\u96c6\u5408\u7684\u5f15\u7528hostNics\uff0c\u4e00\u4e2aHostNic\u5bf9\u8c61\u4ee3\u8868\u4e00\u4e2a\u9700\u8981\u5220\u9664\u7f51\u7edc\u63a5\u53e3\u7ed1\u5b9a\uff0c\u5220\u9664\u96c6\u5408\u4e2d\u53ea\u9700\u8981\u6307\u5b9aHostNic\u5bf9\u8c61\u7684id\u5b57\u6bb5\u5373\u53ef\u3002 checkConnectivity Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u5728\u8bbe\u7f6e\u5b8c\u6210\u4e4b\u540e\uff0c\u6821\u9a8c\u4e3b\u673a\u548cEngine\u4e4b\u95f4\u7684\u7f51\u7edc\u8fde\u63a5\u6027\uff0c\u9ed8\u8ba4\u503c\u4e3afalse\u3002 connectivityTimeout Integer body \u53ef\u9009\u53c2\u6570\uff0c\u8bbe\u7f6e\u4e0e\u4e3b\u673a\u8fde\u63a5\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u9ed8\u8ba4\u503c\u4e3a vdc_options \u8868\u4e2d\u7684NetworkConnectivityCheckTimeoutInSeconds\u53c2\u6570\u5bf9\u5e94\u7684\u503c\u3002 \u8bf4\u660e\uff1a\u5728\u524d\u53f0\u64cd\u4f5c\u4e2d\uff0c\u4e00\u4e2a\u62d6\u52a8\u64cd\u4f5c\u53ef\u80fd\u5bf9\u5e94\u4e86\u591a\u4e2a\u5bf9\u8c61\u4fee\u6539\u6216\u8005\u521b\u5efa\uff0c\u5177\u4f53\u7684\u5bf9\u7167\u5173\u7cfb\u8bf7\u53c2\u8003 NetworkOperation \u679a\u4e3e\u7c7b\u4e2d\u6bcf\u4e2a\u679a\u4e3e\u5bf9\u8c61\u7684getTarget\u65b9\u6cd5\u8fd4\u56de\u7684 NetworkOperationCommandTarget \u5bf9\u8c61\u7684 executeNetworkCommand \u6240\u5bf9\u5e94\u7684\u64cd\u4f5c\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/setupnetworks { \"modifiedNetworkAttachments\": { \"networkAttachments\": [ { \"ipAddressAssignments\": { \"ipAddressAssignments\": [ { \"assignmentMethod\": \"STATIC\", \"ip\": { \"address\": \"192.168.18.127\", \"netmask\": \"255.255.255.0\", \"gateway\": \"192.168.18.2\", \"version\": \"V4\" } }, { \"assignmentMethod\": \"DHCP\", \"ip\": { \"version\": \"V6\" } } ] }, \"qos\": { \"type\": \"HOSTNETWORK\", \"outboundAverageLinkshare\": 10 }, \"hostNic\": { \"name\": \"ens33\" }, \"network\": { \"name\": \"ovirtmgmt\" } } ] }, \"synchronizedNetworkAttachments\": { \"networkAttachments\": [ { \"id\": \"a19e6492-0d6c-4a0a-8f24-27b5eee85380\" } ] }, \"removedNetworkAttachments\": { \"networkAttachments\": [ { \"id\": \"a19e6492-0d6c-4a0a-8f24-27b5eee85380\" } ] }, \"modifiedLabels\": { \"networkLabels\": [ { \"id\": \"test_label\", \"hostNic\": { \"name\": \"ens33\" } } ] }, \"removedLabels\": { \"networkLabels\": [ { \"id\": \"test_remove_label\" } ] }, \"modifiedBonds\": { \"hostNics\": [ { \"name\": \"bond0\", \"bonding\": { \"slaves\": { \"hostNics\": [ { \"id\": \"a19e6492-0d6c-4a0a-8f24-27b5eee85380\" }, { \"id\": \"a19e6492-0d6c-4a0a-8f24-27b5eee85381\" } ], \"options\": { \"options\": [ { \"name\": \"mode\", \"value\": \"1\" }, { \"name\": \"miimon\", \"value\": \"100\" } ] } } } } ] }, \"removedBonds\": { \"hostNics\": [ { \"id\": \"a19e6492-0d6c-4a0a-8f24-27b5eee85383\" } ] }, \"checkConnectivity\": true } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 2.5.16.\u83b7\u5f97\u4e3b\u673a\u8bbe\u5907\u5217\u8868 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u4e3b\u673a\u8bbe\u5907\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts/{hostId}/devices \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.5.17.\u83b7\u5f97\u6307\u5b9a\u7684\u4e3b\u673a\u8bbe\u5907\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts/{hostId}/devices/{deviceId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.5.18.\u83b7\u5f97\u4e3b\u673aHOOK\u5217\u8868 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u7684\u4e3b\u673aHOOK\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts/{hostId}/hooks \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.5.19.\u83b7\u5f97\u6307\u5b9a\u7684\u4e3b\u673aHOOK\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts/{hostId}/hooks/{hookId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.6.\u865a\u62df\u673a\u6a21\u677f 2.6.1.\u521b\u5efa\u865a\u62df\u673a\u6a21\u677f \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u5fc5\u8981\u53c2\u6570\uff0c\u8868\u793a\u521b\u5efa\u7684\u865a\u62df\u673a\u6a21\u677f\u540d\u5b57 vm VmModel body \u5fc5\u8981\u53c2\u6570\uff0c\u5176\u4e2d\u5fc5\u987b\u6307\u5b9a\u4f5c\u4e3a\u6a21\u677f\u7684\u865a\u62df\u673a\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\uff0cid\u5b57\u6bb5\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8ename\u5b57\u6bb5\u3002\u5982\u679c\u4f60\u60f3\u8981\u4fee\u6539\u865a\u62df\u673a\u6a21\u677f\u7684\u78c1\u76d8\u76f8\u5173\u7684\u53c2\u6570\uff0c\u4f60\u9700\u8981\u6307\u5b9aVmModel\u7684diskAttachments\u5b57\u6bb5\uff0cdiskAttachments\u662fDiskAttachments\u5bf9\u8c61\u4ee3\u8868\u865a\u62df\u673a\u9644\u52a0\u78c1\u76d8\u5217\u8868\uff0cDiskAttachments\u53ea\u62e5\u6709diskAttachments\u4e00\u4e2a\u5b57\u6bb5\uff0c\u662fDiskAttachment\u96c6\u5408\u7684\u5f15\u7528\uff0cDiskAttachment\u5bf9\u8c61\u7684disk\u5b57\u6bb5\u6240\u6307\u5411\u7684DiskModel\u624d\u662f\u771f\u6b63\u7684\u78c1\u76d8\u4fe1\u606f\u3002\u5f53\u9700\u8981\u4fee\u6539\u78c1\u76d8\u53c2\u6570\u65f6\u5fc5\u987b\u6307\u5b9a\u8981\u4fee\u6539DiskModel\u7684id\u5b57\u6bb5\u3002\u53ca\u8981\u4fee\u6539\u7684\u53c2\u6570\uff0c\u4f8b\u5982DiskModel\u7684name\u5b57\u6bb5\u8868\u793a\u8981\u4fee\u6539\u7684\u78c1\u76d8\u540d\uff1bDiskModel\u7684format\u5b57\u6bb5\u8868\u793a\u8981\u4fee\u6539\u7684\u78c1\u76d8\u683c\u5f0f\uff0c\u53ef\u9009\u503c\u5305\u62ecCOW\u548cRAW\uff1bDiskModel\u7684storageDomains\u5b57\u6bb5\u662fStorageDomains\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u8868\u793a\u6307\u5b9a\u78c1\u76d8\u7684\u5b58\u50a8\u57df\uff0cStorageDomains\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aStorageDomainModel\u96c6\u5408\u7684\u5f15\u7528storageDomains\u5b57\u6bb5\uff0c\u6307\u5b9a\u78c1\u76d8\u5b58\u50a8\u57df\u65f6\u53ea\u9700\u8981\u6307\u5b9a\u96c6\u5408\u4e2d\u4e00\u4e2aStorageDomainModel\u7684id\u5b57\u6bb5\u5373\u53ef\u3002 cluster ClusterModel body \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u865a\u62df\u673a\u6a21\u677f\u6240\u5c5e\u7684\u96c6\u7fa4\uff0c\u53ef\u4ee5\u6307\u5b9a\u96c6\u7fa4\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\uff0c\u5982\u679c\u6307\u5b9a\u4e86\u96c6\u7fa4\u7684id\u5b57\u6bb5\uff0c\u90a3\u4e48name\u5b57\u6bb5\u5c31\u4e0d\u4f1a\u6709\u4efb\u4f55\u4f5c\u7528\u3002\u4e0d\u6307\u5b9a\u8be5\u53c2\u6570\u65f6\uff0c\u865a\u62df\u673a\u6a21\u677f\u6240\u5c5e\u7684\u96c6\u7fa4\u4e3a\u4f5c\u4e3a\u6a21\u677f\u7684\u865a\u62df\u673a\u6240\u5728\u7684\u96c6\u7fa4\u3002 cpuProfile CpuProfileModel body \u53ef\u9009\u53c2\u6570\uff0c\u5f53\u865a\u62df\u673a\u6a21\u677f\u6240\u5c5e\u7684\u96c6\u7fa4\u4e0e\u4f5c\u4e3a\u6a21\u677f\u7684\u865a\u62df\u673a\u6240\u5728\u7684\u96c6\u7fa4\u4e0d\u540c\u65f6\u9700\u8981\u6307\u5b9a\uff0c\u865a\u62df\u673a\u6a21\u677f\u7684CPU\u914d\u7f6e\u96c6\u5fc5\u987b\u662f\u865a\u62df\u673a\u6a21\u677f\u6240\u5c5e\u7684\u96c6\u7fa4\u4e0b\u7684CPU\u914d\u7f6e\u96c6\u4e4b\u4e00\uff0c\u53ea\u9700\u6307\u5b9aCpuProfileModel\u7684id\u5b57\u6bb5\u5373\u53ef\u3002\u9ed8\u8ba4\u503c\u4e3a\u4f5c\u4e3a\u6a21\u677f\u7684\u865a\u62df\u673a\u6240\u5728\u96c6\u7fa4\u7684\u7b2c\u4e00\u4e2acpu\u914d\u7f6e\u96c6\u3002 description String body \u53ef\u9009\u53c2\u6570\uff0c\u865a\u62df\u673a\u6a21\u677f\u63cf\u8ff0 version TemplateVersionModel body \u53ef\u9009\u53c2\u6570\uff0c\u5f53\u8be5\u5b57\u6bb5\u4e0d\u4e3a\u7a7a\u65f6\uff0c\u4ee3\u8868\u4e3a\u5f53\u524d\u865a\u62df\u673a\u5df2\u5b58\u5728\u7684\u6a21\u677f\u521b\u5efa\u5b50\u6a21\u677f\u3002TemplateVersionModel\u5bf9\u8c61\u67092\u4e2a\u5b57\u6bb5\u9700\u8981\u6307\u5b9a\uff1a1.baseTemplate\u5b57\u6bb5\uff0c\u662fTemplateModel\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u4e86\u8981\u521b\u5efa\u7684\u6a21\u677f\u7236\u6a21\u677f\uff0c\u53ea\u9700\u8981\u6307\u5b9aTemplateModel\u7684id\u5b57\u6bb5\u5373\u53ef\u30022.versionName\u5b57\u6bb5\uff0c\u7528\u4e8e\u6307\u5b9a\u5b50\u6a21\u677f\u7684\u7248\u672c\u540d\u3002 storageDomain StorageDomainModel body \u53ef\u9009\u53c2\u6570\uff0c\u65b9\u4fbf\u7edf\u4e00\u8bbe\u7f6e\u865a\u62df\u673a\u6a21\u677f\u7684\u78c1\u76d8\u6240\u5728\u7684\u6a21\u677f\u5b58\u50a8\u57df\uff0c\u53ea\u8981\u8bbe\u7f6eStorageDomainModel\u7684id\u5b57\u6bb5\u5373\u53ef\u3002\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5373\u4f7f\u5728VmModel\u4e2d\u8bbe\u7f6e\u4e86DiskAttachment\u5bf9\u8c61\u7684DiskModel\u5b58\u50a8\u57df\uff0c\u53ea\u8981\u4e00\u65e6\u8bbe\u7f6eStorageDomainModel\u7684id\u5b57\u6bb5\uff0cVmModel\u4e2d\u5bf9\u4e8e\u78c1\u76d8\u50a8\u5b58\u57df\u7684\u8bbe\u7f6e\u4fbf\u4f1a\u5931\u6548\u3002 clone_permissions Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u590d\u5236\u4f5c\u4e3a\u6a21\u677f\u7684\u865a\u62df\u673a\u7684\u6743\u9650\u5230\u521b\u5efa\u7684\u865a\u62df\u673a\u6a21\u677f\u4e0a\u3002 usb UsbModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u6a21\u677f\u7684usb\u7b56\u7565\uff0cUsbModel\u5177\u67092\u4e2a\u5b57\u6bb5\uff1a1.enabled\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u542f\u7528usb\u7b56\u7565\uff0c\u53ea\u6709\u8be5\u5b57\u6bb5\u4e3atrue\u65f6\uff0c\u5176\u4ed6\u5b57\u6bb5\u624d\u80fd\u751f\u6548\u30022.type\u5b57\u6bb5\uff0c\u4ee3\u8868usb\u7b56\u7565\u7c7b\u578b\uff0c\u53ef\u9009\u503c\u6709LEGACY\u548cNATIVE\u3002 consoleEnabled Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u662f\u5426\u542f\u7528\u63a7\u5236\u53f0\u3002\u9ed8\u8ba4\u503c\u662f\u6839\u636e\u4e3a\u6a21\u677f\u7684\u865a\u62df\u673a\u662f\u5426\u5177\u6709\u63a7\u5236\u53f0\u8bbe\u5907\u51b3\u5b9a\u7684\u3002 virtioScsiEnabled Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u662f\u5426\u542f\u7528virtioScsi\u3002\u9ed8\u8ba4\u503c\u4e3anull\u3002 soundcardEnabled Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u662f\u5426\u542f\u7528\u58f0\u5361\u3002\u9ed8\u8ba4\u503c\u662f\u6839\u636e\u4e3a\u6a21\u677f\u7684\u865a\u62df\u673a\u662f\u5426\u5177\u6709\u58f0\u5361\u8bbe\u5907\u51b3\u5b9a\u7684\u3002 display DisplayModel body \u53ef\u9009\u53c2\u6570\uff0cDisplayModel\u4ee3\u8868\u865a\u62df\u673a\u7684\u663e\u793a\u6a21\u578b\uff0c\u6709\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\uff1a1.type\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u4f7f\u7528\u7684\u56fe\u5f62\u534f\u8bae\uff0c\u53ef\u9009\u7684\u56fe\u5f62\u534f\u8bae\u9009\u9879\u6709VNC\u548cSPICE\uff0c\u5f53\u8bbe\u7f6e\u4e86\u8be5\u5b57\u6bb5\u865a\u62df\u7684\u89c6\u9891\u7c7b\u578b\uff08defaultDisplayType\uff09\u4f1a\u88ab\u7f6e\u4e3a\u7a7a\uff0c\u7531\u540e\u53f0\u51b3\u5b9a\u30022.monitors\u5b57\u6bb5\uff0c\u4ee3\u8868\u76d1\u89c6\u5668\u6570\u91cf\u30023.singleQxlPci\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u4e3a\u5355\u4e2aPCI\u63a5\u53e3\u30024.smartcardEnabled\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u542f\u7528\u667a\u80fd\u5361\u30025.allowOverride\u5b57\u6bb5\uff0c\u4ee3\u8868\u662f\u5426\u5141\u8bb8\u63a7\u5236\u53f0\u91cd\u8fde\uff08\u4e0d\u77e5\u9053\u5565\u610f\u601d\uff09\u3002\u5728\u754c\u9762\u4e2d\u6ca1\u6709\u5bf9\u5e94\u7684\u9009\u9879\uff0c\u4e0e\u865a\u62df\u673a\u662f\u670d\u52a1\u5668\u8fd8\u662f\u684c\u9762\u76f8\u5173\uff0c\u5f53\u865a\u62df\u673a\u4e3a\u670d\u52a1\u5668\u65f6\u8be5\u4f1a\u88ab\u8bbe\u4e3atrue\u30026.keyboardLayout\u5b57\u6bb5\uff0c\u4ee3\u8868vnc\u952e\u76d8\u5e03\u5c40\uff08\u4f5c\u7528\u672a\u77e5\uff09\uff0c\u5728\u754c\u9762\u4e2d\u8be5\u9009\u9879\u88ab\u9690\u85cf\uff0c\u53ef\u9009\u5185\u5bb9\u89c1 vdc_options \u8868\u7684 VncKeyboardLayoutValidValues \u9009\u9879\u30027.fileTransferEnabled\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u542f\u7528SPICE\u6587\u4ef6\u8f6c\u6362\uff08\u4f5c\u7528\u672a\u77e5\uff09\uff0c\u5728\u754c\u9762\u4e2d\u8be5\u9009\u9879\u88ab\u9690\u85cf\u30028.copyPasteEnabled\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u542f\u7528SPICE\u526a\u8d34\u677f\u590d\u5236\u548c\u7c98\u8d34\uff08\u4f5c\u7528\u672a\u77e5\uff09\uff0c\u5728\u754c\u9762\u4e2d\u8be5\u9009\u9879\u88ab\u9690\u85cf\u30029.disconnectAction\u5b57\u6bb5\uff0c\u4ee3\u8868\u63a7\u5236\u53f0\u8fde\u63a5\u4e2d\u65ad\u4ee5\u540e\u865a\u62df\u673a\u7684\u884c\u4e3a\uff0c\u53ef\u9009\u503c\u6709\uff1aNONE\uff08\u65e0\u64cd\u4f5c\uff09\u3001LOCK_SCREEN\uff08\u9501\u5b9a\u5c4f\u5e55\uff09\u3001LOGOUT\uff08\u7528\u6237\u767b\u51fa\uff09\u3001REBOOT\uff08\u91cd\u542f\u865a\u62df\u673a\uff09\u3001SHUTDOWN\uff08\u5173\u95ed\u865a\u62df\u673a\uff09\u3002 filter Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u5f53\u672a\u6307\u5b9a\u865a\u62df\u673aid\u5b57\u6bb5\u800c\u6307\u5b9a\u4e86\u865a\u62df\u673aname\u5b57\u6bb5\u65f6\uff0c\u6839\u636e\u865a\u62df\u673a\u540d\u67e5\u8be2\u6307\u5b9a\u865a\u62df\u673a\u65f6\u662f\u5426\u6839\u636e\u5f53\u524d\u767b\u5165\u7684\u7528\u6237\u6743\u9650\u8fc7\u6ee4\u67e5\u8be2\u7684\u865a\u62df\u673a\u3002 memory Long body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u6a21\u677f\u7684\u5185\u5b58\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3ab NumOfIoThreads Integer body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u6a21\u677f\u7684IO\u7ebf\u7a0b\u6570\u91cf cpu CpuModel body \u53ef\u9009\u53c2\u6570\uff0cCpuModel\u7684topology\u5b57\u6bb5\u662fCpuTopologyModel\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u4e86cpu\u7684\u62d3\u6251\u7ed3\u6784\u3002CpuTopologyModel\u6709\u51e0\u4e2a\u5b57\u6bb5\uff1a1.cores\u5b57\u6bb5\u4ee3\u8868\u4e86\u6bcf\u4e2a\u865a\u62df\u673a\u63d2\u69fd\u7684\u5185\u6838\u6570\uff1b2.sockets\u5b57\u6bb5\u4ee3\u8868\u4e86\u865a\u62df\u673acpu\u63d2\u69fd\u6570\u91cf\uff1b3.threads\u5b57\u6bb5\u4ee3\u8868\u6bcf\u4e2a\u5185\u6838\u7684cpu\u5185\u6838\u7684\u7ebf\u7a0b\u6570\u91cf\uff0c\u53ef\u9009\u503c\u53ea\u67091\u548c2\u3002CpuModel\u7684architecture\u5b57\u6bb5\uff0c\u4ee3\u8868\u96c6\u7fa4cpu\u67b6\u6784\u3002\u53ef\u9009\u7684cpu\u67b6\u6784\u6709x86_64\u548cppc64 highAvailability HighAvailabilityModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u9ad8\u53ef\u7528\u76f8\u5173\u7684\u914d\u7f6e\uff0c\u5176\u4e2denabled\u5b57\u6bb5\u8868\u793a\u662f\u5426\u5f00\u542f\u865a\u62df\u673a\u9ad8\u53ef\u7528\uff1bpriority\u5b57\u6bb5\u8868\u793a\u865a\u62df\u673a\u8fc1\u79fb\u7684\u4f18\u5148\u7ea7\uff0c\u4e3aInterge\u7c7b\u578b\u3002 migrationDowntime Integer body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u81ea\u5b9a\u4e49\u7684\u8fc1\u79fb\u4e0b\u7ebf\u65f6\u95f4\uff0c\u4e3aInterge\u7c7b\u578b\u3002 migration MigrationOptionsModel body \u53ef\u9009\u53c2\u6570\uff0cMigrationOptionsModel\u7684\u51e0\u4e2a\u5c5e\u6027\u6620\u5c04\u4e86\u96c6\u7fa4\u865a\u62df\u673a\u8fc1\u79fb\u7b56\u7565\u76843\u4e2a\u65b9\u9762\u30021. policy \u5b57\u6bb5\u662fMigrationPolicyModel\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u96c6\u7fa4\u7684\u8fc1\u79fb\u7b56\u7565\uff0c\u96c6\u7fa4\u53ef\u9009\u7684\u8fc1\u79fb\u7b56\u7565\u4e00\u5171\u67093\u79cd\uff1aLegacy\uff08id\u4e3a00000000-0000-0000-0000-000000000000\uff09\u3001Minimal downtime\uff08id\u4e3a80554327-0569-496b-bdeb-fcbbf52b827b\uff09\u548cSuspend workload if needed\uff08id\u4e3a80554327-0569-496b-bdeb-fcbbf52b827c\uff09\uff0c\u5176\u4e2dLegacy\u53ea\u8bbe\u7f6e\u4e86\u6700\u5927\u7684\u8fc1\u79fb\u6570\u91cf\u4e3a2\uff0c\u800c\u53e6\u59162\u79cd\u9009\u9879\u7684\u8be6\u7ec6\u914d\u7f6e\u89c1 vdc_optins \u8868\u7684 MigrationPolicies \u9009\u9879\uff0c\u8fc1\u79fb\u7b56\u7565\u9700\u8981\u8bbe\u7f6eMigrationPolicyModel\u5bf9\u8c61\u7684id\u5b57\u6bb5\uff0c\u9ed8\u8ba4\u503c\u4e3anull\uff1b2. autoConverge \u5b57\u6bb5\u548c compressed \u5b57\u6bb5\uff0c\u5206\u522b\u8868\u793a\u662f\u5426\u81ea\u52a8\u805a\u5408\u8fc1\u79fb\u4ee5\u53ca\u662f\u5426\u542f\u7528\u8fc1\u79fb\u538b\u7f29\u3002\u53ea\u6709\u5728\u8fc1\u79fb\u7b56\u7565\u4e3a Legacy \u65f6\uff0c\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u5728\u865a\u62df\u673a\u8fc1\u79fb\u8fc7\u7a0b\u4e2d\u624d\u4f1a\u751f\u6548\uff0c\u5b83\u4eec\u7684\u53ef\u9009\u503c\u6709\u4e09\u79cd\uff1aTRUE\u3001FALSE\u3001INHERIT\uff08\u8868\u793a\u4ece\u5168\u5c40\u8bbe\u7f6e\u7ee7\u627f\uff09\uff0c\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u4e3anull\u3002 customCpuModel String body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7684cpu\u7c7b\u578b\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u865a\u62df\u673acpu\u7c7b\u578b\uff0c\u5fc5\u987b\u4e0e\u865a\u62df\u673a\u6240\u5728\u96c6\u7fa4\u7684cpu\u7c7b\u578b\u4e3a\u540c\u4e00\u4ea7\u5546\uff0c\u4e14\u4ee3\u6570\u5fc5\u987b\u7b49\u4e8e\u6216\u4f4e\u4e8e\u96c6\u7fa4cpu\u7c7b\u578b\u3002 customEmulatedMachine String body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7684\u4eff\u771f\u673a\u3002 memoryPolicy MemoryPolicyModel body \u53ef\u9009\u53c2\u6570\uff0cMemoryPolicyModel\u5bf9\u8c61\u4ee3\u8868\u865a\u62df\u673a\u7684\u5185\u5b58\u7b56\u7565\uff0c\u5176guaranteed\u5b57\u6bb5\u4ee3\u8868\u865a\u62df\u673a\u4fdd\u8bc1\u7684\u7269\u7406\u5185\u5b58\uff0c\u5355\u4f4d\u4e3ab\u3002 os OperatingSystemModel body \u53ef\u9009\u53c2\u6570\uff0cOperatingSystemModel\u5bf9\u8c61\u4ee3\u8868\u4e0e\u7cfb\u7edf\u5f15\u5bfc\u6709\u5173\u7684\u53c2\u6570\u3002\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\u4f1a\u5f71\u54cd\u6a21\u677f\u7684\u521b\u5efa\uff1a1.boot\u5b57\u6bb5\u662fBootModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u5f15\u5bfc\u8bbe\u5907\u5e8f\u5217\u3002BootModel\u53ea\u6301\u6709devices\u5b57\u6bb5\uff0c\u662fBootDeviceValues\u5bf9\u8c61\u7684\u5f15\u7528\u3002BootDeviceValues\u5bf9\u8c61\u662fBootDevice\u7684\u96c6\u5408\u6620\u5c04\uff0c\u53ea\u6301\u6709BootDevice\u96c6\u5408\u7684\u5f15\u7528bootDevice\u5b57\u6bb5\u3002BootDevice\u4ee3\u8868\u865a\u62df\u673a\u7684\u5f15\u5bfc\u8bbe\u5907\u5e8f\u5217\uff0c\u53ef\u9009\u503c\u6709\uff1aCDROM\uff08\u5149\u9a71\uff09\u3001HD\uff08\u786c\u76d8\uff09\u548cNETWORK\uff08\u7f51\u7edc\uff09\u3002\u5217\u8868\u4e2dBootDevice\u5404\u4e2a\u503c\u7684\u6392\u5217\u987a\u5e8f\uff0c\u4ee3\u8868\u865a\u62df\u673a\u5f15\u5bfc\u8bbe\u5907\u987a\u5e8f\uff0c\u5982\u679c\u51fa\u73b0\u91cd\u590d\u7684\u503c\uff0c\u4f1a\u5148\u53bb\u91cd\u30022.type\u5b57\u6bb5\uff0c\u4ee3\u8868\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\uff0c\u4f8b\u5982other_linux\uff0cwindows_7x64\u7b49\uff0c\u53ef\u9009\u503c\u53c2\u8003 /share/ovirt-engine/conf/osinfo-defaults.properties \u6587\u4ef6\u4e2d\u7684\u914d\u7f6e\u30023.kernel\u5b57\u6bb5\uff0c\u4ee3\u8868Linux\u5f15\u5bfc\u9009\u9879\u4e2d\u7684\u5185\u6838\u8def\u5f84\uff0c\u56e0\u6b64\u53ea\u6709\u5728\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u662flinux\u65f6\u624d\u4f1a\u751f\u6548\uff0c\u8be5\u5b57\u6bb5\u586b\u5199\u7684\u662flinux\u5185\u6838\u5728iso\u57df\u7684\u8def\u5f84\u30024.initrd\u5b57\u6bb5\uff0c\u4ee3\u8868Linux\u5f15\u5bfc\u9009\u9879\u4e2d\u7684initrd\u8def\u5f84\uff0c\u56e0\u6b64\u53ea\u6709\u5728\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u662flinux\u65f6\u624d\u4f1a\u751f\u6548\uff0c\u8be5\u5b57\u6bb5\u586b\u5199\u7684\u662finitrd\u5728iso\u57df\u7684\u8def\u5f84\u30025.cmdline\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u81ea\u5b9a\u4e49\u7684\u5185\u6838\u53c2\u6570\uff0c\u683c\u5f0f\u76ee\u524d\u4e0d\u77e5\u9053\u3002 bootMenuEnabled Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u542f\u7528\u5f15\u5bfc\u83dc\u5355\u3002 timeZone TimeZoneModel body \u53ef\u9009\u53c2\u6570\uff0cTimeZoneModel\u5bf9\u8c61\u4ee3\u8868\u4e86\u865a\u62df\u673a\u7684\u65f6\u533a\u8bbe\u7f6e\u3002\u5176name\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u65f6\u533a\uff0c\u53ef\u9009\u503c\u8be6\u89c1 TimeZoneType \u679a\u4e3e\u7c7b\u7684 initializeTimeZoneList \u65b9\u6cd5\u8fd4\u56de\u7684map\u7684key\u503c\u3002 origin String body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u6765\u6e90\uff08\u4e0d\u4f1a\u624b\u52a8\u8bbe\u7f6e\u5427\uff1f\uff09\uff0c\u53ef\u9009\u503c\u6709VMWARE\u3001XEN\u3001OVIRT\u3001EXTERNAL\u3001KVM\u3002 stateless Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u662f\u5426\u4e3a\u65e0\u72b6\u6001\u3002 deleteProtected Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u662f\u5426\u542f\u7528\u5220\u9664\u4fdd\u62a4\u3002 ssoEnabled Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u662f\u5426\u542f\u7528\u5355\u70b9\u767b\u5165\uff08\u5373\u662f\u5426\u4f7f\u7528GuestAgent\uff09\u3002 type String body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7c7b\u578b\uff0c\u53ef\u9009\u503c\u6709\uff1aDESKTOP\uff08\u684c\u9762\uff09\u3001SERVER\uff08\u670d\u52a1\u5668\uff09\u3002 tunnelMigration Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u662f\u5426\u542f\u7528\u901a\u9053\u8fc1\u79fb\uff08\u4f5c\u7528\u672a\u77e5\uff09\uff0c\u754c\u9762\u6ca1\u627e\u5230\u4e0e\u4e4b\u5bf9\u5e94\u7684\u9009\u9879\u3002 startPaused Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u662f\u5426\u4ee5\u6682\u505c\u6a21\u5f0f\u542f\u52a8\u3002 customProperties CustomProperties body \u53ef\u9009\u53c2\u6570\uff0cCustomProperties\u662f\u865a\u62df\u673a\u81ea\u5b9a\u4e49\u53c2\u6570\u96c6\u5408\u7684\u6620\u5c04\uff0c\u6301\u6709\u552f\u4e00\u7684customProperties\u5b57\u6bb5\u662fCustomPropertyModel\u5217\u8868\u7684\u5f15\u7528\u3002CustomPropertyModel\u4ee3\u8868\u4e86\u6bcf\u4e00\u4e2a\u81ea\u5b9a\u4e49\u53c2\u6570\uff0c\u5176\u4e2dname\u5b57\u6bb5\u4ee3\u8868\u53c2\u6570\u540d\uff0cvalue\u5b57\u6bb5\u4ee3\u8868\u53c2\u6570\u503c\uff0cregexp\u4ee3\u8868\u6b63\u5219\u8868\u8fbe\u5f0f\u3002 quota QuotaModel body \u53ef\u9009\u53c2\u6570\uff0cQuotaModel\u4ee3\u8868\u4e86\u865a\u62df\u673a\u7684\u914d\u989d\uff0c\u914d\u989d\u5177\u4f53\u7684\u4f5c\u7528\u4e0d\u6e05\u695a\uff0c\u754c\u9762\u4e0a\u4e5f\u6ca1\u627e\u5230\u5bf9\u5e94\u7684\u5185\u5bb9\uff0c\u8fd9\u91cc\u53ea\u9700\u8981\u6307\u5b9aid\u5b57\u6bb5\u5373\u53ef\u3002 initialization InitializationModel body \u53ef\u9009\u53c2\u6570\uff0c\u865a\u62df\u673a\u521d\u59cb\u5316\u76f8\u5173\u7684\u5185\u5bb9\uff0c\u592a\u591a\u4e86\uff0c\u6682\u65f6\u5148\u4e0d\u5c55\u5f00\u3002 \u5bf9vm\u7684name\u5b57\u6bb5\u4ee5\u53caid\u5b57\u6bb5\u548ccluster\u7684name\u5b57\u6bb5\u5173\u7cfb\u7684\u4e00\u4e2a\u8bf4\u660e\uff1a\u5982\u679c\u6307\u5b9a\u4e86vm\u7684id\u5b57\u6bb5\uff0c\u521b\u5efa\u865a\u62df\u673a\u6a21\u677f\u7684\u4fe1\u606f\u6765\u6e90\u662f\u6839\u636e\u865a\u62df\u673aid\u67e5\u8be2\u83b7\u5f97\u552f\u4e00\u7684\u865a\u62df\u673a\u4fe1\u606f\u3002\u5982\u679c\u672a\u6307\u5b9avm\u7684id\u5b57\u6bb5\uff0c\u800c\u662f\u6307\u5b9a\u4e86vm\u7684name\u5b57\u6bb5\uff0c\u8fd9\u65f6\u5982\u679c\u672a\u6307\u5b9acluster\u7684name\u5b57\u6bb5\uff0c\u521b\u5efa\u865a\u62df\u673a\u6a21\u677f\u7684\u4fe1\u606f\u6765\u6e90\u662f\u5728\u6240\u6709\u865a\u62df\u673a\u4e2d\u83b7\u5f97\u540d\u5b57\u76f8\u540c\u7684\u865a\u62df\u673a\u4fe1\u606f\uff08\u4e0d\u540c\u6570\u636e\u4e2d\u5fc3\u7684\u865a\u62df\u673a\u53ef\u4ee5\u6709\u4e00\u6837\u7684\u540d\u5b57\uff09\uff1b\u8fd9\u65f6\u5982\u679c\u6307\u5b9a\u4e86cluster\u7684name\u5b57\u6bb5\u5e76\u4e14\u672a\u6307\u5b9acluster\u7684id\u5b57\u6bb5\uff0c\u521b\u5efa\u865a\u62df\u673a\u6a21\u677f\u7684\u4fe1\u606f\u6765\u6e90\u5219\u662f\u6839\u636e\u96c6\u7fa4\u6240\u5728\u7684\u6570\u636e\u4e2d\u5fc3\u4ee5\u53ca\u865a\u62df\u673a\u540d\u6765\u83b7\u5f97\u552f\u4e00\u7684\u865a\u62df\u673a\u4fe1\u606f\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/templates Body: { \"name\": \"test_tp\", \"vm\": { \"id\": \"66dcbd82-7644-4566-ad1f-125f4deafb87\" }, \"cluster\": { \"name\": \"cluster_updated\" }, \"cpuProfile\": { \"id\": \"f517fb01-ffbb-4514-85e7-410f2c7ab662\" }, \"description\": \"test add vm template\", \"display\": { \"type\": \"VNC\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.6.2.\u83b7\u5f97\u6240\u6709\u7684\u865a\u62df\u673a\u6a21\u677f \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e case_sensitive Boolean url \u53ef\u9009\uff0c\u4e0esearch\u53c2\u6570\u4e00\u8d77\u4f7f\u7528\uff0c\u6307\u5b9a\u5728\u6267\u884csearch\u53c2\u6570\u65f6\u662f\u5426\u8003\u8651\u5927\u5c0f\u5199 filter Boolean url \u53ef\u9009\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u865a\u62df\u673a\u6a21\u677f\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 max Integer url \u53ef\u9009\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u865a\u62df\u673a\u6a21\u677f\u6570\u91cf search String url \u53ef\u9009\uff0c\u67e5\u8be2\u7ea6\u675f\u6761\u4ef6\u7ea6\u675f\u8fd4\u56de\u4fe1\u606f\uff0c\u4f8b\u5982name=\"myname\" \u8bf7\u6c42\uff1a GET /acloudageks/api/templates \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.6.3.\u5bfc\u51fa\u865a\u62df\u673a\u6a21\u677f\u5230\u5bfc\u51fa\u57df \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e storageDomain StorageDomainModel body \u5fc5\u8981\u53c2\u6570\uff0c\u8868\u793a\u9700\u8981\u865a\u62df\u673a\u6a21\u677f\u88ab\u5bfc\u51fa\u5230\u7684\u5bfc\u51fa\u57df\uff0c\u9700\u8981\u6307\u5b9aStorageDomainModel\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\u3002 exclusive Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u5f53\u5bfc\u51fa\u57df\u5b58\u5728\u540c\u540d\u865a\u62df\u673a\u6a21\u677f\u65f6\u662f\u5426\u8986\u76d6\u5df2\u7ecf\u5b58\u5728\u7684\u865a\u62df\u673a\u6a21\u677f\u3002\u9ed8\u8ba4\u503c\u4e3afalse. \u8bf7\u6c42\uff1a POST /acloudageks/api/templates/{templateId}/export Body: { \"storageDomain\": { \"id\": \"263612f2-d67b-4ce3-9c3e-af05fd4795bf\" }, \"exclusive\": true } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 2.6.4.\u83b7\u5f97\u6307\u5b9a\u7684\u865a\u62df\u673a\u6a21\u677f\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e filter Boolean url \u53ef\u9009\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u865a\u62df\u673a\u6a21\u677f\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 \u8bf7\u6c42\uff1a GET /acloudageks/api/templates/{templateId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.6.5.\u5220\u9664\u865a\u62df\u673a\u6a21\u677f \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/templates/{templateId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.6.6.\u66f4\u65b0\u865a\u62df\u6a21\u677f\u4fe1\u606f \u548c\u865a\u62df\u673a\u521b\u5efa\u4e00\u6837\uff0c\u53ef\u9009\u7684\u53c2\u6570\u592a\u591a\u4e86\u8fd9\u91cc\u5148\u4e0d\u8fdb\u884c\u6df1\u5165\u7684\u63a2\u7a76 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e ... ... body \u4e0e2.6.1\u4e2d\u7684\u53c2\u6570\u5927\u81f4\u76f8\u540c \u8bf7\u6c42\uff1a PUT /acloudageks/api/templates/{templateId} { \"description\": \"test update vm template\", \"type\": \"DESKTOP\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 2.7.\u865a\u62df\u673a\u6a21\u677f\u7f51\u7edc\u63a5\u53e3 2.7.1.\u6dfb\u52a0\u865a\u62df\u673a\u6a21\u677f\u7f51\u7edc\u63a5\u53e3 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u5fc5\u8981\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u540d\u3002 vnicProfile VnicProfileModel body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u7684\u914d\u7f6e\u96c6\uff0c\u8be5\u53c2\u6570\u53ea\u9700\u8981\u6307\u5b9aVnicProfileModel\u7684id\u5b57\u6bb5\uff0c\u9ed8\u8ba4\u503c\u4e3anull interface String body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u7f51\u5361\u7684\u63a5\u53e3\u7c7b\u578b\uff0c\u53ef\u9009\u7684\u503c\u4e00\u5171\u67096\u79cd\uff1aE1000\u3001VIRTIO\u3001RTL8139\u3001RTL8139_VIRTIO\u3001SPAPR_VLAN\u3001PCI_PASSTHROUGH\u3002\u9ed8\u8ba4\u503c\u4e3aRTL8139_VIRTIO\uff0c\u4f46\u662f\u8be5\u503c\u5728\u540e\u53f0\u6807\u8bb0\u4e3a\u5e9f\u5f03\u72b6\u6001\uff0c\u56e0\u6b64\u5efa\u8bae\u624b\u52a8\u8bbe\u7f6e\u8be5\u503c\uff1b\u53e6\u5916\u8be5\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u6709\u5173\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u7cfb\u7edf\u90fd\u80fd\u591f\u8bbe\u7f6e6\u79cd\u53ef\u9009\u503c mac MacModel body \u53ef\u9009\u53c2\u6570\uff0c\u8bbe\u7f6e\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u7684mac\u5730\u5740\uff0c\u82e5\u672a\u8bbe\u7f6e\u6b64\u503c\uff0c\u540e\u53f0\u4f1a\u4ecemac\u5730\u5740\u6c60\u5206\u914d\u5408\u9002\u7684mac\u5730\u5740 linked Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u662f\u5426\u8fde\u63a5\u7f51\u7ebf\uff0c\u9ed8\u8ba4\u503c\u4e3afalse plugged Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u7684\u7f51\u5361\u662f\u5df2\u63d2\u5165\u8fd8\u662f\u62d4\u51fa\u72b6\u6001\uff0c\u9ed8\u8ba4\u503c\u4e3afalse \u8bf7\u6c42\uff1a POST /acloudageks/api/templates/{templateId}/nics Body: { \"name\": \"test_nic\", \"vnicProfile\": { \"id\": \"86684825-e8f8-43bb-97b0-6972e99eaf47\" }, \"interface\": \"VIRTIO\", \"linked\": true, \"plugged\": true } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.7.2.\u83b7\u5f97\u865a\u62df\u673a\u6a21\u677f\u6240\u6709\u7684\u7f51\u7edc\u63a5\u53e3\u5217\u8868 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u865a\u62df\u673a\u6a21\u677f\u7f51\u7edc\u63a5\u53e3\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/templates/{templateId}/nics?max=1 \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.7.3.\u83b7\u5f97\u865a\u62df\u673a\u6a21\u677f\u6307\u5b9a\u7684\u7f51\u7edc\u63a5\u53e3\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/templates/{templateId}/nics/{nicId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.7.4.\u5220\u9664\u6307\u5b9a\u7684\u865a\u62df\u673a\u6a21\u677f\u7f51\u7edc\u63a5\u53e3 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/templates/{templateId}/nics/{nicId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.7.5.\u66f4\u65b0\u865a\u62df\u673a\u6a21\u677f\u7f51\u7edc\u63a5\u53e3\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 name String body \u4fee\u6539\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u540d\u3002 vnicProfile VnicProfileModel body \u4fee\u6539\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u7684\u914d\u7f6e\u96c6\uff0c\u8be5\u53c2\u6570\u53ea\u9700\u8981\u6307\u5b9aVnicProfileModel\u7684id\u5b57\u6bb5 interface String body \u4fee\u6539\u7f51\u5361\u7684\u63a5\u53e3\u7c7b\u578b\uff0c\u53ef\u9009\u7684\u503c\u4e00\u5171\u67096\u79cd\uff1aE1000\u3001VIRTIO\u3001RTL8139\u3001RTL8139_VIRTIO\u3001SPAPR_VLAN\u3001PCI_PASSTHROUGH\u3002\u9ed8\u8ba4\u503c\u4e3aRTL8139_VIRTIO\uff0c\u4f46\u662f\u8be5\u503c\u5728\u540e\u53f0\u6807\u8bb0\u4e3a\u5e9f\u5f03\u72b6\u6001\uff0c\u56e0\u6b64\u5efa\u8bae\u624b\u52a8\u8bbe\u7f6e\u8be5\u503c\uff1b\u53e6\u5916\u8be5\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u6709\u5173\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u7cfb\u7edf\u90fd\u80fd\u591f\u8bbe\u7f6e6\u79cd\u53ef\u9009\u503c mac MacModel body \u4fee\u6539\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u7684mac\u5730\u5740 linked Boolean body \u4fee\u6539\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u662f\u5426\u8fde\u63a5\u7f51\u7ebf plugged Boolean body \u4fee\u6539\u865a\u62df\u673a\u7684\u7f51\u5361\u662f\u5df2\u63d2\u5165\u8fd8\u662f\u62d4\u51fa\u72b6\u6001 \u8bf7\u6c42\uff1a PUT /acloudageks/api/templates/{templateId}/nics/{nicId} Body: { \"name\": \"updated_nic\", \"vnicProfile\": { \"id\": \"86684825-e8f8-43bb-97b0-6972e99eaf47\" }, \"interface\": \"RTL8139\", \"linked\": false, \"plugged\": false } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.8.\u865a\u62df\u673a\u6a21\u677f\u78c1\u76d8 \u4e0e\u865a\u62df\u673a\u6a21\u677f\u78c1\u76d8\u76f8\u5173\u7684\u63a5\u53e3\u5728\u6574\u7406\u65f6\u4e22\u5931\u4e86\uff0c\u6240\u4ee5\u9700\u8981\u5728 BackendTemplateResource \u63a5\u53e3\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u63a5\u53e3\u65b9\u6cd5\u624d\u80fd\u4f7f\u865a\u62df\u673a\u78c1\u76d8\u63a5\u53e3\u751f\u6548\u3002\u5728 ovirt3.0 \u865a\u62df\u673a\u78c1\u76d8\u76f8\u5173\u7684\u64cd\u4f5c\u5728\u6b64\u63a5\u53e3\u4e0b\u6267\u884c\uff0c\u4f46\u662f\u5728 ovirt4.0 \u4ee5\u540e\u7684\u865a\u62df\u673a\u78c1\u76d8\u76f8\u5173\u63a5\u53e3\u5728\u78c1\u76d8\u9644\u52a0\uff08DiskAttachments\uff09\u63a5\u53e3\u4e0b\u6267\u884c\uff0c\u4f46\u662f\u78c1\u76d8\u9644\u52a0\u63a5\u53e3\u7f3a\u5c11\u90e8\u5206\u64cd\u4f5c\uff08\u4f8b\u5982\u78c1\u76d8\u7684\u590d\u5236\uff09\uff0c\u5e76\u4e14\u63a5\u53e3\u8fd4\u56de\u7684\u5bf9\u8c61\u5c5e\u6027\uff0c\u5c06\u4f1a\u5728 2.9 \u8be6\u7ec6\u4ecb\u7ecd\u3002 @Path(\"disks\") TemplateDisksResource getDisksResource(); 2.8.1\u83b7\u5f97\u865a\u62df\u673a\u6a21\u677f\u78c1\u76d8\u5217\u8868 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u865a\u62df\u673a\u6a21\u677f\u78c1\u76d8\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/templates/{templateId}/disks?max=1 \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 2.8.2.\u590d\u5236\u865a\u62df\u673a\u6a21\u677f\u78c1\u76d8 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 storageDomain StorageDomainModel body \u5fc5\u8981\u53c2\u6570\uff0c\u6307\u5b9a\u590d\u5236\u7684\u78c1\u76d8\u6240\u5728\u7684\u5b58\u50a8\u57df\uff0c\u9700\u8981\u6307\u5b9aStorageDomainModel\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/templates/{templateId}/disks/{diskId}/copy Body: { \"storageDomain\": { \"id\": \"263612f2-d67b-4ce3-9c3e-af05fd4795bf\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 2.8.3.\u83b7\u5f97\u865a\u62df\u673a\u6a21\u677f\u6307\u5b9a\u7684\u78c1\u76d8\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/templates/{templateId}/disks/{diskId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 2.8.4.\u5220\u9664\u865a\u62df\u673a\u6a21\u677f\u6307\u5b9a\u7684\u78c1\u76d8 \u4ec5\u5f53\u5176\u4ed6\u5b58\u50a8\u57df\u4e0a\u8fd8\u6709\u5176\u4ed6\u73b0\u6709\u78c1\u76d8\u526f\u672c\u65f6\uff0c\u624d\u4f1a\u5220\u9664\u8be5\u78c1\u76d8 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e storage_domain String url \u5fc5\u8981\u53c2\u6570\uff0c\u5f53\u5220\u9664\u865a\u62df\u673a\u6a21\u677f\u7684\u78c1\u76d8\u65f6\u5fc5\u987b\u6307\u5b9a\u78c1\u76d8\u6240\u5728\u7684\u5b58\u50a8\u57dfId force Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u5f3a\u5236\u5220\u9664\u6307\u5b9a\u7684\u78c1\u76d8\uff0c\u9ed8\u8ba4\u503c\u4e3afalse \u8bf7\u6c42\uff1a DELETE /acloudageks/api/templates/{templateId}/disks/{diskId}?storage_domain=263612f2-d67b-4ce3-9c3e-af05fd4795bf \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5 2.9.\u865a\u62df\u6a21\u677f\u9644\u52a0\u78c1\u76d8 \u4e0e 2.8 \u4e2d\u7684\u63a5\u53e3\u533a\u522b\u5728\u4e8e\u8fd4\u56de\u5bf9\u8c61\u7684\u5c5e\u6027\u4e0d\u540c\uff0c\u662f ovirt3.0 \u5230 ovirt4.0 \u7248\u672c\u53d8\u8fc1\u7684\u7ed3\u679c\uff0c\u4e0e 2.8 \u4e2d\u63a5\u53e3\u76f8\u6bd4\u7f3a\u5c11\u4e86\u590d\u5236\u78c1\u76d8\u7684\u63a5\u53e3\u3002 2.9.1\u83b7\u5f97\u865a\u62df\u673a\u6a21\u677f\u9644\u52a0\u78c1\u76d8\u5217\u8868 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/templates/{templateId}/diskattachments \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.9.2.\u83b7\u5f97\u865a\u62df\u673a\u6a21\u677f\u6307\u5b9a\u7684\u9644\u52a0\u78c1\u76d8\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/templates/{templateId}/diskattachments/{diskattachmentId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 2.9.3.\u5220\u9664\u865a\u62df\u673a\u6a21\u677f\u6307\u5b9a\u7684\u78c1\u76d8 \u4ec5\u5f53\u5176\u4ed6\u5b58\u50a8\u57df\u4e0a\u8fd8\u6709\u5176\u4ed6\u73b0\u6709\u78c1\u76d8\u526f\u672c\u65f6\uff0c\u624d\u4f1a\u5220\u9664\u8be5\u78c1\u76d8 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e storage_domain String url \u5fc5\u8981\u53c2\u6570\uff0c\u5f53\u5220\u9664\u865a\u62df\u673a\u6a21\u677f\u7684\u78c1\u76d8\u65f6\u5fc5\u987b\u6307\u5b9a\u78c1\u76d8\u6240\u5728\u7684\u5b58\u50a8\u57dfId force Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u5f3a\u5236\u5220\u9664\u6307\u5b9a\u7684\u78c1\u76d8\uff0c\u9ed8\u8ba4\u503c\u4e3afalse \u8bf7\u6c42\uff1a DELETE /acloudageks/api/templates/{templateId}/disks/{diskId}?storage_domain=263612f2-d67b-4ce3-9c3e-af05fd4795bf \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.0\u7528\u6237\u767b\u5165\u767b\u51fa 3.0.1.\u767b\u5165 \u767b\u5165\u7684\u8fc7\u7a0b\u662f\u4e00\u4e2a\u7528\u6237\u8ba4\u8bc1\u52a0\u9875\u9762\u8df3\u8f6c\u7684\u8fc7\u7a0b\u3002 \u5728\u9875\u9762\u9009\u62e9\u4e09\u5458\u7684\u64cd\u4f5c\u65f6\uff0c\u5b9e\u9645\u6267\u884c /acloudageks/webadmin/?locale=zh_CN \u8bf7\u6c42\uff0c\u5bf9\u5e94\u7684\u76f8\u5e94\u670d\u52a1\u672a\u627e\u5230\uff0c\u8be5\u8bf7\u6c42\u4f1a\u8fd4\u56de302\u91cd\u5b9a\u5411\u72b6\u6001\u7801\u3002\u5c06\u9875\u9762\u91cd\u5b9a\u5411\u81f3 /acloudageks/webadmin/sso/login \u5e76\u4e14\u5bf9 app_url \u53c2\u6570\u8fdb\u884c\u4e86\u8d4b\u503c\uff0c /acloudageks/webadmin/sso/login \u5bf9\u5e94\u7684\u670d\u52a1\u4e5f\u6ca1\u6709\u627e\u5230\uff0c\u8be5\u8bf7\u6c42\u4e5f\u8fd4\u56de302\u72b6\u6001\u7801\uff0c\u5c06\u8bf7\u6c42\u91cd\u5b9a\u5411\u81f3 /acloudageks/sso/interactive-to-auth \uff08\u7531InteractiveToAuthServlet\u8fdb\u884c\u5904\u7406\uff09\u5e76\u4e14\u5bf9 redirect_uri \u3001 scope \u3001 reauthenticate \u53c2\u6570\u8fdb\u884c\u8d4b\u503c\uff0c\u7136\u540e\u8df3\u8f6c\u5230 /acloudageks/sso/login.html \u767b\u5165\u9875\u9762\u3002 \u6240\u4ee5\u4e09\u5458\u9009\u62e9\u5b9e\u9645\u4e0a\u662f\u5728\u540e\u53f0\u5bf9 redirect_uri \u3001 scope \u3001 reauthenticate \u548c app_url \u53c2\u6570\u8fdb\u884c\u8d4b\u503c\uff0c\u7136\u540e\u70b9\u51fb\u767b\u5165\u6309\u94ae\u624d\u662f\u6b63\u5219\u7684\u7528\u6237\u8ba4\u8bc1\u8fc7\u7a0b\u3002 \u7528\u6237\u7684\u8ba4\u8bc1\u4e5f\u5728 InteractiveToAuthServlet \u4e2d\uff08url\u4e3a /acloudageks/sso/interactive-to-auth \uff09\u8fdb\u884c\uff0c\u8ba4\u8bc1\u6210\u529f\u4ee5\u540e\u4f1a\u5c06\u8ba4\u8bc1\u4fe1\u606f\uff08\u5305\u62ecaccess_token\uff09\u50a8\u5b58\u5230request\u7684Session\u7684 ovirt-ssoSession \u57df\u6240\u6307\u5411\u7684SsoSession\u5bf9\u8c61\u4e2d\uff0c\u5e76SsoSession\u5bf9\u8c61\u6ce8\u518c\u5230\u8ba4\u8bc1\u4e2d\u5fc3\uff08 SsoContext \uff09\u3002\u7136\u540e\u5411\u524d\u53f0\u53d1\u8d77Redirect\u6307\u4ee4\uff08302\uff09\uff0c\u8bf7\u6c42\u5730\u5740\u4e3a /acloudageks/sso/interactive-to-app \uff0c\u8be5\u8bf7\u6c42\u5728 InteractiveToAppServlet \u4e2d\u8fdb\u884c\u5904\u7406\uff0c\u505a\u7684\u64cd\u4f5c\u53ea\u662f\u7b80\u5355\u7684\u5c06SsoSession\u5bf9\u8c61\u7684access_token\u5b57\u6bb5\u548capp_url\u5b57\u6bb5\u505a\u4e3aRedirect\u6307\u4ee4\uff08302\uff09\u7684\u53c2\u6570\uff0c\u91cd\u5b9a\u5411\u5230 /acloudagekswebadmin/sso/oauth2-callback \uff0c\u8be5\u8bf7\u6c42\u7531 SsoPostLoginServlet \u8fdb\u884c\u5904\u7406\uff0c\u4e3b\u8981\u662f\u5bf9access_token\u8fdb\u884c\u9a8c\u8bc1\uff0c\u5e76\u5c06\u4f1a\u8bdd\u5b58\u50a8\u5230\u6570\u636e\u5e93\uff0c\u6700\u540e\u8df3\u8f6c\u5230app_url\u6307\u5411\u7684\u5730\u5740\u3002\u6240\u4ee5\u767b\u5165\u8bf7\u6c42\u4e0d\u4f1a\u8fd4\u56detoken\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e source_mac String url/body \u5fc5\u8981\u53c2\u6570\uff0c\u8868mac\u5730\u5740\uff1f\uff0c\u9ed8\u8ba4\u4f20\u7684\u662f00:00:00:00:00:00 username String url/body \u5fc5\u8981\u53c2\u6570\uff0c\u4ee3\u8868\u767b\u5f55\u7528\u6237\u540d password String url/body \u5fc5\u8981\u53c2\u6570\uff0c\u4ee3\u8868\u7528\u6237\u5bc6\u7801 profile String url/body \u5fc5\u8981\u53c2\u6570\uff0c\u4ee3\u8868\u57df\u540d redirect_uri String url/body \u5fc5\u8981\u53c2\u6570\uff0c\u5fc5\u987b\u624b\u52a8\u6307\u5b9a ip:port/acloudageks/webadmin/sso/oauth2-callback \u5426\u5219\u65e0\u6cd5\u6b63\u786e\u8fdb\u5165SsoPostLoginServlet\u7684\u5904\u7406\u903b\u8f91\u5c06\u4f1a\u8bdd\u5b58\u50a8\u5230\u6570\u636e\u5e93\u3002 app_url String url/body \u5fc5\u8981\u53c2\u6570\uff1f\u4ee3\u8868\u8ba4\u8bc1\u5de5\u4f5c\u5b8c\u6210\u4ee5\u540e\u8981\u8df3\u8f6c\u7684\u9875\u9762\u3002 scope String url/body \u53ef\u9009\u53c2\u6570\uff1f\u610f\u4e49\u4e0d\u660e reauthenticate String url/body \u53ef\u9009\u53c2\u6570\uff1f\u8ba4\u8bc1\u5931\u8d25\u91cd\u8bd5\u6b21\u6570 dynamicKey String url/body \u53ef\u9009\u53c2\u6570\uff0c\u5f53\u5f00\u542f\u52a8\u6001\u53e3\u4ee4\u65f6\uff0c\u9700\u8981\u6307\u5b9a\u6b64\u53c2\u6570\u3002 \u8bf4\u660e\uff1a\u8fd9\u4e9b\u53c2\u6570\u65e2\u53ef\u4ee5\u5728url\u4f20\u9012\uff0c\u4e5f\u53ef\u4ee5\u5728body\u4f20\u9012\u3002\u5728body\u4f20\u9012\u65f6\u5fc5\u987b\u4ee5\u8868\u5355\uff08\u5373Content-Type\u4e3aapplication/x-www-form-urlencoded\uff09\u7684\u5f62\u5f0f\u8fdb\u884c\u3002\u8fd9\u4e9b\u53c2\u6570\u90fd\u662f\u4ee5\u660e\u6587\u7684\u65b9\u5f0f\u4f20\u9012\u7684\u3002 \u8bf7\u6c42\uff1a \u4efb\u4f55http\u8bf7\u6c42\u65b9\u6cd5\u90fd\u53ef\u4ee5 POST /acloudageks/sso/interactive-to-auth?source_mac=00:00:00:00:00:00&username=systemAdmin&password=abcd1234&profile=internal&redirect_uri=http://172.16.2.240:8080/acloudageks/webadmin/sso/oauth2-callback&scope=ovirt-app-admin ovirt-app-api&app_url=http://172.16.2.240:8080/acloudageks/webadmin/&reauthenticate=0 \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.0.2\u767b\u51fa \u767b\u51fa\u7684\u903b\u8f91\u662f\u4e00\u4e2a\u6e05\u9664Session\u52a0\u9875\u9762\u8df3\u8f6c\u7684\u8fc7\u7a0b\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a \u4efb\u4f55http\u8bf7\u6c42\u65b9\u6cd5\u90fd\u53ef\u4ee5 GET /acloudageks/webadmin/sso/logout \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.1\u865a\u62df\u673a\u4e3b\u673a\u8bbe\u5907 3.1.1\u6dfb\u52a0\u865a\u62df\u673a\u4e3b\u673a\u8bbe\u5907 \u6dfb\u52a0\u4e3b\u673a\u8bbe\u5907\u7684\u5230\u865a\u62df\u673a\u7684\u524d\u63d0\u662f\u5148\u628a\u865a\u62df\u673a\u56fa\u5b9a\u5230\u4e3b\u673a\u4e0a \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e id String body \u53ef\u9009\u5fc5\u8981\u53c2\u6570\uff0c\u6dfb\u52a0\u4e3b\u673a\u8bbe\u5907\u5230\u865a\u62df\u673a\u65f6\uff0c\u9700\u8981\u6307\u5b9a\u4e3b\u673a\u8bbe\u5907\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\uff0cid\u5b57\u6bb5\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8ename\u5b57\u6bb5\u3002 name String body \u53ef\u9009\u5fc5\u8981\u53c2\u6570\uff0c\u6dfb\u52a0\u4e3b\u673a\u8bbe\u5907\u5230\u865a\u62df\u673a\u65f6\uff0c\u9700\u8981\u6307\u5b9a\u4e3b\u673a\u8bbe\u5907\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\uff0cid\u5b57\u6bb5\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8ename\u5b57\u6bb5\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/hostdevices/ Body: { \"name\": \"pci_0000_00_07_1\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.1.2\u83b7\u5f97\u865a\u62df\u673a\u4e3b\u673a\u8bbe\u5907\u5217\u8868 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/hostdevices/ \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.1.3.\u83b7\u5f97\u865a\u62df\u673a\u6307\u5b9a\u7684\u4e3b\u673a\u8bbe\u5907 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/hostdevices/{hostdeviceId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.1.4.\u5220\u9664\u865a\u62df\u673a\u6307\u5b9a\u7684\u4e3b\u673a\u8bbe\u5907 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/vms/{vmid}/hostdevices/{hostdeviceId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.2.\u7f51\u7edc 3.2.1.\u83b7\u53d6\u7f51\u7edc \u8bf7\u6c42\uff1a GET /acloudageks/api/networks \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.2.2.\u83b7\u53d6\u6307\u5b9aid\u7684\u7f51\u7edc \u8bf7\u6c42\uff1a GET /acloudageks/api/networks/{network_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.2.3.\u6dfb\u52a0\u7f51\u7edc \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u7f51\u7edc\u540d\u5b57 dataCenter String body \u865a\u62df\u673a\u6240\u5728\u6570\u636e\u4e2d\u5fc3\uff0c\u9700\u8981\u6307\u5b9a\u540d\u5b57\u6216\u8005id ... ... body \u4e0e\u7f51\u7edc\u76f8\u5173\u7684\u6240\u6709\u5c5e\u6027 \u8bf7\u6c42\uff1a POST /acloudageks/api/networks Body: { \"name\": \"myTest\", \"description\": \"\u6d4b\u8bd5postman\", \"dataCenter\": { \"id\": \"5dc116ca-02db-01cb-014d-000000000343\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"NetworkModel [name, dataCenter.name|id] required for add\", \"reason\": \"Incomplete parameters\" } 3.2.4.\u5220\u9664\u7f51\u7edc \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/networks/{network_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.2.5.\u66f4\u65b0\u7f51\u7edc \u66f4\u65b0\u7f51\u7edc\u7684\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 network Network body \u8bf7\u6c42\uff1a PUT /acloudageks/api/networks/{network_id} Body: { \"description\": \"\u6d4b\u8bd5\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.2.6.\u83b7\u53d6\u7f51\u7edc\u7684vnic\u914d\u7f6e \u8bf7\u6c42\uff1a GET /acloudageks/api/networks/{network_id}/vnicprofiles \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.2.7.\u589e\u52a0\u7f51\u7edc\u7684vnic\u914d\u7f6e \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body vnicprofile\u914d\u7f6e\u6587\u4ef6\u540d\u5b57 `... ... body \u4e0evnicprofile\u76f8\u5173\u7684\u6240\u6709\u5c5e\u6027 \u8bf7\u6c42\uff1a POST /acloudageks/api/networks/{network_id}/vnicprofiles Body\uff1a { \"name\": \"test\", \"description\": \"\u589e\u52a0vnicprofile\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"VnicProfileModel [name] required for validateParameters\", \"reason\": \"Incomplete parameters\" } 3.2.8.\u66f4\u65b0\u7f51\u7edc\u7684vnic\u914d\u7f6e \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 networkFilter.id ID body \u53ef\u9009\uff0c\u7f51\u7edc\u8fc7\u6ee4\u5668 description String body \u63cf\u8ff0 ... VnicProfile body profile\u7684\u914d\u7f6e \u8bf7\u6c42\uff1a PUT /acloudageks/api/vnicprofiles/{vnicProfiles_id} Body\uff1a { \"description\": \"\u6d4b\u8bd5\u4fee\u6539vnicprofile\u63cf\u8ff0\", \"networkFilter\": { \"id\": \"5dc116cb-03ac-0143-0396-0000000003c1\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.2.9.\u5220\u9664\u7f51\u7edc\u7684vnic\u914d\u7f6e \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/networks/{network_id}/vnicprofiles/{vnicProfiles_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.2.10.\u67e5\u627e\u7f51\u7edc\u7684\u7f51\u7edc\u6807\u7b7e \u8bf7\u6c42\uff1a GET /acloudageks/api/networks/{network_id}/networklabels \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.2.11.\u6dfb\u52a0\u7f51\u7edc\u7684\u7f51\u7edc\u6807\u7b7e \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e id String body \u8bf7\u6c42\uff1a POST /acloudageks/api/networks/{network_id}/networklabels Body { \"id\": \"abb\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"NetworkLabelModel [id] required for add\", \"reason\": \"Incomplete parameters\" } 3.2.12.\u5220\u9664\u7f51\u7edc\u7684\u7f51\u7edc\u6807\u7b7e \u8bf7\u6c42\uff1a DELETE /acloudageks/api/networks/{network_id}/vnicprofiles/{vnicProfiles_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.2.13.\u83b7\u53d6\u4f7f\u7528\u8fd9\u4e2a\u7f51\u7edc\u7684\u865a\u62df\u673a\u4fe1\u606f \u8bf7\u6c42\uff1a GET /acloudageks/api/networks/{network_id}/getvmnetwork \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.3.\u5b58\u50a8 3.3.1.\u6dfb\u52a0\u5b58\u50a8\u57df \u521b\u5efa\u65b0\u7684StorageDomain\u9700\u8981\u540d\u79f0\uff0c\u7c7b\u578b\uff0c\u4e3b\u673a\u548c\u5b58\u50a8\u5c5e\u6027\u3002\u7528id\u6216name\u5c5e\u6027\u6807\u8bc6\u4e3b\u673a\u5c5e\u6027\u3002\u5728oVirt 3.6\u53ca\u66f4\u9ad8\u7248\u672c\u4e2d\uff0c\u60a8\u53ef\u4ee5\u9ed8\u8ba4\u5728\u5b58\u50a8\u57df\u4e0a\u542f\u7528\u201c\u5220\u9664\u540e\u64e6\u9664\u201d\u9009\u9879\u3002\u8981\u8fdb\u884c\u914d\u7f6e\uff0c\u8bf7\u5728POST\u8bf7\u6c42\u4e2d\u6307\u5b9awipe_after_delete\u3002\u521b\u5efa\u57df\u540e\u53ef\u4ee5\u7f16\u8f91\u6b64\u9009\u9879\uff0c\u4f46\u662f\u8fd9\u6837\u505a\u4e0d\u4f1a\u66f4\u6539\u5df2\u5b58\u5728\u7684\u78c1\u76d8\u7684delete after delete\u5c5e\u6027\u540e\u7684\u64e6\u9664\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body type String body \u57df\u7c7b\u578b\uff1aMASTER, DATA,ISO,IMPORTEXPORT,IMAGE,VOLUME host.name/host.id String body \u4e3b\u673a\u5c5e\u6027 storage.type String body \u5b58\u50a8\u7c7b\u578b\uff1aISCSI,FCP,NFS,LOCALFS,POSIXFS,GLANCE; storage.address String body \u57df\u7684ip storage.path String body \u57df\u7684\u5730\u5740 ... StorageDomain body StorageDomain\u7ed3\u6784\u4f53 \u8bf7\u6c42\uff1a\u6dfb\u52a0\u4e00\u4e2adata\u57df\u7684nfs\u5b58\u50a8 POST /acloudageks/api/storagedomains Body { \"name\": \"mydata\", \"type\": \"DATA\", \"storage\": { \"type\": \"NFS\", \"address\": \"mynfs.example.com\", \"path\": \"/exports/mydata\" }, \"host\": { \"name\": \"myhost\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"StorageDomainModel [host.id|name, type, storage] required for add\", \"reason\": \"Incomplete parameters\" } \u8bf7\u6c42\uff1a\u6dfb\u52a0\u4e00\u4e2aiso\u57df\u7684nfs\u5b58\u50a8 POST /acloudageks/api/storagedomains Body { \"name\": \"myisos\", \"type\": \"ISO\", \"storage\": { \"type\": \"NFS\", \"address\": \"mynfs.example.com\", \"path\": \"/export/myisos\" }, \"host\": { \"name\": \"myhost\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"StorageDomainModel [host.id|name, type, storage] required for add\", \"reason\": \"Incomplete parameters\" } \u8bf7\u6c42\uff1a\u6dfb\u52a0\u4e00\u4e2adata\u57df\u7684iscsi\u5b58\u50a8 POST /acloudageks/api/storagedomains Body { \"name\": \"myiscsi\", \"type\": \"DATA\", \"storage\": { \"type\": \"ISCSI\", \"logicalUnits\": { \"logicalUnits\": [ { \"id\": \"3600144f09dbd050000004eedbd340001\" }, { \"id\": \"3600144f09dbd050000004eedbd340002\" } ] } }, \"host\": { \"name\": \"myhost\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"StorageDomainModel [host.id|name, type, storage] required for add\", \"reason\": \"Incomplete parameters\" } 3.3.2.\u83b7\u53d6\u5b58\u50a8\u57df \u8bf7\u6c42\uff1a GET /acloudageks/api/storagedomains \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.3.3.\u6839\u636e\u5b58\u50a8\u57dfID\u83b7\u53d6\u5b58\u50a8\u57df\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e filter Boolean body \u6307\u793a\u662f\u5426\u5e94\u6839\u636e\u7528\u6237\u6743\u9650\u8fc7\u6ee4\u7ed3\u679c\u3002 \u8bf7\u6c42\uff1a GET /acloudageks/api/storagedomains/{storagedomainId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.3.4.\u5b58\u50a8\u9644\u52a0\u5230\u6570\u636e\u4e2d\u5fc3 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean In \u53ef\u9009\uff0c\u6307\u793a\u662f\u5426\u5e94\u5f02\u6b65\u6267\u884c\u64cd\u4f5c host.id/host.name Host In \u4e3b\u673a\u540d\u6216\u4e3b\u673aid \u8bf7\u6c42\uff1a POST /acloudageks/api/storagedomains/{storagedomainId}/isattached Body { \"host\":{ \"name\":\"172\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"ActionModel [host.id|name] required for isAttached\", \"reason\": \"Incomplete parameters\" } 3.3.5.\u5237\u65b0lun\u7684\u5927\u5c0f \u5728\u5b58\u50a8\u670d\u52a1\u5668\u4e0a\u589e\u52a0\u57fa\u7840LUN\u7684\u5927\u5c0f\u540e\uff0c\u7528\u6237\u53ef\u4ee5\u5237\u65b0LUN\u7684\u5927\u5c0f\u3002\u5982\u679c\u9700\u8981\uff0c\u6b64\u64cd\u4f5c\u5c06\u5f3a\u5236\u91cd\u65b0\u626b\u63cf\u63d0\u4f9b\u7684LUN\u5e76\u4f7f\u7528\u65b0\u5927\u5c0f\u66f4\u65b0\u6570\u636e\u5e93\u3002 \u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean In \u53ef\u9009\uff0c\u6307\u793a\u662f\u5426\u5e94\u5f02\u6b65\u6267\u884c\u64cd\u4f5c logicalUnits LogicalUnit In \u6307\u5b9a\u7684luns \u4f8b\u5982\uff0c\u4e3a\u4e86\u5237\u65b0\u4e24\u4e2aLUN\u7684\u5927\u5c0f\uff0c\u8bf7\u53d1\u9001\u5982\u4e0b\u8bf7\u6c42\uff1a POST /acloudageks/api/storagedomains/{storageDomainId}/refreshluns { \"logicalUnits\": { \"logicalUnits\": [ { \"id\": \"3600144f09dbd050000004eedbd340001\" }, { \"id\": \"3600144f09dbd050000004eedbd340002\" } ] } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a\u6ca1\u6709iscsi\u5b58\u50a8\u7c7b\u578b { \"detail\": \"[Cannot edit Storage. Storage Domain type is illegal.]\", \"reason\": \"Operation Failed\" } 3.3.6.\u5220\u9664\u5b58\u50a8\u57df \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u5e94\u5f02\u6b65\u6267\u884c\u64cd\u4f5c destroy Boolean url \u6307\u793a\u8be5\u64cd\u4f5c\u662f\u5426\u5e94\u8be5\u6210\u529f\uff0c\u5e76\u4e14\u5373\u4f7f\u65e0\u6cd5\u8bbf\u95ee\u5b58\u50a8\u4e5f\u4ece\u6570\u636e\u5e93\u4e2d\u5220\u9664\u4e86\u5b58\u50a8\u57df format Boolean url \u53ef\u9009\uff1a\u9ed8\u8ba4\u503c\u4e3afalse\u3002\u6307\u793a\u662f\u5426\u5e94\u683c\u5f0f\u5316\u5b9e\u9645\u5b58\u50a8\uff0c\u5e76\u4ece\u57fa\u7840LUN\u6216\u76ee\u5f55\u4e2d\u5220\u9664\u6240\u6709\u5143\u6570\u636e\uff1a[\u6e90\u4ee3\u7801] ----\u5220\u9664/ ovirt-engine / api / storagedomains / 123\uff1fformat = true host String url \u6307\u793a\u5e94\u4f7f\u7528\u54ea\u4e2a\u4e3b\u673a\u5220\u9664\u5b58\u50a8\u57df\u3002id/name \u8bf7\u6c42\uff1a DELETE /acloudageks/api/storagedomains/{storageDomainId}?host={hostName} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.3.7.\u4fee\u6539\u57df\u7684\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u6307\u793a\u662f\u5426\u5e94\u5f02\u6b65\u6267\u884c\u64cd\u4f5c name String body \u4fee\u6539\u540d\u79f0 ... StorageDomain body StorageDomain\u7684\u5c5e\u6027 \u8bf7\u6c42\uff1a PUT /acloudageks/api/storagedomains/{storageDomainId} Body { \"name\": \"test2\", \"description\":\"\u6d4b\u8bd5\u4fee\u6539\u57df\u7684\u63cf\u8ff0\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.3.8.\u83b7\u53d6\u4f7f\u7528\u6b64\u5b58\u50a8\u57df\u7684\u865a\u62df\u673a \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max integer body \u53ef\u9009\uff0c\u8bbe\u7f6e\u8981\u8fd4\u56de\u7684\u865a\u62df\u673a\u7684\u6700\u5927\u6570\u91cf\u3002 \u8bf7\u6c42\uff1a GET /acloudageks/api/storagedomains/{storageDomainId}/vms \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.3.9.\u83b7\u53d6\u4f7f\u7528\u6b64\u5b58\u50a8\u57df\u7684\u6a21\u7248 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max integer body \u53ef\u9009\uff0c\u8bbe\u7f6e\u8981\u8fd4\u56de\u7684\u6a21\u7248\u7684\u6700\u5927\u6570\u91cf\u3002 \u8bf7\u6c42\uff1a GET /acloudageks/api/storagedomains/{storageDomainId}/templates \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.3.10.\u6839\u636e\u865a\u62df\u673aid\u83b7\u53d6\u57df\u4e2d\u7684\u865a\u62df\u673a\u7684\u4fe1\u606f \u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max integer body \u53ef\u9009\uff0c\u8bbe\u7f6e\u8981\u8fd4\u56de\u7684\u865a\u62df\u673a\u7684\u6700\u5927\u6570\u91cf\u3002 \u8bf7\u6c42\uff1a GET /acloudageks/api/storagedomains/{storageDomainId}/vms/{vm_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.3.11.\u5bfc\u5165\u865a\u62df\u673a \u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u6307\u793a\u662f\u5426\u5e94\u5f02\u6b65\u6267\u884c\u64cd\u4f5c clone Boolean body \u53ef\u9009\uff0c\u6307\u793a\u662f\u5426\u5e94\u91cd\u65b0\u751f\u6210\u5bfc\u5165\u7684\u865a\u62df\u673a\u7684\u6807\u8bc6\u7b26\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5bfc\u5165\u865a\u62df\u673a\u65f6\u5c06\u4fdd\u7559\u6807\u8bc6\u7b26\u3002\u8fd9\u610f\u5473\u7740\u540c\u4e00\u865a\u62df\u673a\u4e0d\u80fd\u591a\u6b21\u5bfc\u5165\uff0c\u56e0\u4e3a\u6807\u8bc6\u7b26\u5fc5\u987b\u552f\u4e00\u3002\u8981\u5141\u8bb8\u591a\u6b21\u5bfc\u5165\u540c\u4e00\u53f0\u8ba1\u7b97\u673a\uff0c\u8bf7\u5c06\u6b64\u53c2\u6570\u8bbe\u7f6e\u4e3atrue\uff0c\u56e0\u4e3a\u9ed8\u8ba4\u503c\u4e3afalse\u3002 cluster Cluster body collapseSnapshots Boolean body \u53ef\u9009\uff0c\u6307\u793a\u5e94\u8be5\u6298\u53e0\u5bfc\u5165\u7684\u865a\u62df\u673a\u7684\u5feb\u7167\uff0c\u4ee5\u4f7f\u7ed3\u679c\u5c06\u662f\u6ca1\u6709\u5feb\u7167\u7684\u865a\u62df\u673a\u3002\u6b64\u53c2\u6570\u662f\u53ef\u9009\u7684\uff0c\u5982\u679c\u672a\u660e\u786e\u6307\u5b9a\uff0c\u5219\u9ed8\u8ba4\u503c\u4e3afalse\u3002 storageDomains StorageDomain body \u53ef\u9009 vm Vm body \u53ef\u9009 \u8bf7\u6c42\uff1a POST /acloudageks/api/storagedomains/{storageDomainId}/vms/{vm_id}/import Body { \"storageDomain\": { \"name\": \"mydata\" }, \"cluster\": { \"name\": \"mycluster\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"ActionModel [cluster.id|name, storageDomain.id|name] required for doImport\", \"reason\": \"Incomplete parameters\" } 3.3.12.\u5220\u9664\u57df\u4e2d\u7684\u865a\u62df\u673a \u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean In \u53ef\u9009\uff0c\u6307\u793a\u662f\u5426\u5e94\u5f02\u6b65\u6267\u884c\u64cd\u4f5c \u8bf7\u6c42\uff1a DELETE /acloudageks/api/storagedomains/{storageDomainId}/vms/{vm_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.3.13.\u6839\u636e\u6a21\u7248id\u83b7\u53d6\u57df\u4e2d\u7684\u6a21\u7248\u7684\u4fe1\u606f \u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max integer url \u53ef\u9009\uff0c\u8bbe\u7f6e\u8981\u8fd4\u56de\u7684\u865a\u62df\u673a\u7684\u6700\u5927\u6570\u91cf\u3002 \u8bf7\u6c42\uff1a GET /acloudageks/api/storagedomains/{storageDomainId}/vms/{vm_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.3.14.\u5bfc\u5165\u6a21\u7248 \u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u6307\u793a\u662f\u5426\u5e94\u5f02\u6b65\u6267\u884c\u64cd\u4f5c clone Boolean body \u53ef\u9009\uff0c\u6307\u793a\u662f\u5426\u5e94\u91cd\u65b0\u751f\u6210\u5bfc\u5165\u7684\u6a21\u7248\u7684\u6807\u8bc6\u7b26\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5bfc\u5165\u865a\u62df\u673a\u65f6\u5c06\u4fdd\u7559\u6807\u8bc6\u7b26\u3002\u8fd9\u610f\u5473\u7740\u540c\u4e00\u865a\u62df\u673a\u4e0d\u80fd\u591a\u6b21\u5bfc\u5165\uff0c\u56e0\u4e3a\u6807\u8bc6\u7b26\u5fc5\u987b\u552f\u4e00\u3002\u8981\u5141\u8bb8\u591a\u6b21\u5bfc\u5165\u540c\u4e00\u53f0\u8ba1\u7b97\u673a\uff0c\u8bf7\u5c06\u6b64\u53c2\u6570\u8bbe\u7f6e\u4e3atrue\uff0c\u56e0\u4e3a\u9ed8\u8ba4\u503c\u4e3afalse\u3002 cluster Cluster body exclusive Boolean body \u53ef\u9009 storageDomains StorageDomain body \u53ef\u9009 template vm Vm body \u53ef\u9009 \u8bf7\u6c42\uff1a POST /acloudageks/api/storagedomains/{storageDomainId}/templates/{templates_id}/import Body { \"storageDomain\": { \"name\": \"mydata\" }, \"cluster\": { \"name\": \"mycluster\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"ActionModel [cluster.id|name, storageDomain.id|name] required for doImport\", \"reason\": \"Incomplete parameters\" } 3.3.15.\u5220\u9664\u57df\u4e2d\u7684\u6a21\u7248 \u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u6307\u793a\u662f\u5426\u5e94\u5f02\u6b65\u6267\u884c\u64cd\u4f5c \u8bf7\u6c42\uff1a DELETE /acloudageks/api/storagedomains/{storageDomainId}/templates/{vm_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.3.16.\u83b7\u53d6\u57df\u4e2d\u7684\u78c1\u76d8\u5217\u8868 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max integer body \u53ef\u9009\uff0c\u8bbe\u7f6e\u8981\u8fd4\u56de\u7684\u6700\u5927\u6570\u91cf\u3002 \u8bf7\u6c42\uff1a GET /acloudageks/api/storagedomains/{storageDomainId}/disks \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.3.17.\u6839\u636e\u78c1\u76d8id\u5220\u9664\u57df\u4e2d\u7684\u67d0\u4e2a\u78c1\u76d8 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/storagedomains/{storageDomainId}/disks/{disk_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.3.18.\u83b7\u53d6\u78c1\u76d8\u5feb\u7167 \u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max integer body \u53ef\u9009\uff0c\u8bbe\u7f6e\u8981\u8fd4\u56de\u7684\u6700\u5927\u6570\u91cf\u3002 \u8bf7\u6c42\uff1a GET /acloudageks/api/storagedomains/{storageDomainId}/disksnapshots \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.3.19.\u5220\u9664\u78c1\u76d8\u5feb\u7167 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/storagedomains/{storageDomainId}/disksnapshots/{disksnapshots_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.3.20.\u6dfb\u52a0\u78c1\u76d8\u914d\u7f6e\u96c6 \u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body storageDomain.id String body \u5b58\u50a8\u57df\u7684id ... diskprofile body \u5176\u4ed6\u7684\u4e00\u4e9b\u5c5e\u6027 \u8bf7\u6c42\uff1a POST /acloudageks/api/storagedomains/{storageDomainId}/diskprofiles { \"name\": \"333\", \"storageDomain\": { \"id\": \"{{storageDomainId}}\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 { \"detail\": \"DiskProfile [name] required for validateParameters\", \"reason\": \"Incomplete parameters\" } 3.3.21.\u83b7\u53d6\u78c1\u76d8\u914d\u7f6e\u96c6 \u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max integer body \u53ef\u9009\uff0c\u8bbe\u7f6e\u8981\u8fd4\u56de\u7684\u6700\u5927\u6570\u91cf\u3002 \u8bf7\u6c42\uff1a GET /acloudageks/api/storagedomains/{storageDomainId}/diskprofiles \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.3.22.\u83b7\u53d6\u6307\u5b9a\u78c1\u76d8\u914d\u7f6e\u96c6\u7684\u4fe1\u606f \u8bf7\u6c42\uff1a GET /acloudageks/api/storagedomains/{{storageDomainId}}/diskprofiles/diskprofile_id \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.3.23.\u66f4\u65b0\u78c1\u76d8\u914d\u7f6e\u96c6\u5c5e\u6027 \u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body ... diskprofile body \u5176\u4ed6\u7684\u4e00\u4e9b\u5c5e\u6027 \u8bf7\u6c42\uff1a PUT /acloudageks/api/diskprofiles/diskprofiles_id Body { \"name\":\"3333\", \"description\":\"\u6d4b\u8bd5\u66f4\u65b0\u78c1\u76d8\u914d\u7f6e\u96c6\u63cf\u8ff0\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.3.24.\u5220\u9664\u78c1\u76d8\u914d\u7f6e\u96c6 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/storagedomains/{storageDomainId}/diskprofiles/{diskprofile_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.4.\u78c1\u76d8 3.4.1.\u83b7\u53d6\u6240\u6709\u78c1\u76d8\u4fe1\u606f \u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e case_sensitive Boolean url \u53ef\u9009\uff1b\u6307\u793a\u662f\u5426\u5e94\u8003\u8651\u5927\u5c0f\u5199\u6765\u6267\u884c\u4f7f\u7528\u641c\u7d22\u53c2\u6570\u6267\u884c\u7684\u641c\u7d22\u3002 max integer url \u53ef\u9009\uff1b\u8bbe\u7f6e\u8981\u8fd4\u56de\u7684\u6700\u5927\u78c1\u76d8\u6570\u3002 search String url \u67e5\u8be2\u5b57\u7b26\u4e32\uff0c\u7528\u4e8e\u9650\u5236\u8fd4\u56de\u7684\u78c1\u76d8\u3002 \u8bf7\u6c42\uff1a GET /acloudageks/api/disks \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.4.2.\u6dfb\u52a0\u78c1\u76d8 \u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body format DiskFormat body cow\uff0craw\uff0crow\uff1a\u201c\u5199\u65f6\u590d\u5236\u201d\u683c\u5f0f\u5141\u8bb8\u5feb\u7167\uff0c\u800c\u6027\u80fd\u5f00\u9500\u5f88\u5c0f\u3002raw\uff1a\u539f\u59cb\u683c\u5f0f\u4e0d\u5141\u8bb8\u4f7f\u7528\u5feb\u7167\uff0c\u4f46\u662f\u53ef\u4ee5\u63d0\u9ad8\u6027\u80fd\u3002 provisionedSize integer body \u78c1\u76d8\u7684\u865a\u62df\u5927\u5c0f\uff0c\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\u3002 .... Disk body \u5176\u4ed6\u7684disks\u5c5e\u6027 \u8bf7\u6c42\uff1a POST /acloudageks/api/disks Body { \"storageDomain\": { \"id\": \"{storageDomainId}\" }, \"name\": \"test_add_disk\", \"description\":\"test_add_disk\", \"provisionedSize\":1073741824, \"format\": \"COW\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"DiskModel [provisionedSize|size, format] required for add\", \"reason\": \"Incomplete parameters\" } 3.4.3.\u5220\u9664\u78c1\u76d8 \u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u6307\u793a\u662f\u5426\u5e94\u5f02\u6b65\u6267\u884c\u64cd\u4f5c \u8bf7\u6c42\uff1a DELETE /acloudageks/api/disks/{disk_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.4.4.\u590d\u5236\u78c1\u76d8 \u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u6307\u793a\u662f\u5426\u5e94\u5f02\u6b65\u6267\u884c\u590d\u5236\u3002 disk Disk body filter Boolean body \u6307\u793a\u662f\u5426\u5e94\u6839\u636e\u7528\u6237\u6743\u9650\u8fc7\u6ee4\u7ed3\u679c\u3002 storageDomain StorageDomain body \u5176\u4ed6\u7684disks\u5c5e\u6027 \u8bf7\u6c42\uff1a POST /acloudageks/api/disks/{disk_id}/copy Body { \"storageDomain\": { \"id\": \"{{storageDomainId}}\" }, \"disk\": { \"name\": \"mydisk\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"ActionModel [storageDomain.id|name] required for copy\", \"reason\": \"Incomplete parameters\" } 3.4.5.\u79fb\u52a8\u78c1\u76d8 \u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u6307\u793a\u662f\u5426\u5e94\u5f02\u6b65\u6267\u884c\u590d\u5236\u3002 filter Boolean body \u6307\u793a\u662f\u5426\u5e94\u6839\u636e\u7528\u6237\u6743\u9650\u8fc7\u6ee4\u7ed3\u679c\u3002 storageDomain StorageDomain body \u5176\u4ed6\u7684disks\u5c5e\u6027 \u8bf7\u6c42\uff1a POST /acloudageks/api/disks/{disk_id}/copy Body { \"storageDomain\": { \"id\": \"{{storageDomainId}}\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"ActionModel [storageDomain.id|name] required for move\", \"reason\": \"Incomplete parameters\" } 3.5.\u865a\u62df\u673a\u6c60 3.5.1 .\u6dfb\u52a0\u865a\u62df\u673a\u6c60 \u5f53\u6a21\u7248\u4e3a\u7cbe\u7b80\u5206\u914d\uff0c\u6a21\u7248\u7684\u78c1\u76d8\u4e3aRAW\u65f6\uff0c\u521b\u5efa\u865a\u62df\u673a\u6c60\u4f1a\u5931\u8d25\uff0c \u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body cluster.id String body \u96c6\u7fa4id template.id String body \u6a21\u7248id size integer body \u865a\u62df\u673a\u6570\u91cf maxUserVms integer body \u5176\u4ed6\u7684disks\u5c5e\u6027 prestartedVms integer body \u9884\u542f\u52a8\u7684\u865a\u62df\u673a\u6570\u91cf ...... VmPool body \u5176\u4f59\u7684VmPool\u7684\u5c5e\u6027 \u8bf7\u6c42\uff1a POST /acloudageks/api/vmpools Body { \"name\": \"test_add_pool\", \"size\": 2, \"maxUserVms\": 1, \"prestartedVms\": 0, \"cluster\": { \"id\": \"{{test_add_cluster_id}}\" }, \"template\": { \"id\": \"{{test_export_domain_template_id}}\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a \u5f53\u6a21\u7248\u4e3a\u7cbe\u7b80\u5206\u914d\uff0c\u6a21\u7248\u7684\u78c1\u76d8\u4e3aRAW\u65f6\uff0c\u521b\u5efa\u865a\u62df\u673a\u6c60\u4f1a\u5931\u8d25\uff0c\u8fd4\u56de\u7ed3\u679c\u4e3a\u4e0b \u8bf7\u6c42\u539f\u56e0\uff1a { \"detail\": \"[Cannot create VM-Pool. Thin provisioned template disks can not be defined as Raw.]\", \"reason\": \"Operation Failed\" } \u5f53\u78c1\u76d8\u4e3aQCOW2\u65f6\uff0c\u6210\u529f 3.5.2.\u83b7\u53d6\u865a\u62df\u673a\u6c60 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e case_sensitive Boolean url \u6307\u793a\u662f\u5426\u5e94\u8be5\u8003\u8651\u5927\u5c0f\u5199\u6765\u6267\u884c\u4f7f\u7528\u641c\u7d22\u53c2\u6570\u6267\u884c\u7684\u641c\u7d22 filter Boolean url \u6307\u793a\u662f\u5426\u5e94\u6839\u636e\u7528\u6237\u6743\u9650\u8fc7\u6ee4\u7ed3\u679c\u3002 max Integer url \u8bbe\u7f6e\u8981\u8fd4\u56de\u7684\u6700\u5927\u6c60\u6570\u3002 search String url \u67e5\u8be2\u5b57\u7b26\u4e32\uff0c\u7528\u4e8e\u9650\u5236\u8fd4\u56de\u7684\u6c60 \u8bf7\u6c42\uff1a GET /acloudageks/api/vmpools \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.5.3.\u83b7\u53d6\u6307\u5b9a\u7684\u865a\u62df\u673a\u6c60\u7684\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e filter Boolean url \u6307\u793a\u662f\u5426\u5e94\u6839\u636e\u7528\u6237\u6743\u9650\u8fc7\u6ee4\u7ed3\u679c\u3002 \u8bf7\u6c42\uff1a GET /acloudageks/api/vmpools/{vm_pool_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.5.4.\u66f4\u65b0\u865a\u62df\u673a\u6c60\u7684\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e description String body \u63cf\u8ff0 size integer body \u589e\u52a0\u7684\u865a\u62df\u673a\u6570\u91cf maxUserVms integer body \u5176\u4ed6\u7684disks\u5c5e\u6027 prestartedVms integer body \u9884\u542f\u52a8\u7684\u865a\u62df\u673a\u6570\u91cf ...... VmPool body \u5176\u4f59\u7684VmPool\u7684\u5c5e\u6027 \u8bf7\u6c42\uff1a POST /acloudageks/api/vmpools/{vm_pool_id} Body \uff5b \"description\": \"update vm pool\" \uff5d \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.5.5 .\u5220\u9664\u865a\u62df\u673a\u6c60 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean url \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42 DELETE /acloudageks/api/vmpools/{vm_pool_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.6.\u7cfb\u7edf\u65e5\u5fd7 3.6.1.\u83b7\u5f97\u65e5\u5fd7 \u53ea\u5b9a\u4e49\u4e86\u63a5\u53e3\uff0c\u5b9e\u73b0\u4e3a\u7a7a \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/logs \u8bf7\u6c42\u7ed3\u679c\uff1a\u672a\u5b9e\u73b0\u7684\u63a5\u53e3 3.6.2.\u83b7\u5f97\u6307\u5b9a\u7684\u65e5\u5fd7 \u53ea\u5b9a\u4e49\u4e86\u63a5\u53e3\uff0c\u5b9e\u73b0\u4e3a\u7a7a \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/logs/{logId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u672a\u5b9e\u73b0\u7684\u63a5\u53e3 3.6.3.\u5220\u9664\u6307\u5b9a\u65e5\u5fd7 \u53ea\u5b9a\u4e49\u4e86\u63a5\u53e3\uff0c\u5b9e\u73b0\u4e3a\u7a7a \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/logs/{logId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u672a\u5b9e\u73b0\u7684\u63a5\u53e3 3.6.4.\u5bfc\u51fa\u65e5\u5fd7 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/logs/export \u8bf7\u6c42\u7ed3\u679c\uff1a \u63a5\u53e3\u4e0d\u6b63\u786e\uff0c\u65e0\u6cd5\u4e0b\u8f7d\u6587\u4ef6\uff0c\u8fd4\u56de\u7684\u5185\u5bb9\u5982\u4e0b\uff1a file/log_file_75117da0-6b10-4377-92dc-85138ae49a1a.csv 3.6.5.\u83b7\u53d6\u6240\u6709\u8b66\u544a\u65e5\u5fd7 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e page=1&username=systemAdmin%40internal&start=0&limit=20 \u539f\u751f\u53c2\u6570 body \u67e5\u8be2\u6761\u4ef6 \u8bf7\u6c42\uff1a POST /acloudageks/api/logs/notifications Body limit=1 \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f \u5efa\u8bae\uff1a\u8bf7\u6c42\u53c2\u6570\u7684\u683c\u5f0f\u53ef\u80fd\u4e0d\u592a\u5408\u9002\uff0c\u5efa\u8bae\u6539\u4e3aurl\u5f62\u5f0f\uff0c\u6216\u8005\u4ee5model\u7684\u5f62\u5f0f\u8fdb\u884c\u4f20\u9012\u3002 3.6.6.\u6309\u6761\u4ef6\u67e5\u8be2\u65e5\u5fd7 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e moduleType=&sendIP=&riskLevel=&behaviourType=... \u539f\u751f\u53c2\u6570 body \u67e5\u8be2\u6761\u4ef6 \u8bf7\u6c42\uff1a POST /acloudageks/api/logs/getByConditions Body limit=1 \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f \u5efa\u8bae\uff1a\u8bf7\u6c42\u53c2\u6570\u7684\u683c\u5f0f\u53ef\u80fd\u4e0d\u592a\u5408\u9002\uff0c\u5efa\u8bae\u6539\u4e3aurl\u5f62\u5f0f\uff0c\u6216\u8005\u4ee5model\u7684\u5f62\u5f0f\u8fdb\u884c\u4f20\u9012\u3002 3.6.6.\u83b7\u5f97\u6240\u6709\u7684\u65e5\u5fd7 \u7531\u4e8e\u6e05\u7a7a\u65e5\u5fd7\u7684\u64cd\u4f5c\u662f\u4e00\u4e2a\u4f2a\u5220\u9664\u64cd\u4f5c\uff0c\u6240\u4ee5\u9700\u8981\u8fc7\u6ee4\u72b6\u6001\u7684\u4e3adeleted\u7684\u65e5\u5fd7\uff0c\u4f46\u662f\u6b64\u63a5\u53e3\u6ca1\u6709\u8fdb\u884c\u8fc7\u6ee4\uff0c\u9700\u8981\u4fee\u6539\u8be5\u63a5\u53e3\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/logs/getAll \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f 3.6.7.\u6e05\u7a7a\u65e5\u5fd7 \u8fd9\u662f\u4e00\u4e2a\u4f2a\u5220\u9664\u64cd\u4f5c\uff0c\u53ea\u662f\u5c06\u65e5\u5fd7\u7684\u72b6\u6001\u8bbe\u7f6e\u4e3adeleted\uff0c\u5b9e\u9645\u4e0a\u5e76\u6ca1\u6709\u5220\u9664\u65e5\u5fd7\u3002\u5e76\u4e14\u5220\u9664\u7684\u65e5\u5fd7\u4e0e\u767b\u5165\u7684\u89d2\u8272\u76f8\u5173\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a POST /acloudageks/api/logs/clear \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f \u8bf4\u660e\uff1a\u8fd4\u56de\u7684\u7ed3\u679c\u7684\u5f62\u5f0f\u4e0e\u5176\u4ed6\u63a5\u53e3\u4e0d\u7edf\u4e00 3.6.8.\u83b7\u5f97kvm\u65e5\u5fd7 \u53ea\u5b9a\u4e49\u4e86\u63a5\u53e3\uff0c\u5b9e\u73b0\u4e3a\u7a7a \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/logs/getKvmLog \u8bf7\u6c42\u7ed3\u679c\uff1a\u672a\u5b9e\u73b0\u7684\u63a5\u53e3 3.6.8.\u83b7\u5f97Root\u65e5\u5fd7 \u53ea\u5b9a\u4e49\u4e86\u63a5\u53e3\uff0c\u5b9e\u73b0\u4e3a\u7a7a \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/logs/getRootLog \u8bf7\u6c42\u7ed3\u679c\uff1a\u672a\u5b9e\u73b0\u7684\u63a5\u53e3","title":"[OvirtEngine]RestApi\u6574\u7406"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#engine","text":"EngineApi\u63a5\u53e3\u7684\u6839\u8def\u5f84\u4e3a IP:PORT/acloudageks/api","title":"Engine\u63a5\u53e3\u6574\u7406"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#1","text":"","title":"1.\u670d\u52a1\u63a5\u53e3"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#11","text":"","title":"1.1.\u865a\u62df\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#111","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e clone Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u65b0\u5efa\u7684\u865a\u62df\u673a\u662f\u5426\u72ec\u7acb\u4e8e\u6a21\u677f\u3002\u4ece\u6a21\u677f\u521b\u5efa\u865a\u62df\u673a\u65f6\uff0c\u865a\u62df\u673a\u7684\u78c1\u76d8\u53d6\u51b3\u4e8e\u6a21\u677f\u7684\u78c1\u76d8\uff0c\u5b83\u4eec\u4f7f\u7528\u5199\u65f6\u590d\u5236\u673a\u5236\uff0c\u56e0\u6b64\u53ea\u6709\u4e0e\u6a21\u677f\u4e4b\u95f4\u7684\u5dee\u5f02\u624d\u5360\u7528\u5b9e\u9645\u5b58\u50a8\u7a7a\u95f4\u3002 \u5982\u679c\u6307\u5b9a\u4e86\u6b64\u53c2\u6570\u4e14\u503c\u4e3atrue\uff0c\u5219\u5c06\u514b\u9686\u521b\u5efa\u7684\u865a\u62df\u673a\u7684\u78c1\u76d8\uff0c\u5e76\u4e14\u4e0e\u6a21\u677f\u65e0\u5173\u3002 clone_permissions Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u6a21\u677f\u6743\u9650\u662f\u5426\u590d\u5236\u5230\u65b0\u5efa\u7684\u865a\u62df\u673a name String body \u5fc5\u8981\u53c2\u6570\uff0c\u865a\u62df\u673a\u540d cluster ClusterModel body \u5fc5\u8981\u53c2\u6570\uff0c\u6307\u5b9a\u865a\u62df\u673a\u6240\u5c5e\u7684\u96c6\u7fa4\uff0c\u9700\u8981\u6307\u5b9a\u96c6\u7fa4\u7684id\u6216\u8005name\u5b57\u6bb5 template TemplateModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u901a\u8fc7\u6a21\u677f\u521b\u5efa\u865a\u62df\u673a\u65f6\u9009\u62e9\u7684\u865a\u62df\u673a\u6a21\u677f\uff0c\u9700\u8981\u6307\u5b9aid\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\u3002 snapshots Snapshots body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u901a\u8fc7\u5feb\u7167\u521b\u5efa\u865a\u62df\u673a\u65f6\uff0c\u6307\u5b9a\u7684\u865a\u62df\u673a\u5feb\u7167\u3002Snapshots\u662fSnapshot\u96c6\u5408\u7684\u6620\u5c04\uff0c\u53ea\u6301\u6709\u4e00\u4e2asnapshots\u5b57\u6bb5\u662fSnapshot\u96c6\u5408\u7684\u5f15\u7528\uff0c\u53ea\u9700\u8981\u6307\u5b9aSnapshot\u5bf9\u8c61\u7684id\u5b57\u6bb5\u3002Snapshot\u96c6\u5408\u4e2d\u53ea\u8981\u4e00\u4e2aSnapshot\u5bf9\u8c61\u5373\u53ef\uff0c\u5373\u4f7f\u4f20\u5165\u591a\u4e2a\u4e5f\u53ea\u4f1a\u4f7f\u7528\u7b2c\u4e00Snapshot\u5bf9\u8c61\u3002 initialization InitializationModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u51e0\u4e2a\u65b9\u9762\uff1a1.\u901a\u8fc7\u914d\u7f6e\u521b\u5efa\u865a\u62df\u673a\u65f6\uff0c\u6307\u5b9a\u914d\u7f6e\u7684\u5185\u5bb9\u3002\u9700\u8981\u6307\u5b9aInitializationModel\u7684configuration\u5b57\u6bb5\uff0cconfiguration\u5b57\u6bb5\u662fConfigurationModel\u7684\u5f15\u7528\uff0c\u5b83\u75312\u4e2a\u5b57\u6bb5\u7ec4\u6210\uff1atype\u5b57\u6bb5\u4ee3\u8868\u914d\u7f6e\u7684\u7c7b\u578b\uff0c\u53ea\u6709\u552f\u4e00\u7684\u503cOVF\uff1bdata\u5b57\u6bb5\u4ee3\u8868\u914d\u7f6e\u7684\u5185\u5bb9\uff0c\u5373\u865a\u62df\u673a\u7684xml\u4fe1\u606f\u3002\u53e6\u5916\u53ef\u4ee5\u6307\u5b9aInitializationModel\u7684regenerateIds\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u4e3a\u521b\u5efa\u7684\u865a\u62df\u673a\u751f\u6210\u65b0\u7684id\u30022.\u865a\u62df\u673a\u521d\u59cb\u5316\u76f8\u5173\u7684\u5185\u5bb9\uff0c\u8fd9\u4e00\u90e8\u5206\u5185\u5bb9\u592a\u591a\u4e86\uff0c\u6682\u65f6\u5148\u4e0d\u5c55\u5f00\u3002 memory Long body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u7684\u5185\u5b58\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3ab\u3002\u5f53\u8be5\u503c\u4e3a\u7a7a\u6216\u8005\u4e3a0\u65f6\uff0c\u4f7f\u7528\u9ed8\u8ba4\u5927\u5c0f10240MB\u53731G\u3002 NumOfIoThreads Integer body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u7684IO\u7ebf\u7a0b\u6570\u91cf description String body \u53ef\u9009\u53c2\u6570\uff0c\u865a\u62df\u673a\u63cf\u8ff0 cpu CpuModel body \u53ef\u9009\u53c2\u6570\uff0cCpuModel\u6709\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\uff1a1.topology\u5b57\u6bb5\u662fCpuTopologyModel\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u4e86cpu\u7684\u62d3\u6251\u7ed3\u6784\u3002CpuTopologyModel\u7684\u51e0\u4e2a\u5b57\u6bb5\uff1acores\u5b57\u6bb5\u4ee3\u8868\u4e86\u6bcf\u4e2a\u865a\u62df\u673a\u63d2\u69fd\u7684\u5185\u6838\u6570\uff1bsockets\u5b57\u6bb5\u4ee3\u8868\u4e86\u865a\u62df\u673acpu\u63d2\u69fd\u6570\u91cf\uff1bthreads\u5b57\u6bb5\u4ee3\u8868\u6bcf\u4e2a\u5185\u6838\u7684cpu\u5185\u6838\u7684\u7ebf\u7a0b\u6570\u91cf\uff0c\u53ef\u9009\u503c\u53ea\u67091\u548c2\u30022.architecture\u5b57\u6bb5\uff0c\u4ee3\u8868\u96c6\u7fa4cpu\u67b6\u6784\u3002\u53ef\u9009\u7684cpu\u67b6\u6784\u6709x86_64\u548cppc64\u30023.mode\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673acpu\u6a21\u5f0f\uff0c\u53ef\u9009\u503c\u6709CUSTOM\u3001HOST_MODEL\u3001HOST_PASSTHROUGH\u3002mode\u5b57\u6bb5\u4e3aHOST_PASSTHROUGH\u65f6\uff0c\u8868\u793a\u542f\u7528PASSTHROUGH\u4e3b\u673aCPU\u30024.cpuTune\u5b57\u6bb5\uff0c\u4ee3\u8868cpu\u56fa\u5b9a\u62d3\u6251\u7ed3\u6784\u53c2\u6570\uff0c\u662fCpuTuneModel\u5bf9\u8c61\u7684\u5f15\u7528\u3002CpuTuneModel\u53ea\u6301\u6709vcpuPins\u5b57\u6bb5\uff0c\u662fVcpuPins\u5bf9\u8c61\u7684\u5f15\u7528\u3002VcpuPins\u5bf9\u8c61\u662fVcpuPin\u96c6\u5408\u7684\u6620\u5c04\uff0c\u5176vcpuPins\u5b57\u6bb5\u662fVcpuPin\u5bf9\u8c61\u5217\u8868\u7684\u5f15\u7528\u3002VcpuPin\u6709\u4ee5\u4e0b2\u4e2a\u5b57\u6bb5\uff1acpuSet\u5b57\u6bb5\uff0c\u4e3aString\u683c\u5f0f\uff0c\u4f5c\u7528\u672a\u77e5\uff1bvcpu\u5b57\u6bb5\uff0c\u4e3aInteger\u683c\u5f0f\uff0c\u4f5c\u7528\u672a\u77e5\u3002 highAvailability HighAvailabilityModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u9ad8\u53ef\u7528\u76f8\u5173\u7684\u914d\u7f6e\uff0c\u5176\u4e2denabled\u5b57\u6bb5\u8868\u793a\u662f\u5426\u5f00\u542f\u865a\u62df\u673a\u9ad8\u53ef\u7528\uff1bpriority\u5b57\u6bb5\u8868\u793a\u865a\u62df\u673a\u8fc1\u79fb\u7684\u4f18\u5148\u7ea7\uff0c\u4e3aInterge\u7c7b\u578b\u3002 display DisplayModel body \u53ef\u9009\u53c2\u6570\uff0cDisplayModel\u4ee3\u8868\u865a\u62df\u673a\u7684\u663e\u793a\u6a21\u578b\uff0c\u6709\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\uff1a1.type\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u4f7f\u7528\u7684\u56fe\u5f62\u534f\u8bae\uff0c\u53ef\u9009\u7684\u56fe\u5f62\u534f\u8bae\u9009\u9879\u6709VNC\u548cSPICE\uff0c\u5f53\u8bbe\u7f6e\u4e86\u8be5\u5b57\u6bb5\u865a\u62df\u7684\u89c6\u9891\u7c7b\u578b\uff08defaultDisplayType\uff09\u4f1a\u88ab\u7f6e\u4e3a\u7a7a\uff0c\u7531\u540e\u53f0\u51b3\u5b9a\u30022.monitors\u5b57\u6bb5\uff0c\u4ee3\u8868\u76d1\u89c6\u5668\u6570\u91cf\u30023.singleQxlPci\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u4e3a\u5355\u4e2aPCI\u63a5\u53e3\u30024.smartcardEnabled\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u542f\u7528\u667a\u80fd\u5361\u30025.allowOverride\u5b57\u6bb5\uff0c\u4ee3\u8868\u662f\u5426\u5141\u8bb8\u63a7\u5236\u53f0\u91cd\u8fde\uff08\u4e0d\u77e5\u9053\u5565\u610f\u601d\uff09\u3002\u5728\u754c\u9762\u4e2d\u6ca1\u6709\u5bf9\u5e94\u7684\u9009\u9879\uff0c\u4e0e\u865a\u62df\u673a\u662f\u670d\u52a1\u5668\u8fd8\u662f\u684c\u9762\u76f8\u5173\uff0c\u5f53\u865a\u62df\u673a\u4e3a\u670d\u52a1\u5668\u65f6\u8be5\u4f1a\u88ab\u8bbe\u4e3atrue\u30026.keyboardLayout\u5b57\u6bb5\uff0c\u4ee3\u8868vnc\u952e\u76d8\u5e03\u5c40\uff08\u4f5c\u7528\u672a\u77e5\uff09\uff0c\u5728\u754c\u9762\u4e2d\u8be5\u9009\u9879\u88ab\u9690\u85cf\uff0c\u53ef\u9009\u5185\u5bb9\u89c1 vdc_options \u8868\u7684 VncKeyboardLayoutValidValues \u9009\u9879\u30027.fileTransferEnabled\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u542f\u7528SPICE\u6587\u4ef6\u8f6c\u6362\uff08\u4f5c\u7528\u672a\u77e5\uff09\uff0c\u5728\u754c\u9762\u4e2d\u8be5\u9009\u9879\u88ab\u9690\u85cf\u30028.copyPasteEnabled\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u542f\u7528SPICE\u526a\u8d34\u677f\u590d\u5236\u548c\u7c98\u8d34\uff08\u4f5c\u7528\u672a\u77e5\uff09\uff0c\u5728\u754c\u9762\u4e2d\u8be5\u9009\u9879\u88ab\u9690\u85cf\u30029.disconnectAction\u5b57\u6bb5\uff0c\u4ee3\u8868\u63a7\u5236\u53f0\u8fde\u63a5\u4e2d\u65ad\u4ee5\u540e\u865a\u62df\u673a\u7684\u884c\u4e3a\uff0c\u53ef\u9009\u503c\u6709\uff1aNONE\uff08\u65e0\u64cd\u4f5c\uff09\u3001LOCK_SCREEN\uff08\u9501\u5b9a\u5c4f\u5e55\uff09\u3001LOGOUT\uff08\u7528\u6237\u767b\u51fa\uff09\u3001REBOOT\uff08\u91cd\u542f\u865a\u62df\u673a\uff09\u3001SHUTDOWN\uff08\u5173\u95ed\u865a\u62df\u673a\uff09\u3002 migrationDowntime Integer body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u81ea\u5b9a\u4e49\u7684\u8fc1\u79fb\u4e0b\u7ebf\u65f6\u95f4\uff0c\u4e3aInterge\u7c7b\u578b\u3002 migration MigrationOptionsModel body \u53ef\u9009\u53c2\u6570\uff0cMigrationOptionsModel\u7684\u51e0\u4e2a\u5c5e\u6027\u6620\u5c04\u4e86\u96c6\u7fa4\u865a\u62df\u673a\u8fc1\u79fb\u7b56\u7565\u76843\u4e2a\u65b9\u9762\u30021. policy \u5b57\u6bb5\u662fMigrationPolicyModel\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u96c6\u7fa4\u7684\u8fc1\u79fb\u7b56\u7565\uff0c\u96c6\u7fa4\u53ef\u9009\u7684\u8fc1\u79fb\u7b56\u7565\u4e00\u5171\u67093\u79cd\uff1aLegacy\uff08id\u4e3a00000000-0000-0000-0000-000000000000\uff09\u3001Minimal downtime\uff08id\u4e3a80554327-0569-496b-bdeb-fcbbf52b827b\uff09\u548cSuspend workload if needed\uff08id\u4e3a80554327-0569-496b-bdeb-fcbbf52b827c\uff09\uff0c\u5176\u4e2dLegacy\u53ea\u8bbe\u7f6e\u4e86\u6700\u5927\u7684\u8fc1\u79fb\u6570\u91cf\u4e3a2\uff0c\u800c\u53e6\u59162\u79cd\u9009\u9879\u7684\u8be6\u7ec6\u914d\u7f6e\u89c1 vdc_optins \u8868\u7684 MigrationPolicies \u9009\u9879\uff0c\u8fc1\u79fb\u7b56\u7565\u9700\u8981\u8bbe\u7f6eMigrationPolicyModel\u5bf9\u8c61\u7684id\u5b57\u6bb5\uff0c\u9ed8\u8ba4\u503c\u4e3anull\uff1b2. autoConverge \u5b57\u6bb5\u548c compressed \u5b57\u6bb5\uff0c\u5206\u522b\u8868\u793a\u662f\u5426\u81ea\u52a8\u805a\u5408\u8fc1\u79fb\u4ee5\u53ca\u662f\u5426\u542f\u7528\u8fc1\u79fb\u538b\u7f29\u3002\u53ea\u6709\u5728\u8fc1\u79fb\u7b56\u7565\u4e3a Legacy \u65f6\uff0c\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u5728\u865a\u62df\u673a\u8fc1\u79fb\u8fc7\u7a0b\u4e2d\u624d\u4f1a\u751f\u6548\uff0c\u5b83\u4eec\u7684\u53ef\u9009\u503c\u6709\u4e09\u79cd\uff1aTRUE\u3001FALSE\u3001INHERIT\uff08\u8868\u793a\u4ece\u5168\u5c40\u8bbe\u7f6e\u7ee7\u627f\uff09\uff0c\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u4e3anull\u3002 customCpuModel String body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7684cpu\u7c7b\u578b\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u865a\u62df\u673acpu\u7c7b\u578b\uff0c\u5fc5\u987b\u4e0e\u865a\u62df\u673a\u6240\u5728\u96c6\u7fa4\u7684cpu\u7c7b\u578b\u4e3a\u540c\u4e00\u4ea7\u5546\uff0c\u4e14\u4ee3\u6570\u5fc5\u987b\u7b49\u4e8e\u6216\u4f4e\u4e8e\u96c6\u7fa4cpu\u7c7b\u578b\u3002 customEmulatedMachine String body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7684\u4eff\u771f\u673a\u3002 memoryPolicy MemoryPolicyModel body \u53ef\u9009\u53c2\u6570\uff0cMemoryPolicyModel\u5bf9\u8c61\u4ee3\u8868\u865a\u62df\u673a\u7684\u5185\u5b58\u7b56\u7565\uff0c\u5176guaranteed\u5b57\u6bb5\u4ee3\u8868\u865a\u62df\u673a\u4fdd\u8bc1\u7684\u7269\u7406\u5185\u5b58\uff0c\u5355\u4f4d\u4e3ab\u3002 os OperatingSystemModel body \u53ef\u9009\u53c2\u6570\uff0cOperatingSystemModel\u5bf9\u8c61\u4ee3\u8868\u4e0e\u7cfb\u7edf\u5f15\u5bfc\u6709\u5173\u7684\u53c2\u6570\u3002\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\u4f1a\u5f71\u54cd\u6a21\u677f\u7684\u521b\u5efa\uff1a1.boot\u5b57\u6bb5\u662fBootModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u5f15\u5bfc\u8bbe\u5907\u5e8f\u5217\u3002BootModel\u53ea\u6301\u6709devices\u5b57\u6bb5\uff0c\u662fBootDeviceValues\u5bf9\u8c61\u7684\u5f15\u7528\u3002BootDeviceValues\u5bf9\u8c61\u662fBootDevice\u7684\u96c6\u5408\u6620\u5c04\uff0c\u53ea\u6301\u6709BootDevice\u96c6\u5408\u7684\u5f15\u7528bootDevice\u5b57\u6bb5\u3002BootDevice\u4ee3\u8868\u865a\u62df\u673a\u7684\u5f15\u5bfc\u8bbe\u5907\u5e8f\u5217\uff0c\u53ef\u9009\u503c\u6709\uff1aCDROM\uff08\u5149\u9a71\uff09\u3001HD\uff08\u786c\u76d8\uff09\u548cNETWORK\uff08\u7f51\u7edc\uff09\u3002\u5217\u8868\u4e2dBootDevice\u5404\u4e2a\u503c\u7684\u6392\u5217\u987a\u5e8f\uff0c\u4ee3\u8868\u865a\u62df\u673a\u5f15\u5bfc\u8bbe\u5907\u987a\u5e8f\uff0c\u5982\u679c\u51fa\u73b0\u91cd\u590d\u7684\u503c\uff0c\u4f1a\u5148\u53bb\u91cd\u30022.type\u5b57\u6bb5\uff0c\u4ee3\u8868\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\uff0c\u4f8b\u5982other_linux\uff0cwindows_7x64\u7b49\uff0c\u53ef\u9009\u503c\u53c2\u8003 share/ovirt-engine/conf/osinfo-defaults.properties \u6587\u4ef6\u4e2d\u7684\u914d\u7f6e\u30023.kernel\u5b57\u6bb5\uff0c\u4ee3\u8868Linux\u5f15\u5bfc\u9009\u9879\u4e2d\u7684\u5185\u6838\u8def\u5f84\uff0c\u56e0\u6b64\u53ea\u6709\u5728\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u662flinux\u65f6\u624d\u4f1a\u751f\u6548\uff0c\u8be5\u5b57\u6bb5\u586b\u5199\u7684\u662flinux\u5185\u6838\u5728iso\u57df\u7684\u8def\u5f84\u30024.initrd\u5b57\u6bb5\uff0c\u4ee3\u8868Linux\u5f15\u5bfc\u9009\u9879\u4e2d\u7684initrd\u8def\u5f84\uff0c\u56e0\u6b64\u53ea\u6709\u5728\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u662flinux\u65f6\u624d\u4f1a\u751f\u6548\uff0c\u8be5\u5b57\u6bb5\u586b\u5199\u7684\u662finitrd\u5728iso\u57df\u7684\u8def\u5f84\u30025.cmdline\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u81ea\u5b9a\u4e49\u7684\u5185\u6838\u53c2\u6570\uff0c\u683c\u5f0f\u76ee\u524d\u4e0d\u77e5\u9053\u3002 bootMenuEnabled Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u542f\u7528\u5f15\u5bfc\u83dc\u5355\u3002 timeZone TimeZoneModel body \u53ef\u9009\u53c2\u6570\uff0cTimeZoneModel\u5bf9\u8c61\u4ee3\u8868\u4e86\u865a\u62df\u673a\u7684\u65f6\u533a\u8bbe\u7f6e\u3002\u5176name\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u65f6\u533a\uff0c\u53ef\u9009\u503c\u8be6\u89c1 TimeZoneType \u679a\u4e3e\u7c7b\u7684 initializeTimeZoneList \u65b9\u6cd5\u8fd4\u56de\u7684map\u7684key\u503c\u3002 origin String body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u6765\u6e90\uff08\u4e0d\u4f1a\u624b\u52a8\u8bbe\u7f6e\u5427\uff1f\uff09\uff0c\u53ef\u9009\u503c\u6709VMWARE\u3001XEN\u3001OVIRT\u3001EXTERNAL\u3001KVM\u3002 stateless Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u662f\u5426\u4e3a\u65e0\u72b6\u6001\u3002 deleteProtected Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u662f\u5426\u542f\u7528\u5220\u9664\u4fdd\u62a4\u3002 ssoEnabled Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u662f\u5426\u542f\u7528\u5355\u70b9\u767b\u5165\uff08\u5373\u662f\u5426\u4f7f\u7528GuestAgent\uff09\u3002 type String body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7c7b\u578b\uff0c\u53ef\u9009\u503c\u6709\uff1aDESKTOP\uff08\u684c\u9762\uff09\u3001SERVER\uff08\u670d\u52a1\u5668\uff09\u3002 tunnelMigration Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u662f\u5426\u542f\u7528\u901a\u9053\u8fc1\u79fb\uff08\u4f5c\u7528\u672a\u77e5\uff09\uff0c\u754c\u9762\u6ca1\u627e\u5230\u4e0e\u4e4b\u5bf9\u5e94\u7684\u9009\u9879\u3002 startPaused Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u662f\u5426\u4ee5\u6682\u505c\u6a21\u5f0f\u542f\u52a8\u3002 customProperties CustomProperties body \u53ef\u9009\u53c2\u6570\uff0cCustomProperties\u662f\u865a\u62df\u673a\u81ea\u5b9a\u4e49\u53c2\u6570\u96c6\u5408\u7684\u6620\u5c04\uff0c\u6301\u6709\u552f\u4e00\u7684customProperties\u5b57\u6bb5\u662fCustomPropertyModel\u5217\u8868\u7684\u5f15\u7528\u3002CustomPropertyModel\u4ee3\u8868\u4e86\u6bcf\u4e00\u4e2a\u81ea\u5b9a\u4e49\u53c2\u6570\uff0c\u5176\u4e2dname\u5b57\u6bb5\u4ee3\u8868\u53c2\u6570\u540d\uff0cvalue\u5b57\u6bb5\u4ee3\u8868\u53c2\u6570\u503c\uff0cregexp\u4ee3\u8868\u6b63\u5219\u8868\u8fbe\u5f0f\u3002 quota QuotaModel body \u53ef\u9009\u53c2\u6570\uff0cQuotaModel\u4ee3\u8868\u4e86\u865a\u62df\u673a\u7684\u914d\u989d\uff0c\u914d\u989d\u5177\u4f53\u7684\u4f5c\u7528\u4e0d\u6e05\u695a\uff0c\u754c\u9762\u4e0a\u4e5f\u6ca1\u627e\u5230\u5bf9\u5e94\u7684\u5185\u5bb9\uff0c\u8fd9\u91cc\u53ea\u9700\u8981\u6307\u5b9aid\u5b57\u6bb5\u5373\u53ef\u3002 useLatestTemplateVersion Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u901a\u8fc7\u6a21\u677f\u521b\u5efa\u865a\u62df\u673a\u65f6\u662f\u5426\u4f7f\u7528\u6a21\u677f\u7684\u6700\u65b0\u5b50\u7248\u672c\u3002 placementPolicy VmPlacementPolicy body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7684\u5b89\u7f6e\u7b56\u7565\uff08\u5373\u865a\u62df\u673a\u4e0e\u4e3b\u673a\u4e4b\u95f4\u7684\u5173\u7cfb\uff09\uff0cVmPlacementPolicy\u6709\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\uff1a1.affinity\u5b57\u6bb5\uff0c\u4ee3\u8868\u4e3b\u673a\u7684\u8fc1\u79fb\u6a21\u5f0f\uff0c\u53ef\u9009\u503c\u6709MIGRATABLE\uff08\u5141\u8bb8\u624b\u52a8\u8fc1\u79fb\u548c\u81ea\u52a8\u8fc1\u79fb\uff09\u3001USER_MIGRATABLE\uff08\u5141\u8bb8\u624b\u52a8\u8fc1\u79fb\uff09\u3001PINNED\uff08\u4e0d\u8fd0\u884c\u8fc1\u79fb\uff09\u30022.hosts\u5b57\u6bb5\uff0c\u662fHosts\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u865a\u62df\u673a\u53ef\u7528\u7684\u4e3b\u673a\u5217\u8868\u3002Hosts\u5bf9\u8c61\u662f\u7684HostModel\u96c6\u5408\u6620\u5c04\uff0c\u53ea\u6301\u6709\u4e00\u4e2aHostModel\u96c6\u5408\u7684\u5f15\u7528hosts\u5b57\u6bb5\u3002\u8fd9\u91cc\u53ea\u9700\u8981\u6307\u5b9aHostModel\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\uff0chost\u5fc5\u987b\u4e3a\u865a\u62df\u673a\u6240\u5728\u96c6\u7fa4\u7684\u4e3b\u673a\u3002\u5f53HostModel\u96c6\u5408\u4e3a\u7a7a\uff08\u6216\u8005null\uff09\u65f6\uff0c\u8868\u793a\u865a\u62df\u673a\u80fd\u8fd0\u884c\u5728\u4efb\u4e00\u4e3b\u673a\u4e0a\u3002 usb UsbModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u6a21\u677f\u7684usb\u7b56\u7565\uff0cUsbModel\u5177\u67092\u4e2a\u5b57\u6bb5\uff1a1.enabled\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u542f\u7528usb\u7b56\u7565\uff0c\u53ea\u6709\u8be5\u5b57\u6bb5\u4e3atrue\u65f6\uff0c\u5176\u4ed6\u5b57\u6bb5\u624d\u80fd\u751f\u6548\u30022.type\u5b57\u6bb5\uff0c\u4ee3\u8868usb\u7b56\u7565\u7c7b\u578b\uff0c\u53ef\u9009\u503c\u6709LEGACY\u548cNATIVE\u3002\u5728\u521b\u5efa\u65b9\u5f0f\u4e3a\u865a\u62df\u673a\u6a21\u677f\u65f6\u6709\u6548\u3002 numaTuneMode NumaTuneMode body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868Numa\u7684Tune\u6a21\u5f0f\uff0c\u53ef\u9009\u503c\u6709\uff1aSTRICT\uff08\u4e25\u683c\uff09\u3001INTERLEAVE\uff08\u4ea4\u9519\uff09\u3001PREFERRED\uff08\u9996\u9009\uff09\u3002 diskAttachments DiskAttachments body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u5bf9\u6307\u5b9a\u7684\u6a21\u677f\u6216\u8005\u5feb\u7167\u4e2d\u539f\u6709\u7684\u78c1\u76d8\u4fe1\u606f\u8fdb\u884c\u4fee\u6539\u3002DiskAttachments\u5bf9\u8c61\u4ee3\u8868\u865a\u62df\u673a\u9644\u52a0\u78c1\u76d8\u5217\u8868\uff0cDiskAttachments\u53ea\u62e5\u6709diskAttachments\u4e00\u4e2a\u5b57\u6bb5\uff0c\u662fDiskAttachment\u96c6\u5408\u7684\u5f15\u7528\uff0cDiskAttachment\u5bf9\u8c61\u7684disk\u5b57\u6bb5\u6240\u6307\u5411\u7684DiskModel\u624d\u662f\u771f\u6b63\u7684\u78c1\u76d8\u4fe1\u606f\u3002\u5f53\u9700\u8981\u4fee\u6539\u78c1\u76d8\u4fe1\u606f\u65f6\u5fc5\u987b\u6307\u5b9a\u7684\u5b57\u6bb5\u4e0e\u521b\u5efa\u65b9\u5f0f\u6709\u5173\uff0c\u5f53\u901a\u8fc7\u6a21\u677f\u521b\u5efa\u865a\u62df\u673a\u65f6\u9700\u8981\u6307\u5b9aDiskModel\u7684id\u5b57\u6bb5\u6765\u6307\u5b9a\u8981\u4fee\u6539\u7684\u78c1\u76d8\uff0c\u4f46\u662f\u5982\u679c\u901a\u8fc7\u5feb\u7167\u521b\u5efa\u865a\u62df\u673a\u65f6\u9700\u8981\u6307\u5b9aDiskModel\u7684imageId\u5b57\u6bb5\u3002\u53ef\u4fee\u6539\u78c1\u76d8\u4fe1\u606f\uff0c\u4f8b\u5982DiskModel\u7684name\u5b57\u6bb5\u8868\u793a\u8981\u4fee\u6539\u7684\u78c1\u76d8\u540d\uff1bDiskModel\u7684format\u5b57\u6bb5\u8868\u793a\u8981\u4fee\u6539\u7684\u78c1\u76d8\u683c\u5f0f\uff0c\u53ef\u9009\u503c\u5305\u62ecCOW\u548cRAW\uff1bDiskModel\u7684storageDomains\u5b57\u6bb5\u662fStorageDomains\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u8868\u793a\u6307\u5b9a\u78c1\u76d8\u7684\u5b58\u50a8\u57df\uff0cStorageDomains\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aStorageDomainModel\u96c6\u5408\u7684\u5f15\u7528storageDomains\u5b57\u6bb5\uff0c\u6307\u5b9a\u78c1\u76d8\u5b58\u50a8\u57df\u65f6\u53ea\u9700\u8981\u6307\u5b9a\u96c6\u5408\u4e2d\u4e00\u4e2aStorageDomainModel\u7684id\u5b57\u6bb5\u5373\u53ef\u3002 \u8bf4\u660e\uff1a\u521b\u5efa\u865a\u62df\u673a\u63a5\u53e3\uff0c\u53ef\u4ee5\u901a\u8fc7\u6a21\u677f\u3001\u5feb\u7167\u6216\u8005xml\u4fe1\u606f\u521b\u5efa\u865a\u62df\u673a\uff0c\u540c\u65f6\u4e5f\u53ef\u4ee5\u6307\u5b9a\u5176\u4ed6\u53c2\u6570\u5bf9\u76f8\u5e94\u6a21\u677f\u6216\u8005\u5feb\u7167\u4fe1\u606f\u8fdb\u884c\u4fee\u6539\u3002\u8fd9\u4e09\u8005\u7684\u4f18\u5148\u7ea7\u4e3a\uff1a xml > \u5feb\u7167 > \u6a21\u677f \u3002 \u901a\u8fc7\u6a21\u677f\u521b\u5efa\u865a\u62df\u673a\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5fc5\u987b\u63d0\u4f9b\u6a21\u677f\u7684 id \u6216\u8005\u540d\u5b57\uff1a \u8bf7\u6c42\uff1a POST /acloudageks/api/vms Body: { \"name\": \"myvm\", \"template\": { \"name\": \"Blank\" }, \"cluster\": { \"name\": \"Default\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"VmModel [cluster.id|name] required for add\", \"reason\": \"Incomplete parameters\" } \u901a\u8fc7\u5feb\u7167\u521b\u5efa\u865a\u62df\u673a\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5fc5\u987b\u63d0\u4f9b\u5feb\u7167id \u8bf7\u6c42\uff1a POST /acloudageks/api/vms Body: { \"name\": \"myvm\", \"snapshots\": { \"snapshots\": [ { \"id\": \"bc6ccc8b-278c-4d87-a945-5728b45690d5\" } ] }, \"cluster\": { \"name\": \"Default\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"VmModel [cluster.id|name] required for add\", \"reason\": \"Incomplete parameters\" } \u4ece\u6a21\u677f\u6216\u5feb\u7167\u521b\u5efa\u865a\u62df\u673a\u65f6\uff0c\u901a\u5e38\u901a\u5e38\u8981\u660e\u786e\u6307\u51fa\u8981\u5728\u54ea\u4e2a\u5b58\u50a8\u57df\u4e2d\u521b\u5efa\u865a\u62df\u673a\u78c1\u76d8\u3002 \u5982\u679c\u865a\u62df\u673a\u662f\u4ece\u6a21\u677f\u521b\u5efa\u7684\uff0c\u5219\u53ef\u4ee5\u901a\u8fc7\u6dfb\u52a0diskAttachment\u53c2\u6570\u6765\u8bf4\u660e\u6620\u5c04\u5173\u7cfb\uff1a { ... \"diskAttachments\": { \"diskAttachments\": [ \"disk\": { \"id\": \"bc6ccc8b-1234-4d87-a945-5728b45690d1\", \"storageDomains\": { \"storageDomains\": [ { \"id\": \"9cb6cb0a-cf1d-41c2-92ca-5a6d665649c9\" } ] } } ] } } \u4ece\u5feb\u7167\u521b\u5efa\u865a\u62df\u673a\u65f6\u78c1\u76d8\u914d\u7f6e\u7565\u5fae\u6709\u4e9b\u4e0d\u540c\uff0c\u8fd9\u65f6\u9700\u8981\u4f7f\u7528imageId\u5c5e\u6027\u6765\u66ff\u6362id\u5c5e\u6027 { ... \"diskAttachments\": { \"diskAttachments\": [ \"disk\": { \"imageId\": \"bc6ccc8b-1234-4d87-a945-5728b45690d1\", \"storageDomains\": { \"storageDomains\": [ { \"id\": \"9cb6cb0a-cf1d-41c2-92ca-5a6d665649c9\" } ] } } ] } } \u53ef\u4ee5\u5728\u8bf7\u6c42\u53c2\u6570\u4e2d\u6307\u5b9a\u5176\u4ed6\u865a\u62df\u673a\u53c2\u6570\uff0c\u4f8b\u5982\u53ef\u4ee5\u6dfb\u52a0\u5177\u67092 GiB RAM\u548c\u9644\u52a0\u8bf4\u660e\u7684\u684c\u9762\u578b\u865a\u62df\u673a\uff0c\u53ef\u4ee5\u6dfb\u52a0\u4ee5\u4e0b\u53c2\u6570\uff1a { \"name\": \"myvm\", \"description\": \"My Desktop Virtual Machine\", \"type\": \"desktop\" \"memory\": 2147483648 ... }","title":"1.1.1. \u6dfb\u52a0\u865a\u62df\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#112","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e all_content Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u662f\u5426\u5728response\u662f\u5426\u5e94\u8be5\u5305\u62ec\u6240\u6709\u7684\u865a\u62df\u673a\u5c5e\u6027\uff08\u8c8c\u4f3c\u6ca1\u4f5c\u7528\uff09 case_sensitive Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u4e0esearch\u53c2\u6570\u4e00\u8d77\u4f7f\u7528\uff0c\u6307\u5b9a\u5728\u6267\u884csearch\u53c2\u6570\u65f6\u662f\u5426\u8003\u8651\u5927\u5c0f\u5199 filter Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u865a\u62df\u673a\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u865a\u62df\u673a\u6570\u91cf search String url \u53ef\u9009\u53c2\u6570\uff0c\u67e5\u8be2\u7ea6\u675f\u6761\u4ef6\u7ea6\u675f\u8fd4\u56de\u4fe1\u606f\uff0c\u4f8b\u5982name=\"myname\" \u8bf7\u6c42\uff1a GET /acloudageks/api/vms \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.1.2.\u83b7\u5f97\u865a\u62df\u673a\u5217\u8868"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#113","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/cancelmigration Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"1.1.3.\u53d6\u6d88\u8fc1\u79fb\u865a\u62df\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#114","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 vm VmModel body \u5fc5\u8981\u53c2\u6570\uff0c\u9700\u8981\u6307\u5b9a\u514b\u9686\u7684\u65b0\u865a\u62df\u673a\u7684\u540d\u5b57 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/clone Body: { \"vm\": { \"name\": \"myClone\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"ActionModel [vm.name] required for doClone\", \"reason\": \"Incomplete parameters\" }","title":"1.1.4.\u514b\u9686\u865a\u62df\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#115","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/commitsnapshot Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"1.1.5.\u63d0\u4ea4\u9884\u89c8\u955c\u50cf"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#116","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/detach Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.1.6.\u4ece\u865a\u62df\u673a\u6c60\u4e2d\u5206\u79bb\u865a\u62df\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#117","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 discardSnapshots Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u5bfc\u51fa\u865a\u62df\u673a\u5230\u5bfc\u51fa\u57df\u65f6\u662f\u5426\u9700\u8981\u6298\u53e0\u865a\u62df\u673a\u6240\u6709\u7684\u5feb\u7167 exclusive Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u5bfc\u51fa\u865a\u62df\u673a\u5230\u5bfc\u51fa\u57df\u65f6\u5982\u679c\u8be5\u865a\u62df\u673a\u5df2\u7ecf\u5728\u5bfc\u51fa\u57df\u5b58\u5728\uff0c\u662f\u5426\u8986\u76d6\u5df2\u7ecf\u5b58\u5728\u5bfc\u51fa\u57df\u7684\u865a\u62df\u673a storageDomain StorageDomainModel body \u5fc5\u8981\u53c2\u6570\uff0c\u9700\u8981\u6307\u5b9a\u5b58\u50a8\u57df\u7684id\u5b57\u6bb5\u6216\u8005id\u5b57\u6bb5 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/export Body: { \"storageDomain\": { \"name\": \"myexport\" }, \"exclusive\": true, \"discardSnapshots\": true } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"1.1.7.\u5bfc\u51fa\u865a\u62df\u673a\u5230\u5b58\u50a8\u57df"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#118","text":"\u5f53\u4e3a\u6b63\u5728\u8fd0\u884c\u7684\u865a\u62df\u673a\u62cd\u6444\u6d3b\u52a8\u5feb\u7167\u65f6\uff0c QEMU guest agent \u4f1a\u51bb\u7ed3\u865a\u62df\u673a\u7684\u6587\u4ef6\u7cfb\u7edf\u3002\u901a\u5e38\uff0c\u8fd9\u4e2a\u662f\u7531\u7ba1\u7406\u7cfb\u7edf\u81ea\u52a8\u5b8c\u6210\u7684\uff0c\u4f46\u865a\u62df\u673a\u5728\u4f7f\u7528 OpenStack Volume(Cinder) \u78c1\u76d8\u65f6\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u5fc5\u987b\u8fdb\u884c\u624b\u52a8\u8c03\u7528\u3002 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/freezefilesystems Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"1.1.8.\u51bb\u7ed3\u865a\u62df\u673a\u6587\u4ef6\u7cfb\u7edf"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#119","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e all_content Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u662f\u5426\u5728response\u662f\u5426\u5e94\u8be5\u5305\u62ec\u6240\u6709\u7684\u865a\u62df\u673a\u5c5e\u6027\uff08\u8c8c\u4f3c\u6ca1\u4f5c\u7528\uff09 filter Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u865a\u62df\u673a\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 next_run Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u7ed3\u679c\u662f\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u865a\u62df\u673a\u7684\u865a\u62df\u673a\u4fe1\u606f\uff0c\u8fd8\u662f\u5df2\u7ecf\u6267\u884c\u4e86\u4fee\u6539\uff0c\u4f46\u662f\u5728\u865a\u62df\u673a\u4e0b\u6b21\u91cd\u542f\u624d\u751f\u6548\u7684\u865a\u62df\u673a\u4fe1\u606f \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.1.9.\u83b7\u5f97\u6307\u5b9a\u7684\u865a\u62df\u673a\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#1110","text":"\u542f\u52a8\u81ea\u52a8\u7528\u6237\u767b\u5f55\u4ee5\u4ece\u5916\u90e8\u63a7\u5236\u53f0\u8bbf\u95ee\u865a\u62df\u673a\u3002\u7528\u6237\u9700\u8981\u865a\u62df\u673a\u7684\u9002\u5f53\u7528\u6237\u6743\u9650\uff0c\u624d\u80fd\u4ece\u5916\u90e8\u63a7\u5236\u53f0\u8bbf\u95ee\u865a\u62df\u673a\u3002 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/logon Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.1.10.\u542f\u7528\u7528\u6237\u81ea\u52a8\u767b\u5165\u865a\u62df\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#1111","text":"\u5728ovirt\u4e2d\u6b64\u63a5\u53e3\u7528\u4e8e\u5c06\u4f5c\u4e3a\u4e3b\u673a\u7684\u865a\u62df\u673a\u6267\u884c\u7ef4\u62a4\u64cd\u4f5c\uff08\u5d4c\u5957\u865a\u62df\u5316\uff09\uff0c\u5728\u6211\u4eec\u7684\u7cfb\u7edf\u4e2d\u4e0d\u652f\u6301\uff0c\u6240\u4ee5\u8c03\u7528\u8be5\u63a5\u53e3\u4f1a\u76f4\u63a5\u629b\u51fa\u5f02\u5e38\u3002 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/maintenance Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5e9f\u5f03\u7684\u63a5\u53e3","title":"1.1.11.\u7ef4\u62a4\u865a\u62df\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#1112","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 cluster ClusterModel body \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u865a\u62df\u673a\u8981\u8fc1\u79fb\u5230\u7684\u96c6\u7fa4\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u7cfb\u7edf\u4f1a\u5c06\u865a\u62df\u673a\u8fc1\u79fb\u5230\u540c\u4e00\u96c6\u7fa4\u4e2d\u7684\u53e6\u4e00\u53f0\u4e3b\u673a\u4e0a\u3002\u9700\u8981\u901a\u8fc7id\u5b57\u6bb5\u6765\u6307\u5b9a\u96c6\u7fa4\u3002 force Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u5f3a\u5236\u8fc1\u79fb\u865a\u62df\u673a\uff0c\u5373\u4f7f\u865a\u62df\u673a\u53ef\u80fd\u88ab\u5b9a\u4e49\u4e3a\u4e0d\u53ef\u8fc1\u79fb host HostModel body \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u865a\u62df\u673a\u8fc1\u79fb\u5230\u7684\u4e3b\u673a\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u7cfb\u7edf\u4f1a\u5c06\u865a\u62df\u673a\u8fc1\u79fb\u5230\u540c\u4e00\u96c6\u7fa4\u4e2d\u7684\u53e6\u4e00\u53f0\u4e3b\u673a\u4e0a\u3002\u9700\u8981\u901a\u8fc7name\u5b57\u6bb5\u6216\u8005id\u5b57\u6bb5\u6765\u6307\u5b9a\u4e3b\u673a\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/migrate Body: { \"host\": { \"id\": \"2ab5e1da-b726-4274-bbf7-0a42b16a0fc3\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"1.1.12.\u865a\u62df\u673a\u8fc1\u79fb"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#1113","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 disks Disks body \u53ef\u9009\u53c2\u6570\uff0c\u7528\u4e8e\u6307\u5b9a\u6267\u884c\u5feb\u7167\u9884\u89c8\u7684\u78c1\u76d8\uff0cDisks\u5bf9\u8c61\u4e3aDiskModel\u96c6\u5408\u7684\u6620\u5c04\uff0cDisks\u5bf9\u8c61\u53ea\u6301\u6709DiskModel\u96c6\u5408\u7684\u5f15\u7528disks\u5b57\u6bb5\uff0c\u9700\u8981DiskModel\u7684\u5b8c\u6574\u7684\u4fe1\u606f\uff0c\u9ed8\u8ba4\u5bf9\u6240\u6709\u78c1\u76d8\u8fdb\u884c\u5feb\u7167\u9884\u89c8\u3002 restoreMemory Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u662f\u5426\u6062\u590d\u5feb\u7167\u7684\u5185\u5b58\u4fe1\u606f\uff0c\u9ed8\u8ba4\u4e3afalse snapshot SnapshotModel body \u5fc5\u8981\u53c2\u6570\uff0c\u8868\u793a\u8981\u8fdb\u884c\u9884\u89c8\u7684\u5feb\u7167\uff0c\u9700\u8981\u6307\u5b9a\u5feb\u7167id\u3002 \u8bf4\u660e\uff1a\u53c2\u6570\u4e2dDiskModel\u7684\u5b8c\u6574\u7684\u4fe1\u606f\u4e0d\u662f\u5f88\u5408\u7406\uff0c\u8fd9\u91cc\u5e94\u8be5\u6539\u4e3a\u53ea\u9700\u8981\u6307\u5b9aid\u5b57\u6bb5\u548cimageId\u5b57\u6bb5\u3002 ovirt4.3 \u4e2d\u7684\u903b\u8f91\u4e5f\u662f\u5982\u6b64\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/previewsnapshot Body: { \"snapshot\": { \"id\": \"2ab5e1da-b726-4274-bbf7-0a42b16a0fc3\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"1.1.13.\u5feb\u7167\u9884\u89c8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#1114","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/reboot Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.1.14.\u91cd\u542f\u865a\u62df\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#1115","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e detach_only Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u5220\u9664\u865a\u62df\u673a\u65f6\uff0c\u662f\u5426\u53ea\u5206\u79bb\u865a\u62df\u673a\u7684\u9644\u52a0\u78c1\u76d8\uff0c\u800c\u4e0d\u662f\u5220\u9664\u78c1\u76d8\u3002 force Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u662f\u5426\u5f3a\u5236\u5220\u9664\u865a\u62df\u673a \u9501\u5b9a\u7684\u865a\u62df\u673a\u548c\u9644\u52a0\u4e86\u9501\u5b9a\u78c1\u76d8\u7684\u865a\u62df\u673a\u5728\u6ca1\u6709\u9644\u52a0fore\u53c2\u6570\u65f6\u65e0\u6cd5\u88ab\u5220\u9664\u3002 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/vms/{id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.1.15.\u5220\u9664\u865a\u62df\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#1116mac","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/reordermacaddresses Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.1.16.mac\u5730\u5740\u91cd\u6392"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#1117","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/shutdown Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.1.17.\u5173\u95ed\u865a\u62df\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#1118","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 pause Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u662f\u5426\u4ee5\u6682\u505c\u6a21\u5f0f\u542f\u52a8\uff0c\u9ed8\u8ba4\u503c\u4e3afalse useSysprep Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u4ec5\u5728RunVmOnce\u6a21\u5f0f\u6709\u6548\uff0c\u8868\u793a\u865a\u62df\u673a\u662f\u5426\u4ee5sysprep\u65b9\u5f0f\u542f\u52a8\uff08\u4ec5\u652f\u6301windows\uff09\uff0c\u4e0euseCloudInit\u53c2\u6570\u51b2\u7a81\uff0c\u9ed8\u8ba4\u503c\u4e3afalse useCloudInit Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u4ec5\u5728RunVmOnce\u6a21\u5f0f\u6709\u6548\uff0c\u8868\u793a\u865a\u62df\u673a\u662f\u5426\u4ee5clouldinit\u65b9\u5f0f\u542f\u52a8\uff08\u4ec5\u652f\u6301linux\uff09\uff0c\u4e0euseCloudInit\u53c2\u6570\u51b2\u7a81\uff0c\u9ed8\u8ba4\u503c\u4e3afalse vm VmModel body \u529f\u80fd\u533a\u5206\u53c2\u6570\uff0c\u7528\u4e8e\u542f\u7528RunVmOnce\u6a21\u5f0f\uff0c\u5f53\u6307\u5b9a\u8be5\u53c2\u6570\u65f6\uff0c\u8868\u793a\u4ee5RunVmOnce\u6a21\u5f0f\u542f\u52a8\u865a\u62df\u673a\u3002VmModel\u5bf9\u8c61\u4e2d\u5bf9RunVmOnce\u6a21\u5f0f\u4ea7\u751f\u5f71\u54cd\u7684\u5b57\u6bb5\u6709\u4ee5\u4e0b\u51e0\u4e2a\uff1a1.stateless\u5b57\u6bb5\uff0c\u8868\u793a\u865a\u62df\u673a\u662f\u5426\u4e3a\u65e0\u72b6\u6001\u30022.display\u5b57\u6bb5\uff0c\u662fDisplayModel\u5bf9\u8c61\u7684\u5f15\u7528\u4ee3\u8868\u865a\u62df\u673a\u7684\u663e\u793a\u6a21\u578b\uff0c\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\u5f71\u54cd\u865a\u62df\u673a\u542f\u52a8\uff1akeyboardLayout\u5b57\u6bb5\uff0c\u4ee3\u8868vnc\u952e\u76d8\u5e03\u5c40\uff08\u4f5c\u7528\u672a\u77e5\uff09\uff0c\u5728\u754c\u9762\u4e2d\u8be5\u9009\u9879\u88ab\u9690\u85cf\uff0c\u53ef\u9009\u5185\u5bb9\u89c1 vdc_options \u8868\u7684 VncKeyboardLayoutValidValues \u9009\u9879\uff1btype\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u542f\u52a8\u4f7f\u7528\u7684\u56fe\u5f62\u534f\u8bae\uff0c\u53ef\u9009\u7684\u56fe\u5f62\u534f\u8bae\u9009\u9879\u6709VNC\u548cSPICE\u30023.os\u5b57\u6bb5\uff0c\u662fOperatingSystemModel\u5bf9\u8c61\u7684\u5f15\u7528\u4ee3\u8868\u4e0e\u7cfb\u7edf\u5f15\u5bfc\u6709\u5173\u7684\u53c2\u6570\uff0c\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\u5f71\u54cd\u865a\u62df\u673a\u542f\u52a8\uff1a boot \u5b57\u6bb5\u662fBootModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u5f15\u5bfc\u8bbe\u5907\u5e8f\u5217\u3002BootModel\u53ea\u6301\u6709devices\u5b57\u6bb5\uff0c\u662fBootDeviceValues\u5bf9\u8c61\u7684\u5f15\u7528\u3002BootDeviceValues\u5bf9\u8c61\u662fBootDevice\u7684\u96c6\u5408\u6620\u5c04\uff0c\u53ea\u6301\u6709BootDevice\u96c6\u5408\u7684\u5f15\u7528bootDevice\u5b57\u6bb5\u3002BootDevice\u4ee3\u8868\u865a\u62df\u673a\u7684\u5f15\u5bfc\u8bbe\u5907\u5e8f\u5217\uff0c\u53ef\u9009\u503c\u6709\uff1aCDROM\uff08\u5149\u9a71\uff09\u3001HD\uff08\u786c\u76d8\uff09\u548cNETWORK\uff08\u7f51\u7edc\uff09\u3002\u5217\u8868\u4e2dBootDevice\u5404\u4e2a\u503c\u7684\u6392\u5217\u987a\u5e8f\uff0c\u4ee3\u8868\u865a\u62df\u673a\u5f15\u5bfc\u8bbe\u5907\u987a\u5e8f\uff0c\u5982\u679c\u51fa\u73b0\u91cd\u590d\u7684\u503c\uff0c\u4f1a\u5148\u53bb\u91cd\uff1b kernel \u5b57\u6bb5\uff0c\u4ee3\u8868Linux\u5f15\u5bfc\u9009\u9879\u4e2d\u7684\u5185\u6838\u8def\u5f84\uff0c\u56e0\u6b64\u53ea\u6709\u5728\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u662flinux\u65f6\u624d\u4f1a\u751f\u6548\uff0c\u8be5\u5b57\u6bb5\u586b\u5199\u7684\u662flinux\u5185\u6838\u5728iso\u57df\u7684\u8def\u5f84\uff1b initrd \u5b57\u6bb5\uff0c\u4ee3\u8868Linux\u5f15\u5bfc\u9009\u9879\u4e2d\u7684initrd\u8def\u5f84\uff0c\u56e0\u6b64\u53ea\u6709\u5728\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u662flinux\u65f6\u624d\u4f1a\u751f\u6548\uff0c\u8be5\u5b57\u6bb5\u586b\u5199\u7684\u662finitrd\u5728iso\u57df\u7684\u8def\u5f84\uff1b cmdline \u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u81ea\u5b9a\u4e49\u7684\u5185\u6838\u53c2\u6570\uff0c\u683c\u5f0f\u76ee\u524d\u4e0d\u77e5\u9053\u30024.cdroms\u5b57\u6bb5\uff0c\u662fCdroms\u5bf9\u8c61\u662fCdromModel\u96c6\u5408\u6620\u5c04\uff0c\u53ea\u6301\u6709CdromModel\u96c6\u5408\u7684\u5f15\u7528cdroms\u5b57\u6bb5\u3002CdromModel\u5bf9\u8c61\u4ee3\u8868\u865a\u62df\u673a\u5149\u76d8\uff0c\u53ea\u6709\u4e00\u4e2afile\u5b57\u6bb5\uff0cfile\u5b57\u6bb5\u662fFileModel\u7684\u5f15\u7528\uff0c\u9700\u8981\u6307\u5b9aFileModel\u5bf9\u8c61\u7684id\u5b57\u6bb5\u6765\u6307\u5b9a\u5149\u76d8\u6587\u4ef6\u7684\u8def\u5f84\u30025.floppies\u5b57\u6bb5\uff0c\u662fFloppies\u5bf9\u8c61\u662fFloppyModel\u96c6\u5408\u6620\u5c04\uff0c\u53ea\u6301\u6709FloppyModel\u96c6\u5408\u7684\u5f15\u7528floppies\u5b57\u6bb5\u3002FloppyModel\u5bf9\u8c61\u4ee3\u8868\u865a\u62df\u673a\u8f6f\u76d8\uff0c\u53ea\u6709\u4e00\u4e2afile\u5b57\u6bb5\uff0cfile\u5b57\u6bb5\u662fFileModel\u7684\u5f15\u7528\uff0c\u9700\u8981\u6307\u5b9aFileModel\u5bf9\u8c61\u7684id\u5b57\u6bb5\u6765\u6307\u5b9a\u8f6f\u76d8\u6587\u4ef6\u7684\u8def\u5f84\u30026.customProperties\u5b57\u6bb5\uff0c\u662fCustomProperties\u5bf9\u8c61\u7684\u5f15\u7528\u4ee3\u8868\u865a\u62df\u673a\u81ea\u5b9a\u4e49\u53c2\u6570\u96c6\u5408\u7684\u6620\u5c04\uff0c\u6301\u6709\u552f\u4e00\u7684customProperties\u5b57\u6bb5\u662fCustomPropertyModel\u5217\u8868\u7684\u5f15\u7528\u3002CustomPropertyModel\u4ee3\u8868\u4e86\u6bcf\u4e00\u4e2a\u81ea\u5b9a\u4e49\u53c2\u6570\uff0c\u5176\u4e2dname\u5b57\u6bb5\u4ee3\u8868\u53c2\u6570\u540d\uff0cvalue\u5b57\u6bb5\u4ee3\u8868\u53c2\u6570\u503c\uff0cregexp\u4ee3\u8868\u6b63\u5219\u8868\u8fbe\u5f0f\u30027.bootMenuEnabled\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u542f\u7528\u5f15\u5bfc\u83dc\u5355\u30028.domain\u5b57\u6bb5\uff0cDomainModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u57df\u76f8\u5173\u7684\u4fe1\u606f\uff0c\u53ea\u5728SysPrep\u6a21\u5f0f\u751f\u6548\u3002DomainModel\u5bf9\u8c61\u7684name\u5b57\u6bb5\u4ee3\u8868\u8fdb\u884c\u8ba4\u8bc1\u7684\u57df\u7684\u57df\u540d\uff1bDomainModel\u5bf9\u8c61\u7684user\u5b57\u6bb5\uff0c\u662fUserModel\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u57df\u7528\u6237\u4fe1\u606f\u3002UserModel\u7684name\u5b57\u6bb5\u4ee3\u8868\u57df\u7528\u6237\u540d\uff0cUserModel\u7684password\u5b57\u6bb5\u4ee3\u8868\u57df\u7528\u6237\u5bc6\u7801\u30029.customCpuModel\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7684cpu\u7c7b\u578b\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u865a\u62df\u673acpu\u7c7b\u578b\uff0c\u5fc5\u987b\u4e0e\u865a\u62df\u673a\u6240\u5728\u96c6\u7fa4\u7684cpu\u7c7b\u578b\u4e3a\u540c\u4e00\u4ea7\u5546\uff0c\u4e14\u4ee3\u6570\u5fc5\u987b\u7b49\u4e8e\u6216\u4f4e\u4e8e\u96c6\u7fa4cpu\u7c7b\u578b\u300210.customEmulatedMachine\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7684\u4eff\u771f\u673a\u300211.placementPolicy\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7684\u5b89\u7f6e\u7b56\u7565\uff08\u5373\u865a\u62df\u673a\u4e0e\u4e3b\u673a\u4e4b\u95f4\u7684\u5173\u7cfb\uff09\uff0c\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\u5f71\u54cd\u865a\u62df\u673a\u542f\u52a8\uff1ahosts\u5b57\u6bb5\uff0c\u662fHosts\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u865a\u62df\u673a\u53ef\u7528\u7684\u4e3b\u673a\u5217\u8868\u3002Hosts\u5bf9\u8c61\u662f\u7684HostModel\u96c6\u5408\u6620\u5c04\uff0c\u53ea\u6301\u6709\u4e00\u4e2aHostModel\u96c6\u5408\u7684\u5f15\u7528hosts\u5b57\u6bb5\u3002\u8fd9\u91cc\u53ea\u9700\u8981\u6307\u5b9aHostModel\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\uff0chost\u5fc5\u987b\u4e3a\u865a\u62df\u673a\u6240\u5728\u96c6\u7fa4\u7684\u4e3b\u673a\u3002\u5f53HostModel\u96c6\u5408\u4e3a\u7a7a\uff08\u6216\u8005null\uff09\u65f6\uff0c\u8868\u793a\u865a\u62df\u673a\u53ea\u80fd\u8fd0\u884c\u5728\u56fa\u5b9a\u4e3b\u673a\u4e0a\u300212.initialization\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u521d\u59cb\u5316\u76f8\u5173\u7684\u4fe1\u606f\uff0c\u53c2\u6570\u592a\u591a\u4e86\uff0c\u6682\u65f6\u5148\u4e0d\u6df1\u5165\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/start Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.1.18.\u542f\u52a8\u865a\u62df\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#1119","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/stop Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.1.19.\u865a\u62df\u673a\u65ad\u7535"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#1120","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/suspend Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.1.20.\u6302\u8d77\u865a\u62df\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#1121","text":"\u5f53\u4e3a\u6b63\u5728\u8fd0\u884c\u7684\u865a\u62df\u673a\u62cd\u6444\u6d3b\u52a8\u5feb\u7167\u65f6\uff0c QEMU guest agent \u4f1a\u51bb\u7ed3\u548c\u89e3\u51bb\u865a\u62df\u673a\u7684\u6587\u4ef6\u7cfb\u7edf\u3002\u901a\u5e38\uff0c\u8fd9\u4e2a\u662f\u7531\u7ba1\u7406\u7cfb\u7edf\u81ea\u52a8\u5b8c\u6210\u7684\uff0c\u4f46\u865a\u62df\u673a\u5728\u4f7f\u7528 OpenStack Volume(Cinder) \u78c1\u76d8\u65f6\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u5fc5\u987b\u8fdb\u884c\u624b\u52a8\u8c03\u7528\u3002 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/thawfilesystems Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"1.1.21.\u89e3\u51bb\u865a\u62df\u673a\u6587\u4ef6\u7cfb\u7edf"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#1122","text":"\u7528\u4e8e\u751f\u6210\u6709\u65f6\u6548\u6027\u7684\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c\u6765\u8bbf\u95ee\u542f\u52a8\u72b6\u6001\u7684\u865a\u62df\u673a\u663e\u793a\u7a97\u53e3\u3002 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 ticket TicketModel body \u53ef\u9009\u53c2\u6570\uff0c\u5305\u62ecvalue\u503c\u548c\u6709\u6548\u65f6\u95f4\u4e24\u4e2a\u5b57\u6bb5\uff0c\u800c\u4e24\u4e2a\u5b57\u6bb5\u90fd\u662f\u53ef\u9009\u7684\uff0c\u5176\u4e2d\u8fc7\u671f\u65f6\u95f4\u7684\u9ed8\u8ba4\u503c\u4e3a2\u4e2a\u5c0f\u65f6\uff0cvalue\u503c\u9ed8\u8ba4\u503c\u4e3a\u968f\u673a\u5b57\u7b26\u4e32 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/ticket Body: { \"ticket\": { \"value\": \"abcd12345\", \"expiry\": 120 } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.1.22.\u751f\u6210\u663e\u793a\u4ee4\u724c"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#1123","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{id}/undosnapshot Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"1.1.23.\u64a4\u9500\u9884\u89c8\u955c\u50cf"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#1124","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e filter Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u865a\u62df\u673a\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 next_run Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u66f4\u65b0\u7684\u4fe1\u606f\u662f\u5728\u865a\u62df\u673a\u4e0b\u6b21\u542f\u52a8\u65f6\u518d\u751f\u6548\uff0c\u8fd8\u662f\u5bf9\u865a\u62df\u673a\u7acb\u5373\u751f\u6548\uff0c\u8be5\u53c2\u6570\u7684\u9ed8\u8ba4\u503c\u4e3afalse\uff0c\u6240\u4ee5\u66f4\u65b0\u7684\u4fe1\u606f\u4f1a\u7acb\u5373\u751f\u6548 .. ... body \u9700\u8981\u66f4\u65b0\u7684\u865a\u62df\u673a\u4fe1\u606f\uff0c\u4e0e1.1.1\u4e2d\u65b0\u5efa\u865a\u62df\u673a\u53c2\u6570\u5927\u81f4\u76f8\u540c \u8bf7\u6c42\uff1a PUT /acloudageks/api/vms/{id} Body: { \"description\": \"\u6d4b\u8bd5\u66f4\u65b0\u865a\u62df\u673a\u4fe1\u606f\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"1.1.24.\u66f4\u65b0\u865a\u62df\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#12","text":"","title":"1.2.\u865a\u62df\u673a\u5e94\u7528"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#121","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e filter Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u5e94\u7528\u7a0b\u5e8f\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u5e94\u7528\u7a0b\u5e8f\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{id}/applications \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.2.1.\u83b7\u5f97\u865a\u62df\u673a\u5df2\u5b89\u88c5\u5e94\u7528\u7a0b\u5e8f\u5217\u8868"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#122","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e filter Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u5e94\u7528\u7a0b\u5e8f\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/applications/{appid} \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"1.2.2.\u83b7\u5f97\u865a\u62df\u673a\u6307\u5b9a\u7684\u5df2\u5b89\u88c5\u5e94\u7528\u7a0b\u5e8f\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#13","text":"","title":"1.3.\u865a\u62df\u673a\u5149\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#131","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u5149\u76d8\u8bbe\u5907\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{id}/cdroms \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.3.1.\u83b7\u5f97\u865a\u62df\u673a\u7684\u5149\u76d8\u8bbe\u5907\u5217\u8868"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#132","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e current Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u7531\u4e8e\u5bf9\u5149\u76d8\u4fe1\u606f\u7684\u4fee\u6539\u53ef\u4ee5\u7acb\u5373\u751f\u6548\uff0c\u4e5f\u53ef\u4ee5\u5728\u865a\u62df\u673a\u4e0b\u6b21\u542f\u52a8\u65f6\u751f\u6548\uff0c\u6240\u4ee5\u8be5\u503c\u8868\u793a\u83b7\u5f97\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684\u865a\u62df\u673a\u5149\u76d8\u4fe1\u606f\uff0c\u8fd8\u662f\u865a\u62df\u673a\u4e0b\u6b21\u542f\u52a8\u65f6\u7684\u5149\u76d8\u4fe1\u606f\uff0c\u9ed8\u8ba4\u503c\u4e3afalse \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/cdroms/{cdid} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.3.2.\u83b7\u5f97\u6307\u5b9a\u7684\u5149\u76d8\u8bbe\u5907\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#133","text":"\u66f4\u6539\u548c\u5f39\u51fa\u5149\u76d8\u90fd\u4f7f\u7528\u8be5\u63a5\u53e3\u8fdb\u884c\u64cd\u4f5c\uff0c\u901a\u8fc7\u8bbe\u7f6e\u7684 FileModel \u5bf9\u8c61\u7684id\u503c\u6765\u6267\u884c\u66f4\u6539\u548c\u5f39\u51fa\u5149\u76d8\u64cd\u4f5c\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e file FileModel body \u5fc5\u8981\u53c2\u6570\uff0c\u901a\u8fc7\u8bbe\u7f6efile\u5bf9\u8c61\u7684id\u503c\uff0c\u6765\u66f4\u6539\u6216\u5f39\u51fa\u78c1\u76d8\u3002ISO\u57df\u4e2d\u5fc5\u987b\u5b58\u5728\u4e0efile\u5bf9\u8c61id\u76f8\u5bf9\u5e94\u7684\u6587\u4ef6\uff0c\u5f53file\u5bf9\u8c61id\u4e0d\u4e3a\u7a7a\u65f6\uff0c\u6302\u8f7d\u76f8\u5e94\u7684iso\u6587\u4ef6\uff1b\u5f53id\u4e3a\u7a7a\u5219\u8868\u793a\u5f39\u51fa\u5149\u76d8\u3002 current Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u5bf9\u5149\u76d8\u4fe1\u606f\u7684\u4fee\u6539\u662f\u7acb\u5373\u5e94\u7528\u5230\u5f53\u524d\u8fd0\u884c\u7684\u865a\u62df\u673a\u4e0a\uff0c\u8fd8\u662f\u5728\u865a\u62df\u673a\u4e0b\u6b21\u542f\u52a8\u65f6\u751f\u6548\uff0c\u9ed8\u8ba4\u503c\u4e3afalse \u8bf7\u6c42\uff1a PUT /acloudageks/api/vms/{vmid}/cdroms/{cdid}?current=true Body: { \"file\": { \"id\": \"boot2docker.iso\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"CdromModel [file] required for update\", \"reason\": \"Incomplete parameters\" }","title":"1.3.3.\u66f4\u65b0\u865a\u62df\u673a\u5149\u76d8\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#14","text":"\u4e0e\u865a\u62df\u673a\u78c1\u76d8\u76f8\u5173\u7684\u63a5\u53e3\u5728\u6574\u7406\u65f6\u4e22\u5931\u4e86\uff0c\u6240\u4ee5\u9700\u8981\u5728 VmResource \u63a5\u53e3\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u63a5\u53e3\u65b9\u6cd5\u624d\u80fd\u4f7f\u865a\u62df\u673a\u78c1\u76d8\u63a5\u53e3\u751f\u6548\u3002\u5728 ovirt3.0 \u865a\u62df\u673a\u78c1\u76d8\u76f8\u5173\u7684\u64cd\u4f5c\u5728\u6b64\u63a5\u53e3\u4e0b\u6267\u884c\uff0c\u4f46\u662f\u5728 ovirt4.0 \u4ee5\u540e\u7684\u865a\u62df\u673a\u78c1\u76d8\u76f8\u5173\u63a5\u53e3\u5728\u78c1\u76d8\u9644\u52a0\uff08DiskAttachments\uff09\u63a5\u53e3\u4e0b\u6267\u884c\uff0c\u4f46\u662f\u78c1\u76d8\u9644\u52a0\u63a5\u53e3\u7f3a\u5c11\u90e8\u5206\u64cd\u4f5c\uff08\u4f8b\u5982\u78c1\u76d8\u7684\u6fc0\u6d3b\u548c\u53d6\u6d88\u6fc0\u6d3b\u64cd\u4f5c\uff09\uff0c\u5e76\u4e14\u63a5\u53e3\u53c2\u6570\u4ee5\u53ca\u8fd4\u56de\u5bf9\u8c61\u7684\u5c5e\u6027\u4e5f\u53d1\u751f\u4e86\u6539\u53d8\uff0c\u5c06\u4f1a\u5728 1.5 \u8be6\u7ec6\u4ecb\u7ecd\u3002 @Path(\"disks\") VmDisksResource getDisksResource();","title":"1.4.\u865a\u62df\u673a\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#141","text":"\u6dfb\u52a0\u78c1\u76d8\u63a5\u53e3\u5b9e\u9645\u4e0a\u67092\u4e2a\u529f\u80fd\uff0c\u4e00\u4e2a\u662f\u9644\u52a0\u73b0\u6709\u78c1\u76d8\u5230\u6307\u5b9a\u865a\u62df\u673a\uff0c\u53e6\u4e00\u4e2a\u662f\u4e3a\u865a\u62df\u673a\u6dfb\u52a0\u78c1\u76d8\u3002\u4e24\u4e2a\u529f\u80fd\u901a\u8fc7\u662f\u5426\u4f20\u5165 diskId \u8fdb\u884c\u533a\u5206\u3002 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e id String body \u529f\u80fd\u533a\u5206\u53c2\u6570\uff0c\u5f53\u4f20\u5165\u6b64\u53c2\u6570\u65f6\uff0c\u8868\u793a\u8c03\u7528\u78c1\u76d8\u9644\u52a0\u529f\u80fd\uff0c\u5426\u5219\u8c03\u7528\u865a\u62df\u673a\u6dfb\u52a0\u78c1\u76d8\u529f\u80fd\u3002 bootable Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u4f5c\u4e3a\u5c06\u78c1\u76d8\u4f5c\u4e3a\u53ef\u5f15\u5bfc\u78c1\u76d8\uff0c\u9ed8\u8ba4\u503c\u4e3afalse\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6bcf\u4e2a\u865a\u62df\u673a\u53ea\u80fd\u6709\u4e00\u4e2a\u53ef\u5f15\u5bfc\u78c1\u76d8 interface String body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u78c1\u76d8\u63a5\u53e3\u7c7b\u578b\uff0c\u78c1\u76d8\u63a5\u53e3\u7c7b\u578b\u4e00\u5171\u6709\u4e09\u79cd\uff1aIDE\u3001VIRTIO_SCSI\u3001VIRTIO\uff1b\u9ed8\u8ba4\u7684\u63a5\u53e3\u7c7b\u578b\u4e3aVIRTIO active Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u6fc0\u6d3b\u78c1\u76d8\uff0c\u9ed8\u8ba4\u503c\u4e3afalse readOnly Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u78c1\u76d8\u662f\u5426\u53ea\u8bfb\uff0c\u9ed8\u8ba4\u503c\u4e3afalse snapshot SnapshotModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ec5\u5728\u78c1\u76d8\u9644\u52a0\u65f6\u6709\u6548\uff0c\u53ea\u9700\u8981\u6307\u5b9aSnapshotModel\u7684id\u53c2\u6570\uff0c\u6765\u6307\u5b9a\u78c1\u76d8\u5feb\u7167id\u3002 lunStorage HostStorageModel body \u4ec5\u5728\u78c1\u76d8\u521b\u5efa\u65f6\u6709\u6548\uff0c\u521b\u5efa\u5757\u8bbe\u5907\uff08lun\uff09\u7684\u78c1\u76d8\u65f6\uff0c\u5fc5\u987b\u4f20\u5165\u6b64\u53c2\u6570\uff0c\u5e76\u4e14\u5fc5\u987b\u6307\u5b9aHostStorageModel\u7684 logicalUnits \u5b57\u6bb5\u548c type \u5b57\u6bb5\u3002logicalUnits\u5b57\u6bb5\u7684\u7c7b\u578b\u4e3aLogicalUnits\u5bf9\u8c61\uff0cLogicalUnits\u5bf9\u8c61\u53ea\u6709\u4e00\u4e2alogicalUnits\u5b57\u6bb5\uff0c\u662f\u7531LogicalUnitModel\u5bf9\u8c61\u7ec4\u6210\u7684\u5217\u8868\uff1btype\u662f\u78c1\u76d8\u7684\u5b58\u50a8\u7c7b\u578b\uff0c\u5728\u521b\u5efalun\u65f6\uff0c\u53ef\u9009\u7684\u5b58\u50a8\u7c7b\u578b\u6709ISCSI\u548cFCP\u3002\u5f53type\u4e3aISCSI\u65f6\uff0cLogicalUnitModel\u5bf9\u8c61\u7684address\u3001target\u3001port\u3001id\u5b57\u6bb5\u4e0d\u80fd\u4e3a\u7a7a format String body \u4ec5\u5728\u78c1\u76d8\u521b\u5efa\u65f6\u6709\u6548\uff0c\u6307\u5b9a\u78c1\u76d8\u683c\u5f0f\uff0c\u521b\u5efa\u975e\u5757\u8bbe\u5907\u78c1\u76d8\u65f6\uff0c\u5fc5\u987b\u6307\u5b9a\u6b64\u53c2\u6570\uff0c\u53ef\u9009\u7684\u78c1\u76d8\u683c\u5f0f\u6709RAW\u548cCOW\u3002 provisionedSize Long body \u4ec5\u5728\u78c1\u76d8\u521b\u5efa\u65f6\u6709\u6548\uff0c\u6307\u5b9a\u78c1\u76d8\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3ab\uff0c\u521b\u5efa\u975e\u5757\u8bbe\u5907\u78c1\u76d8\u65f6\uff0c\u5fc5\u987b\u6307\u5b9a\u6b64\u53c2\u6570\u3002 storageDomains StorageDomains body \u7528\u4e8e\u6307\u5b9a\u78c1\u76d8\u7684\u5b58\u50a8\u57df\uff0c\u5728\u65b0\u5efa\u78c1\u76d8\u65f6\u5fc5\u987b\u6307\u5b9a\u6b64\u53c2\u6570\u3002StorageDomains\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aStorageDomainModel\u96c6\u5408\u7684\u5f15\u7528storageDomains\u5b57\u6bb5\uff0c\u6307\u5b9a\u78c1\u76d8\u5b58\u50a8\u57df\u65f6\u53ea\u9700\u8981\u6307\u5b9a\u96c6\u5408\u4e2d\u4e00\u4e2aStorageDomainModel\u7684id\u5b57\u6bb5\u5373\u53ef\uff0c\u5e76\u4e14\u540e\u53f0\u4f1a\u6839\u636eid\u83b7\u5f97\u6307\u5b9a\u5b58\u50a8\u57df\u5e76\u5c06\u78c1\u76d8\u7684\u5b58\u50a8\u57df\u7c7b\u578b\u8bbe\u7f6e\u4e3a\u4e0e\u6307\u5b9a\u5b58\u50a8\u57df\u76f8\u540c\u3002 name String body \u53ef\u9009\u53c2\u6570\uff0c\u78c1\u76d8\u522b\u540d\uff0c\u5df2\u5e9f\u5f03\u7684\u5b57\u6bb5\uff0c\u76ee\u524d\u4f7f\u7528alias\u5b57\u6bb5\u4ee3\u66ff\u3002 alias String body \u53ef\u9009\u53c2\u6570\uff0c\u78c1\u76d8\u522b\u540d\u3002 propagateErrors Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u4f20\u64ad\u9519\u8bef\u5230Guest\uff0c\u4f5c\u7528\u672a\u77e5\u3002 wipeAfterDelete Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u5728\u5220\u9664\u540e\u6e05\u7406\u3002 logicalName String body \u53ef\u9009\u53c2\u6570\uff0c\u78c1\u76d8\u903b\u8f91\u540d\uff0c\u4f5c\u7528\u672a\u77e5\u3002 description String body \u53ef\u9009\u53c2\u6570\uff0c\u78c1\u76d8\u63cf\u8ff0\u3002 lunStorage HostStorageModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ec5\u5728\u78c1\u76d8\u7c7b\u578b\u4e3alun\u65f6\u6709\u6548\uff0c\u8fd9\u91cc\u5148\u4e0d\u5c55\u5f00\u3002 usesScsiReservation Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u4ec5\u5728\u78c1\u76d8\u7c7b\u578b\u4e3alun\u65f6\u6709\u6548\uff0c\u4f5c\u7528\u672a\u77e5\u3002 sgio ScsiGenericIO body \u53ef\u9009\u53c2\u6570\uff0c\u4ec5\u5728\u78c1\u76d8\u7c7b\u578b\u4e3alun\u65f6\u6709\u6548\uff0c\u53ef\u9009\u503c\u6709FILTERED\u548cUNFILTERED\uff0c\u4f5c\u7528\u672a\u77e5\u3002 imageId String body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u78c1\u76d8\u6240\u5728\u5377\u7684id\u3002 sparse Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u78c1\u76d8\u662f\u5426\u4e3a\u7cbe\u7b80\u5206\u914d\uff0ctrue\u4e3a\u7cbe\u7b80\u5206\u914d\uff0cfalse\u4e3a\u9884\u5206\u914d\u3002 quota QuotaModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u78c1\u76d8\u914d\u989d\uff0c\u53ea\u9700\u8981\u6307\u5b9aQuotaModel\u7684id\u5b57\u6bb5\u5373\u53ef\u3002 diskProfile DiskProfile body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u78c1\u76d8\u914d\u7f6e\u96c6\uff0c\u53ea\u9700\u8981\u6307\u5b9aDiskProfile\u7684id\u5b57\u6bb5\u5373\u53ef\u3002 \u8bf7\u6c42\uff1a \u9644\u52a0\u78c1\u76d8 POST /acloudageks/api/vms/{vmid}/disks/ Body: { \"id\": \"3c0433b5-14b5-41ac-b2d5-3319b534b05e\", \"bootable\": true, \"interface\": \"IDE\", \"active\": true, \"readOnly\": false, \"snapshot\": { \"id\": \"d764f497-85a7-4585-b6f7-6fa3e4f8b085\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a \u672a\u6dfb\u52a0 snapshot \u53c2\u6570\u65f6\u8bf7\u6c42\u6210\u529f\uff0c\u6dfb\u52a0\u540e\u8bf7\u6c42\u5931\u8d25\u3002 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"DiskModel [snapshot.id] required for attachDiskToVm\", \"reason\": \"Incomplete parameters\" } \u65b0\u5efa\u78c1\u76d8\u5e76\u9644\u52a0\u5230\u865a\u62df\u673a \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/disks/ Body: { \"bootable\": true, \"interface\": \"IDE\", \"active\": false, \"readOnly\": true, \"format\": \"RAW\", \"provisionedSize\": 1073741824 } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"DiskModel [provisionedSize|size, format] required for invoke0\", \"reason\": \"Incomplete parameters\" }","title":"1.4.1.\u6dfb\u52a0\u865a\u62df\u673a\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#142","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u865a\u62df\u673a\u78c1\u76d8\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/disks?max=1 \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.4.2.\u5217\u51fa\u865a\u62df\u673a\u6240\u6709\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#143","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/disks/{diskId}/activate Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.4.3.\u6fc0\u6d3b\u865a\u62df\u673a\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#144","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/disks/{diskId}/deactivate Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.4.4.\u53d6\u6d88\u6fc0\u6d3b\u865a\u62df\u673a\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#145","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/disks/{diskId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.4.5.\u83b7\u5f97\u865a\u62df\u673a\u6307\u5b9a\u78c1\u76d8\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#146","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 filter Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u78c1\u76d8\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 storageDomain StorageDomainModel body \u5fc5\u8981\u53c2\u6570\uff0c\u9700\u8981\u6307\u5b9aStorageDomainModel\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/disks/{diskId}/move Body: { \"storageDomain\": { \"id\": \"263612f2-d67b-4ce3-9c3e-af05fd4795bf\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"1.4.6.\u79fb\u52a8\u865a\u62df\u673a\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#147","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/vms/{vmid}/disks/{diskId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.4.7.\u5206\u79bb\u865a\u62df\u673a\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#148","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 bootable Boolean body \u78c1\u76d8\u662f\u5426\u4f5c\u4e3a\u53ef\u5f15\u5bfc\u78c1\u76d8\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6bcf\u4e2a\u865a\u62df\u673a\u53ea\u80fd\u6709\u4e00\u4e2a\u53ef\u5f15\u5bfc\u78c1\u76d8 interface String body \u78c1\u76d8\u63a5\u53e3\u7c7b\u578b\uff0c\u78c1\u76d8\u63a5\u53e3\u7c7b\u578b\u4e00\u5171\u6709\u4e09\u79cd\uff1aIDE\u3001VIRTIO_SCSI\u3001VIRTIO readOnly Boolean body \u78c1\u76d8\u662f\u5426\u53ea\u8bfb\u3002 name String body \u78c1\u76d8\u522b\u540d\uff0c\u5df2\u5e9f\u5f03\u7684\u5b57\u6bb5\uff0c\u76ee\u524d\u4f7f\u7528alias\u5b57\u6bb5\u4ee3\u66ff\u3002 provisionedSize Long body \u78c1\u76d8\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3ab\u3002 alias String body \u78c1\u76d8\u522b\u540d\u3002 format String body \u5b9a\u78c1\u76d8\u683c\u5f0f\uff0c\u53ef\u9009\u7684\u78c1\u76d8\u683c\u5f0f\u6709RAW\u548cCOW\u3002 propagateErrors Boolean body \u662f\u5426\u4f20\u64ad\u9519\u8bef\u5230Guest\uff0c\u4f5c\u7528\u672a\u77e5\u3002 wipeAfterDelete Boolean body \u8868\u793a\u662f\u5426\u5728\u5220\u9664\u540e\u6e05\u7406\u3002 logicalName String body \u78c1\u76d8\u903b\u8f91\u540d\uff0c\u4f5c\u7528\u672a\u77e5\u3002 description String body \u78c1\u76d8\u63cf\u8ff0\u3002 lunStorage HostStorageModel body \u4ec5\u5728\u78c1\u76d8\u7c7b\u578b\u4e3alun\u65f6\u6709\u6548\uff0c\u8fd9\u91cc\u5148\u4e0d\u5c55\u5f00\u3002 usesScsiReservation Boolean body \u4ec5\u5728\u78c1\u76d8\u7c7b\u578b\u4e3alun\u65f6\u6709\u6548\uff0c\u4f5c\u7528\u672a\u77e5\u3002 sgio String body \u4ec5\u5728\u78c1\u76d8\u7c7b\u578b\u4e3alun\u65f6\u6709\u6548\uff0c\u53ef\u9009\u503c\u6709FILTERED\u548cUNFILTERED\uff0c\u4f5c\u7528\u672a\u77e5\u3002 imageId String body \u78c1\u76d8\u6240\u5728\u5377\u7684id\u3002 snapshot SnapshotModel body \u78c1\u76d8\u5feb\u7167\uff0c\u53ea\u9700\u8981\u6307\u5b9aSnapshotModel\u7684id\u5b57\u6bb5\uff0c\u6765\u6307\u5b9a\u78c1\u76d8\u5feb\u7167id\u3002 sparse Boolean body \u78c1\u76d8\u662f\u5426\u4e3a\u7cbe\u7b80\u5206\u914d\uff0ctrue\u4e3a\u7cbe\u7b80\u5206\u914d\uff0cfalse\u4e3a\u9884\u5206\u914d\u3002 storageDomains StorageDomains body \u4ee3\u8868\u78c1\u76d8\u6240\u5728\u7684\u5b58\u50a8\u57df\uff0cStorageDomains\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aStorageDomainModel\u96c6\u5408\u7684\u5f15\u7528storageDomains\u5b57\u6bb5\uff0c\u6307\u5b9a\u78c1\u76d8\u5b58\u50a8\u57df\u65f6\u53ea\u9700\u8981\u6307\u5b9a\u96c6\u5408\u4e2d\u4e00\u4e2aStorageDomainModel\u7684id\u5b57\u6bb5\u5373\u53ef\u3002 quota QuotaModel body \u78c1\u76d8\u914d\u989d\u6a21\u5f0f\uff0c\u53ea\u9700\u8981\u6307\u5b9aQuotaModel\u7684id\u5b57\u6bb5\u5373\u53ef\u3002 diskProfile DiskProfile body \u78c1\u76d8\u914d\u7f6e\u96c6\uff0c\u53ea\u9700\u8981\u6307\u5b9aDiskProfile\u7684id\u5b57\u6bb5\u5373\u53ef\u3002 \u8bf7\u6c42\uff1a PUT /acloudageks/api/vms/{vmid}/disks/{diskId} Body: { \"interface\": \"VIRTIO\", \"readOnly\": false, \"provisionedSize\": 2147483648, \"name\": \"update\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.4.8.\u66f4\u65b0\u865a\u62df\u673a\u78c1\u76d8\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#15","text":"\u4e0e 1.4 \u4e2d\u7684\u63a5\u53e3\u533a\u522b\u5728\u4e8e\u8fd4\u56de\u5bf9\u8c61\u7684\u5c5e\u6027\u4e0d\u540c\uff0c\u662f ovirt3.0 \u5230 ovirt4.0 \u7248\u672c\u53d8\u8fc1\u7684\u7ed3\u679c\uff0c\u4e0e 2.8 \u4e2d\u63a5\u53e3\u76f8\u6bd4\u7f3a\u5c11\u4e86\u90e8\u5206\u7684\u63a5\u53e3\u3002","title":"1.5.\u865a\u62df\u673a\u9644\u52a0\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#151","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e bootable Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u4f5c\u4e3a\u5c06\u78c1\u76d8\u4f5c\u4e3a\u53ef\u5f15\u5bfc\u78c1\u76d8\uff0c\u9ed8\u8ba4\u503c\u4e3afalse\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6bcf\u4e2a\u865a\u62df\u673a\u53ea\u80fd\u6709\u4e00\u4e2a\u53ef\u5f15\u5bfc\u78c1\u76d8 interface String body \u5fc5\u8981\u53c2\u6570\uff0c\u8868\u793a\u78c1\u76d8\u63a5\u53e3\u7c7b\u578b\uff0c\u78c1\u76d8\u63a5\u53e3\u7c7b\u578b\u4e00\u5171\u6709\u4e09\u79cd\uff1aIDE\u3001VIRTIO_SCSI\u3001VIRTIO\uff1b active Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u6fc0\u6d3b\u78c1\u76d8\uff0c\u9ed8\u8ba4\u503c\u4e3afalse disk DiskModel body \u5c01\u88c51.4.1\u4e2d\u7684\u5176\u4ed6\u53c2\u6570 \u8bf7\u6c42\uff1a \u9644\u52a0\u78c1\u76d8 POST /acloudageks/api/vms/{vmid}/diskattachments/ Body: { \"bootable\": false, \"interface\": \"IDE\", \"active\": true, \"disk\": { \"id\": \"220b052e-b0fe-4d6e-9412-a232d42342a9\", \"readOnly\": false, \"snapshot\": { \"id\": \"d764f497-85a7-4585-b6f7-6fa3e4f8b085\" } } } \u8bf7\u6c42\u7ed3\u679c\uff1a \u672a\u6dfb\u52a0 snapshot \u53c2\u6570\u65f6\u8bf7\u6c42\u6210\u529f\uff0c\u6dfb\u52a0\u540e\u8bf7\u6c42\u5931\u8d25\u3002 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"DiskModel [snapshot.id] required for attachDiskToVm\", \"reason\": \"Incomplete parameters\" } \u65b0\u5efa\u78c1\u76d8\u5e76\u9644\u52a0\u5230\u865a\u62df\u673a \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/diskattachments/ Body: { \"bootable\": false, \"interface\": \"IDE\", \"active\": false, \"disk\": { \"readOnly\": true, \"format\": \"RAW\", \"provisionedSize\": 1073741824 } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"DiskModel [provisionedSize|size, format] required for invoke0\", \"reason\": \"Incomplete parameters\" }","title":"1.5.1.\u6dfb\u52a0\u865a\u62df\u673a\u9644\u52a0\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#152","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/diskattachments \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.5.2.\u5217\u51fa\u865a\u62df\u673a\u6240\u6709\u9644\u52a0\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#153","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/diskattachments/{diskId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.5.3.\u83b7\u5f97\u865a\u62df\u673a\u6307\u5b9a\u7684\u9644\u52a0\u78c1\u76d8\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#154","text":"1.4.7\u7684\u5220\u9664\u63a5\u53e3 \u53ea\u80fd\u6267\u884c\u78c1\u76d8\u5206\u79bb\u64cd\u4f5c\uff0c\u4f46\u8be5\u63a5\u53e3\u53ef\u4ee5\u901a\u8fc7 detach_only \u53c2\u6570\u6765\u9009\u62e9\u5206\u79bb\u78c1\u76d8\u8fd8\u662f\u76f4\u63a5\u5220\u9664\u78c1\u76d8\u3002 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e detach_only Boolean url \u53ef\u9009\uff0c\u8868\u793a\u4ece\u865a\u62df\u673a\u5206\u79bb\u78c1\u76d8\u8fd8\u662f\u76f4\u63a5\u4ece\u7cfb\u7edf\u5220\u9664\u78c1\u76d8\uff0c\u9ed8\u8ba4\u503c\u4e3atrue \u8bf7\u6c42\uff1a DELETE /acloudageks/api/vms/{vmid}/disksattachments/{diskId}?detach_only=false \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.5.4.\u5220\u9664\u6216\u5206\u79bb\u865a\u62df\u673a\u9644\u52a0\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#155","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e bootable Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u4f5c\u4e3a\u5c06\u78c1\u76d8\u4f5c\u4e3a\u53ef\u5f15\u5bfc\u78c1\u76d8\uff0c\u9ed8\u8ba4\u503c\u4e3afalse\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6bcf\u4e2a\u865a\u62df\u673a\u53ea\u80fd\u6709\u4e00\u4e2a\u53ef\u5f15\u5bfc\u78c1\u76d8 interface String body \u5fc5\u8981\u53c2\u6570\uff0c\u8868\u793a\u78c1\u76d8\u63a5\u53e3\u7c7b\u578b\uff0c\u78c1\u76d8\u63a5\u53e3\u7c7b\u578b\u4e00\u5171\u6709\u4e09\u79cd\uff1aIDE\u3001VIRTIO_SCSI\u3001VIRTIO\uff1b active Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u6fc0\u6d3b\u78c1\u76d8\uff0c\u9ed8\u8ba4\u503c\u4e3afalse disk DiskModel body \u5c01\u88c51.4.1\u4e2d\u7684\u5176\u4ed6\u53c2\u6570 \u8bf7\u6c42\uff1a PUT /acloudageks/api/vms/{vmid}/disksattachments/{diskId} Body: { \"interface\": \"IDE\", \"disk\": { \"name\": \"update2\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.5.5.\u66f4\u65b0\u865a\u62df\u673a\u9644\u52a0\u78c1\u76d8\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#16","text":"","title":"1.6.\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#161","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u5fc5\u8981\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u540d\u3002 vnicProfile VnicProfileModel body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u7684\u914d\u7f6e\u96c6\uff0c\u8be5\u53c2\u6570\u53ea\u9700\u8981\u6307\u5b9aVnicProfileModel\u7684id\u5b57\u6bb5\uff0c\u9ed8\u8ba4\u503c\u4e3anull interface String body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u7f51\u5361\u7684\u63a5\u53e3\u7c7b\u578b\uff0c\u53ef\u9009\u7684\u503c\u4e00\u5171\u67096\u79cd\uff1aE1000\u3001VIRTIO\u3001RTL8139\u3001RTL8139_VIRTIO\u3001SPAPR_VLAN\u3001PCI_PASSTHROUGH\u3002\u9ed8\u8ba4\u503c\u4e3aRTL8139_VIRTIO\uff0c\u4f46\u662f\u8be5\u503c\u5728\u540e\u53f0\u6807\u8bb0\u4e3a\u5e9f\u5f03\u72b6\u6001\uff0c\u56e0\u6b64\u5efa\u8bae\u624b\u52a8\u8bbe\u7f6e\u8be5\u503c\uff1b\u53e6\u5916\u8be5\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u6709\u5173\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u7cfb\u7edf\u90fd\u80fd\u591f\u8bbe\u7f6e6\u79cd\u53ef\u9009\u503c mac MacModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7684mac\u5730\u5740\uff0c\u9700\u8981\u6307\u5b9aMacModel\u7684address\u5b57\u6bb5\u3002\u82e5\u672a\u8bbe\u7f6e\u6b64\u503c\uff0c\u540e\u53f0\u4f1a\u4ecemac\u5730\u5740\u6c60\u5206\u914d\u5408\u9002\u7684mac\u5730\u5740 linked Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u662f\u5426\u8fde\u63a5\u7f51\u7ebf\uff0c\u9ed8\u8ba4\u503c\u4e3afalse plugged Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u7684\u7f51\u5361\u662f\u5df2\u63d2\u5165\u8fd8\u662f\u62d4\u51fa\u72b6\u6001\uff0c\u9ed8\u8ba4\u503c\u4e3afalse \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/nics/ Body: { \"name\": \"test_nic\", \"vnicProfile\": { \"id\": \"86684825-e8f8-43bb-97b0-6972e99eaf47\" }, \"interface\": \"VIRTIO\", \"linked\": true, \"plugged\": true } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"NicModel [name] required for add\", \"reason\": \"Incomplete parameters\" }","title":"1.6.1.\u6dfb\u52a0\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#162","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/nics?max=1 \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.6.2.\u5217\u51fa\u865a\u62df\u673a\u6240\u6709\u7684\u7f51\u7edc\u63a5\u53e3"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#163","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/nics/{nicId}/activate Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.6.3.\u5c06\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u7f51\u5361\u8bbe\u7f6e\u4e3a\u63d2\u5165\u72b6\u6001"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#164","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/nics/{nicId}/deactivate Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.6.4.\u5c06\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u7f51\u5361\u8bbe\u7f6e\u4e3a\u62d4\u51fa\u72b6\u6001"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#165","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/nics/{nicId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.6.5.\u83b7\u5f97\u865a\u62df\u673a\u6307\u5b9a\u7684\u7f51\u7edc\u63a5\u53e3\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#166","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/vms/{vmid}/nics/{nicId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.6.6.\u5220\u9664\u6307\u5b9a\u7684\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#167","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 name String body \u4fee\u6539\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u540d\u3002 vnicProfile VnicProfileModel body \u4fee\u6539\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u7684\u914d\u7f6e\u96c6\uff0c\u8be5\u53c2\u6570\u53ea\u9700\u8981\u6307\u5b9aVnicProfileModel\u7684id\u5b57\u6bb5 interface String body \u4fee\u6539\u7f51\u5361\u7684\u63a5\u53e3\u7c7b\u578b\uff0c\u53ef\u9009\u7684\u503c\u4e00\u5171\u67096\u79cd\uff1aE1000\u3001VIRTIO\u3001RTL8139\u3001RTL8139_VIRTIO\u3001SPAPR_VLAN\u3001PCI_PASSTHROUGH\u3002\u9ed8\u8ba4\u503c\u4e3aRTL8139_VIRTIO\uff0c\u4f46\u662f\u8be5\u503c\u5728\u540e\u53f0\u6807\u8bb0\u4e3a\u5e9f\u5f03\u72b6\u6001\uff0c\u56e0\u6b64\u5efa\u8bae\u624b\u52a8\u8bbe\u7f6e\u8be5\u503c\uff1b\u53e6\u5916\u8be5\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u6709\u5173\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u7cfb\u7edf\u90fd\u80fd\u591f\u8bbe\u7f6e6\u79cd\u53ef\u9009\u503c mac MacModel body \u4fee\u6539\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u7684mac\u5730\u5740\uff0c\u9700\u8981\u6307\u5b9aMacModel\u7684address\u5b57\u6bb5\u3002 linked Boolean body \u4fee\u6539\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u662f\u5426\u8fde\u63a5\u7f51\u7ebf plugged Boolean body \u4fee\u6539\u865a\u62df\u673a\u7684\u7f51\u5361\u662f\u5df2\u63d2\u5165\u8fd8\u662f\u62d4\u51fa\u72b6\u6001 \u8bf7\u6c42\uff1a PUT /acloudageks/api/vms/{vmid}/nics/{nicId} Body: { \"name\": \"updated_nic\", \"vnicProfile\": { \"id\": \"86684825-e8f8-43bb-97b0-6972e99eaf47\" }, \"interface\": \"RTL8139\", \"linked\": false, \"plugged\": false } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.6.7.\u66f4\u65b0\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#_1","text":"\u865a\u62df\u673a\u7f51\u5361\u867d\u7136\u652f\u6301\u70ed\u63d2\u62d4\u529f\u80fd\uff0c\u4f46\u70ed\u63d2\u62d4\u529f\u80fd\u4ec5\u652f\u6301\u5177\u6709\u70ed\u63d2\u62d4\u64cd\u4f5c\u7684\u865a\u62df\u673a\u64cd\u4f5c\u7cfb\u7edf\u3002 \u793a\u4f8b\u64cd\u4f5c\u7cfb\u7edf\u5305\u62ec\uff1a Red Hat Enterprise Linux 6 Red Hat Enterprise Linux 5 Windows Server 2008 and Windows Server 2003","title":"\u6ce8\u610f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#17","text":"","title":"1.7.\u865a\u62df\u673a\u5feb\u7167"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#171","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e description String body \u5fc5\u8981\u53c2\u6570\uff0c\u5feb\u7167\u63cf\u8ff0\u3002 persistMemorystate Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u662f\u5426\u4fdd\u5b58\u865a\u62df\u673a\u5185\u5b58\u72b6\u6001\u4f5c\u4e3a\u5feb\u7167\u7684\u4e00\u90e8\u5206\uff0c\u9ed8\u8ba4\u503c\u4e3afalse diskAttachments DiskAttachments body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u9700\u8981\u521b\u5efa\u5feb\u7167\u7684\u78c1\u76d8\u5217\u8868\uff0cDiskAttachments\u5bf9\u8c61\u4e3aDiskAttachmentModel\u96c6\u5408\u7684\u6620\u5c04\u53ea\u6301\u6709DiskAttachment\u96c6\u5408\u7684\u5f15\u7528diskAttachments\u5b57\u6bb5\uff0c\u800cDiskAttachment\u5bf9\u8c61\u53c8\u6301\u6709DiskModel\u5bf9\u8c61\u7684\u5f15\u7528disk\u5b57\u6bb5\uff0c\u8be5\u53c2\u6570\u5e94\u8be5\u662f\u7528\u6765\u6307\u5b9a\u9700\u8981\u6253\u5feb\u7167\u78c1\u76d8\uff0c\u53ea\u8981\u8bbe\u7f6eDiskModel\u5bf9\u8c61\u7684id\u5b57\u6bb5\u5373\u53ef\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/snapshots Body: { \"description\": \"My snapshot\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"SnapshotModel [description] required for doAdd\", \"reason\": \"Incomplete parameters\" }","title":"1.7.1.\u521b\u5efa\u865a\u62df\u673a\u5feb\u7167"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#172","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u865a\u62df\u673a\u5feb\u7167\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/snapshots?max=1 \u8bf7\u6c42\u7ed3\u679c\uff1a\u672a\u521b\u5efa\u5feb\u7167\u65f6\uff0c\u8c03\u7528\u6210\u529f\uff1b\u5f53\u521b\u5efa\u5feb\u7167\u4ee5\u540e SecurityLevelMapper \u7684map\u65b9\u6cd5\u6267\u884c\u5931\u8d25\uff0c\u9700\u8981\u8fdb\u884c\u4ee5\u4e0b\u6539\u52a8\uff1a @Mapping(from = org.ovirt.engine.core.common.businessentities.SecurityLevel.class, to = SecurityLevel.class) public static SecurityLevel map(org.ovirt.engine.core.common.businessentities.SecurityLevel level) { if (level == null) { return com.phy.vms.api.model.SecurityLevel.NONE; } switch (level) { case LEVEL3: return com.phy.vms.api.model.SecurityLevel.LEVEL3; case LEVEL2: return com.phy.vms.api.model.SecurityLevel.LEVEL2; case LEVEL1: return com.phy.vms.api.model.SecurityLevel.LEVEL1; case LEVEL0: return com.phy.vms.api.model.SecurityLevel.LEVEL0; default: return com.phy.vms.api.model.SecurityLevel.NONE; } }","title":"1.7.2.\u5217\u51fa\u865a\u62df\u673a\u7684\u5feb\u7167"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#173","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/snapshots/{snapshotId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.7.3.\u83b7\u5f97\u865a\u62df\u673a\u6307\u5b9a\u7684\u5feb\u7167\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#174","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/vms/{vmid}/snapshots/{snapshotId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.7.4.\u5220\u9664\u865a\u62df\u673a\u6307\u5b9a\u7684\u5feb\u7167"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#175","text":"\u8be5\u63a5\u53e3\u5b9e\u9645\u4e0a\u6267\u884c\u4e86\u4e24\u6b65\u64cd\u4f5c\u3002\u9996\u5148\uff0c\u8fdb\u884c\u5feb\u7167\u9884\u89c8\uff0c\u5982\u679c\u672a\u51fa\u73b0\u5f02\u5e38\uff0c\u5219\u63a5\u7740\u8fdb\u884c\u9884\u89c8\u63d0\u4ea4\u64cd\u4f5c\uff1b\u5426\u5219\u8fd4\u56de\u5f02\u5e38\u4fe1\u606f\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e restoreMemory Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u6062\u590d\u5feb\u7167\u7684\u5185\u5b58\u72b6\u6001\uff0c\u9ed8\u8ba4\u503c\u4e3afalse disks Disks body \u53ef\u9009\u53c2\u6570\uff0cDisks\u5bf9\u8c61\u4e3aDiskModel\u96c6\u5408\u7684\u6620\u5c04\uff0cDisks\u5bf9\u8c61\u53ea\u6301\u6709DiskModel\u96c6\u5408\u7684\u5f15\u7528disks\u5b57\u6bb5\uff0c\u9700\u8981DiskModel\u7684\u5b8c\u6574\u7684\u4fe1\u606f\uff0c\u9ed8\u8ba4\u5bf9\u6240\u6709\u78c1\u76d8\u8fdb\u884c\u5feb\u7167\u9884\u89c8\u3002 \u8bf4\u660e\uff1a\u53c2\u6570\u4e2dDiskModel\u7684\u5b8c\u6574\u7684\u4fe1\u606f\u4e0d\u662f\u5f88\u5408\u7406\uff0c\u8fd9\u91cc\u5e94\u8be5\u6539\u4e3a\u53ea\u9700\u8981\u6307\u5b9aid\u5b57\u6bb5\u548cimageId\u5b57\u6bb5\u3002 ovirt4.3 \u4e2d\u7684\u903b\u8f91\u4e5f\u662f\u5982\u6b64\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/snapshots/{snapshotId}/restore Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.7.5.\u5c06\u865a\u62df\u673a\u6062\u590d\u5230\u6307\u5b9a\u5feb\u7167"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#18","text":"","title":"1.8\u6570\u636e\u4e2d\u5fc3"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#181","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u5fc5\u8981\u53c2\u6570\uff0c\u6570\u636e\u4e2d\u5fc3\u540d local Boolean body \u5fc5\u8981\u53c2\u6570\uff0c\u8868\u793a\u6570\u636e\u4e2d\u5fc3\u4f7f\u7528\u672c\u5730\u5b58\u50a8\u8fd8\u662f\u5171\u4eab\u5b58\u50a8\u3002 description String body \u53ef\u9009\u53c2\u6570\uff0c\u6570\u636e\u4e2d\u5fc3\u63cf\u8ff0\uff0c\u9ed8\u8ba4\u4e3a\u7a7a\uff08\"\"\uff09 quotaMode String body \u53ef\u9009\u53c2\u6570\uff0c\u6570\u636e\u4e2d\u5fc3\u7684\u914d\u989d\u7c7b\u578b\uff0c\u53ef\u9009\u7684\u914d\u989d\u7c7b\u578b\u4e00\u5171\u67093\u79cd\uff1aENABLED\uff08\u542f\u52a8\uff09\u3001DISABLED\uff08\u7981\u7528\uff09\u3001AUDIT\uff08\u5ba1\u8ba1\uff09\uff0c\u9ed8\u8ba4\u7684\u914d\u989d\u7c7b\u578b\u4e3aDISABLED macPool MacPoolModel body \u53ef\u9009\u53c2\u6570\uff0c\u6570\u636e\u4e2d\u5fc3\u7684mac\u5730\u5740\u6c60\u5bf9\u8c61\uff0c\u9700\u8981\u6307\u5b9aMacPoolModel\u7684id\u5b57\u6bb5 \u8bf7\u6c42\uff1a POST /acloudageks/api/datacenters Body: { \"name\": \"mydc\", \"local\": false, \"description\": \"test dc\", \"quotaMode\": \"DISABLED\", \"macPool\": { \"id\": \"5dd7d3e9-00ef-0112-03e6-0000000002cb\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"DataCenterModel [name] required for add\", \"reason\": \"Incomplete parameters\" }","title":"1.8.1.\u65b0\u5efa\u6570\u636e\u4e2d\u5fc3"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#182","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e case_sensitive Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u4e0esearch\u53c2\u6570\u4e00\u8d77\u4f7f\u7528\uff0c\u6307\u5b9a\u5728\u6267\u884csearch\u53c2\u6570\u65f6\u662f\u5426\u8003\u8651\u5927\u5c0f\u5199 filter Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6570\u636e\u4e2d\u5fc3\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u6570\u636e\u4e2d\u5fc3\u6570\u91cf search String url \u53ef\u9009\u53c2\u6570\uff0c\u67e5\u8be2\u7ea6\u675f\u6761\u4ef6\u7ea6\u675f\u8fd4\u56de\u4fe1\u606f\uff0c\u4f8b\u5982name=\"myname\" \u8bf7\u6c42\uff1a GET /acloudageks/api/datacenters \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.8.2.\u83b7\u5f97\u6240\u6709\u6570\u636e\u4e2d\u5fc3\u5217\u8868"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#183","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/datacenters/{datacenterId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.8.3.\u83b7\u5f97\u6307\u5b9a\u7684\u6570\u636e\u4e2d\u5fc3\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#184","text":"\u5220\u9664\u6570\u636e\u4e2d\u5fc3\u65f6\u5982\u679c\u6ca1\u6709\u6dfb\u52a0\u4efb\u4f55\u53c2\u6570\uff0c\u90a3\u4e48\u8fde\u63a5\u5230\u6570\u636e\u4e2d\u5fc3\u7684\u5b58\u50a8\u57df\u5c06\u88ab\u5206\u79bb\uff0c\u7136\u540e\u4ece\u5b58\u50a8\u4e2d\u5220\u9664\u3002\u5982\u679c\u6267\u884c\u6b64\u64cd\u4f5c\u65f6\u67d0\u4e9b\u64cd\u4f5c\u5931\u8d25\uff0c\u4f8b\u5982\uff0c\u5982\u679c\u6ca1\u6709\u4e3b\u673a\u53ef\u7528\u4e8e\u4ece\u5b58\u50a8\u4e2d\u5220\u9664\u5b58\u50a8\u57df\uff0c\u5219\u6574\u4e2a\u64cd\u4f5c\u5c06\u5931\u8d25\u3002 \u5982\u679cforce\u53c2\u6570\u4e3atrue\uff0c\u5219\u5220\u9664\u64cd\u4f5c\u65e0\u8bba\u5982\u4f55\u90fd\u4f1a\u6210\u529f\uff0c\u4f8b\u5982\uff0c\u5373\u4f7f\u5728\u5220\u9664\u4e00\u4e2a\u5b58\u50a8\u57df\u65f6\u67d0\u4e9b\u64cd\u4f5c\u5931\u8d25\u3002\u5931\u8d25\u7684\u64cd\u4f5c\u4f1a\u88ab\u5ffd\u7565\u8be5\uff0c\u5e76\u4e14\u4ece\u6570\u636e\u5e93\u4e2d\u5220\u9664\u6570\u636e\u4e2d\u5fc3\u7684\u4fe1\u606f\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e force Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u5f3a\u5236\u4ece\u6570\u636e\u5e93\u5220\u9664\u6570\u636e\u4e2d\u5fc3\u4fe1\u606f\uff0c\u5373\u4f7f\u5728\u5220\u9664\u8fc7\u7a0b\u4e2d\uff0c\u67d0\u4e9b\u64cd\u4f5c\u5931\u8d25\u4e86\uff0c\u9ed8\u8ba4\u503c\u4e3afalse \u8bf7\u6c42\uff1a DELETE /acloudageks/api/vms/{vmid}/datacenters/{datacenterId}?force=false \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.8.4\u5220\u9664\u6570\u636e\u4e2d\u5fc3"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#185","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u6570\u636e\u4e2d\u5fc3\u540d local Boolean body \u8bbe\u7f6e\u6570\u636e\u4e2d\u5fc3\u4f7f\u7528\u672c\u5730\u5b58\u50a8\u8fd8\u662f\u5171\u4eab\u5b58\u50a8\uff0c\u4f46\u662f\u4e00\u65e6\u6570\u636e\u4e2d\u5fc3\u9644\u52a0\u4e86\u5b58\u50a8\u57df\uff0c\u5c31\u65e0\u6cd5\u4fee\u6539\u8be5\u503c\u3002 description String body \u6570\u636e\u4e2d\u5fc3\u63cf\u8ff0 quotaMode String body \u914d\u989d\u7c7b\u578b\uff0c\u53ef\u9009\u7684\u914d\u989d\u7c7b\u578b\u4e00\u5171\u67093\u79cd\uff1aENABLED\uff08\u542f\u52a8\uff09\u3001DISABLED\uff08\u7981\u7528\uff09\u3001AUDIT\uff08\u5ba1\u8ba1\uff09 macPool MacPoolModel body \u6570\u636e\u4e2d\u5fc3\u7684mac\u5730\u5740\u6c60\u5bf9\u8c61\uff0c\u9700\u8981\u6307\u5b9aMacPoolModel\u7684id\u5b57\u6bb5 \u8bf7\u6c42\uff1a PUT /acloudageks/api/datacenters/{datacenterId} Body: { \"name\": \"updateDefault\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.8.5.\u66f4\u65b0\u6570\u636e\u4e2d\u5fc3\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#19","text":"","title":"1.9\u6570\u636e\u4e2d\u5fc3\u5b58\u50a8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#191","text":"\u53ef\u4ee5\u901a\u8fc7\u8be5\u63a5\u53e3\u9644\u52a0\u6240\u6709\u7c7b\u578b\u7684\u5b58\u50a8\u57df\uff0c\u5373\u6570\u636e\u57df\u3001iso\u57df\u548c\u5bfc\u51fa\u57df\uff1b\u4f46\u524d\u63d0\u6761\u4ef6\u662f\u8981\u9644\u52a0\u7684\u5b58\u50a8\u57df\u672a\u9644\u52a0\u5230\u4efb\u4f55\u6570\u636e\u4e2d\u5fc3\uff0c\u5e76\u4e14\u4e0e\u88ab\u9644\u52a0\u7684\u6570\u636e\u4e2d\u5fc3\u7684\u5b58\u50a8\u7c7b\u578b\u4ee5\u53ca\u5b58\u50a8\u683c\u5f0f\u5411\u5339\u914d\u3002 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e id String body \u53ef\u9009\u5fc5\u8981\u53c2\u6570\uff0c\u8981\u9644\u52a0\u5230\u6570\u636e\u4e2d\u5fc3\u7684\u5b58\u50a8\u57dfid\uff0c\u5fc5\u987b\u6307\u5b9aid\u6216\u8005name\u5b57\u6bb5\u4e2d\u7684\u4e00\u4e2a\uff0c\u82e5\u4e24\u8005\u90fd\u6307\u5b9a\uff0cid\u5b57\u6bb5\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8ename\u5b57\u6bb5\u3002 name String body \u53ef\u9009\u5fc5\u8981\u53c2\u6570\uff0c\u8981\u9644\u52a0\u5230\u6570\u636e\u4e2d\u5fc3\u7684\u5b58\u50a8\u57df\u540d\u5b57\uff0c\u5fc5\u987b\u6307\u5b9aid\u6216\u8005name\u5b57\u6bb5\u4e2d\u7684\u4e00\u4e2a\uff0c\u82e5\u4e24\u8005\u90fd\u6307\u5b9a\uff0cid\u5b57\u6bb5\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8ename\u5b57\u6bb5\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/datacenters/{datacenterId}/storagedomains Body: { \"name\": \"data\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"1.9.1.\u9644\u52a0\u5b58\u50a8\u57df\u5230\u6570\u636e\u4e2d\u5fc3"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#192","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u5b58\u50a8\u57df\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/datacenters/{datacenterId}/storagedomains?max=1 \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.9.2.\u83b7\u5f97\u6570\u636e\u4e2d\u5fc3\u6240\u6709\u7684\u9644\u52a0\u5b58\u50a8\u57df"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#193","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/datacenters/{datacenterId}/storagedomains/{storagedomainId}/deactivate Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.9.3.\u5c06\u6570\u636e\u4e2d\u5fc3\u6307\u5b9a\u7684\u5b58\u50a8\u57df\u8bbe\u7f6e\u4e3a\u7ef4\u62a4\u72b6\u6001"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#194","text":"\u53ea\u80fd\u6fc0\u6d3b\u72b6\u6001\u4e3a\u7ef4\u62a4\u7684\u5b58\u50a8\u57df\u3002 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/datacenters/{datacenterId}/storagedomains/{storagedomainId}/activate Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.9.4.\u5c06\u6570\u636e\u4e2d\u5fc3\u6307\u5b9a\u7684\u5b58\u50a8\u57df\u8bbe\u7f6e\u4e3a\u6fc0\u6d3b\u72b6\u6001"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#195","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/datacenters/{datacenterId}/storagedomains/{storagedomainId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"1.9.5.\u83b7\u5f97\u6570\u636e\u4e2d\u5fc3\u4fe1\u606f\u6307\u5b9a\u7684\u5b58\u50a8\u57df\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#196","text":"\u8981\u5206\u79bb\u6570\u636e\u4e2d\u5fc3\u7684\u5b58\u50a8\u57df\uff0c\u5fc5\u987b\u5148\u5c06\u5b58\u50a8\u57df\u7684\u8bbe\u7f6e\u4e3a\u7ef4\u62a4\u72b6\u6001\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/vms/{vmid}/datacenters/{datacenterId}/storagedomains/{storagedomainId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"1.9.6.\u4ece\u6570\u636e\u4e2d\u5fc3\u5206\u79bb\u5b58\u50a8\u57df"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#20","text":"","title":"2.0\u6570\u636e\u4e2d\u5fc3\u903b\u8f91\u7f51\u7edc"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#201","text":"\u5f53\u521b\u5efa\u903b\u8f91\u7f51\u7edc\u65f6\uff0c\u662f\u5fc5\u987b\u6307\u5b9a\u5176\u6240\u5c5e\u7684\u6570\u636e\u4e2d\u5fc3\u7684\uff1b\u901a\u8fc7\u8be5\u63a5\u53e3\u8c03\u7528\u903b\u8f91\u7f51\u7edc\u521b\u5efa\u63a5\u53e3\uff0c\u5b9e\u9645\u4e0a\u662f\u628a\u9700\u8981\u7684\u6570\u636e\u4e2d\u5fc3\u53c2\u6570\u653e\u5728url\u8fdb\u884c\u4f20\u9012\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u5fc5\u8981\u53c2\u6570\uff0c\u903b\u8f91\u7f51\u7edc\u540d description String body \u53ef\u9009\u53c2\u6570\uff0c\u903b\u8f91\u7f51\u7edc\u63cf\u8ff0 vlan VlanModel body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u8be5\u7f51\u7edc\u662f\u5426\u4e3avlan\uff0c\u53ea\u9700\u8981\u8bbe\u7f6evlan\u6807\u8bc6id\uff0cid\u4e3aInteger\u7c7b\u578b ip IpModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u903b\u8f91\u7f51\u7edc\u7684ip\u914d\u7f6e\uff0c\u62e5\u6709address\u5b57\u6bb5\u548cgateway\u5b57\u6bb5\uff0c\u76ee\u524d\u8fd8\u4e0d\u77e5\u9053\u8be5\u53c2\u6570\u6709\u4ec0\u4e48\u4f5c\u7528\uff0c\u901a\u8fc7ui\u754c\u9762\u65b0\u5efa\u903b\u8f91\u7f51\u7edc\u65f6\uff0c\u8fd9\u4e9b\u5b57\u6bb5\u90fd\u4e3a\u7a7a\u3002 usages NetworkUsageValues body \u53ef\u9009\u53c2\u6570\uff0c\u8be5\u5bf9\u8c61\u4e3aNetworkUsage\u96c6\u5408\u7684\u6620\u5c04\uff0c\u53ea\u6301\u6709NetworkUsage\u679a\u4e3e\u96c6\u5408\u7684\u5f15\u7528networkUsage\uff0c\u8be5\u53c2\u6570\u7528\u4e8e\u6307\u5b9a\u65b0\u5efa\u7684\u903b\u8f91\u7f51\u7edc\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u54ea\u4e9b\u7f51\u7edc\u4f7f\u7528\uff0c\u5305\u62ec\u4ee5\u4e0b\u56db\u79cd\uff1aDISPLAY\uff08\u663e\u793a\u7f51\u7edc\uff09\u3001MANAGEMENT\uff08\u7ba1\u7406\u7f51\u7edc\uff09\u3001MIGRATION\uff08\u8fc1\u79fb\u7f51\u7edc\uff09\u3001VM\uff08\u865a\u62df\u673a\u7f51\u7edc\uff09\u3002\u5176\u4e2d\u524d\u4e09\u79cd\u662f\u76f8\u5bf9\u4e8e\u96c6\u7fa4\u7684\uff08\u8fd9\u4e09\u79cd\u7f51\u7edc\u5bf9\u4e8e\u96c6\u7fa4\u6765\u8bf4\u90fd\u662f\u5fc5\u987b\u7684\uff0c\u8bbe\u7f6e\u7684\u76ee\u7684\u662f\u662f\u5426\u628a\u5f53\u524d\u7684\u903b\u8f91\u7f51\u7edc\u4f5c\u4e3a\u96c6\u7fa4\u7684\u67d0\u79cd\u6216\u591a\u79cd\u7f51\u7edc\uff09\uff0c\u6700\u540e\u4e00\u79cd\u662f\u76f8\u5bf9\u4e8e\u865a\u62df\u673a\u7684\uff08\u5373\u8be5\u7f51\u7edc\u662f\u5426\u80fd\u4f5c\u4e3a\u865a\u62df\u673a\u7684\u901a\u4fe1\u7f51\u7edc\uff09\u3002\u7531\u4e8e\u5728\u6570\u636e\u4e2d\u5fc3\u65e0\u6cd5\u8bbe\u7f6e\u96c6\u7fa4\u76f8\u5173\u5185\u5bb9\uff0c\u53ea\u80fd\u8bbe\u7f6e\u8be5\u7f51\u7edc\u662f\u5426\u4e3a\u865a\u62df\u673a\u7f51\u7edc\uff1b\u8bbe\u7f6e\u975e\u865a\u62df\u673a\u7f51\u7edc\u7684\u65b9\u6cd5\u4e3a\u5728NetworkUsageValues\u5217\u8868\u4e2d\u6dfb\u52a0\u4efb\u4e00\u975eVM\u7f51\u7edc\u5373\u53ef\uff1b\u4e0d\u8bbe\u7f6e\u8be5\u503c\u65f6\uff0c\u9ed8\u8ba4\u8be5\u7f51\u7edc\u4e3a\u865a\u62df\u673a\u7f51\u7edc\u3002 mtu Integer body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u903b\u8f91\u7f51\u7edc\u7684\u6700\u5927\u4f20\u8f93\u5355\u5143\uff0c\u9ed8\u8ba4\u503c\u4e3a0\uff0c\u8be5\u503c\u6709\u8303\u56f4\u8981\u6c42\u5fc5\u987b\u7b49\u4e8e0\u6216\u8005\u5927\u4e8e\u7b49\u4e8e68\u4e14\u5c0f\u4e8e\u7b49\u4e8e4094 profileRequired Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u9700\u8981\u521b\u5efa\u9ed8\u8ba4\u7684\u7f51\u7edc\u914d\u7f6e\u96c6\uff0c\u9ed8\u8ba4\u503c\u4e3afalse qos QosModel body \u53ef\u9009\u53c2\u6570\uff0c\u8bbe\u7f6e\u903b\u8f91\u7f51\u7edc\u7684\u8d28\u91cf\u670d\u52a1\uff0c\u9700\u8981\u6307\u5b9aQosModel\u7684id\u5b57\u6bb5 \u8bf7\u6c42\uff1a POST /acloudageks/api/datacenters/{datacenterId}/networks Body: { \"name\": \"mynetwork\", \"description\": \"test dc network\", \"vlan\": { \"id\": 6342 }, \"usages\": { \"networkUsage\": [ \"DISPLAY\" ] }, \"mtu\": 1500, \"profileRequired\": false } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"NetworkModel [name] required for add\", \"reason\": \"Incomplete parameters\" }","title":"2.0.1.\u4e3a\u6570\u636e\u4e2d\u5fc3\u521b\u5efa\u903b\u8f91\u7f51\u7edc"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#202","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/datacenters/{datacenterId}/networks \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.0.2.\u5217\u51fa\u6570\u636e\u4e2d\u5fc3\u6240\u6709\u7684\u903b\u8f91\u7f51\u7edc"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#203","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/datacenters/{datacenterId}/networks/{networkId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.0.3.\u83b7\u5f97\u6570\u636e\u4e2d\u5fc3\u6307\u5b9a\u7684\u903b\u8f91\u7f51\u7edc"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#204","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/datacenters/{datacenterId}/networks/{networkId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.0.4.\u5220\u9664\u6570\u636e\u4e2d\u5fc3\u6307\u5b9a\u7684\u903b\u8f91\u7f51\u7edc"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#205","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u903b\u8f91\u7f51\u7edc\u540d description String body \u903b\u8f91\u7f51\u7edc\u63cf\u8ff0 vlan VlanModel body \u8bbe\u7f6e\u8be5\u7f51\u7edc\u662f\u5426\u4e3avlan\uff0c\u53ea\u9700\u8981\u8bbe\u7f6evlan\u6807\u8bc6id\uff0cid\u4e3aInteger\u7c7b\u578b usages NetworkUsageValues body \u8be5\u5bf9\u8c61\u4e3aNetworkUsage\u96c6\u5408\u7684\u6620\u5c04\uff0c\u53ea\u6301\u6709NetworkUsage\u679a\u4e3e\u96c6\u5408\u7684\u5f15\u7528networkUsage\uff0c\u8be5\u53c2\u6570\u7528\u4e8e\u6307\u5b9a\u65b0\u5efa\u7684\u903b\u8f91\u7f51\u7edc\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u54ea\u4e9b\u7f51\u7edc\u4f7f\u7528\uff0c\u5305\u62ec\u4ee5\u4e0b\u56db\u79cd\uff1aDISPLAY\uff08\u663e\u793a\u7f51\u7edc\uff09\u3001MANAGEMENT\uff08\u7ba1\u7406\u7f51\u7edc\uff09\u3001MIGRATION\uff08\u8fc1\u79fb\u7f51\u7edc\uff09\u3001VM\uff08\u865a\u62df\u673a\u7f51\u7edc\uff09\u3002\u5176\u4e2d\u524d\u4e09\u79cd\u662f\u76f8\u5bf9\u4e8e\u96c6\u7fa4\u7684\uff08\u8fd9\u4e09\u79cd\u7f51\u7edc\u5bf9\u4e8e\u96c6\u7fa4\u6765\u8bf4\u90fd\u662f\u5fc5\u987b\u7684\uff0c\u8bbe\u7f6e\u7684\u76ee\u7684\u662f\u662f\u5426\u628a\u5f53\u524d\u7684\u903b\u8f91\u7f51\u7edc\u4f5c\u4e3a\u96c6\u7fa4\u7684\u67d0\u79cd\u6216\u591a\u79cd\u7f51\u7edc\uff09\uff0c\u6700\u540e\u4e00\u79cd\u662f\u76f8\u5bf9\u4e8e\u865a\u62df\u673a\u7684\uff08\u5373\u8be5\u7f51\u7edc\u662f\u5426\u80fd\u4f5c\u4e3a\u865a\u62df\u673a\u7684\u901a\u4fe1\u7f51\u7edc\uff09\u3002\u7531\u4e8e\u5728\u6570\u636e\u65e0\u6cd5\u8bbe\u7f6e\u96c6\u7fa4\u76f8\u5173\u5185\u5bb9\uff0c\u53ea\u80fd\u8bbe\u7f6e\u8be5\u7f51\u7edc\u662f\u5426\u4e3a\u865a\u62df\u673a\u7f51\u7edc\uff1b\u8bbe\u7f6e\u975e\u865a\u62df\u673a\u7f51\u7edc\u7684\u65b9\u6cd5\u4e3a\u5728NetworkUsageValues\u5217\u8868\u4e2d\u6dfb\u52a0\u4efb\u4e00\u975eVM\u7f51\u7edc\u5373\u53ef\uff1b\u4e0d\u8bbe\u7f6e\u8be5\u503c\u65f6\uff0c\u9ed8\u8ba4\u8be5\u7f51\u7edc\u4e3a\u865a\u62df\u673a\u7f51\u7edc\u3002 mtu Integer body \u903b\u8f91\u7f51\u7edc\u7684\u6700\u5927\u4f20\u8f93\u5355\u5143\uff0c\u9ed8\u8ba4\u503c\u4e3a0\uff0c\u8be5\u503c\u6709\u8303\u56f4\u8981\u6c42\u5fc5\u987b\u7b49\u4e8e0\u6216\u8005\u5927\u4e8e\u7b49\u4e8e68\u4e14\u5c0f\u4e8e\u7b49\u4e8e4094 qos QosModel body \u8bbe\u7f6e\u903b\u8f91\u7f51\u7edc\u7684\u8d28\u91cf\u670d\u52a1\uff0c\u9700\u8981\u6307\u5b9aQosModel\u7684id\u5b57\u6bb5 \u8bf7\u6c42\uff1a PUT /acloudageks/api/datacenters/{datacenterId}/networks/{networkId} Body: { \"name\": \"mynetwork\", \"description\": \"test dc network update\", \"vlan\": { \"id\": null }\uff0c \"usages\": { \"networkUsage\": [ \"DISPLAY\" ] }, \"mtu\": 68 } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.0.5.\u66f4\u65b0\u6570\u636e\u4e2d\u5fc3\u6307\u5b9a\u7684\u903b\u8f91\u7f51\u7edc\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#21qos","text":"\u670d\u52a1\u8d28\u91cf\u76f8\u5173\u7684\u63a5\u53e3\u5df2\u7ecf\u88ab\u5220\u9664\uff0c\u63a8\u6d4b\u53ef\u80fd\u662f\u5220quota\u76f8\u5173\u7684\u63a5\u53e3\u65f6\uff0c\u9519\u5220\u4e86qos\u63a5\u53e3\uff0c\u7559\u4e0b\u4e86quota\u63a5\u53e3\u3002","title":"2.1\u8d28\u91cf\u670d\u52a1\uff08qos\uff09"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#22","text":"","title":"2.2\u96c6\u7fa4"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#221","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u5fc5\u8981\u53c2\u6570\uff0c\u96c6\u7fa4\u540d dataCenter DataCenterModel body \u5fc5\u8981\u53c2\u6570\uff0c\u8868\u793a\u96c6\u7fa4\u6240\u5c5e\u7684\u6570\u636e\u4e2d\u5fc3\uff0c\u9700\u8981\u6307\u5b9a\u6570\u636e\u4e2d\u5fc3name\u6216\u8005id\u5b57\u6bb5 cpu CpuModel body \u5fc5\u8981\u53c2\u6570\uff0c\u53ef\u4ee5\u8bbe\u7f6e architecture \u5b57\u6bb5\uff08\u4ee3\u8868\u96c6\u7fa4cpu\u67b6\u6784\uff09\u548c type \u5b57\u6bb5\uff08\u4ee3\u8868\u96c6\u7fa4\u7684cpu\u7c7b\u578b\uff09\uff0c\u901a\u5e38\u53ea\u9700\u8981\u8bbe\u7f6etype\u5373\u53ef\uff0c\u56e0\u4e3acpu\u67b6\u6784\u4f1a\u6839\u636e\u8bbe\u7f6e\u7684cpu\u7c7b\u578b\u8fdb\u884c\u8bbe\u7f6e\uff0c\u5373\u4f7f\u8bbe\u7f6e\u4e86\u9519\u8befcpu\u67b6\u6784\uff0c\u4e5f\u4f1a\u6839\u636ecpu\u7c7b\u578b\u8fdb\u884c\u7ea0\u6b63\u3002\u53ef\u9009\u7684cpu\u67b6\u6784\u6709x86_64\u548cppc64\u3002ppc64\u4e0b\u53ef\u9009\u7684cpu\u7c7b\u578b\u53ea\u6709 IBM POWER8 \uff1b\u800cx86_64\u67b6\u6784\u4e0bcpu\u7c7b\u578b\u8f83\u591a\uff0c\u5305\u62ecAMD\u548c\u56e0\u7279\u5c14CPU\u5bb6\u65cf\uff0c\u5e38\u89c1\u7684\u6709 Intel SandyBridge Family \u3001 AMD Opteron G2 \u7b49\u3002 managementNetwork NetworkModel body \u5fc5\u8981\u53c2\u6570\uff0c\u7528\u4e8e\u8bbe\u7f6e\u96c6\u7fa4\u7684\u7ba1\u7406\u7f51\u7edc\uff0c\u9700\u8981\u6307\u5b9a\u903b\u8f91\u7f51\u7edc\u7684id\u6216\u8005name\u5b57\u6bb5 description String body \u53ef\u9009\u53c2\u6570\uff0c\u96c6\u7fa4\u63cf\u8ff0 switchType String body \u53ef\u9009\u53c2\u6570\uff0c\u96c6\u7fa4\u4ea4\u6362\u673a\u7c7b\u578b\uff0c\u53ef\u9009\u7684\u4ea4\u6362\u673a\u7c7b\u578b\u67092\u79cd\uff1aLEGACY\u3001OVS\uff0c\u9ed8\u8ba4\u503c\u4e3aLEGACY threadsAsCores Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u96c6\u7fa4\u4f18\u5316\u7b56\u7565\uff0c\u662f\u5426\u5c06\u4e3b\u673a\u7ebf\u7a0b\u4f5c\u4e3a\u865a\u62df\u673acpu\u5185\u6838\uff0c\u9ed8\u8ba4\u503c\u4e3afalse migration MigrationOptionsModel body \u53ef\u9009\u53c2\u6570\uff0cMigrationOptionsModel\u7684\u51e0\u4e2a\u5c5e\u6027\u6620\u5c04\u4e86\u96c6\u7fa4\u865a\u62df\u673a\u8fc1\u79fb\u7b56\u7565\u76843\u4e2a\u65b9\u9762\u30021. policy \u5b57\u6bb5\u662fMigrationPolicyModel\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u96c6\u7fa4\u7684\u8fc1\u79fb\u7b56\u7565\uff0c\u96c6\u7fa4\u53ef\u9009\u7684\u8fc1\u79fb\u7b56\u7565\u4e00\u5171\u67093\u79cd\uff1aLegacy\uff08id\u4e3a00000000-0000-0000-0000-000000000000\uff09\u3001Minimal downtime\uff08id\u4e3a80554327-0569-496b-bdeb-fcbbf52b827b\uff09\u548cSuspend workload if needed\uff08id\u4e3a80554327-0569-496b-bdeb-fcbbf52b827c\uff09\uff0c\u5176\u4e2dLegacy\u53ea\u8bbe\u7f6e\u4e86\u6700\u5927\u7684\u8fc1\u79fb\u6570\u91cf\u4e3a2\uff0c\u800c\u53e6\u59162\u79cd\u9009\u9879\u7684\u8be6\u7ec6\u914d\u7f6e\u89c1 vdc_optins \u8868\u7684 MigrationPolicies \u9009\u9879\uff0c\u8fc1\u79fb\u7b56\u7565\u9700\u8981\u8bbe\u7f6eMigrationPolicyModel\u5bf9\u8c61\u7684id\u5b57\u6bb5\uff0c\u9ed8\u8ba4\u503c\u4e3anull\uff1b2. bandwidth \u5b57\u6bb5\u662fMigrationBandwidthModel\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u96c6\u7fa4\u8fc1\u79fb\u5e26\u5bbd\u9650\u5236\uff0c\u7531MigrationBandwidthModel\u7684 assignmentMethod \u5b57\u6bb5\u8bbe\u7f6e\uff0c\u53ef\u9009\u7684\u9650\u5236\u67093\u79cd\uff1aAUTO\u3001HYPERVISOR_DEFAULT\u4ee5\u53caCUSTOM\uff0c\u9ed8\u8ba4\u503c\u4e3aAUTO\u3002\u5f53\u9009\u62e9\u7684\u9650\u5236\u4e3aCUSTOM\u65f6\uff0c\u9700\u8981\u8bbe\u7f6eMigrationBandwidthModel\u7684 customValue \u5b57\u6bb5\u5bf9\u5e26\u5bbd\u8fdb\u884c\u9650\u5236\uff08\u5355\u4f4d\u4e3aMbps\uff09\uff0c\u8be5\u503c\u53ef\u4ee5\u8bbe\u7f6e\u7684\u6700\u5c0f\u503c\u4e3a1\u30023. autoConverge \u5b57\u6bb5\u548c compressed \u5b57\u6bb5\uff0c\u5206\u522b\u8868\u793a\u662f\u5426\u81ea\u52a8\u805a\u5408\u8fc1\u79fb\u4ee5\u53ca\u662f\u5426\u542f\u7528\u8fc1\u79fb\u538b\u7f29\u3002\u53ea\u6709\u5728\u8fc1\u79fb\u7b56\u7565\u4e3a Legacy \u65f6\uff0c\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u5728\u865a\u62df\u673a\u8fc1\u79fb\u8fc7\u7a0b\u4e2d\u624d\u4f1a\u751f\u6548\uff0c\u5b83\u4eec\u7684\u53ef\u9009\u503c\u6709\u4e09\u79cd\uff1aTRUE\u3001FALSE\u3001INHERIT\uff08\u8868\u793a\u4ece\u5168\u5c40\u8bbe\u7f6e\u7ee7\u627f\uff09\uff0c\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u4e3anull\u3002 errorHandling ErrorHandlingModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u96c6\u7fa4\u865a\u62df\u673a\u8fc1\u79fb\u7684\u5f39\u6027\u7b56\u7565\uff0c\u5373\u5f53\u67d0\u53f0\u4e3b\u673a\u5b95\u673a\uff0c\u4e3b\u673a\u4e0a\u7684\u865a\u62df\u673a\u5982\u4f55\u5904\u7406\u7684\u7b56\u7565\u3002ErrorHandlingModel\u7684 onError \u5b57\u6bb5\u4ee3\u8868\u4e86\u5f39\u6027\u7b56\u7565\uff0c\u53ef\u9009\u503c\u67093\u79cd\uff1aMIGRATE\uff08\u8fc1\u79fb\u6240\u6709\u7684\u865a\u62df\u673a\uff09\u3001DO_NOT_MIGRATE\uff08\u4e0d\u8fc1\u79fb\u865a\u62df\u673a\uff09\u3001MIGRATE_HIGHLY_AVAILABLE\uff08\u53ea\u8fc1\u79fb\u9ad8\u53ef\u7528\u865a\u62df\u673a\uff09\u3002\u5982\u679c\u4e0d\u8bbe\u7f6e\u8be5\u503c\uff0c\u90a3\u4e48\u4f1a\u6839\u636e\u96c6\u7fa4\u7684cpu\u67b6\u6784\u662f\u5426\u652f\u6301\u8fc1\u79fb\u81ea\u52a8\u8bbe\u7f6e\u4e3a\u8fc1\u79fb\u6240\u6709\u7684\u865a\u62df\u673a\u6216\u4e0d\u8fc1\u79fb\u865a\u62df\u673a\u3002 schedulingPolicy SchedulingPolicyModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u96c6\u7fa4\u7684\u8c03\u5ea6\u7b56\u7565\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u8c03\u5ea6\u7b56\u7565\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\uff0cid\u5b57\u6bb5\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8ename\u5b57\u6bb5\u3002\u5185\u7f6e\u7684\u8c03\u5ea6\u7b56\u7565\u6709\u4ee5\u4e0b\u51e0\u79cd\uff0c\u683c\u5f0f\u4e3a name(id) \uff1a\u5e38\u89c4\u6a21\u5f0f\uff08b4ed2332-a7ac-4d5f-9596-99a439cb2812\uff09\u3001\u8282\u7535\u6a21\u5f0f\uff085a2b0939-7d46-4b73-a469-e9c2c7fc6a53\uff09\u3001\u865a\u62df\u673a\u5747\u5300\u5206\u5e03\u6a21\u5f0f\uff088d5d7bec-68de-4a67-b53e-0ac54686d579\uff09\u3001\u8d44\u6e90\u5747\u5300\u5206\u5e03\u6a21\u5f0f\uff0820d25257-b4bd-4589-92a6-c4c5c5d3fd1a\uff09\uff0c\u5177\u4f53\u914d\u7f6e\u6211\u4e5f\u770b\u4e0d\u61c2\uff0c\u5177\u4f53\u4fe1\u606f\u5b9a\u4e49\u5728 InternalClusterPolicies \u7c7b\u4e2d\u3002\u5982\u679c\u901a\u8fc7id\u548cname\u90fd\u6ca1\u627e\u5230\u5339\u914d\u7684\u8c03\u5ea6\u7b56\u7565\u5219\u4f7f\u7528\u9ed8\u8ba4\u7684\u8c03\u5ea6\u7b56\u7565\uff0c\u9ed8\u8ba4\u8c03\u5ea6\u7b56\u7565\u4e3a\u5e38\u89c4\u6a21\u5f0f\u3002 customSchedulingPolicyProperties Properties body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u8c03\u5ea6\u7b56\u7565\u7684\u53ef\u8986\u76d6\u5c5e\u6027\uff0c\u53ef\u4ee5\u5bf9\u8c03\u5ea6\u7b56\u7565\u7684\u5c5e\u6027\u8fdb\u884c\u8986\u76d6\u3002Properties\u5bf9\u8c61\u662fPropertyModel\u5bf9\u8c61\u96c6\u5408\u7684\u6620\u5c04\uff0c\u8be5\u5bf9\u8c61\u53ea\u6301\u6709\u96c6\u5408\u5f15\u7528\u5b57\u6bb5properties\uff0c\u9700\u8981\u8986\u76d6\u7684\u5c5e\u6027\u53ef\u4ee5\u8bbe\u7f6ePropertyModel\u5bf9\u8c61\u7684name\u548cvalue\u5b57\u6bb5\u3002 trustedService Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u542f\u52a8\u53ef\u4fe1\u670d\u52a1\uff0c\u9ed8\u8ba4\u503c\u4e3afalse haReservation Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u542f\u52a8\u9ad8\u53ef\u7528\u6027\u8d44\u6e90\u9884\u7559\uff0c\u9ed8\u8ba4\u503c\u4e3afalse fencingPolicy FencingPolicyModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u96c6\u7fa4\u9694\u79bb\u7b56\u7565\u7684\u51e0\u4e2a\u65b9\u9762\u30021. enabled \u5b57\u6bb5\u8868\u793a\u662f\u5426\u5f00\u542f\u96c6\u7fa4\u9694\u79bb\u7b56\u7565\uff0c\u53ea\u6709\u5f00\u542f\u96c6\u7fa4\u7b56\u7565\u4ee5\u540e\u5176\u4ed6\u5b57\u6bb5\u624d\u80fd\u751f\u6548\u30022. skipIfSdActive \u5b57\u6bb5\u662fSkipIfSdActive\u5bf9\u8c61\u7684\u5f15\u7528\uff0cSkipIfSdActive\u5bf9\u8c61\u7684 enable \u5b57\u6bb5\u8868\u793a\u662f\u5426\u5728\u4e3b\u673a\u50a8\u5b58\u4e0a\u6709\u5b9e\u65f6\u79df\u7ea6\u65f6\uff0c\u5ffd\u7565\u9694\u79bb\u64cd\u4f5c\u30023. skipIfConnectivityBroken \u5b57\u6bb5\u662fSkipIfConnectivityBroken\u5bf9\u8c61\u5f15\u7528\uff0c\u8be5\u5bf9\u8c61\u62e5\u6709 enable \u5b57\u6bb5\u548c threshold \u5b57\u6bb5\uff0cenable\u5b57\u6bb5\u8868\u793a\u662f\u5426\u5728\u4e3b\u673a\u5b58\u5728\u95ee\u9898\u7684\u8fde\u63a5\u8fbe\u5230\u9608\u503c\u65f6\u5ffd\u7565\u9694\u79bb\u64cd\u4f5c\uff0c\u800cthreshold\u5219\u662f\u5bf9\u9608\u503c\u8fdb\u884c\u8bbe\u7f6e\u3002\u5f53\u672a\u8bbe\u7f6eFencingPolicyModel\u5bf9\u8c61\u65f6\uff0c\u96c6\u7fa4\u9ed8\u8ba4\u542f\u52a8\u9694\u79bb\u7b56\u7565\uff0c\u5e76\u4e14\u5173\u95ed2\u548c3\u4e24\u4e2a\u8bbe\u7f6e\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/clusters Body: { \"name\": \"cluster\", \"dataCenter\": { \"name\": \"Default\" }, \"cpu\": { \"type\": \"Intel Penryn Family\" }, \"managementNetwork\": { \"id\": \"00000000-0000-0000-0000-000000000009\" }, \"description\": \"test creat cluster\", \"switchType\": \"LEGACY\", \"migration\": { \"policy\": { \"id\": \"80554327-0569-496b-bdeb-fcbbf52b827b\" }, \"bandwidth\": { \"assignmentMethod\": \"CUSTOM\", \"customValue\": 1234 } }, \"errorHandling\": { \"onError\": \"MIGRATE_HIGHLY_AVAILABLE\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"ClusterModel [name, dataCenter.name|id] required for add\", \"reason\": \"Incomplete parameters\" }","title":"2.2.1.\u521b\u5efa\u96c6\u7fa4"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#222","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e case_sensitive Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u4e0esearch\u53c2\u6570\u4e00\u8d77\u4f7f\u7528\uff0c\u6307\u5b9a\u5728\u6267\u884csearch\u53c2\u6570\u65f6\u662f\u5426\u8003\u8651\u5927\u5c0f\u5199 filter Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u96c6\u7fa4\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u96c6\u7fa4\u6570\u91cf search String url \u53ef\u9009\u53c2\u6570\uff0c\u67e5\u8be2\u7ea6\u675f\u6761\u4ef6\u7ea6\u675f\u8fd4\u56de\u4fe1\u606f\uff0c\u4f8b\u5982name=\"myname\" \u8bf7\u6c42\uff1a GET /acloudageks/api/clusters \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.2.2.\u83b7\u5f97\u6240\u6709\u7684\u96c6\u7fa4\u5217\u8868"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#223","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e filter Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u96c6\u7fa4\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 \u8bf7\u6c42\uff1a GET /acloudageks/api/clusters/{clustersId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.2.3.\u83b7\u5f97\u6307\u5b9a\u7684\u96c6\u7fa4\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#224","text":"\u5220\u9664\u96c6\u7fa4\u524d\uff0c\u5fc5\u987b\u4fdd\u8bc1\u96c6\u7fa4\u4e2d\u4e0d\u5b58\u5728\u865a\u62df\u673a\u548c\u4e3b\u673a \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/clusters/{clustersId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.2.4.\u5220\u9664\u6307\u5b9a\u7684\u96c6\u7fa4"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#225","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/clusters/{clustersId}/resetemulatedmachine Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.2.5.\u5f3a\u5236\u91cd\u7f6e\u4eff\u771f\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#226","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u5fc5\u8981\u53c2\u6570\uff0c\u96c6\u7fa4\u540d cpu CpuModel body \u53ef\u4ee5\u4fee\u6539 architecture \u5b57\u6bb5\uff08\u4ee3\u8868\u96c6\u7fa4cpu\u67b6\u6784\uff09\u548c type \u5b57\u6bb5\uff08\u4ee3\u8868\u96c6\u7fa4\u7684cpu\u7c7b\u578b\uff09\uff0c\u901a\u5e38\u53ea\u9700\u8981\u8bbe\u7f6etype\u5373\u53ef\uff0c\u56e0\u4e3acpu\u67b6\u6784\u4f1a\u6839\u636e\u8bbe\u7f6e\u7684cpu\u7c7b\u578b\u8fdb\u884c\u8bbe\u7f6e\uff0c\u5373\u4f7f\u8bbe\u7f6e\u4e86\u9519\u8befcpu\u67b6\u6784\uff0c\u4e5f\u4f1a\u6839\u636ecpu\u7c7b\u578b\u8fdb\u884c\u7ea0\u6b63\u3002\u53ef\u9009\u7684cpu\u67b6\u6784\u6709x86_64\u548cppc64\u3002ppc64\u4e0b\u53ef\u9009\u7684cpu\u7c7b\u578b\u53ea\u6709 IBM POWER8 \uff1b\u800cx86_64\u67b6\u6784\u4e0bcpu\u7c7b\u578b\u8f83\u591a\uff0c\u5305\u62ecAMD\u548c\u56e0\u7279\u5c14CPU\u5bb6\u65cf\uff0c\u5e38\u89c1\u7684\u6709 Intel SandyBridge Family \u3001 AMD Opteron G2 \u7b49\u3002 description String body \u96c6\u7fa4\u63cf\u8ff0 switchType String body \u96c6\u7fa4\u4ea4\u6362\u673a\u7c7b\u578b\uff0c\u53ef\u9009\u7684\u4ea4\u6362\u673a\u7c7b\u578b\u67092\u79cd\uff1aLEGACY\u3001OVS\uff0c\u9ed8\u8ba4\u503c\u4e3aLEGACY threadsAsCores Boolean body \u96c6\u7fa4\u4f18\u5316\u7b56\u7565\uff0c\u662f\u5426\u5c06\u4e3b\u673a\u7ebf\u7a0b\u4f5c\u4e3a\u865a\u62df\u673acpu\u5185\u6838 migration MigrationOptionsModel body MigrationOptionsModel\u7684\u51e0\u4e2a\u5c5e\u6027\u6620\u5c04\u4e86\u96c6\u7fa4\u865a\u62df\u673a\u8fc1\u79fb\u7b56\u7565\u76843\u4e2a\u65b9\u9762\u30021. policy \u5b57\u6bb5\u662fMigrationPolicyModel\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u96c6\u7fa4\u7684\u8fc1\u79fb\u7b56\u7565\uff0c\u96c6\u7fa4\u53ef\u9009\u7684\u8fc1\u79fb\u7b56\u7565\u4e00\u5171\u67093\u79cd\uff1aLegacy\uff08id\u4e3a00000000-0000-0000-0000-000000000000\uff09\u3001Minimal downtime\uff08id\u4e3a80554327-0569-496b-bdeb-fcbbf52b827b\uff09\u548cSuspend workload if needed\uff08id\u4e3a80554327-0569-496b-bdeb-fcbbf52b827c\uff09\uff0c\u5176\u4e2dLegacy\u53ea\u8bbe\u7f6e\u4e86\u6700\u5927\u7684\u8fc1\u79fb\u6570\u91cf\u4e3a2\uff0c\u800c\u53e6\u59162\u79cd\u9009\u9879\u7684\u8be6\u7ec6\u914d\u7f6e\u89c1 vdc_optins \u8868\u7684 MigrationPolicies \u9009\u9879\uff0c\u8fc1\u79fb\u7b56\u7565\u9700\u8981\u8bbe\u7f6eMigrationPolicyModel\u5bf9\u8c61\u7684id\u5b57\u6bb5\u30022. bandwidth \u5b57\u6bb5\u662fMigrationBandwidthModel\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u96c6\u7fa4\u8fc1\u79fb\u5e26\u5bbd\u9650\u5236\uff0c\u7531MigrationBandwidthModel\u7684 assignmentMethod \u5b57\u6bb5\u8bbe\u7f6e\uff0c\u53ef\u9009\u7684\u9650\u5236\u67093\u79cd\uff1aAUTO\u3001HYPERVISOR_DEFAULT\u4ee5\u53caCUSTOM\u3002\u5f53\u9009\u62e9\u7684\u9650\u5236\u4e3aCUSTOM\u65f6\uff0c\u9700\u8981\u8bbe\u7f6eMigrationBandwidthModel\u7684 customValue \u5b57\u6bb5\u5bf9\u5e26\u5bbd\u8fdb\u884c\u9650\u5236\uff08\u5355\u4f4d\u4e3aMbps\uff09\uff0c\u8be5\u503c\u53ef\u4ee5\u8bbe\u7f6e\u7684\u6700\u5c0f\u503c\u4e3a1\u30023. autoConverge \u5b57\u6bb5\u548c compressed \u5b57\u6bb5\uff0c\u5206\u522b\u8868\u793a\u662f\u5426\u81ea\u52a8\u805a\u5408\u8fc1\u79fb\u4ee5\u53ca\u662f\u5426\u542f\u7528\u8fc1\u79fb\u538b\u7f29\u3002\u53ea\u6709\u5728\u8fc1\u79fb\u7b56\u7565\u4e3a Legacy \u65f6\uff0c\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u5728\u865a\u62df\u673a\u8fc1\u79fb\u8fc7\u7a0b\u4e2d\u624d\u4f1a\u751f\u6548\uff0c\u5b83\u4eec\u7684\u53ef\u9009\u503c\u6709\u4e09\u79cd\uff1aTRUE\u3001FALSE\u3001INHERIT\uff08\u8868\u793a\u4ece\u5168\u5c40\u8bbe\u7f6e\u7ee7\u627f\uff09\u3002 errorHandling ErrorHandlingModel body \u4ee3\u8868\u96c6\u7fa4\u865a\u62df\u673a\u8fc1\u79fb\u7684\u5f39\u6027\u7b56\u7565\uff0c\u5373\u5f53\u67d0\u53f0\u4e3b\u673a\u5b95\u673a\uff0c\u4e3b\u673a\u4e0a\u7684\u865a\u62df\u673a\u5982\u4f55\u5904\u7406\u7684\u7b56\u7565\u3002ErrorHandlingModel\u7684 onError \u5b57\u6bb5\u4ee3\u8868\u4e86\u5f39\u6027\u7b56\u7565\uff0c\u53ef\u9009\u503c\u67093\u79cd\uff1aMIGRATE\uff08\u8fc1\u79fb\u6240\u6709\u7684\u865a\u62df\u673a\uff09\u3001DO_NOT_MIGRATE\uff08\u4e0d\u8fc1\u79fb\u865a\u62df\u673a\uff09\u3001MIGRATE_HIGHLY_AVAILABLE\uff08\u53ea\u8fc1\u79fb\u9ad8\u53ef\u7528\u865a\u62df\u673a\uff09\u3002 schedulingPolicy SchedulingPolicyModel body \u4ee3\u8868\u96c6\u7fa4\u7684\u8c03\u5ea6\u7b56\u7565\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u8c03\u5ea6\u7b56\u7565\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\uff0cid\u5b57\u6bb5\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8ename\u5b57\u6bb5\u3002\u5185\u7f6e\u7684\u8c03\u5ea6\u7b56\u7565\u6709\u4ee5\u4e0b\u51e0\u79cd\uff0c\u683c\u5f0f\u4e3a name(id) \uff1a\u5e38\u89c4\u6a21\u5f0f\uff08b4ed2332-a7ac-4d5f-9596-99a439cb2812\uff09\u3001\u8282\u7535\u6a21\u5f0f\uff085a2b0939-7d46-4b73-a469-e9c2c7fc6a53\uff09\u3001\u865a\u62df\u673a\u5747\u5300\u5206\u5e03\u6a21\u5f0f\uff088d5d7bec-68de-4a67-b53e-0ac54686d579\uff09\u3001\u8d44\u6e90\u5747\u5300\u5206\u5e03\u6a21\u5f0f\uff0820d25257-b4bd-4589-92a6-c4c5c5d3fd1a\uff09\uff0c\u5177\u4f53\u914d\u7f6e\u6211\u4e5f\u770b\u4e0d\u61c2\uff0c\u5177\u4f53\u4fe1\u606f\u5b9a\u4e49\u5728 InternalClusterPolicies \u7c7b\u4e2d\u3002 customSchedulingPolicyProperties Properties body \u4ee3\u8868\u8c03\u5ea6\u7b56\u7565\u7684\u53ef\u8986\u76d6\u5c5e\u6027\uff0c\u53ef\u4ee5\u5bf9\u8c03\u5ea6\u7b56\u7565\u7684\u5c5e\u6027\u8fdb\u884c\u8986\u76d6\u3002Properties\u5bf9\u8c61\u662fPropertyModel\u5bf9\u8c61\u96c6\u5408\u7684\u6620\u5c04\uff0c\u8be5\u5bf9\u8c61\u53ea\u6301\u6709\u96c6\u5408\u5f15\u7528\u5b57\u6bb5properties\uff0c\u9700\u8981\u8986\u76d6\u7684\u5c5e\u6027\u53ef\u4ee5\u8bbe\u7f6ePropertyModel\u5bf9\u8c61\u7684name\u548cvalue\u5b57\u6bb5\u3002 trustedService Boolean body \u8868\u793a\u662f\u5426\u542f\u52a8\u53ef\u4fe1\u670d\u52a1 haReservation Boolean body \u8868\u793a\u662f\u5426\u542f\u52a8\u9ad8\u53ef\u7528\u6027\u8d44\u6e90\u9884\u7559 fencingPolicy FencingPolicyModel body \u4ee3\u8868\u96c6\u7fa4\u9694\u79bb\u7b56\u7565\u7684\u51e0\u4e2a\u65b9\u9762\u30021. enabled \u5b57\u6bb5\u8868\u793a\u662f\u5426\u5f00\u542f\u96c6\u7fa4\u9694\u79bb\u7b56\u7565\uff0c\u53ea\u6709\u5f00\u542f\u96c6\u7fa4\u7b56\u7565\u4ee5\u540e\u5176\u4ed6\u5b57\u6bb5\u624d\u80fd\u751f\u6548\u30022. skipIfSdActive \u5b57\u6bb5\u662fSkipIfSdActive\u5bf9\u8c61\u7684\u5f15\u7528\uff0cSkipIfSdActive\u5bf9\u8c61\u7684 enable \u5b57\u6bb5\u8868\u793a\u662f\u5426\u5728\u4e3b\u673a\u50a8\u5b58\u4e0a\u6709\u5b9e\u65f6\u79df\u7ea6\u65f6\uff0c\u5ffd\u7565\u9694\u79bb\u64cd\u4f5c\u30023. skipIfConnectivityBroken \u5b57\u6bb5\u662fSkipIfConnectivityBroken\u5bf9\u8c61\u5f15\u7528\uff0c\u8be5\u5bf9\u8c61\u62e5\u6709 enable \u5b57\u6bb5\u548c threshold \u5b57\u6bb5\uff0cenable\u5b57\u6bb5\u8868\u793a\u662f\u5426\u5728\u4e3b\u673a\u5b58\u5728\u95ee\u9898\u7684\u8fde\u63a5\u8fbe\u5230\u9608\u503c\u65f6\u5ffd\u7565\u9694\u79bb\u64cd\u4f5c\uff0c\u800cthreshold\u5219\u662f\u5bf9\u9608\u503c\u8fdb\u884c\u8bbe\u7f6e\u3002 \u8bf7\u6c42\uff1a PUT /acloudageks/api/clusters/{clustersId} Body: { \"name\": \"cluster_updated\", \"cpu\": { \"type\": \"Intel Penryn Family\" }, \"description\": \"test update cluster\", \"switchType\": \"LEGACY\", \"migration\": { \"policy\": { \"id\": \"80554327-0569-496b-bdeb-fcbbf52b827b\" }, \"bandwidth\": { \"assignmentMethod\": \"CUSTOM\", \"customValue\": 1234 } }, \"errorHandling\": { \"onError\": \"MIGRATE_HIGHLY_AVAILABLE\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.2.6.\u66f4\u65b0\u96c6\u7fa4\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#23","text":"","title":"2.3.\u96c6\u7fa4\u903b\u8f91\u7f51\u7edc"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#231","text":"\u5728\u96c6\u7fa4\u6240\u5728\u7684\u6570\u636e\u4e2d\u5fc3\u62e5\u6709\u7684\u903b\u8f91\u7f51\u7edc\u5206\u914d\u7ed9\u6307\u5b9a\u96c6\u7fa4\uff0c\u5e76\u4e14\u4e5f\u53ef\u4ee5\u5bf9\u7f51\u7edc\u8fdb\u884c\u4ee5\u4e0b\u8bbe\u7f6e\uff1a \u8bbe\u7f6e\u903b\u8f91\u7f51\u7edc\u662f\u5426\u662f\u8be5\u96c6\u7fa4\u5fc5\u987b\u7684 \u8bbe\u7f6e\u903b\u8f91\u7f51\u7edc\u662f\u5426\u4f5c\u4e3a\u8be5\u96c6\u7fa4\u7684\u663e\u793a\u7f51\u7edc \u8bbe\u7f6e\u903b\u8f91\u7f51\u7edc\u662f\u5426\u4f5c\u4e3a\u8be5\u96c6\u7fa4\u7684\u8fc1\u79fb\u7f51\u7edc \u9700\u8981\u6ce8\u610f\u7684\u662f\u5206\u914d\u7f51\u7edc\u65f6\uff0c\u4e0d\u80fd\u5c06\u8be5\u7f51\u7edc\u8bbe\u7f6e\u4e3a\u96c6\u7fa4\u7ba1\u7406\u7f51\u7edc\uff0c\u539f\u56e0\u53ef\u80fd\u662f\uff0c\u53ea\u6709\u7f51\u7edc\u4e3a\u96c6\u7fa4\u7684\u5fc5\u987b\u7f51\u7edc\u624d\u80fd\u88ab\u8bbe\u7f6e\u4e3a\u7ba1\u7406\u7f51\u7edc\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u5fc5\u8981\u53c2\u6570\uff0c\u7531\u4e8e\u540e\u53f0\u9a8c\u8bc1\u7684\u539f\u56e0\u8fd9\u91cc\u5fc5\u987b\u6307\u5b9a\uff1b\u903b\u8f91\u7f51\u7edc\u540d display Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u662f\u5426\u5c06\u8be5\u7f51\u7edc\u4f5c\u4e3a\u96c6\u7fa4\u7684\u663e\u793a\u7f51\u7edc\uff0c\u65b9\u4fbf\u5feb\u901f\u8bbe\u7f6e\u6307\u5b9a\u7f51\u7edc\u4e3a\u663e\u793a\u7f51\u7edc usages NetworkUsageValues body \u53ef\u9009\u53c2\u6570\uff0c\u8be5\u5bf9\u8c61\u4e3aNetworkUsage\u96c6\u5408\u7684\u6620\u5c04\uff0c\u53ea\u6301\u6709NetworkUsage\u679a\u4e3e\u96c6\u5408\u7684\u5f15\u7528networkUsage\uff0c\u8be5\u53c2\u6570\u7528\u4e8e\u6307\u5b9a\u65b0\u5efa\u7684\u903b\u8f91\u7f51\u7edc\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u54ea\u4e9b\u7f51\u7edc\u4f7f\u7528\uff0c\u5305\u62ec\u4ee5\u4e0b\u56db\u79cd\uff1aDISPLAY\uff08\u663e\u793a\u7f51\u7edc\uff09\u3001MANAGEMENT\uff08\u7ba1\u7406\u7f51\u7edc\uff09\u3001MIGRATION\uff08\u8fc1\u79fb\u7f51\u7edc\uff09\u3001VM\uff08\u865a\u62df\u673a\u7f51\u7edc\uff09\u3002\u5176\u4e2d\u524d\u4e09\u79cd\u662f\u76f8\u5bf9\u4e8e\u96c6\u7fa4\u7684\uff08\u8fd9\u4e09\u79cd\u7f51\u7edc\u5bf9\u4e8e\u96c6\u7fa4\u6765\u8bf4\u90fd\u662f\u5fc5\u987b\u7684\uff0c\u8bbe\u7f6e\u7684\u76ee\u7684\u662f\u662f\u5426\u628a\u5f53\u524d\u7684\u903b\u8f91\u7f51\u7edc\u4f5c\u4e3a\u96c6\u7fa4\u7684\u67d0\u79cd\u6216\u591a\u79cd\u7f51\u7edc\uff09\uff0c\u6700\u540e\u4e00\u79cd\u662f\u76f8\u5bf9\u4e8e\u865a\u62df\u673a\u7684\uff08\u5373\u8be5\u7f51\u7edc\u662f\u5426\u80fd\u4f5c\u4e3a\u865a\u62df\u673a\u7684\u901a\u4fe1\u7f51\u7edc\uff09\u3002\u7531\u4e8e\u8be5\u63a5\u53e3\u53ea\u80fd\u5206\u914d\u6570\u636e\u4e2d\u5fc3\u5df2\u6709\u7684\u903b\u8f91\u7f51\u7edc\u5230\u6307\u5b9a\u96c6\u7fa4\uff0c\u6240\u4ee5\u53ea\u80fd\u5bf9\u96c6\u7fa4\u76f8\u5173\u7684\u5185\u5bb9\uff08\u9664\u4e86\u7ba1\u7406\u7f51\u7edc\u4ee5\u5916\uff09\u8fdb\u884c\u64cd\u4f5c\u3002 required Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u662f\u5426\u5c06\u8be5\u7f51\u7edc\u4f5c\u4e3a\u96c6\u7fa4\u7684\u5fc5\u987b\u7f51\u7edc \u8bf7\u6c42\uff1a POST /acloudageks/api/clusters/{clustersId}/networks Body: { \"name\": \"re0\", \"usages\": { \"networkUsage\": [ \"MIGRATION\", \"DISPLAY\" ] }, \"required\": false } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"NetworkModel [id|name] required for add\", \"reason\": \"Incomplete parameters\" }","title":"2.3.1.\u5206\u914d\u96c6\u7fa4\u903b\u8f91\u7f51\u7edc"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#232","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u96c6\u7fa4\u903b\u8f91\u7f51\u7edc\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/clusters/{clusterId}/networks \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.3.2.\u83b7\u5f97\u96c6\u7fa4\u7684\u7f51\u7edc\u63a5\u53e3\u5217\u8868"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#233","text":"\u8be5\u63a5\u53e3\u53ef\u4ee5\u66f4\u65b0\u903b\u8f91\u7f51\u7edc\u4e0e\u96c6\u7fa4\u76f8\u5173\u7684\u5185\u5bb9\uff0c\u4e0e2.3.1\u7684\u5dee\u5f02\u5728\u4e8e\uff0c\u8be5\u63a5\u53e3\u4e0d\u80fd\u5206\u914d\u7f51\u7edc\u7ed9\u96c6\u7fa4\uff0c\u4f46\u662f\u53ef\u4ee5\u8bbe\u7f6e\u903b\u8f91\u7f51\u7edc\u662f\u5426\u4e3a\u7ba1\u7406\u7f51\u7edc\uff0c\u800c\u4e14\u4e0d\u9700\u8981\u5728\u8bf7\u6c42\u4f53\u4f20\u9012\u903b\u8f91\u7f51\u7edc\u7684id\u6216\u8005name\u5b57\u6bb5\uff0c\u5c06id\u4f5c\u4e3aurl\u7684\u4e00\u90e8\u5206\u5728url\u4f20\u9012\u3002 \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4e0d\u80fd\u5728\u4e00\u4e2a\u975e\u7a7a\u96c6\u7fa4\uff08\u6709\u4e3b\u673a\u548c\u865a\u62df\u673a\u7684\u96c6\u7fa4\uff09\u8fdb\u884c\u7ba1\u7406\u7f51\u7edc\u7684\u4fee\u6539\uff0c\u800c\u4e14\u5bf9\u5e94\u7684\u7f51\u7edc\u5728\u4e3b\u673a\u4e0a\u5fc5\u987b\u8981\u62e5\u6709ip\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e display Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u662f\u5426\u5c06\u8be5\u7f51\u7edc\u4f5c\u4e3a\u96c6\u7fa4\u7684\u663e\u793a\u7f51\u7edc\uff0c\u65b9\u4fbf\u5feb\u901f\u8bbe\u7f6e\u6307\u5b9a\u7f51\u7edc\u4e3a\u663e\u793a\u7f51\u7edc usages NetworkUsageValues body \u53ef\u9009\u53c2\u6570\uff0c\u8be5\u5bf9\u8c61\u4e3aNetworkUsage\u96c6\u5408\u7684\u6620\u5c04\uff0c\u53ea\u6301\u6709NetworkUsage\u679a\u4e3e\u96c6\u5408\u7684\u5f15\u7528networkUsage\uff0c\u8be5\u53c2\u6570\u7528\u4e8e\u6307\u5b9a\u65b0\u5efa\u7684\u903b\u8f91\u7f51\u7edc\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u54ea\u4e9b\u7f51\u7edc\u4f7f\u7528\uff0c\u5305\u62ec\u4ee5\u4e0b\u56db\u79cd\uff1aDISPLAY\uff08\u663e\u793a\u7f51\u7edc\uff09\u3001MANAGEMENT\uff08\u7ba1\u7406\u7f51\u7edc\uff09\u3001MIGRATION\uff08\u8fc1\u79fb\u7f51\u7edc\uff09\u3001VM\uff08\u865a\u62df\u673a\u7f51\u7edc\uff09\u3002\u5176\u4e2d\u524d\u4e09\u79cd\u662f\u76f8\u5bf9\u4e8e\u96c6\u7fa4\u7684\uff08\u8fd9\u4e09\u79cd\u7f51\u7edc\u5bf9\u4e8e\u96c6\u7fa4\u6765\u8bf4\u90fd\u662f\u5fc5\u987b\u7684\uff0c\u8bbe\u7f6e\u7684\u76ee\u7684\u662f\u662f\u5426\u628a\u5f53\u524d\u7684\u903b\u8f91\u7f51\u7edc\u4f5c\u4e3a\u96c6\u7fa4\u7684\u67d0\u79cd\u6216\u591a\u79cd\u7f51\u7edc\uff09\uff0c\u6700\u540e\u4e00\u79cd\u662f\u76f8\u5bf9\u4e8e\u865a\u62df\u673a\u7684\uff08\u5373\u8be5\u7f51\u7edc\u662f\u5426\u80fd\u4f5c\u4e3a\u865a\u62df\u673a\u7684\u901a\u4fe1\u7f51\u7edc\uff09\u3002\u7531\u4e8e\u8be5\u63a5\u53e3\u53ea\u80fd\u5206\u914d\u6570\u636e\u4e2d\u5fc3\u5df2\u6709\u7684\u903b\u8f91\u7f51\u7edc\u5230\u6307\u5b9a\u96c6\u7fa4\uff0c\u6240\u4ee5\u53ea\u80fd\u5bf9\u96c6\u7fa4\u76f8\u5173\u7684\u5185\u5bb9\u8fdb\u884c\u64cd\u4f5c\u3002 required Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u662f\u5426\u5c06\u8be5\u7f51\u7edc\u4f5c\u4e3a\u96c6\u7fa4\u7684\u5fc5\u987b\u7f51\u7edc \u8bf7\u6c42\uff1a PUT /acloudageks/api/clusters/{clustersId}/networks/{networkId} Body: { \"usages\": { \"networkUsage\": [ \"MIGRATION\", \"DISPLAY\", \"MANAGEMENT\" ] }, \"required\": true } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.3.3.\u66f4\u65b0\u96c6\u7fa4\u7f51\u7edc\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#234","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/clusters/{clustersId}/networks/{networkId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"2.3.4.\u83b7\u5f97\u6307\u5b9a\u7684\u96c6\u7fa4\u903b\u8f91\u7f51\u7edc"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#235","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/clusters/{clustersId}/networks/{networkId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"2.3.5.\u5206\u79bb\u6307\u5b9a\u7684\u96c6\u7fa4\u7f51\u7edc"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#24cpu","text":"","title":"2.4\u96c6\u7fa4CPU\u914d\u7f6e\u96c6"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#241cpu","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u5fc5\u8981\u53c2\u6570\uff0cCPU\u914d\u7f6e\u96c6\u540d\u79f0 description String body \u53ef\u9009\u53c2\u6570\uff0cCPU\u914d\u7f6e\u96c6\u63cf\u8ff0 qos QosModel body \u53ef\u9009\u53c2\u6570\uff0c\u9700\u8981\u8bbe\u7f6ecpu\u8d28\u91cf\u670d\u52a1id\uff0c\u9ed8\u8ba4\u503c\u4e3anull\uff0c\u8868\u793aqos\u4e3a\u65e0\u9650 \u8bf7\u6c42\uff1a POST /acloudageks/api/clusters/{clustersId}/cpuprofiles Body: { \"name\": \"test cpu profile\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"CpuProfileModel [name] required for validateParameters\", \"reason\": \"Incomplete parameters\" }","title":"2.4.1.\u6dfb\u52a0\u96c6\u7fa4CPU\u914d\u7f6e\u96c6"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#242cpu","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u5b58\u50a8\u57df\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/clusters/{clustersId}/cpuprofiles \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.4.2.\u83b7\u5f97\u96c6\u7fa4CPU\u914d\u7f6e\u96c6\u5217\u8868"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#243cpu","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/clusters/{clustersId}/cpuprofiles/{cpuprofileId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.4.3.\u83b7\u5f97\u96c6\u7fa4\u6307\u5b9a\u7684CPU\u914d\u7f6e\u96c6\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#244cpu","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/clusters/{clustersId}/cpuprofiles/{cpuprofileId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.4.4.\u5220\u9664\u96c6\u7fa4\u6307\u5b9aCPU\u914d\u7f6e\u96c6"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#25","text":"","title":"2.5.\u4e3b\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#251","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u5fc5\u8981\u53c2\u6570\uff0c\u4e3b\u673a\u540d address String body \u5fc5\u8981\u53c2\u6570\uff0c\u4e3b\u673a\u57df\u540d\u6216\u8005ip cluster ClusterModel body \u5fc5\u8981\u53c2\u6570\uff0c\u6307\u5b9a\u4e3b\u673a\u6240\u5c5e\u7684\u96c6\u7fa4\uff0c\u9700\u8981\u6307\u5b9a\u96c6\u7fa4\u7684id\u6216\u8005name\u5b57\u6bb5 ssh SshModel body \u53ef\u9009\u5fc5\u8981\u53c2\u6570\uff0cSshModel\u5bf9\u8c61\u4ee3\u8868\u4e86\u4e0e\u4e3b\u673a\u8fdb\u884cssh\u8fde\u63a5\u7684\u51e0\u4e2a\u9009\u9879\u3002\u5176\u4e2dauthenticationMethod\u5b57\u6bb5\u8868\u793a\u8fdb\u884cssh\u8ba4\u8bc1\u7684\u65b9\u5f0f\uff0c\u4e00\u5171\u6709\u4e24\u79cd\u9009\u62e9\uff1aPASSWORD\uff08\u901a\u8fc7\u7528\u6237\u540d\u548c\u5bc6\u7801\u8ba4\u8bc1\uff09\uff0cPUBLICKEY\uff08\u901a\u8fc7ssh\u516c\u94a5\u8ba4\u8bc1\uff09\uff0c\u9ed8\u8ba4\u503c\u4e3aPASSWORD\uff0c\u65b0\u5efa\u4e3b\u673a\u65f6\u53ea\u80fd\u4f7f\u7528PASSWORD\u65b9\u5f0f\uff1bfingerprint\u5b57\u6bb5\u4ee3\u8868\u4e3b\u673a\u6307\u7eb9\uff0c\u5177\u4f53\u4f5c\u7528\u4e0d\u592a\u6e05\u695a\uff1bport\u5b57\u6bb5\u4ee3\u8868\u4e3b\u673assh\u670d\u52a1\u7684\u7aef\u53e3\u53f7\uff0c\u9ed8\u8ba4\u503c\u4e3a22\uff1buser\u5b57\u6bb5\u662fUserModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u4e86\u8fde\u63a5\u4e3b\u673a\u7684\u7528\u6237\u4fe1\u606f\uff0c\u901a\u5e38\u53ea\u9700\u8981\u6307\u5b9a\u5176userName\uff08\u7528\u6237\u540d\uff09\u5b57\u6bb5\u548cpassword\uff08\u5bc6\u7801\uff09\u5b57\u6bb5\uff0cUserModel\u5bf9\u8c61\u53ea\u5728\u8ba4\u8bc1\u65b9\u5f0f\u4e3aPASSWORD\u6709\u6548\u3002\u8be5\u53c2\u6570\u4e0erootPassword\u53c2\u6570\u5fc5\u987b\u6709\u4e00\u4e2a\u6b63\u786e\u586b\u5199\u3002 rootPassword String body \u53ef\u9009\u5fc5\u8981\u53c2\u6570\uff0c\u56e0\u4e3a\u65b0\u5efa\u4e3b\u673a\u65f6\u53ea\u80fd\u4f7f\u7528\u7528\u6237\u540d\u548c\u5bc6\u7801\u8fdb\u884c\u8ba4\u8bc1\uff0c\u6240\u4ee5\u63d0\u4f9b\u4e86\uff0c\u4e00\u79cd\u4fbf\u5229\u7684\u65b9\u5f0f\uff0c\u9ed8\u8ba4\u4f7f\u7528root\u7528\u6237\u8fdb\u884c\u8ba4\u8bc1\uff0c\u56e0\u6b64\u53ea\u9700\u8981\u6307\u5b9aroot\u7528\u6237\u5bc6\u7801\u5373\u53ef\u3002\u8be5\u53c2\u6570\u4e0essh\u53c2\u6570\u5fc5\u987b\u6709\u4e00\u4e2a\u6b63\u786e\u586b\u5199\u3002 spm SpmModel body \u53ef\u9009\u53c2\u6570\uff0cSpmModel\u4ee3\u8868\u4e86\u4e3b\u673aspm\u76f8\u5173\u5c5e\u6027\uff0c\u5305\u62ec\u4e3b\u673a\u7684spm\u72b6\u6001\uff08status\uff09\u548cspm\u4f18\u5148\u7ea7\uff08priority\uff09\u3002\u65b0\u5efa\u4e3b\u673a\u65f6\uff0c\u53ef\u4ee5\u6307\u5b9a\u4e3b\u673a\u7684spm\u4f18\u5148\u7ea7\uff0c\u53ef\u9009\u8303\u56f4\u4e3a-1~10\uff0c\u9ed8\u8ba4\u503c\u4e3a0\u3002 os OperatingSystemModel body \u53ef\u9009\u53c2\u6570\uff0cOperatingSystemModel\u5bf9\u8c61\u4ee3\u8868\u4e0e\u7cfb\u7edf\u5f15\u5bfc\u6709\u5173\u7684\u53c2\u6570\u3002\u5b83\u7684customKernelCmdline\u5b57\u6bb5\uff0c\u8868\u793a\u5728\u4e3b\u673a\u5b89\u88c5\u65f6\u66f4\u6539\u4e3b\u673a\u7684\u5185\u6838\u5f15\u5bfc\u53c2\u6570\uff0c\u53ef\u4ee5\u9009\u62e9\u7684\u9ed8\u8ba4\u5f15\u5bfc\u53c2\u6570\u67094\u4e2a\uff1aintel_iommu=on\u3001 kvm-intel.nested=1\u3001vfio_iommu_type1.allow_unsafe_interrupts=1\u3001pci=realloc\uff0c\u5f53\u6dfb\u52a0\u591a\u4e2a\u5f15\u5bfc\u53c2\u6570\u65f6\uff0c\u9700\u8981\u5728\u5f15\u5bfc\u53c2\u6570\u95f4\u7528\u7a7a\u683c\u9694\u5f00\u3002 powerManagement PowerManagementModel body \u53ef\u9009\u53c2\u6570\uff0cPowerManagementModel\u4ee3\u8868\u4e86\u4e3b\u673a\u7684\u7535\u6e90\u7ba1\u7406\u7b56\u7565\u4e2d\u7684\u51e0\u4e2a\u9009\u9879\u3002\u5176\u4e2denabled\u5b57\u6bb5\u8868\u793a\u662f\u5426\u542f\u7528\u7535\u6e90\u7ba1\u7406\uff0c\u9ed8\u8ba4\u503c\u4e3afalse\uff0c\u53ea\u6709\u542f\u7528\u4e86\u7535\u6e90\u7ba1\u7406\u5176\u4ed6\u53c2\u6570\u624d\u80fd\u8d77\u4f5c\u7528\uff1bautomaticPmEnabled\u5b57\u6bb5\u8868\u793a\uff0c\u662f\u5426\u7981\u7528\u7535\u6e90\u7ba1\u7406\u7b56\u7565\u63a7\u5236\uff0c\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662ffalse\u8868\u793a\u7981\u7528\uff0c\u800ctrue\u8868\u793a\u542f\u7528\uff0c\u9ed8\u8ba4\u503c\u4e3afalse\uff1bpmProxies\u5b57\u6bb5\u662fPmProxies\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u4e86\u7535\u6e90\u7ba1\u7406\u4ee3\u7406\u7684\u96c6\u5408\u6620\u5c04\uff0cPmProxies\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aPmProxyModel\u5bf9\u8c61\u96c6\u5408\u7684\u5f15\u7528\u5b57\u6bb5pmProxies\uff0cPmProxyModel\u53ea\u6709\u4e00\u4e2atype\u5b57\u6bb5\u7528\u4e8e\u6307\u5b9a\u4ee3\u7406\u7c7b\u578b\uff0c\u53ef\u9009\u7684\u7535\u6e90\u7ba1\u7406\u4ee3\u7406\u7c7b\u578b\u6709\u4e09\u79cd\uff1aCLUSTER\u3001DC\u3001OTHER_DC\uff1bkdumpDetection\u5b57\u6bb5\u8868\u793a\u662f\u5426\u96c6\u6210KDump\uff0c\u9ed8\u8ba4\u503c\u4e3afalse port Integer body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u4e3b\u673avdsm\u670d\u52a1\u7684\u7aef\u53e3\u53f7\uff0c\u9ed8\u8ba4\u503c\u4e3a54321\uff0c\u4e00\u822c\u4e0d\u4f1a\u4f7f\u7528\u8fd9\u4e2a\u503c\u3002 protocol String body \u53ef\u9009\u53c2\u6570\uff0c\u8bbe\u7f6e\u4e0e\u4e3b\u673a\u7684\u901a\u4fe1\u534f\u8bae\uff0c\u53ef\u9009\u503c\u6709\uff1aXML\u3001STOMP\uff0c\u9ed8\u8ba4\u503c\u4e3aSTOMP\uff0c\u56e0\u4e3a\u76ee\u524d\u4f7f\u7528\u7684\u90fd\u662fSTOMP\u534f\u8bae\uff0c\u8fd9\u4e2a\u503c\u4e5f\u4e0d\u9700\u8981\u8bbe\u7f6e\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts Body: { \"name\": \"myhost\", \"address\": \"172.16.2.242\", \"rootPassword\": \"adcd1234\", \"spm\": { \"priority\": 5 }, \"powerManagement\": { \"enabled\": true, \"automaticPmEnabled\": false, \"pmProxies\": { \"pmProxies\": [ {\"type\": \"CLUSTER\"}, {\"type\": \"DC\"} ] } } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"HostModel [name, address] required for add\", \"reason\": \"Incomplete parameters\" }","title":"2.5.1.\u65b0\u5efa\u4e3b\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#252","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e case_sensitive Boolean url \u53ef\u9009\uff0c\u4e0esearch\u53c2\u6570\u4e00\u8d77\u4f7f\u7528\uff0c\u6307\u5b9a\u5728\u6267\u884csearch\u53c2\u6570\u65f6\u662f\u5426\u8003\u8651\u5927\u5c0f\u5199 filter Boolean url \u53ef\u9009\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u4e3b\u673a\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 max Integer url \u53ef\u9009\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u4e3b\u673a\u6570\u91cf search String url \u53ef\u9009\uff0c\u67e5\u8be2\u7ea6\u675f\u6761\u4ef6\u7ea6\u675f\u8fd4\u56de\u4fe1\u606f\uff0c\u4f8b\u5982name=\"myname\" \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.5.2.\u83b7\u5f97\u4e3b\u673a\u5217\u8868"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#253","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/activate Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"2.5.3.\u6fc0\u6d3b\u4e3b\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#254","text":"\u6279\u51c6\u9884\u5b89\u88c5\u7684Hypervisor\u4e3b\u673a\u4ee5\u5728\u865a\u62df\u5316\u73af\u5883\u4e2d\u4f7f\u7528\u3002 \u6b64\u64cd\u4f5c\u8fd8\u63a5\u53d7\u53ef\u9009\u7684cluster\u5143\u7d20\uff0c\u4ee5\u4e3a\u6b64\u4e3b\u673a\u5b9a\u4e49\u76ee\u6807\u96c6\u7fa4\u3002 \u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 cluster ClusterModel body \u53ef\u9009\u53c2\u6570\uff0c\u9700\u8981\u6307\u5b9a\u96c6\u7fa4\u7684name\u6216\u8005id\u5b57\u6bb5 ssh SshModel body \u53ef\u9009\u53c2\u6570\uff0cSshModel\u5bf9\u8c61\u4ee3\u8868\u4e86\u4e0e\u4e3b\u673a\u8fdb\u884cssh\u8fde\u63a5\u7684\u51e0\u4e2a\u9009\u9879\u3002\u5176\u4e2dauthenticationMethod\u5b57\u6bb5\u8868\u793a\u8fdb\u884cssh\u8ba4\u8bc1\u7684\u65b9\u5f0f\uff0c\u4e00\u5171\u6709\u4e24\u79cd\u9009\u62e9\uff1aPASSWORD\uff08\u901a\u8fc7\u7528\u6237\u540d\u548c\u5bc6\u7801\u8ba4\u8bc1\uff09\uff0cPUBLICKEY\uff08\u901a\u8fc7ssh\u516c\u94a5\u8ba4\u8bc1\uff09\uff1buser\u5b57\u6bb5\u662fUserModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u4e86\u8fde\u63a5\u4e3b\u673a\u7684\u7528\u6237\u4fe1\u606f\uff0c\u901a\u5e38\u53ea\u9700\u8981\u6307\u5b9a\u5176userName\uff08\u7528\u6237\u540d\uff09\u5b57\u6bb5\u548cpassword\uff08\u5bc6\u7801\uff09\u5b57\u6bb5\uff0cUserModel\u5bf9\u8c61\u53ea\u5728\u8ba4\u8bc1\u65b9\u5f0f\u4e3aPASSWORD\u6709\u6548\u3002\u6279\u51c6\u4e3b\u673a\u9ed8\u8ba4\u4f7f\u7528\u7684\u8ba4\u8bc1\u65b9\u5f0f\u662fPUBLICKEY\uff0c\u5728\u4e0d\u60f3\u4f7f\u7528\u9ed8\u8ba4\u7684ssh\u65b9\u5f0f\u65f6\uff0c\u53ef\u4ee5\u9009\u62e9\u3002 rootPassword String body \u53ef\u9009\u53c2\u6570\uff0c\u4f7f\u7528root\u7528\u6237\u8fdb\u884c\u8ba4\u8bc1\uff0c\u56e0\u6b64\u53ea\u9700\u8981\u6307\u5b9aroot\u7528\u6237\u5bc6\u7801\u5373\u53ef\u3002\u5728\u4e0d\u60f3\u4f7f\u7528\u9ed8\u8ba4\u7684ssh\u65b9\u5f0f\u65f6\uff0c\u53ef\u4ee5\u9009\u62e9\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/approve Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"2.5.4.\u6279\u51c6\u4e3b\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#255","text":"\u5c06\u7f51\u7edc\u914d\u7f6e\u6807\u8bb0\u4e3a\u826f\u597d\uff0c\u5e76\u6301\u4e45\u5316\u5230\u4e3b\u673a\u4e0a\u3002\uff08\u628a\u7f51\u7edc\u4fe1\u606f\u4fdd\u5b58\u5230 /var/lib/vdsm/persistence/netconf/nets/ovirtmgmt \u76ee\u5f55\u4e0b\uff1f\uff1f\uff1f\uff1f\uff09 \u7528\u6237\u53ef\u4ee5\u63d0\u4ea4\u7f51\u7edc\u914d\u7f6e\u7528\u4e8e\u6301\u4e45\u5316\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7684\u9644\u52a0\u6216\u5206\u79bb\uff0c\u6216\u6301\u4e45\u5316\u7ed1\u5b9a\u63a5\u53e3\u7684\u521b\u5efa\u548c\u5220\u9664\u3002 \u4ec5\u5728\u5f15\u64ce\u786e\u5b9a\u4e3b\u673a\u8fde\u63a5\u4e0d\u4f1a\u7531\u4e8e\u914d\u7f6e\u66f4\u6539\u800c\u4e22\u5931\u540e\uff0c\u624d\u63d0\u4ea4\u7f51\u7edc\u914d\u7f6e\u3002 \u5982\u679c\u4e3b\u673a\u8fde\u63a5\u4e22\u5931\uff0c\u5219\u4e3b\u673a\u9700\u8981\u91cd\u65b0\u542f\u52a8\u5e76\u81ea\u52a8\u6062\u590d\u4e3a\u4ee5\u524d\u7684\u7f51\u7edc\u914d\u7f6e\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/commitnetconfig Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"2.5.5.\u4fdd\u5b58\u4e3b\u673a\u7f51\u7edc\u914d\u7f6e"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#256","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 reason String body \u53ef\u9009\u53c2\u6570\uff0c\u8bbe\u7f6e\u7ef4\u62a4\u4e3b\u673a\u7684\u539f\u56e0 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/deactivate Body: { \"reason\": \"test deactivate host\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"2.5.6.\u4f7f\u4e3b\u673a\u8fdb\u5165\u7ef4\u62a4\u72b6\u6001"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#257","text":"\u5f53\u4e3b\u673a\u8bc1\u4e66\u5feb\u8981\u8fc7\u671f\u65f6\u4f7f\u7528\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/enrollcertificate Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"2.5.7.\u6ce8\u518c\u4e3b\u673a\u8bc1\u4e66"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#258","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 fenceType String body \u5fc5\u8981\u53c2\u6570\uff0c\u7528\u4e8e\u63a7\u5236\u4e3b\u673a\u7684\u7535\u6e90\u7ba1\u7406\u8bbe\u5907\uff0c\u53ef\u9009\u7684\u53c2\u6570\u6709\uff1aMANUAL\u3001RESTART\u3001START\u3001STOP\u3001STATUS \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/fence Body: { \"fenceType\": \"RESTART\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"2.5.8.\u4e3b\u673a\u7535\u6e90\u7ba1\u7406"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#259spm","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/forceselectspm Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"2.5.9.\u5c06\u4e3b\u673a\u4f5c\u4e3aSpm"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#2510","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts/{hostId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.5.10.\u83b7\u5f97\u6307\u5b9a\u7684\u4e3b\u673a\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#2511","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 ssh SshModel body \u53ef\u9009\u5fc5\u8981\u53c2\u6570\uff0cSshModel\u5bf9\u8c61\u4ee3\u8868\u4e86\u4e0e\u4e3b\u673a\u8fdb\u884cssh\u8fde\u63a5\u7684\u51e0\u4e2a\u9009\u9879\u3002\u5176\u4e2dauthenticationMethod\u5b57\u6bb5\u8868\u793a\u8fdb\u884cssh\u8ba4\u8bc1\u7684\u65b9\u5f0f\uff0c\u4e00\u5171\u6709\u4e24\u79cd\u9009\u62e9\uff1aPASSWORD\uff08\u901a\u8fc7\u7528\u6237\u540d\u548c\u5bc6\u7801\u8ba4\u8bc1\uff09\uff0cPUBLICKEY\uff08\u901a\u8fc7ssh\u516c\u94a5\u8ba4\u8bc1\uff09\uff0c\u9ed8\u8ba4\u503c\u4e3aPASSWORD\uff1bfingerprint\u5b57\u6bb5\u4ee3\u8868\u4e3b\u673a\u6307\u7eb9\uff0c\u5177\u4f53\u4f5c\u7528\u4e0d\u592a\u6e05\u695a\uff1bport\u5b57\u6bb5\u4ee3\u8868\u4e3b\u673assh\u670d\u52a1\u7684\u7aef\u53e3\u53f7\uff0c\u9ed8\u8ba4\u503c\u4e3a22\uff1buser\u5b57\u6bb5\u662fUserModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u4e86\u8fde\u63a5\u4e3b\u673a\u7684\u7528\u6237\u4fe1\u606f\uff0c\u901a\u5e38\u53ea\u9700\u8981\u6307\u5b9a\u5176userName\uff08\u7528\u6237\u540d\uff09\u5b57\u6bb5\u548cpassword\uff08\u5bc6\u7801\uff09\u5b57\u6bb5\uff0cUserModel\u5bf9\u8c61\u53ea\u5728\u8ba4\u8bc1\u65b9\u5f0f\u4e3aPASSWORD\u6709\u6548\u3002\u8be5\u53c2\u6570\u4e0erootPassword\u53c2\u6570\u5fc5\u987b\u6709\u4e00\u4e2a\u6b63\u786e\u586b\u5199\u3002 rootPassword String body \u53ef\u9009\u5fc5\u8981\u53c2\u6570\uff0c\u63d0\u4f9b\u4e86\u4e00\u79cd\u4fbf\u5229\u7684\u65b9\u5f0f\uff0c\u9ed8\u8ba4\u4f7f\u7528root\u7528\u6237\u8fdb\u884c\u8ba4\u8bc1\uff0c\u56e0\u6b64\u53ea\u9700\u8981\u6307\u5b9aroot\u7528\u6237\u5bc6\u7801\u5373\u53ef\u3002\u8be5\u53c2\u6570\u4e0essh\u53c2\u6570\u5fc5\u987b\u6709\u4e00\u4e2a\u6b63\u786e\u586b\u5199\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/install Body: { \"ssh\": { \"authenticationMethod\": \"PUBLICKEY\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"2.5.11.\u91cd\u65b0\u5b89\u88c5\u4e3b\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#2512","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u4e3b\u673a\u540d cluster ClusterModel body \u6307\u5b9a\u4e3b\u673a\u6240\u5c5e\u7684\u96c6\u7fa4\uff0c\u9700\u8981\u6307\u5b9a\u96c6\u7fa4\u7684id\u6216\u8005name\u5b57\u6bb5\uff0c\u53ea\u6709\u4e3b\u673a\u5728\u7ef4\u62a4\u72b6\u6001\u4e0b\u624d\u80fd\u4fee\u6539\u4e3b\u673a\u6240\u5c5e\u96c6\u7fa4 ssh SshModel body \u53ef\u9009\u5fc5\u8981\u53c2\u6570\uff0cSshModel\u5bf9\u8c61\u4ee3\u8868\u4e86\u4e0e\u4e3b\u673a\u8fdb\u884cssh\u8fde\u63a5\u7684\u51e0\u4e2a\u9009\u9879\u3002\u5176\u4e2dauthenticationMethod\u5b57\u6bb5\u8868\u793a\u8fdb\u884cssh\u8ba4\u8bc1\u7684\u65b9\u5f0f\uff0c\u4e00\u5171\u6709\u4e24\u79cd\u9009\u62e9\uff1aPASSWORD\uff08\u901a\u8fc7\u7528\u6237\u540d\u548c\u5bc6\u7801\u8ba4\u8bc1\uff09\uff0cPUBLICKEY\uff08\u901a\u8fc7ssh\u516c\u94a5\u8ba4\u8bc1\uff09\uff0c\u9ed8\u8ba4\u503c\u4e3aPASSWORD\uff1buser\u5b57\u6bb5\u662fUserModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u4e86\u8fde\u63a5\u4e3b\u673a\u7684\u7528\u6237\u4fe1\u606f\uff0c\u901a\u5e38\u53ea\u9700\u8981\u6307\u5b9a\u5176userName\uff08\u7528\u6237\u540d\uff09\u5b57\u6bb5\u548cpassword\uff08\u5bc6\u7801\uff09\u5b57\u6bb5\uff0cUserModel\u5bf9\u8c61\u53ea\u5728\u8ba4\u8bc1\u65b9\u5f0f\u4e3aPASSWORD\u6709\u6548\u3002\u8be5\u53c2\u6570\u4e0erootPassword\u53c2\u6570\u5fc5\u987b\u6709\u4e00\u4e2a\u6b63\u786e\u586b\u5199\u3002 rootPassword String body \u53ef\u9009\u5fc5\u8981\u53c2\u6570\uff0c\u63d0\u4f9b\u4e86\u4e00\u79cd\u4fbf\u5229\u7684\u65b9\u5f0f\uff0c\u9ed8\u8ba4\u4f7f\u7528root\u7528\u6237\u8fdb\u884c\u8ba4\u8bc1\uff0c\u56e0\u6b64\u53ea\u9700\u8981\u6307\u5b9aroot\u7528\u6237\u5bc6\u7801\u5373\u53ef\u3002\u8be5\u53c2\u6570\u4e0essh\u53c2\u6570\u5fc5\u987b\u6709\u4e00\u4e2a\u6b63\u786e\u586b\u5199\u3002 spm SpmModel body SpmModel\u4ee3\u8868\u4e86\u4e3b\u673aspm\u76f8\u5173\u5c5e\u6027\uff0c\u5305\u62ec\u4e3b\u673a\u7684spm\u72b6\u6001\uff08status\uff09\u548cspm\u4f18\u5148\u7ea7\uff08priority\uff09\u3002\u65b0\u5efa\u4e3b\u673a\u65f6\uff0c\u53ef\u4ee5\u6307\u5b9a\u4e3b\u673a\u7684spm\u4f18\u5148\u7ea7\uff0c\u53ef\u9009\u8303\u56f4\u4e3a-1~10\uff0c\u9ed8\u8ba4\u503c\u4e3a0\u3002 os OperatingSystemModel body OperatingSystemModel\u5bf9\u4ee3\u8868\u4e0e\u7cfb\u7edf\u5f15\u5bfc\u6709\u5173\u7684\u53c2\u6570\u3002\u5b83\u7684customKernelCmdline\u5b57\u6bb5\uff0c\u8868\u793a\u5728\u4e3b\u673a\u5b89\u88c5\u65f6\u66f4\u6539\u4e3b\u673a\u7684\u5185\u6838\u5f15\u5bfc\u53c2\u6570\uff0c\u53ef\u4ee5\u9009\u62e9\u7684\u9ed8\u8ba4\u5f15\u5bfc\u53c2\u6570\u67094\u4e2a\uff1aintel_iommu=on\u3001 kvm-intel.nested=1\u3001vfio_iommu_type1.allow_unsafe_interrupts=1\u3001pci=realloc\uff0c\u5f53\u6dfb\u52a0\u591a\u4e2a\u5f15\u5bfc\u53c2\u6570\u65f6\uff0c\u9700\u8981\u5728\u5f15\u5bfc\u53c2\u6570\u95f4\u7528\u7a7a\u683c\u9694\u5f00\u3002 powerManagement PowerManagementModel body PowerManagementModel\u4ee3\u8868\u4e86\u4e3b\u673a\u7684\u7535\u6e90\u7ba1\u7406\u7b56\u7565\u4e2d\u7684\u51e0\u4e2a\u9009\u9879\u3002\u5176\u4e2denabled\u5b57\u6bb5\u8868\u793a\u662f\u5426\u542f\u7528\u7535\u6e90\u7ba1\u7406\uff0c\u9ed8\u8ba4\u503c\u4e3afalse\uff0c\u53ea\u6709\u542f\u7528\u4e86\u7535\u6e90\u7ba1\u7406\u5176\u4ed6\u53c2\u6570\u624d\u80fd\u8d77\u4f5c\u7528\uff1bautomaticPmEnabled\u5b57\u6bb5\u8868\u793a\uff0c\u662f\u5426\u7981\u7528\u7535\u6e90\u7ba1\u7406\u7b56\u7565\u63a7\u5236\uff0c\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662ffalse\u8868\u793a\u7981\u7528\uff0c\u800ctrue\u8868\u793a\u542f\u7528\uff0c\u9ed8\u8ba4\u503c\u4e3afalse\uff1bpmProxies\u5b57\u6bb5\u662fPmProxies\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u4e86\u7535\u6e90\u7ba1\u7406\u4ee3\u7406\u7684\u96c6\u5408\u6620\u5c04\uff0cPmProxies\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aPmProxyModel\u5bf9\u8c61\u96c6\u5408\u7684\u5f15\u7528\u5b57\u6bb5pmProxies\uff0cPmProxyModel\u53ea\u6709\u4e00\u4e2atype\u5b57\u6bb5\u7528\u4e8e\u6307\u5b9a\u4ee3\u7406\u7c7b\u578b\uff0c\u53ef\u9009\u7684\u7535\u6e90\u7ba1\u7406\u4ee3\u7406\u7c7b\u578b\u6709\u4e09\u79cd\uff1aCLUSTER\u3001DC\u3001OTHER_DC\uff1bkdumpDetection\u5b57\u6bb5\u8868\u793a\u662f\u5426\u96c6\u6210KDump\uff0c\u9ed8\u8ba4\u503c\u4e3afalse \u8bf7\u6c42\uff1a PUT /acloudageks/api/hosts/{hostId} Body: { \"spm\": { \"priority\": 7 }, \"ssh\": { \"authenticationMethod\": \"PUBLICKEY\" }\uff0c \"powerManagement\": { \"enabled\": false } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"2.5.12.\u66f4\u65b0\u4e3b\u673a\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#2513","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/refresh Body: { } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"2.5.13.\u5237\u65b0\u4e3b\u673a\u80fd\u529b"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#2514","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/hosts/{hostId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"2.5.14\u5220\u9664\u4e3b\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#2515","text":"\u8be5\u63a5\u53e3\u4f1a\u8fd4\u56de\u4e3b\u673a\u7684\u4e0a\u7684\u6240\u6709\u7f51\u7edc\u63a5\u53e3\u4fe1\u606f\uff0c\u5305\u62ec\u865a\u62df\u7f51\u7edc\u63a5\u53e3\uff08vlan\uff09\u4e5f\u4f1a\u88ab\u89c6\u4e3a\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts/{hostId}/nics \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.5.15.\u83b7\u5f97\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u5217\u8868"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#2515_1","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts/{hostId}/nics/{nicId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.5.15.\u83b7\u5f97\u6307\u5b9a\u7684\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#2515_2","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts/{hostId}/nics/{nicId}/networkattachments \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.5.15.\u83b7\u5f97\u6307\u5b9a\u7684\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7684\u7f51\u7edc\u9644\u4ef6\u5217\u8868"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#2515_3","text":"\u4e3b\u673a\u7f51\u7edc\u9644\u4ef6\u5373\u5206\u914d\u7ed9\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7684engine\u903b\u8f91\u7f51\u7edc\u7684\u914d\u7f6e\u4fe1\u606f\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts/{hostId}/networkattachments \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.5.15.\u83b7\u5f97\u4e3b\u673a\u7f51\u7edc\u9644\u4ef6\u5217\u8868"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#2516","text":"\u76f8\u5f53\u4e8e\u628aengine\u903b\u8f91\u7f51\u7edc\u5206\u914d\u7ed9\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\uff0c\u8fd9\u91cc\u7684\u7f51\u7edc\u63a5\u53e3\u4e0d\u80fd\u662f\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\uff08vlan\uff09\uff0c\u800c\u4e14\u7f51\u7edc\u914d\u7f6e\u4e0d\u80fd\u5b58\u5728\u51b2\u7a81\uff08\u591a\u4e2a\u7f51\u5361\u5728\u540c\u4e00\u4e2a\u7f51\u6bb5\uff09\uff0c\u4e0d\u7136\u4f1a\u5bfc\u81f4\u7f51\u7edc\u51b2\u7a81\u4f7f\u4e3b\u673a\u7f51\u7edc\u5931\u6548\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 network NetworkModel body \u5fc5\u8981\u53c2\u6570\uff0c\u4ee3\u8868\u4e86NetworkAttachment\u6240\u5c5e\u7684\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\uff0chostNic\u5fc5\u987b\u6307\u5b9aHostNicModel\u7684name\u5b57\u6bb5\u6216\u8005id\u5b57\u6bb5\u3002 hostNic HostNicModel body \u5fc5\u8981\u53c2\u6570\uff0c\u4ee3\u8868NetworkAttachment\u6240\u5c5e\u7684\u903b\u8f91\u7f51\u7edc\uff0cnetwork\u5fc5\u987b\u6307\u5b9aHostNicModel\u7684name\u5b57\u6bb5\u6216\u8005id\u5b57\u6bb5\u3002 properties Properties body \u53ef\u9009\u53c2\u6570\uff0cProperties\u5bf9\u8c61\u53ea\u6301\u6709\u96c6\u5408\u5f15\u7528\uff0c\u662fPropertyModel\u5bf9\u8c61\u96c6\u5408\u7684\u6620\u5c04\uff0c\u901a\u8fc7\u8bbe\u7f6ePropertyModel\u5bf9\u8c61\u7684name\u548cvalue\u5b57\u6bb5\u6765\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u5c5e\u6027\uff0c\u76ee\u524d\u53ef\u9009\u7684name\u53ea\u6709 bridge_opts \u3002properties\u5b57\u6bb5\u5b57\u6bb5\u53ef\u4ee5\u4e3a\u7a7a ipAddressAssignments IpAddressAssignments body \u53ef\u9009\u53c2\u6570\uff0cIpAddressAssignments\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aIpAddressAssignmentModel\u5217\u8868\u7684\u5f15\u7528ipAddressAssignments\u3002IpAddressAssignmentModel\u6709\u4e24\u4e2a\u5b57\u6bb5\uff0c\u5176\u4e2dassignmentMethod\u5b57\u6bb5\u8868\u793a\u7f51\u7edc\u542f\u52a8\u534f\u8bae\uff0c\u53ef\u9009\u7684\u503c\u6709\uff1aDHCP\u3001STATIC\u3001AUTOCONF\u3001NONE\u3002ip\u5b57\u6bb5\u662fIpModel\u7684\u5f15\u7528\u8868\u793a\u7f51\u7edc\u914d\u7f6e\u4fe1\u606f\uff0cIP\u67094\u4e2a\u5b57\u6bb5\uff0caddress\u5b57\u6bb5\u8868\u793a\u7f51\u5740\uff1bnetmask\u8868\u793a\u5b50\u7f51\u63a9\u7801\uff1bgateway\u8868\u793a\u7f51\u5173\uff1bversion\u8868\u793a\u7f51\u7edc\u534f\u8bae\u7248\u672c\uff0c\u7f51\u7edc\u534f\u8bae\u7248\u672c\u5fc5\u987b\u6307\u5b9a\uff0c\u53ef\u9009\u503c\u6709\uff1aV4\u3001V6\uff0c\u5206\u522b\u4ee3\u8868IPv4\u548cIPv6\u534f\u8bae\u3002\u56e0\u6b64IpAddressAssignments\u7684\u5217\u8868\u4e2d\u6700\u591a\u53ea\u80fd\u6709\u4ee3\u8868IPv4\u548cIPv6\u76842\u4e2aIpAddressAssignmentModel\u5bf9\u8c61\uff0c\u5f53\u66f4\u65b0\u65f6\u5373\u4f7f\u4e0d\u53ea\u66f4\u65b0V6\u6216V4\u4e2d\u7684\u4e00\u4e2a\uff0c\u4e5f\u8981\u540c\u65f6\u63d0\u4ea4\u672a\u66f4\u65b0\u7684\u5185\u5bb9\uff0c\u5426\u5219\u89c6\u4e3a\u7f6e\u7a7a\u3002 qos QosModel body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u5bf9\u4e3b\u673a\u7f51\u7edcqos\u7684\u8986\u76d6\u3002\u9996\u5148QosModel\u5fc5\u987b\u8bbe\u7f6etype\u5b57\u6bb5\uff0c\u4e14\u5fc5\u987b\u4e3aHOSTNETWORK\uff1bQosModel\u53ef\u4ee5\u8bbe\u7f6e\u7684\u5b57\u6bb5\u6709outboundAverageLinkshare\uff08\u52a0\u6743\u91cd\u7684\u5171\u4eab\uff09\u3001outboundAverageRealtime\uff08\u5b9e\u73b0\u7684\u901f\u7387\uff09\u4ee5\u53caoutboundAverageUpperlimit\uff08\u901f\u7387\u9650\u5236\uff09\uff0cqos\u5b57\u6bb5\u53ef\u4ee5\u4e3a\u7a7a\u3002\u8bbe\u7f6eqos\u65f6\uff0c\u6240\u6709\u7684\u7f51\u7edc\u63a5\u53e3\u90fd\u5fc5\u987b\u8bbe\u7f6e\uff0c\u4e0d\u80fd\u53ea\u8bbe\u7f6e\u90e8\u5206\u7f51\u7edc\u63a5\u53e3\u7684qos\u3002 override_configuration String url \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u662f\u5426\u4fdd\u5b58\u4e3b\u673a\u7f51\u7edc\u914d\u7f6e\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/networkattachments Body: { \"hostNic\": { \"name\": \"ens33\" }, \"network\": { \"name\": \"re0\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.5.16.\u6dfb\u52a0\u4e3b\u673a\u7f51\u7edc\u9644\u4ef6"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#2516_1","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts/{hostId}/networkattachments/{networkattachmentId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.5.16.\u83b7\u5f97\u6307\u5b9a\u7684\u4e3b\u673a\u7f51\u7edc\u9644\u4ef6"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#2516_2","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 network NetworkModel body \u4ee3\u8868\u4e86NetworkAttachment\u6240\u5c5e\u7684\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\uff0chostNic\u5fc5\u987b\u6307\u5b9aHostNicModel\u7684name\u5b57\u6bb5\u6216\u8005id\u5b57\u6bb5\u3002 hostNic HostNicModel body \u4ee3\u8868NetworkAttachment\u6240\u5c5e\u7684\u903b\u8f91\u7f51\u7edc\uff0cnetwork\u5fc5\u987b\u6307\u5b9aHostNicModel\u7684name\u5b57\u6bb5\u6216\u8005id\u5b57\u6bb5\u3002 properties Properties body Properties\u5bf9\u8c61\u53ea\u6301\u6709\u96c6\u5408\u5f15\u7528\uff0c\u662fPropertyModel\u5bf9\u8c61\u96c6\u5408\u7684\u6620\u5c04\uff0c\u901a\u8fc7\u8bbe\u7f6ePropertyModel\u5bf9\u8c61\u7684name\u548cvalue\u5b57\u6bb5\u6765\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u5c5e\u6027\uff0c\u76ee\u524d\u53ef\u9009\u7684name\u53ea\u6709 bridge_opts \u3002properties\u5b57\u6bb5\u5b57\u6bb5\u53ef\u4ee5\u4e3a\u7a7a ipAddressAssignments IpAddressAssignments body IpAddressAssignments\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aIpAddressAssignmentModel\u5217\u8868\u7684\u5f15\u7528ipAddressAssignments\u3002IpAddressAssignmentModel\u6709\u4e24\u4e2a\u5b57\u6bb5\uff0c\u5176\u4e2dassignmentMethod\u5b57\u6bb5\u8868\u793a\u7f51\u7edc\u542f\u52a8\u534f\u8bae\uff0c\u53ef\u9009\u7684\u503c\u6709\uff1aDHCP\u3001STATIC\u3001AUTOCONF\u3001NONE\u3002ip\u5b57\u6bb5\u662fIpModel\u7684\u5f15\u7528\u8868\u793a\u7f51\u7edc\u914d\u7f6e\u4fe1\u606f\uff0cIP\u67094\u4e2a\u5b57\u6bb5\uff0caddress\u5b57\u6bb5\u8868\u793a\u7f51\u5740\uff1bnetmask\u8868\u793a\u5b50\u7f51\u63a9\u7801\uff1bgateway\u8868\u793a\u7f51\u5173\uff1bversion\u8868\u793a\u7f51\u7edc\u534f\u8bae\u7248\u672c\uff0c\u7f51\u7edc\u534f\u8bae\u7248\u672c\u5fc5\u987b\u6307\u5b9a\uff0c\u53ef\u9009\u503c\u6709\uff1aV4\u3001V6\uff0c\u5206\u522b\u4ee3\u8868IPv4\u548cIPv6\u534f\u8bae\u3002\u56e0\u6b64IpAddressAssignments\u7684\u5217\u8868\u4e2d\u6700\u591a\u53ea\u80fd\u6709\u4ee3\u8868IPv4\u548cIPv6\u76842\u4e2aIpAddressAssignmentModel\u5bf9\u8c61\uff0c\u5f53\u66f4\u65b0\u65f6\u5373\u4f7f\u4e0d\u53ea\u66f4\u65b0V6\u6216V4\u4e2d\u7684\u4e00\u4e2a\uff0c\u4e5f\u8981\u540c\u65f6\u63d0\u4ea4\u672a\u66f4\u65b0\u7684\u5185\u5bb9\uff0c\u5426\u5219\u89c6\u4e3a\u7f6e\u7a7a\u3002 qos QosModel body QosModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u5f53\u8be5\u5b57\u6bb5\u4e0d\u4e3a\u7a7a\u65f6\u8868\u793a\u5bf9\u4e3b\u673a\u7f51\u7edcqos\u7684\u8986\u76d6\u3002\u9996\u5148QosModel\u5fc5\u987b\u8bbe\u7f6etype\u5b57\u6bb5\uff0c\u4e14\u5fc5\u987b\u4e3aHOSTNETWORK\uff1bQosModel\u53ef\u4ee5\u8bbe\u7f6e\u7684\u5b57\u6bb5\u6709outboundAverageLinkshare\uff08\u52a0\u6743\u91cd\u7684\u5171\u4eab\uff09\u3001outboundAverageRealtime\uff08\u5b9e\u73b0\u7684\u901f\u7387\uff09\u4ee5\u53caoutboundAverageUpperlimit\uff08\u901f\u7387\u9650\u5236\uff09\uff0cqos\u5b57\u6bb5\u53ef\u4ee5\u4e3a\u7a7a\u3002\u8bbe\u7f6eqos\u65f6\uff0c\u6240\u6709\u7684\u7f51\u7edc\u63a5\u53e3\u90fd\u5fc5\u987b\u8bbe\u7f6e\uff0c\u4e0d\u80fd\u53ea\u8bbe\u7f6e\u90e8\u5206\u7f51\u7edc\u63a5\u53e3\u7684qos\u3002 override_configuration String url \u4ee3\u8868\u662f\u5426\u8986\u76d6\u4e3b\u673a\u7f51\u7edc\u914d\u7f6e\u6587\u4ef6\u7684\u5185\u5bb9\u3002 \u8bf7\u6c42\uff1a PUT /acloudageks/api/hosts/{hostId}/networkattachments/{networkattachmentId} Body: { \"ipAddressAssignments\": { \"ipAddressAssignments\": [ { \"assignmentMethod\": \"DHCP\", \"ip\": { \"version\": \"V6\" } } ] } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.5.16.\u66f4\u65b0\u4e3b\u673a\u7f51\u7edc\u9644\u4ef6"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#2516_3","text":"\u5220\u9664\u4e3b\u673a\u7f51\u7edc\u9644\u4ef6\u76f8\u5f53\u4e8e\u5c06engine\u903b\u8f91\u7f51\u7edc\u4ece\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u4e0a\u5206\u79bb\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/hosts/{hostId}/networkattachments/{networkattachmentId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.5.16.\u5220\u9664\u4e3b\u673a\u7f51\u7edc\u9644\u4ef6"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#2515_4","text":"\u8bbe\u7acb\u4e3b\u673a\u7f51\u7edc\u8fd9\u4e2a\u90e8\u5206\u6bd4\u8f83\u590d\u6742\uff0c\u6d89\u53ca\u7684\u5bf9\u8c61\u5f88\u591a\uff0c\u8fd9\u91cc\u6839\u636e\u6211\u4e2a\u4eba\u7684\u7406\u89e3\u5bf9\u51e0\u4e2a\u5bf9\u8c61\u8fdb\u884c\u8bf4\u660e\u3002 LogicalNetworkModel \u8be5\u5bf9\u8c61\u4ee3\u8868\u4e86Engine\u903b\u8f91\u7f51\u7edc\u548c\u5916\u90e8\u903b\u8f91\u7f51\u7edc\uff08\u6ca1\u7528\u8fc7\uff09\uff0c\u5bf9\u5e94\u7684\u9875\u9762\u4fe1\u606f\u5982\u4e0b\uff1a \u5728\u9875\u9762\u4e0a\u53ef\u4ee5\u901a\u8fc7\u62d6\u52a8\u903b\u8f91\u7f51\u7edc\u5c06Engine\u903b\u8f91\u7f51\u7edc\u5206\u914d\u7ed9\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\uff0c\u4f46\u662f\u4e00\u4e2a\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u4e0a\u53ea\u80fd\u6709\u4e00\u4e2a\u975eVlan\u7f51\u7edc\u3002 NetworkAttachments \u8be5\u5bf9\u8c61\u4ee3\u8868\u5206\u914d\u7ed9\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7684 Engine\u903b\u8f91\u7f51\u7edc \u7684\u5c5e\u6027\u4fe1\u606f\uff08\u4e00\u4e2aEngine\u903b\u8f91\u7f51\u7edc\u5728\u4e0d\u540c\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u4e0a\u7684\u5c5e\u6027\u4fe1\u606f\u4e0d\u540c\uff09\uff0c\u76f8\u5f53\u4e8e\u4fee\u6539\u7269\u7406\u4e3b\u673a\u4e0a\u7684\u7f51\u7edc\u914d\u7f6e\u6587\u4ef6\uff0c\u5305\u62ecIPv4\u548cIPv6\u4fe1\u606f\u3001qos\u4fe1\u606f\u4ee5\u53ca\u81ea\u5b9a\u4e49\u5c5e\u6027\uff0c\u6ce8\u610f\u53ea\u6709\u5c06Engine\u903b\u8f91\u7f51\u7edc\u5206\u914d\u7ed9\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u4ee5\u540e\uff0cEngine\u903b\u8f91\u7f51\u7edc\u624d\u80fd\u62e5\u6709\u5bf9\u5e94\u7684NetworkAttachments\u3002\u5bf9\u5e94\u9875\u9762\u4fe1\u606f\u5982\u4e0b\uff1a \u4f46\u662f\uff0c\u8be5\u5bf9\u8c61\u7684\u4fe1\u606f\u5e76\u4e0d\u4e00\u5b9a\u4e0e\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7684 Engine\u903b\u8f91\u7f51\u7edc \u7684\u5c5e\u6027\u4fe1\u606f\u4e00\u81f4\uff0c\u53ef\u4ee5\u901a\u8fc7\u540c\u6b65\u7f51\u7edc\u7684\u65b9\u5f0f\uff0c\u5c06\u8be5\u5bf9\u8c61\u8bbe\u7f6e\u7684\u5c5e\u6027\u5e94\u7528\u5230\u5206\u914d\u7ed9\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7684 Engine\u903b\u8f91\u7f51\u7edc \u4e0a\u3002 NetworkLabelModel \u8be5\u5bf9\u8c61\u4ee3\u8868\u903b\u8f91\u7f51\u7edc\u6807\u7b7e\uff0c\u903b\u8f91\u7f51\u7edc\u6807\u7b7e\u5206\u914d\u7ed9\u7f51\u7edc\u63a5\u53e3\u4ee5\u540e\u53ef\u4ee5\u4e0e\u5206\u914d\u7ed9\u540c\u4e00\u7f51\u7edc\u63a5\u53e3\u7684\u903b\u8f91\u7f51\u7edc\u8fdb\u884c\u7ed1\u5b9a\uff08\u901a\u8fc7\u7f16\u8f91\u6216\u4fee\u6539\u903b\u8f91\u7f51\u7edc\uff09\uff0c\u8fd9\u6837\u53ea\u5bf9\u6807\u7b7e\u8fdb\u884c\u64cd\u4f5c\u5c31\u53ef\u4ee5\u540c\u65f6\u5bf9\u4e0e\u6807\u7b7e\u7ed1\u5b9a\u7684\u6240\u6709\u903b\u8f91\u540c\u65f6\u8fdb\u884c\u64cd\u4f5c\u3002\u5bf9\u5e94\u7684\u9875\u9762\u4fe1\u606f\u5982\u4e0b\uff1a \u5728\u9875\u9762\u4e0a\u53ef\u4ee5\u901a\u8fc7\u62d6\u52a8\u6807\u7b7e\u5c06\u6807\u7b7e\u5206\u914d\u7ed9\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\uff0c\u4e00\u4e2a\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u53ef\u4ee5\u6709\u591a\u4e2a\u6807\u7b7e\u3002 NetworkInterfaceModel \u8be5\u5bf9\u8c61\u4ee3\u8868\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\uff0c\u5305\u62ec\u4e86Engine\u903b\u8f91\u7f51\u7edc\u3001\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7684Engine\u903b\u8f91\u7f51\u7edc\u5c5e\u6027\u4fe1\u606f\u4ee5\u53ca\u7f51\u7edc\u6807\u7b7e\u3002\u5bf9\u5e94\u7684\u9875\u9762\u4fe1\u606f\u5982\u4e0b\uff1a \u8be5\u5bf9\u8c61\u5728\u540e\u53f0\u5bf9\u5e94\u7684\u5b9e\u4f53\u5bf9\u8c61\u4e3aVdsNetworkInteface\uff0cVdsNetworkInteface\u5bf9\u8c61\u5b9e\u9645\u4e0a\u662f\u5c06Engine\u903b\u8f91\u7f51\u7edc\u3001\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7684Engine\u903b\u8f91\u7f51\u7edc\u5c5e\u6027\u4fe1\u606f\u4ee5\u53ca\u7f51\u7edc\u6807\u7b7e\u7b49\u4fe1\u606f\u5e94\u7528\u5230\u7269\u7406\u4e3b\u673a\u7684\u7f51\u7edc\u63a5\u53e3\u4ee5\u540e\u7684\u751f\u6210\u7684\u4fe1\u606f\u62bd\u8c61\u5bf9\u8c61\u3002 Bond \u8be5\u5bf9\u8c61\u662f\u591a\u4e2a\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7ed1\u5b9a\u7684\u62bd\u8c61\uff0c\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7ed1\u5b9a\u5373\u591a\u4e2a\u7f51\u7edc\u63a5\u53e3\u5171\u7528\u591a\u4e2a\u903b\u8f91\u7f51\u7edc\uff0c\u5b9e\u9645\u4e0aBond\u5bf9\u8c61\u540d\u5b57\uff08name\uff09\u3001\u7ed1\u5b9a\u6a21\u5f0f\uff08bondOptions\uff09\u4ee5\u53ca\u7ed1\u5b9a\u7684\u63a5\u53e3\u540d\u5b57\u96c6\u5408\uff08slaves\uff09\u7528\u4e8e\u4ee3\u8868\u4e24\u8005\u7684\u7ed1\u5b9a\u5173\u7cfb\u3002\u7ed1\u5b9a\u5173\u7cfb\u5728\u6570\u636e\u5e93\u5e76\u6ca1\u6709\u5bf9\u5e94\u7684\u6620\u5c04\u8868\uff0c\u800c\u662f\u5728VdsNetworkInteface\u4ee5isbond\u5b57\u6bb5\u4ee3\u8868\u662f\u5426\u7ed1\u5b9a\uff0c\u5e76\u4e14\u901a\u8fc7\u5171\u6709\u7684bondName\u8fdb\u884c\u805a\u5408\uff0cVdsNetworkInteface\u7684\u4fe1\u606f\u662f\u5728\u4e3b\u673anetwork\u4fe1\u606f\u66f4\u65b0\u540e\uff0c\u4ecevdsm\u91cd\u65b0\u83b7\u5f97\u4e3b\u673a\u4fe1\u606f\uff0c\u4e4b\u540e\u518d\u66f4\u65b0VdsNetworkInteface\u7684\u6570\u636e\u5e93\u4fe1\u606f\u3002\u5bf9\u5e94\u7684\u9875\u9762\u4fe1\u606f\u5982\u4e0b\uff1a \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 modifiedNetworkAttachments NetworkAttachments body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u4e86\u4fee\u6539\u6216\u8005\u589e\u52a0\u7684NetworkAttachment\u5bf9\u8c61\u7684\u96c6\u5408\u6620\u5c04\uff0c\u8be5\u5bf9\u53ea\u6301\u6709\u4e00\u4e2aNetworkAttachmentModel\u5bf9\u8c61\u96c6\u5408\u7684\u5f15\u7528networkAttachments\u3002NetworkAttachmentModel\u5bf9\u8c61\u5728\u65b0\u5efa\u6216\u8005\u66f4\u65b0\u65f6\uff0c\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\u53ef\u4ee5\u8bbe\u7f6e\uff1a1.id\u5b57\u6bb5\uff0c\u8bbe\u7f6eid\u5b57\u6bb5\u8868\u793a\u66f4\u65b0\uff0c\u672a\u8bbe\u7f6e\u8868\u793a\u65b0\u5efa\u30022.ipAddressAssignments\u5b57\u6bb5\u662fIpAddressAssignments\u5bf9\u8c61\u7684\u5f15\u7528\uff0cIpAddressAssignments\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aIpAddressAssignmentModel\u5217\u8868\u7684\u5f15\u7528ipAddressAssignments\u3002IpAddressAssignmentModel\u6709\u4e24\u4e2a\u5b57\u6bb5\uff0c\u5176\u4e2dassignmentMethod\u5b57\u6bb5\u8868\u793a\u7f51\u7edc\u542f\u52a8\u534f\u8bae\uff0c\u53ef\u9009\u7684\u503c\u6709\uff1aDHCP\u3001STATIC\u3001AUTOCONF\u3001NONE\u3002ip\u5b57\u6bb5\u662fIpModel\u7684\u5f15\u7528\u8868\u793a\u7f51\u7edc\u914d\u7f6e\u4fe1\u606f\uff0cIP\u67094\u4e2a\u5b57\u6bb5\uff0caddress\u5b57\u6bb5\u8868\u793a\u7f51\u5740\uff1bnetmask\u8868\u793a\u5b50\u7f51\u63a9\u7801\uff1bgateway\u8868\u793a\u7f51\u5173\uff1bversion\u8868\u793a\u7f51\u7edc\u534f\u8bae\u7248\u672c\uff0c\u7f51\u7edc\u534f\u8bae\u7248\u672c\u5fc5\u987b\u6307\u5b9a\uff0c\u53ef\u9009\u503c\u6709\uff1aV4\u3001V6\uff0c\u5206\u522b\u4ee3\u8868IPv4\u548cIPv6\u534f\u8bae\u3002\u56e0\u6b64IpAddressAssignments\u7684\u5217\u8868\u4e2d\u6700\u591a\u53ea\u80fd\u6709\u4ee3\u8868IPv4\u548cIPv6\u76842\u4e2aIpAddressAssignmentModel\u5bf9\u8c61\uff0cIpAddressAssignmentModel\u53ef\u4ee5\u4e3a\u7a7a\uff0cIPv4\u548cIPv6\u7684\u6240\u6709\u9ed8\u8ba4\u5c5e\u6027\u90fd\u4e3a\u7a7a\uff0c\u4e5f\u53ef\u4ee5\u53ea\u6dfb\u52a0\u5176\u4e2d\u4e00\u4e2a\uff0c\u90a3\u4e48\u53e6\u4e00\u4e2a\u7684\u6240\u6709\u5c5e\u6027\u5219\u9ed8\u8ba4\u4e3a\u7a7a\u30023.qos\u5b57\u6bb5\u662fQosModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u5f53\u8be5\u5b57\u6bb5\u4e0d\u4e3a\u7a7a\u65f6\u8868\u793a\u5bf9\u4e3b\u673a\u7f51\u7edcqos\u7684\u8986\u76d6\u3002\u9996\u5148QosModel\u5fc5\u987b\u8bbe\u7f6etype\u5b57\u6bb5\uff0c\u4e14\u5fc5\u987b\u4e3aHOSTNETWORK\uff1bQosModel\u53ef\u4ee5\u8bbe\u7f6e\u7684\u5b57\u6bb5\u6709outboundAverageLinkshare\uff08\u52a0\u6743\u91cd\u7684\u5171\u4eab\uff09\u3001outboundAverageRealtime\uff08\u5b9e\u73b0\u7684\u901f\u7387\uff09\u4ee5\u53caoutboundAverageUpperlimit\uff08\u901f\u7387\u9650\u5236\uff09\uff0cqos\u5b57\u6bb5\u53ef\u4ee5\u4e3a\u7a7a\u30024.properties\u5b57\u6bb5\u662fProperties\u5bf9\u8c61\u7684\u5f15\u7528\u4ee3\u8868\u4e86\u81ea\u5b9a\u4e49\u5c5e\u6027\uff0cProperties\u5bf9\u8c61\u53ea\u6301\u6709\u96c6\u5408\u5f15\u7528\uff0c\u662fPropertyModel\u5bf9\u8c61\u96c6\u5408\u7684\u6620\u5c04\uff0c\u901a\u8fc7\u8bbe\u7f6ePropertyModel\u5bf9\u8c61\u7684name\u548cvalue\u5b57\u6bb5\u6765\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u5c5e\u6027\uff0c\u76ee\u524d\u53ef\u9009\u7684name\u53ea\u6709 bridge_opts \u3002properties\u5b57\u6bb5\u5b57\u6bb5\u53ef\u4ee5\u4e3a\u7a7a5.hostNic\u5b57\u6bb5\u662fHostNicModel\u5f15\u7528\uff0c\u4ee3\u8868\u4e86NetworkAttachment\u6240\u5c5e\u7684\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\uff0chostNic\u5fc5\u987b\u6307\u5b9aHostNicModel\u7684name\u5b57\u6bb5\u6216\u8005id\u5b57\u6bb5\u30026.network\u5b57\u6bb5\u4ee3\u8868\u4e86NetworkAttachment\u6240\u5c5e\u7684\u903b\u8f91\u7f51\u7edc\uff0cnetwork\u5fc5\u987b\u6307\u5b9aHostNicModel\u7684name\u5b57\u6bb5\u6216\u8005id\u5b57\u6bb5\u3002\u5f535.6\u7ed3\u5408\u5728\u4e00\u8d77\u65f6\uff0c\u5c31\u53ef\u4ee5\u8868\u793a\u628a\u903b\u8f91\u7f51\u7edc\u5206\u914d\u7ed9\u4e86\u6307\u5b9a\u7684\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u3002 synchronizedNetworkAttachments NetworkAttachments body \u53ef\u9009\u53c2\u6570\uff0c\u8be5\u5bf9\u8c61\u7684networkAttachments\u5b57\u6bb5\u8868\u793a\u9700\u8981\u7acb\u5373\u540c\u6b65\uff08\u7acb\u5373\u5e94\u7528\uff09NetworkAttachment\u7684\u7f51\u7edc\u914d\u7f6e\u4fe1\u606f\u5230\u7269\u7406\u4e3b\u673a\u7684\u7f51\u7edc\u63a5\u53e3\u7684NetworkAttachment\u96c6\u5408\uff0c\u8be5\u96c6\u5408\u4e2d\u7684NetworkAttachment\u5bf9\u8c61\u53ea\u9700\u8981\u8bbe\u7f6eid\u5b57\u6bb5\u5373\u53ef\uff0c\u8be5\u96c6\u5408NetworkAttachment\u65e2\u53ef\u4ee5\u662fmodifiedNetworkAttachments\u4e2d\u4fee\u6539\u4e86\u7684\u5bf9\u8c61\uff0c\u4e5f\u53ef\u4ee5\u662f\u540e\u53f0\u6570\u636e\u5e93\u5df2\u7ecf\u5b58\u5728\u7684\u5bf9\u8c61\uff0c\u4f46\u662f\u4e0d\u80fd\u662f\u65b0\u5efa\u7684NetworkAttachment\u5bf9\u8c61\uff0c\u56e0\u4e3a\u65b0\u5efa\u7684\u5bf9\u8c61\u4e0d\u80fd\u8bbe\u7f6eid\u5b57\u6bb5\u3002 removedNetworkAttachments NetworkAttachments body \u53ef\u9009\u53c2\u6570\uff0cNetworkAttachments\u7684networkAttachments\u5b57\u6bb5\u8868\u793a\u9700\u8981\u5220\u9664\u7684NetworkAttachment\u5bf9\u8c61\u96c6\u5408\uff0c\u53ea\u9700\u8981\u6307\u5b9aNetworkAttachment\u5bf9\u8c61\u7684id\u5b57\u6bb5\u5373\u53ef\u3002\u5f53NetworkAttachment\u88ab\u76f4\u63a5\u5220\u9664\uff0cNetworkAttachment\u9644\u52a0\u5230\u7684\u903b\u8f91\u7f51\u7edc\u4e5f\u4f1a\u4ece\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u5206\u79bb\u3002 modifiedLabels NetworkLabels body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u4e86\u65b0\u589e\u7684NetworkLabel\u5bf9\u8c61\u7684\u96c6\u5408\u6620\u5c04\uff0c\u8be5\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aNetworkLabelModel\u5bf9\u8c61\u96c6\u5408\u7684\u5f15\u7528networkLabels\u3002\u5728\u65b0\u589e\u7f51\u7edc\u63a5\u53e3\u6807\u7b7e\u65f6\uff0cNetworkLabelModel\u9700\u8981\u6307\u5b9a\u4e24\u4e2a\u5b57\u6bb51.hostNic\u5b57\u6bb5\uff0chostNic\u5b57\u6bb5\u662f\u7f51\u7edc\u63a5\u53e3\u6807\u7b7e\u6240\u9644\u52a0\u5230\u7684\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3HostNicModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u81f3\u5c11\u9700\u8981\u6307\u5b9aHostNicModel\u5bf9\u8c61\u7684id\u5b57\u6bb5\u6216name\u5b57\u6bb5\u30022.id\u5b57\u6bb5\uff0c\u4ee3\u8868\u6807\u7b7e\u540d\uff0c\u5373\u4e3a\u6807\u7b7e\u53d6\u4e00\u4e2a\u540d\u5b57\u3002 removedLabels NetworkLabels body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u9700\u8981\u4ece\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u89e3\u7ed1\u7684\u7f51\u7edc\u63a5\u53e3\u6807\u7b7e\u96c6\u5408\uff0c\u8be5\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aNetworkLabelModel\u5bf9\u8c61\u96c6\u5408\u7684\u5f15\u7528networkLabels\u3002\u5728\u6307\u5b9a\u8981\u89e3\u7ed1\u7684\u7f51\u7edc\u6807\u7b7e\u5bf9\u8c61\u65f6\uff0c\u53ea\u9700\u8981\u6307\u5b9aNetworkLabelModel\u7684id\u5b57\u6bb5\u3002 modifiedBonds HostNics body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u5bf9\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7ed1\u5b9a\u5173\u7cfb\u7684\u4fee\u6539\uff08\u4ece\u591a\u4e2a\u7ed1\u5b9a\u4e2d\u53bb\u6389\u67d0\u4e2a\u7ed1\u5b9a\u3001\u5408\u5e76\u7ed1\u5b9a\u3001\u5728\u7ed1\u5b9a\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3\u7b49\uff09\u548c\u65b0\u589e\uff08\u5c06\u4e24\u4e2a\u6216\u4e24\u4e2a\u4ee5\u4e0a\u7684\u63a5\u53e3\u7ec4\u5408\u4e00\u4e2a\u7ed1\u5b9a\uff09\u64cd\u4f5c\u7684HostNic\u5bf9\u8c61\u7684\u96c6\u5408\u6620\u5c04\uff0cHostNics\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aHostNic\u5bf9\u8c61\u96c6\u5408\u7684\u5f15\u7528hostNics\uff0c\u4e00\u4e2aHostNic\u5bf9\u8c61\u4ee3\u8868\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3\u7ed1\u5b9a\u3002HostNic\u5bf9\u8c61\u5728\u65b0\u5efa\u6216\u8005\u4fee\u6539\u65f6\uff0c\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\u53ef\u4ee5\u8bbe\u7f6e\uff1a1.id\u5b57\u6bb5\uff0c\u5f53\u8bbe\u7f6eid\u65f6\u8868\u793a\u5bf9\u5df2\u7ecf\u5b58\u5728\u7684\u7f51\u7edc\u63a5\u53e3\u7ed1\u5b9a\u8fdb\u884c\u4fee\u6539\uff0c\u672a\u8bbe\u7f6eid\u65f6\u8868\u793a\u65b0\u5efa\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3\u7ed1\u5b9a\u30022.name\u5b57\u6bb5\uff0cname\u5b57\u6bb5\u4e0d\u80fd\u4e3a\u7a7a\u4e14\u5fc5\u987b\u662f bond +\u6570\u5b57\u7684\u5f62\u5f0f\uff0c\u5982\u679cname\u5df2\u7ecf\u5b58\u5728\u5219\u8868\u793a\u5bf9\u5df2\u6709\u7ed1\u5b9a\u8fdb\u884c\u4fee\u6539\uff0c\u5426\u5219\u8868\u793a\u65b0\u5efa\u4e00\u4e2a\u7ed1\u5b9a\u30023.bonding\u5b57\u6bb5\uff0c\u8be5\u5b57\u6bb5\u4ee3\u8868\u9700\u8981\u7ed1\u5b9a\u5728\u4e00\u8d77\u7684\u7f51\u7edc\u63a5\u53e3\u96c6\u5408BondingModel\u5bf9\u8c61\uff0cBondingModel\u6709\u4e24\u4e2a\u5b57\u6bb5\u53ef\u4ee5\u5f71\u54cd\u7f51\u7edc\u63a5\u53e3\u7684\u7ed1\u5b9a\u5c5e\u6027\u30024.slaves\u5b57\u6bb5\uff0cslaves\u662fHostNics\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u9700\u8981\u7ed1\u5b9a\u5728\u4e00\u8d77\u7684\u7f51\u7edc\u63a5\u53e3\u96c6\u5408\u6620\u5c04\uff0cHostNics\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aHostNic\u5bf9\u8c61\u96c6\u5408\u7684\u5f15\u7528hostNics\uff0c\u8fd9\u91cc\u7684\u4e00\u4e2aHostNic\u5bf9\u8c61\u4ee3\u8868\u4e00\u4e2a\u9700\u8981\u88ab\u7ed1\u5b9a\u7684\u7f51\u7edc\u63a5\u53e3\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6307\u5b9aHostNic\u5bf9\u8c61\u7684id\u5b57\u6bb5\u5373\u53ef\u30025.options\u5b57\u6bb5\uff0c\u662fOptions\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u7ed1\u5b9a\u7f51\u7edc\u63a5\u53e3\u7684\u7ed1\u5b9a\u6a21\u5f0f\uff0cOptions\u5bf9\u8c61\u53ea\u6301\u6709OptionModel\u96c6\u5408\u7684\u5f15\u7528\u5b57\u6bb5options\uff0c\u9700\u8981\u8bbe\u7f6e\u7684\u5c5e\u6027\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6eOptionModel\u5bf9\u8c61\u7684name\u548cvalue\u5b57\u6bb5\u6765\u8d4b\u503c\uff1b\u76ee\u524d\u7ed1\u5b9a\u6a21\u5f0f\u80fd\u591f\u8bbe\u7f6e2\u4e2a\u53c2\u6570\uff0c\u5176\u4e00\u662fmode\u53ef\u9009\u503c\u7684\u8303\u56f4\u4e3a0-6\uff0c\u53e6\u4e00\u4e2a\u662fmiimon\u53ef\u586b\u7684\u503c\u76ee\u524d\u53ea\u77e5\u9053\u540e\u53f0\u7684\u9ed8\u8ba4\u503c\u4e3a100\u3002 removedBonds HostNics body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u5bf9\u4e3b\u673a\u7f51\u7edc\u63a5\u53e3\u7ed1\u5b9a\u5173\u7cfb\u7684\u5220\u9664\u64cd\u4f5c\u7684HostNic\u5bf9\u8c61\u7684\u96c6\u5408\u6620\u5c04\uff0cHostNics\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aHostNic\u5bf9\u8c61\u96c6\u5408\u7684\u5f15\u7528hostNics\uff0c\u4e00\u4e2aHostNic\u5bf9\u8c61\u4ee3\u8868\u4e00\u4e2a\u9700\u8981\u5220\u9664\u7f51\u7edc\u63a5\u53e3\u7ed1\u5b9a\uff0c\u5220\u9664\u96c6\u5408\u4e2d\u53ea\u9700\u8981\u6307\u5b9aHostNic\u5bf9\u8c61\u7684id\u5b57\u6bb5\u5373\u53ef\u3002 checkConnectivity Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u5728\u8bbe\u7f6e\u5b8c\u6210\u4e4b\u540e\uff0c\u6821\u9a8c\u4e3b\u673a\u548cEngine\u4e4b\u95f4\u7684\u7f51\u7edc\u8fde\u63a5\u6027\uff0c\u9ed8\u8ba4\u503c\u4e3afalse\u3002 connectivityTimeout Integer body \u53ef\u9009\u53c2\u6570\uff0c\u8bbe\u7f6e\u4e0e\u4e3b\u673a\u8fde\u63a5\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u9ed8\u8ba4\u503c\u4e3a vdc_options \u8868\u4e2d\u7684NetworkConnectivityCheckTimeoutInSeconds\u53c2\u6570\u5bf9\u5e94\u7684\u503c\u3002 \u8bf4\u660e\uff1a\u5728\u524d\u53f0\u64cd\u4f5c\u4e2d\uff0c\u4e00\u4e2a\u62d6\u52a8\u64cd\u4f5c\u53ef\u80fd\u5bf9\u5e94\u4e86\u591a\u4e2a\u5bf9\u8c61\u4fee\u6539\u6216\u8005\u521b\u5efa\uff0c\u5177\u4f53\u7684\u5bf9\u7167\u5173\u7cfb\u8bf7\u53c2\u8003 NetworkOperation \u679a\u4e3e\u7c7b\u4e2d\u6bcf\u4e2a\u679a\u4e3e\u5bf9\u8c61\u7684getTarget\u65b9\u6cd5\u8fd4\u56de\u7684 NetworkOperationCommandTarget \u5bf9\u8c61\u7684 executeNetworkCommand \u6240\u5bf9\u5e94\u7684\u64cd\u4f5c\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/hosts/{hostId}/setupnetworks { \"modifiedNetworkAttachments\": { \"networkAttachments\": [ { \"ipAddressAssignments\": { \"ipAddressAssignments\": [ { \"assignmentMethod\": \"STATIC\", \"ip\": { \"address\": \"192.168.18.127\", \"netmask\": \"255.255.255.0\", \"gateway\": \"192.168.18.2\", \"version\": \"V4\" } }, { \"assignmentMethod\": \"DHCP\", \"ip\": { \"version\": \"V6\" } } ] }, \"qos\": { \"type\": \"HOSTNETWORK\", \"outboundAverageLinkshare\": 10 }, \"hostNic\": { \"name\": \"ens33\" }, \"network\": { \"name\": \"ovirtmgmt\" } } ] }, \"synchronizedNetworkAttachments\": { \"networkAttachments\": [ { \"id\": \"a19e6492-0d6c-4a0a-8f24-27b5eee85380\" } ] }, \"removedNetworkAttachments\": { \"networkAttachments\": [ { \"id\": \"a19e6492-0d6c-4a0a-8f24-27b5eee85380\" } ] }, \"modifiedLabels\": { \"networkLabels\": [ { \"id\": \"test_label\", \"hostNic\": { \"name\": \"ens33\" } } ] }, \"removedLabels\": { \"networkLabels\": [ { \"id\": \"test_remove_label\" } ] }, \"modifiedBonds\": { \"hostNics\": [ { \"name\": \"bond0\", \"bonding\": { \"slaves\": { \"hostNics\": [ { \"id\": \"a19e6492-0d6c-4a0a-8f24-27b5eee85380\" }, { \"id\": \"a19e6492-0d6c-4a0a-8f24-27b5eee85381\" } ], \"options\": { \"options\": [ { \"name\": \"mode\", \"value\": \"1\" }, { \"name\": \"miimon\", \"value\": \"100\" } ] } } } } ] }, \"removedBonds\": { \"hostNics\": [ { \"id\": \"a19e6492-0d6c-4a0a-8f24-27b5eee85383\" } ] }, \"checkConnectivity\": true } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"2.5.15.\u8bbe\u7acb\u4e3b\u673a\u7f51\u7edc"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#2516_4","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u4e3b\u673a\u8bbe\u5907\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts/{hostId}/devices \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.5.16.\u83b7\u5f97\u4e3b\u673a\u8bbe\u5907\u5217\u8868"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#2517","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts/{hostId}/devices/{deviceId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.5.17.\u83b7\u5f97\u6307\u5b9a\u7684\u4e3b\u673a\u8bbe\u5907\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#2518hook","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u7684\u4e3b\u673aHOOK\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts/{hostId}/hooks \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.5.18.\u83b7\u5f97\u4e3b\u673aHOOK\u5217\u8868"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#2519hook","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/hosts/{hostId}/hooks/{hookId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.5.19.\u83b7\u5f97\u6307\u5b9a\u7684\u4e3b\u673aHOOK\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#26","text":"","title":"2.6.\u865a\u62df\u673a\u6a21\u677f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#261","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u5fc5\u8981\u53c2\u6570\uff0c\u8868\u793a\u521b\u5efa\u7684\u865a\u62df\u673a\u6a21\u677f\u540d\u5b57 vm VmModel body \u5fc5\u8981\u53c2\u6570\uff0c\u5176\u4e2d\u5fc5\u987b\u6307\u5b9a\u4f5c\u4e3a\u6a21\u677f\u7684\u865a\u62df\u673a\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\uff0cid\u5b57\u6bb5\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8ename\u5b57\u6bb5\u3002\u5982\u679c\u4f60\u60f3\u8981\u4fee\u6539\u865a\u62df\u673a\u6a21\u677f\u7684\u78c1\u76d8\u76f8\u5173\u7684\u53c2\u6570\uff0c\u4f60\u9700\u8981\u6307\u5b9aVmModel\u7684diskAttachments\u5b57\u6bb5\uff0cdiskAttachments\u662fDiskAttachments\u5bf9\u8c61\u4ee3\u8868\u865a\u62df\u673a\u9644\u52a0\u78c1\u76d8\u5217\u8868\uff0cDiskAttachments\u53ea\u62e5\u6709diskAttachments\u4e00\u4e2a\u5b57\u6bb5\uff0c\u662fDiskAttachment\u96c6\u5408\u7684\u5f15\u7528\uff0cDiskAttachment\u5bf9\u8c61\u7684disk\u5b57\u6bb5\u6240\u6307\u5411\u7684DiskModel\u624d\u662f\u771f\u6b63\u7684\u78c1\u76d8\u4fe1\u606f\u3002\u5f53\u9700\u8981\u4fee\u6539\u78c1\u76d8\u53c2\u6570\u65f6\u5fc5\u987b\u6307\u5b9a\u8981\u4fee\u6539DiskModel\u7684id\u5b57\u6bb5\u3002\u53ca\u8981\u4fee\u6539\u7684\u53c2\u6570\uff0c\u4f8b\u5982DiskModel\u7684name\u5b57\u6bb5\u8868\u793a\u8981\u4fee\u6539\u7684\u78c1\u76d8\u540d\uff1bDiskModel\u7684format\u5b57\u6bb5\u8868\u793a\u8981\u4fee\u6539\u7684\u78c1\u76d8\u683c\u5f0f\uff0c\u53ef\u9009\u503c\u5305\u62ecCOW\u548cRAW\uff1bDiskModel\u7684storageDomains\u5b57\u6bb5\u662fStorageDomains\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u8868\u793a\u6307\u5b9a\u78c1\u76d8\u7684\u5b58\u50a8\u57df\uff0cStorageDomains\u5bf9\u8c61\u53ea\u6301\u6709\u4e00\u4e2aStorageDomainModel\u96c6\u5408\u7684\u5f15\u7528storageDomains\u5b57\u6bb5\uff0c\u6307\u5b9a\u78c1\u76d8\u5b58\u50a8\u57df\u65f6\u53ea\u9700\u8981\u6307\u5b9a\u96c6\u5408\u4e2d\u4e00\u4e2aStorageDomainModel\u7684id\u5b57\u6bb5\u5373\u53ef\u3002 cluster ClusterModel body \u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u865a\u62df\u673a\u6a21\u677f\u6240\u5c5e\u7684\u96c6\u7fa4\uff0c\u53ef\u4ee5\u6307\u5b9a\u96c6\u7fa4\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\uff0c\u5982\u679c\u6307\u5b9a\u4e86\u96c6\u7fa4\u7684id\u5b57\u6bb5\uff0c\u90a3\u4e48name\u5b57\u6bb5\u5c31\u4e0d\u4f1a\u6709\u4efb\u4f55\u4f5c\u7528\u3002\u4e0d\u6307\u5b9a\u8be5\u53c2\u6570\u65f6\uff0c\u865a\u62df\u673a\u6a21\u677f\u6240\u5c5e\u7684\u96c6\u7fa4\u4e3a\u4f5c\u4e3a\u6a21\u677f\u7684\u865a\u62df\u673a\u6240\u5728\u7684\u96c6\u7fa4\u3002 cpuProfile CpuProfileModel body \u53ef\u9009\u53c2\u6570\uff0c\u5f53\u865a\u62df\u673a\u6a21\u677f\u6240\u5c5e\u7684\u96c6\u7fa4\u4e0e\u4f5c\u4e3a\u6a21\u677f\u7684\u865a\u62df\u673a\u6240\u5728\u7684\u96c6\u7fa4\u4e0d\u540c\u65f6\u9700\u8981\u6307\u5b9a\uff0c\u865a\u62df\u673a\u6a21\u677f\u7684CPU\u914d\u7f6e\u96c6\u5fc5\u987b\u662f\u865a\u62df\u673a\u6a21\u677f\u6240\u5c5e\u7684\u96c6\u7fa4\u4e0b\u7684CPU\u914d\u7f6e\u96c6\u4e4b\u4e00\uff0c\u53ea\u9700\u6307\u5b9aCpuProfileModel\u7684id\u5b57\u6bb5\u5373\u53ef\u3002\u9ed8\u8ba4\u503c\u4e3a\u4f5c\u4e3a\u6a21\u677f\u7684\u865a\u62df\u673a\u6240\u5728\u96c6\u7fa4\u7684\u7b2c\u4e00\u4e2acpu\u914d\u7f6e\u96c6\u3002 description String body \u53ef\u9009\u53c2\u6570\uff0c\u865a\u62df\u673a\u6a21\u677f\u63cf\u8ff0 version TemplateVersionModel body \u53ef\u9009\u53c2\u6570\uff0c\u5f53\u8be5\u5b57\u6bb5\u4e0d\u4e3a\u7a7a\u65f6\uff0c\u4ee3\u8868\u4e3a\u5f53\u524d\u865a\u62df\u673a\u5df2\u5b58\u5728\u7684\u6a21\u677f\u521b\u5efa\u5b50\u6a21\u677f\u3002TemplateVersionModel\u5bf9\u8c61\u67092\u4e2a\u5b57\u6bb5\u9700\u8981\u6307\u5b9a\uff1a1.baseTemplate\u5b57\u6bb5\uff0c\u662fTemplateModel\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u4e86\u8981\u521b\u5efa\u7684\u6a21\u677f\u7236\u6a21\u677f\uff0c\u53ea\u9700\u8981\u6307\u5b9aTemplateModel\u7684id\u5b57\u6bb5\u5373\u53ef\u30022.versionName\u5b57\u6bb5\uff0c\u7528\u4e8e\u6307\u5b9a\u5b50\u6a21\u677f\u7684\u7248\u672c\u540d\u3002 storageDomain StorageDomainModel body \u53ef\u9009\u53c2\u6570\uff0c\u65b9\u4fbf\u7edf\u4e00\u8bbe\u7f6e\u865a\u62df\u673a\u6a21\u677f\u7684\u78c1\u76d8\u6240\u5728\u7684\u6a21\u677f\u5b58\u50a8\u57df\uff0c\u53ea\u8981\u8bbe\u7f6eStorageDomainModel\u7684id\u5b57\u6bb5\u5373\u53ef\u3002\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5373\u4f7f\u5728VmModel\u4e2d\u8bbe\u7f6e\u4e86DiskAttachment\u5bf9\u8c61\u7684DiskModel\u5b58\u50a8\u57df\uff0c\u53ea\u8981\u4e00\u65e6\u8bbe\u7f6eStorageDomainModel\u7684id\u5b57\u6bb5\uff0cVmModel\u4e2d\u5bf9\u4e8e\u78c1\u76d8\u50a8\u5b58\u57df\u7684\u8bbe\u7f6e\u4fbf\u4f1a\u5931\u6548\u3002 clone_permissions Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u590d\u5236\u4f5c\u4e3a\u6a21\u677f\u7684\u865a\u62df\u673a\u7684\u6743\u9650\u5230\u521b\u5efa\u7684\u865a\u62df\u673a\u6a21\u677f\u4e0a\u3002 usb UsbModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u6a21\u677f\u7684usb\u7b56\u7565\uff0cUsbModel\u5177\u67092\u4e2a\u5b57\u6bb5\uff1a1.enabled\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u542f\u7528usb\u7b56\u7565\uff0c\u53ea\u6709\u8be5\u5b57\u6bb5\u4e3atrue\u65f6\uff0c\u5176\u4ed6\u5b57\u6bb5\u624d\u80fd\u751f\u6548\u30022.type\u5b57\u6bb5\uff0c\u4ee3\u8868usb\u7b56\u7565\u7c7b\u578b\uff0c\u53ef\u9009\u503c\u6709LEGACY\u548cNATIVE\u3002 consoleEnabled Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u662f\u5426\u542f\u7528\u63a7\u5236\u53f0\u3002\u9ed8\u8ba4\u503c\u662f\u6839\u636e\u4e3a\u6a21\u677f\u7684\u865a\u62df\u673a\u662f\u5426\u5177\u6709\u63a7\u5236\u53f0\u8bbe\u5907\u51b3\u5b9a\u7684\u3002 virtioScsiEnabled Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u662f\u5426\u542f\u7528virtioScsi\u3002\u9ed8\u8ba4\u503c\u4e3anull\u3002 soundcardEnabled Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u662f\u5426\u542f\u7528\u58f0\u5361\u3002\u9ed8\u8ba4\u503c\u662f\u6839\u636e\u4e3a\u6a21\u677f\u7684\u865a\u62df\u673a\u662f\u5426\u5177\u6709\u58f0\u5361\u8bbe\u5907\u51b3\u5b9a\u7684\u3002 display DisplayModel body \u53ef\u9009\u53c2\u6570\uff0cDisplayModel\u4ee3\u8868\u865a\u62df\u673a\u7684\u663e\u793a\u6a21\u578b\uff0c\u6709\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\uff1a1.type\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u4f7f\u7528\u7684\u56fe\u5f62\u534f\u8bae\uff0c\u53ef\u9009\u7684\u56fe\u5f62\u534f\u8bae\u9009\u9879\u6709VNC\u548cSPICE\uff0c\u5f53\u8bbe\u7f6e\u4e86\u8be5\u5b57\u6bb5\u865a\u62df\u7684\u89c6\u9891\u7c7b\u578b\uff08defaultDisplayType\uff09\u4f1a\u88ab\u7f6e\u4e3a\u7a7a\uff0c\u7531\u540e\u53f0\u51b3\u5b9a\u30022.monitors\u5b57\u6bb5\uff0c\u4ee3\u8868\u76d1\u89c6\u5668\u6570\u91cf\u30023.singleQxlPci\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u4e3a\u5355\u4e2aPCI\u63a5\u53e3\u30024.smartcardEnabled\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u542f\u7528\u667a\u80fd\u5361\u30025.allowOverride\u5b57\u6bb5\uff0c\u4ee3\u8868\u662f\u5426\u5141\u8bb8\u63a7\u5236\u53f0\u91cd\u8fde\uff08\u4e0d\u77e5\u9053\u5565\u610f\u601d\uff09\u3002\u5728\u754c\u9762\u4e2d\u6ca1\u6709\u5bf9\u5e94\u7684\u9009\u9879\uff0c\u4e0e\u865a\u62df\u673a\u662f\u670d\u52a1\u5668\u8fd8\u662f\u684c\u9762\u76f8\u5173\uff0c\u5f53\u865a\u62df\u673a\u4e3a\u670d\u52a1\u5668\u65f6\u8be5\u4f1a\u88ab\u8bbe\u4e3atrue\u30026.keyboardLayout\u5b57\u6bb5\uff0c\u4ee3\u8868vnc\u952e\u76d8\u5e03\u5c40\uff08\u4f5c\u7528\u672a\u77e5\uff09\uff0c\u5728\u754c\u9762\u4e2d\u8be5\u9009\u9879\u88ab\u9690\u85cf\uff0c\u53ef\u9009\u5185\u5bb9\u89c1 vdc_options \u8868\u7684 VncKeyboardLayoutValidValues \u9009\u9879\u30027.fileTransferEnabled\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u542f\u7528SPICE\u6587\u4ef6\u8f6c\u6362\uff08\u4f5c\u7528\u672a\u77e5\uff09\uff0c\u5728\u754c\u9762\u4e2d\u8be5\u9009\u9879\u88ab\u9690\u85cf\u30028.copyPasteEnabled\u5b57\u6bb5\uff0c\u8868\u793a\u662f\u5426\u542f\u7528SPICE\u526a\u8d34\u677f\u590d\u5236\u548c\u7c98\u8d34\uff08\u4f5c\u7528\u672a\u77e5\uff09\uff0c\u5728\u754c\u9762\u4e2d\u8be5\u9009\u9879\u88ab\u9690\u85cf\u30029.disconnectAction\u5b57\u6bb5\uff0c\u4ee3\u8868\u63a7\u5236\u53f0\u8fde\u63a5\u4e2d\u65ad\u4ee5\u540e\u865a\u62df\u673a\u7684\u884c\u4e3a\uff0c\u53ef\u9009\u503c\u6709\uff1aNONE\uff08\u65e0\u64cd\u4f5c\uff09\u3001LOCK_SCREEN\uff08\u9501\u5b9a\u5c4f\u5e55\uff09\u3001LOGOUT\uff08\u7528\u6237\u767b\u51fa\uff09\u3001REBOOT\uff08\u91cd\u542f\u865a\u62df\u673a\uff09\u3001SHUTDOWN\uff08\u5173\u95ed\u865a\u62df\u673a\uff09\u3002 filter Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u5f53\u672a\u6307\u5b9a\u865a\u62df\u673aid\u5b57\u6bb5\u800c\u6307\u5b9a\u4e86\u865a\u62df\u673aname\u5b57\u6bb5\u65f6\uff0c\u6839\u636e\u865a\u62df\u673a\u540d\u67e5\u8be2\u6307\u5b9a\u865a\u62df\u673a\u65f6\u662f\u5426\u6839\u636e\u5f53\u524d\u767b\u5165\u7684\u7528\u6237\u6743\u9650\u8fc7\u6ee4\u67e5\u8be2\u7684\u865a\u62df\u673a\u3002 memory Long body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u6a21\u677f\u7684\u5185\u5b58\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3ab NumOfIoThreads Integer body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u6a21\u677f\u7684IO\u7ebf\u7a0b\u6570\u91cf cpu CpuModel body \u53ef\u9009\u53c2\u6570\uff0cCpuModel\u7684topology\u5b57\u6bb5\u662fCpuTopologyModel\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u4e86cpu\u7684\u62d3\u6251\u7ed3\u6784\u3002CpuTopologyModel\u6709\u51e0\u4e2a\u5b57\u6bb5\uff1a1.cores\u5b57\u6bb5\u4ee3\u8868\u4e86\u6bcf\u4e2a\u865a\u62df\u673a\u63d2\u69fd\u7684\u5185\u6838\u6570\uff1b2.sockets\u5b57\u6bb5\u4ee3\u8868\u4e86\u865a\u62df\u673acpu\u63d2\u69fd\u6570\u91cf\uff1b3.threads\u5b57\u6bb5\u4ee3\u8868\u6bcf\u4e2a\u5185\u6838\u7684cpu\u5185\u6838\u7684\u7ebf\u7a0b\u6570\u91cf\uff0c\u53ef\u9009\u503c\u53ea\u67091\u548c2\u3002CpuModel\u7684architecture\u5b57\u6bb5\uff0c\u4ee3\u8868\u96c6\u7fa4cpu\u67b6\u6784\u3002\u53ef\u9009\u7684cpu\u67b6\u6784\u6709x86_64\u548cppc64 highAvailability HighAvailabilityModel body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u9ad8\u53ef\u7528\u76f8\u5173\u7684\u914d\u7f6e\uff0c\u5176\u4e2denabled\u5b57\u6bb5\u8868\u793a\u662f\u5426\u5f00\u542f\u865a\u62df\u673a\u9ad8\u53ef\u7528\uff1bpriority\u5b57\u6bb5\u8868\u793a\u865a\u62df\u673a\u8fc1\u79fb\u7684\u4f18\u5148\u7ea7\uff0c\u4e3aInterge\u7c7b\u578b\u3002 migrationDowntime Integer body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u81ea\u5b9a\u4e49\u7684\u8fc1\u79fb\u4e0b\u7ebf\u65f6\u95f4\uff0c\u4e3aInterge\u7c7b\u578b\u3002 migration MigrationOptionsModel body \u53ef\u9009\u53c2\u6570\uff0cMigrationOptionsModel\u7684\u51e0\u4e2a\u5c5e\u6027\u6620\u5c04\u4e86\u96c6\u7fa4\u865a\u62df\u673a\u8fc1\u79fb\u7b56\u7565\u76843\u4e2a\u65b9\u9762\u30021. policy \u5b57\u6bb5\u662fMigrationPolicyModel\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u96c6\u7fa4\u7684\u8fc1\u79fb\u7b56\u7565\uff0c\u96c6\u7fa4\u53ef\u9009\u7684\u8fc1\u79fb\u7b56\u7565\u4e00\u5171\u67093\u79cd\uff1aLegacy\uff08id\u4e3a00000000-0000-0000-0000-000000000000\uff09\u3001Minimal downtime\uff08id\u4e3a80554327-0569-496b-bdeb-fcbbf52b827b\uff09\u548cSuspend workload if needed\uff08id\u4e3a80554327-0569-496b-bdeb-fcbbf52b827c\uff09\uff0c\u5176\u4e2dLegacy\u53ea\u8bbe\u7f6e\u4e86\u6700\u5927\u7684\u8fc1\u79fb\u6570\u91cf\u4e3a2\uff0c\u800c\u53e6\u59162\u79cd\u9009\u9879\u7684\u8be6\u7ec6\u914d\u7f6e\u89c1 vdc_optins \u8868\u7684 MigrationPolicies \u9009\u9879\uff0c\u8fc1\u79fb\u7b56\u7565\u9700\u8981\u8bbe\u7f6eMigrationPolicyModel\u5bf9\u8c61\u7684id\u5b57\u6bb5\uff0c\u9ed8\u8ba4\u503c\u4e3anull\uff1b2. autoConverge \u5b57\u6bb5\u548c compressed \u5b57\u6bb5\uff0c\u5206\u522b\u8868\u793a\u662f\u5426\u81ea\u52a8\u805a\u5408\u8fc1\u79fb\u4ee5\u53ca\u662f\u5426\u542f\u7528\u8fc1\u79fb\u538b\u7f29\u3002\u53ea\u6709\u5728\u8fc1\u79fb\u7b56\u7565\u4e3a Legacy \u65f6\uff0c\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u5728\u865a\u62df\u673a\u8fc1\u79fb\u8fc7\u7a0b\u4e2d\u624d\u4f1a\u751f\u6548\uff0c\u5b83\u4eec\u7684\u53ef\u9009\u503c\u6709\u4e09\u79cd\uff1aTRUE\u3001FALSE\u3001INHERIT\uff08\u8868\u793a\u4ece\u5168\u5c40\u8bbe\u7f6e\u7ee7\u627f\uff09\uff0c\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u4e3anull\u3002 customCpuModel String body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7684cpu\u7c7b\u578b\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u865a\u62df\u673acpu\u7c7b\u578b\uff0c\u5fc5\u987b\u4e0e\u865a\u62df\u673a\u6240\u5728\u96c6\u7fa4\u7684cpu\u7c7b\u578b\u4e3a\u540c\u4e00\u4ea7\u5546\uff0c\u4e14\u4ee3\u6570\u5fc5\u987b\u7b49\u4e8e\u6216\u4f4e\u4e8e\u96c6\u7fa4cpu\u7c7b\u578b\u3002 customEmulatedMachine String body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7684\u4eff\u771f\u673a\u3002 memoryPolicy MemoryPolicyModel body \u53ef\u9009\u53c2\u6570\uff0cMemoryPolicyModel\u5bf9\u8c61\u4ee3\u8868\u865a\u62df\u673a\u7684\u5185\u5b58\u7b56\u7565\uff0c\u5176guaranteed\u5b57\u6bb5\u4ee3\u8868\u865a\u62df\u673a\u4fdd\u8bc1\u7684\u7269\u7406\u5185\u5b58\uff0c\u5355\u4f4d\u4e3ab\u3002 os OperatingSystemModel body \u53ef\u9009\u53c2\u6570\uff0cOperatingSystemModel\u5bf9\u8c61\u4ee3\u8868\u4e0e\u7cfb\u7edf\u5f15\u5bfc\u6709\u5173\u7684\u53c2\u6570\u3002\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\u4f1a\u5f71\u54cd\u6a21\u677f\u7684\u521b\u5efa\uff1a1.boot\u5b57\u6bb5\u662fBootModel\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4ee3\u8868\u5f15\u5bfc\u8bbe\u5907\u5e8f\u5217\u3002BootModel\u53ea\u6301\u6709devices\u5b57\u6bb5\uff0c\u662fBootDeviceValues\u5bf9\u8c61\u7684\u5f15\u7528\u3002BootDeviceValues\u5bf9\u8c61\u662fBootDevice\u7684\u96c6\u5408\u6620\u5c04\uff0c\u53ea\u6301\u6709BootDevice\u96c6\u5408\u7684\u5f15\u7528bootDevice\u5b57\u6bb5\u3002BootDevice\u4ee3\u8868\u865a\u62df\u673a\u7684\u5f15\u5bfc\u8bbe\u5907\u5e8f\u5217\uff0c\u53ef\u9009\u503c\u6709\uff1aCDROM\uff08\u5149\u9a71\uff09\u3001HD\uff08\u786c\u76d8\uff09\u548cNETWORK\uff08\u7f51\u7edc\uff09\u3002\u5217\u8868\u4e2dBootDevice\u5404\u4e2a\u503c\u7684\u6392\u5217\u987a\u5e8f\uff0c\u4ee3\u8868\u865a\u62df\u673a\u5f15\u5bfc\u8bbe\u5907\u987a\u5e8f\uff0c\u5982\u679c\u51fa\u73b0\u91cd\u590d\u7684\u503c\uff0c\u4f1a\u5148\u53bb\u91cd\u30022.type\u5b57\u6bb5\uff0c\u4ee3\u8868\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\uff0c\u4f8b\u5982other_linux\uff0cwindows_7x64\u7b49\uff0c\u53ef\u9009\u503c\u53c2\u8003 /share/ovirt-engine/conf/osinfo-defaults.properties \u6587\u4ef6\u4e2d\u7684\u914d\u7f6e\u30023.kernel\u5b57\u6bb5\uff0c\u4ee3\u8868Linux\u5f15\u5bfc\u9009\u9879\u4e2d\u7684\u5185\u6838\u8def\u5f84\uff0c\u56e0\u6b64\u53ea\u6709\u5728\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u662flinux\u65f6\u624d\u4f1a\u751f\u6548\uff0c\u8be5\u5b57\u6bb5\u586b\u5199\u7684\u662flinux\u5185\u6838\u5728iso\u57df\u7684\u8def\u5f84\u30024.initrd\u5b57\u6bb5\uff0c\u4ee3\u8868Linux\u5f15\u5bfc\u9009\u9879\u4e2d\u7684initrd\u8def\u5f84\uff0c\u56e0\u6b64\u53ea\u6709\u5728\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u662flinux\u65f6\u624d\u4f1a\u751f\u6548\uff0c\u8be5\u5b57\u6bb5\u586b\u5199\u7684\u662finitrd\u5728iso\u57df\u7684\u8def\u5f84\u30025.cmdline\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u81ea\u5b9a\u4e49\u7684\u5185\u6838\u53c2\u6570\uff0c\u683c\u5f0f\u76ee\u524d\u4e0d\u77e5\u9053\u3002 bootMenuEnabled Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u542f\u7528\u5f15\u5bfc\u83dc\u5355\u3002 timeZone TimeZoneModel body \u53ef\u9009\u53c2\u6570\uff0cTimeZoneModel\u5bf9\u8c61\u4ee3\u8868\u4e86\u865a\u62df\u673a\u7684\u65f6\u533a\u8bbe\u7f6e\u3002\u5176name\u5b57\u6bb5\uff0c\u4ee3\u8868\u865a\u62df\u673a\u65f6\u533a\uff0c\u53ef\u9009\u503c\u8be6\u89c1 TimeZoneType \u679a\u4e3e\u7c7b\u7684 initializeTimeZoneList \u65b9\u6cd5\u8fd4\u56de\u7684map\u7684key\u503c\u3002 origin String body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u6765\u6e90\uff08\u4e0d\u4f1a\u624b\u52a8\u8bbe\u7f6e\u5427\uff1f\uff09\uff0c\u53ef\u9009\u503c\u6709VMWARE\u3001XEN\u3001OVIRT\u3001EXTERNAL\u3001KVM\u3002 stateless Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u662f\u5426\u4e3a\u65e0\u72b6\u6001\u3002 deleteProtected Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u662f\u5426\u542f\u7528\u5220\u9664\u4fdd\u62a4\u3002 ssoEnabled Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u662f\u5426\u542f\u7528\u5355\u70b9\u767b\u5165\uff08\u5373\u662f\u5426\u4f7f\u7528GuestAgent\uff09\u3002 type String body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u7c7b\u578b\uff0c\u53ef\u9009\u503c\u6709\uff1aDESKTOP\uff08\u684c\u9762\uff09\u3001SERVER\uff08\u670d\u52a1\u5668\uff09\u3002 tunnelMigration Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u662f\u5426\u542f\u7528\u901a\u9053\u8fc1\u79fb\uff08\u4f5c\u7528\u672a\u77e5\uff09\uff0c\u754c\u9762\u6ca1\u627e\u5230\u4e0e\u4e4b\u5bf9\u5e94\u7684\u9009\u9879\u3002 startPaused Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u4ee3\u8868\u865a\u62df\u673a\u662f\u5426\u4ee5\u6682\u505c\u6a21\u5f0f\u542f\u52a8\u3002 customProperties CustomProperties body \u53ef\u9009\u53c2\u6570\uff0cCustomProperties\u662f\u865a\u62df\u673a\u81ea\u5b9a\u4e49\u53c2\u6570\u96c6\u5408\u7684\u6620\u5c04\uff0c\u6301\u6709\u552f\u4e00\u7684customProperties\u5b57\u6bb5\u662fCustomPropertyModel\u5217\u8868\u7684\u5f15\u7528\u3002CustomPropertyModel\u4ee3\u8868\u4e86\u6bcf\u4e00\u4e2a\u81ea\u5b9a\u4e49\u53c2\u6570\uff0c\u5176\u4e2dname\u5b57\u6bb5\u4ee3\u8868\u53c2\u6570\u540d\uff0cvalue\u5b57\u6bb5\u4ee3\u8868\u53c2\u6570\u503c\uff0cregexp\u4ee3\u8868\u6b63\u5219\u8868\u8fbe\u5f0f\u3002 quota QuotaModel body \u53ef\u9009\u53c2\u6570\uff0cQuotaModel\u4ee3\u8868\u4e86\u865a\u62df\u673a\u7684\u914d\u989d\uff0c\u914d\u989d\u5177\u4f53\u7684\u4f5c\u7528\u4e0d\u6e05\u695a\uff0c\u754c\u9762\u4e0a\u4e5f\u6ca1\u627e\u5230\u5bf9\u5e94\u7684\u5185\u5bb9\uff0c\u8fd9\u91cc\u53ea\u9700\u8981\u6307\u5b9aid\u5b57\u6bb5\u5373\u53ef\u3002 initialization InitializationModel body \u53ef\u9009\u53c2\u6570\uff0c\u865a\u62df\u673a\u521d\u59cb\u5316\u76f8\u5173\u7684\u5185\u5bb9\uff0c\u592a\u591a\u4e86\uff0c\u6682\u65f6\u5148\u4e0d\u5c55\u5f00\u3002 \u5bf9vm\u7684name\u5b57\u6bb5\u4ee5\u53caid\u5b57\u6bb5\u548ccluster\u7684name\u5b57\u6bb5\u5173\u7cfb\u7684\u4e00\u4e2a\u8bf4\u660e\uff1a\u5982\u679c\u6307\u5b9a\u4e86vm\u7684id\u5b57\u6bb5\uff0c\u521b\u5efa\u865a\u62df\u673a\u6a21\u677f\u7684\u4fe1\u606f\u6765\u6e90\u662f\u6839\u636e\u865a\u62df\u673aid\u67e5\u8be2\u83b7\u5f97\u552f\u4e00\u7684\u865a\u62df\u673a\u4fe1\u606f\u3002\u5982\u679c\u672a\u6307\u5b9avm\u7684id\u5b57\u6bb5\uff0c\u800c\u662f\u6307\u5b9a\u4e86vm\u7684name\u5b57\u6bb5\uff0c\u8fd9\u65f6\u5982\u679c\u672a\u6307\u5b9acluster\u7684name\u5b57\u6bb5\uff0c\u521b\u5efa\u865a\u62df\u673a\u6a21\u677f\u7684\u4fe1\u606f\u6765\u6e90\u662f\u5728\u6240\u6709\u865a\u62df\u673a\u4e2d\u83b7\u5f97\u540d\u5b57\u76f8\u540c\u7684\u865a\u62df\u673a\u4fe1\u606f\uff08\u4e0d\u540c\u6570\u636e\u4e2d\u5fc3\u7684\u865a\u62df\u673a\u53ef\u4ee5\u6709\u4e00\u6837\u7684\u540d\u5b57\uff09\uff1b\u8fd9\u65f6\u5982\u679c\u6307\u5b9a\u4e86cluster\u7684name\u5b57\u6bb5\u5e76\u4e14\u672a\u6307\u5b9acluster\u7684id\u5b57\u6bb5\uff0c\u521b\u5efa\u865a\u62df\u673a\u6a21\u677f\u7684\u4fe1\u606f\u6765\u6e90\u5219\u662f\u6839\u636e\u96c6\u7fa4\u6240\u5728\u7684\u6570\u636e\u4e2d\u5fc3\u4ee5\u53ca\u865a\u62df\u673a\u540d\u6765\u83b7\u5f97\u552f\u4e00\u7684\u865a\u62df\u673a\u4fe1\u606f\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/templates Body: { \"name\": \"test_tp\", \"vm\": { \"id\": \"66dcbd82-7644-4566-ad1f-125f4deafb87\" }, \"cluster\": { \"name\": \"cluster_updated\" }, \"cpuProfile\": { \"id\": \"f517fb01-ffbb-4514-85e7-410f2c7ab662\" }, \"description\": \"test add vm template\", \"display\": { \"type\": \"VNC\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.6.1.\u521b\u5efa\u865a\u62df\u673a\u6a21\u677f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#262","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e case_sensitive Boolean url \u53ef\u9009\uff0c\u4e0esearch\u53c2\u6570\u4e00\u8d77\u4f7f\u7528\uff0c\u6307\u5b9a\u5728\u6267\u884csearch\u53c2\u6570\u65f6\u662f\u5426\u8003\u8651\u5927\u5c0f\u5199 filter Boolean url \u53ef\u9009\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u865a\u62df\u673a\u6a21\u677f\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 max Integer url \u53ef\u9009\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u865a\u62df\u673a\u6a21\u677f\u6570\u91cf search String url \u53ef\u9009\uff0c\u67e5\u8be2\u7ea6\u675f\u6761\u4ef6\u7ea6\u675f\u8fd4\u56de\u4fe1\u606f\uff0c\u4f8b\u5982name=\"myname\" \u8bf7\u6c42\uff1a GET /acloudageks/api/templates \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.6.2.\u83b7\u5f97\u6240\u6709\u7684\u865a\u62df\u673a\u6a21\u677f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#263","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e storageDomain StorageDomainModel body \u5fc5\u8981\u53c2\u6570\uff0c\u8868\u793a\u9700\u8981\u865a\u62df\u673a\u6a21\u677f\u88ab\u5bfc\u51fa\u5230\u7684\u5bfc\u51fa\u57df\uff0c\u9700\u8981\u6307\u5b9aStorageDomainModel\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\u3002 exclusive Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u5f53\u5bfc\u51fa\u57df\u5b58\u5728\u540c\u540d\u865a\u62df\u673a\u6a21\u677f\u65f6\u662f\u5426\u8986\u76d6\u5df2\u7ecf\u5b58\u5728\u7684\u865a\u62df\u673a\u6a21\u677f\u3002\u9ed8\u8ba4\u503c\u4e3afalse. \u8bf7\u6c42\uff1a POST /acloudageks/api/templates/{templateId}/export Body: { \"storageDomain\": { \"id\": \"263612f2-d67b-4ce3-9c3e-af05fd4795bf\" }, \"exclusive\": true } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"2.6.3.\u5bfc\u51fa\u865a\u62df\u673a\u6a21\u677f\u5230\u5bfc\u51fa\u57df"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#264","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e filter Boolean url \u53ef\u9009\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u865a\u62df\u673a\u6a21\u677f\u4fe1\u606f\u662f\u5426\u6839\u636e\u7528\u6237\u6743\u9650\u88ab\u8fc7\u6ee4 \u8bf7\u6c42\uff1a GET /acloudageks/api/templates/{templateId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.6.4.\u83b7\u5f97\u6307\u5b9a\u7684\u865a\u62df\u673a\u6a21\u677f\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#265","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/templates/{templateId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.6.5.\u5220\u9664\u865a\u62df\u673a\u6a21\u677f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#266","text":"\u548c\u865a\u62df\u673a\u521b\u5efa\u4e00\u6837\uff0c\u53ef\u9009\u7684\u53c2\u6570\u592a\u591a\u4e86\u8fd9\u91cc\u5148\u4e0d\u8fdb\u884c\u6df1\u5165\u7684\u63a2\u7a76 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e ... ... body \u4e0e2.6.1\u4e2d\u7684\u53c2\u6570\u5927\u81f4\u76f8\u540c \u8bf7\u6c42\uff1a PUT /acloudageks/api/templates/{templateId} { \"description\": \"test update vm template\", \"type\": \"DESKTOP\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"2.6.6.\u66f4\u65b0\u865a\u62df\u6a21\u677f\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#27","text":"","title":"2.7.\u865a\u62df\u673a\u6a21\u677f\u7f51\u7edc\u63a5\u53e3"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#271","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u5fc5\u8981\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u540d\u3002 vnicProfile VnicProfileModel body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u7684\u914d\u7f6e\u96c6\uff0c\u8be5\u53c2\u6570\u53ea\u9700\u8981\u6307\u5b9aVnicProfileModel\u7684id\u5b57\u6bb5\uff0c\u9ed8\u8ba4\u503c\u4e3anull interface String body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u7f51\u5361\u7684\u63a5\u53e3\u7c7b\u578b\uff0c\u53ef\u9009\u7684\u503c\u4e00\u5171\u67096\u79cd\uff1aE1000\u3001VIRTIO\u3001RTL8139\u3001RTL8139_VIRTIO\u3001SPAPR_VLAN\u3001PCI_PASSTHROUGH\u3002\u9ed8\u8ba4\u503c\u4e3aRTL8139_VIRTIO\uff0c\u4f46\u662f\u8be5\u503c\u5728\u540e\u53f0\u6807\u8bb0\u4e3a\u5e9f\u5f03\u72b6\u6001\uff0c\u56e0\u6b64\u5efa\u8bae\u624b\u52a8\u8bbe\u7f6e\u8be5\u503c\uff1b\u53e6\u5916\u8be5\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u6709\u5173\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u7cfb\u7edf\u90fd\u80fd\u591f\u8bbe\u7f6e6\u79cd\u53ef\u9009\u503c mac MacModel body \u53ef\u9009\u53c2\u6570\uff0c\u8bbe\u7f6e\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u7684mac\u5730\u5740\uff0c\u82e5\u672a\u8bbe\u7f6e\u6b64\u503c\uff0c\u540e\u53f0\u4f1a\u4ecemac\u5730\u5740\u6c60\u5206\u914d\u5408\u9002\u7684mac\u5730\u5740 linked Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u662f\u5426\u8fde\u63a5\u7f51\u7ebf\uff0c\u9ed8\u8ba4\u503c\u4e3afalse plugged Boolean body \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u865a\u62df\u673a\u7684\u7f51\u5361\u662f\u5df2\u63d2\u5165\u8fd8\u662f\u62d4\u51fa\u72b6\u6001\uff0c\u9ed8\u8ba4\u503c\u4e3afalse \u8bf7\u6c42\uff1a POST /acloudageks/api/templates/{templateId}/nics Body: { \"name\": \"test_nic\", \"vnicProfile\": { \"id\": \"86684825-e8f8-43bb-97b0-6972e99eaf47\" }, \"interface\": \"VIRTIO\", \"linked\": true, \"plugged\": true } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.7.1.\u6dfb\u52a0\u865a\u62df\u673a\u6a21\u677f\u7f51\u7edc\u63a5\u53e3"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#272","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u865a\u62df\u673a\u6a21\u677f\u7f51\u7edc\u63a5\u53e3\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/templates/{templateId}/nics?max=1 \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.7.2.\u83b7\u5f97\u865a\u62df\u673a\u6a21\u677f\u6240\u6709\u7684\u7f51\u7edc\u63a5\u53e3\u5217\u8868"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#273","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/templates/{templateId}/nics/{nicId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.7.3.\u83b7\u5f97\u865a\u62df\u673a\u6a21\u677f\u6307\u5b9a\u7684\u7f51\u7edc\u63a5\u53e3\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#274","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/templates/{templateId}/nics/{nicId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.7.4.\u5220\u9664\u6307\u5b9a\u7684\u865a\u62df\u673a\u6a21\u677f\u7f51\u7edc\u63a5\u53e3"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#275","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 name String body \u4fee\u6539\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u540d\u3002 vnicProfile VnicProfileModel body \u4fee\u6539\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u7684\u914d\u7f6e\u96c6\uff0c\u8be5\u53c2\u6570\u53ea\u9700\u8981\u6307\u5b9aVnicProfileModel\u7684id\u5b57\u6bb5 interface String body \u4fee\u6539\u7f51\u5361\u7684\u63a5\u53e3\u7c7b\u578b\uff0c\u53ef\u9009\u7684\u503c\u4e00\u5171\u67096\u79cd\uff1aE1000\u3001VIRTIO\u3001RTL8139\u3001RTL8139_VIRTIO\u3001SPAPR_VLAN\u3001PCI_PASSTHROUGH\u3002\u9ed8\u8ba4\u503c\u4e3aRTL8139_VIRTIO\uff0c\u4f46\u662f\u8be5\u503c\u5728\u540e\u53f0\u6807\u8bb0\u4e3a\u5e9f\u5f03\u72b6\u6001\uff0c\u56e0\u6b64\u5efa\u8bae\u624b\u52a8\u8bbe\u7f6e\u8be5\u503c\uff1b\u53e6\u5916\u8be5\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u6709\u5173\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u7cfb\u7edf\u90fd\u80fd\u591f\u8bbe\u7f6e6\u79cd\u53ef\u9009\u503c mac MacModel body \u4fee\u6539\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u7684mac\u5730\u5740 linked Boolean body \u4fee\u6539\u865a\u62df\u673a\u7f51\u7edc\u63a5\u53e3\u662f\u5426\u8fde\u63a5\u7f51\u7ebf plugged Boolean body \u4fee\u6539\u865a\u62df\u673a\u7684\u7f51\u5361\u662f\u5df2\u63d2\u5165\u8fd8\u662f\u62d4\u51fa\u72b6\u6001 \u8bf7\u6c42\uff1a PUT /acloudageks/api/templates/{templateId}/nics/{nicId} Body: { \"name\": \"updated_nic\", \"vnicProfile\": { \"id\": \"86684825-e8f8-43bb-97b0-6972e99eaf47\" }, \"interface\": \"RTL8139\", \"linked\": false, \"plugged\": false } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.7.5.\u66f4\u65b0\u865a\u62df\u673a\u6a21\u677f\u7f51\u7edc\u63a5\u53e3\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#28","text":"\u4e0e\u865a\u62df\u673a\u6a21\u677f\u78c1\u76d8\u76f8\u5173\u7684\u63a5\u53e3\u5728\u6574\u7406\u65f6\u4e22\u5931\u4e86\uff0c\u6240\u4ee5\u9700\u8981\u5728 BackendTemplateResource \u63a5\u53e3\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u63a5\u53e3\u65b9\u6cd5\u624d\u80fd\u4f7f\u865a\u62df\u673a\u78c1\u76d8\u63a5\u53e3\u751f\u6548\u3002\u5728 ovirt3.0 \u865a\u62df\u673a\u78c1\u76d8\u76f8\u5173\u7684\u64cd\u4f5c\u5728\u6b64\u63a5\u53e3\u4e0b\u6267\u884c\uff0c\u4f46\u662f\u5728 ovirt4.0 \u4ee5\u540e\u7684\u865a\u62df\u673a\u78c1\u76d8\u76f8\u5173\u63a5\u53e3\u5728\u78c1\u76d8\u9644\u52a0\uff08DiskAttachments\uff09\u63a5\u53e3\u4e0b\u6267\u884c\uff0c\u4f46\u662f\u78c1\u76d8\u9644\u52a0\u63a5\u53e3\u7f3a\u5c11\u90e8\u5206\u64cd\u4f5c\uff08\u4f8b\u5982\u78c1\u76d8\u7684\u590d\u5236\uff09\uff0c\u5e76\u4e14\u63a5\u53e3\u8fd4\u56de\u7684\u5bf9\u8c61\u5c5e\u6027\uff0c\u5c06\u4f1a\u5728 2.9 \u8be6\u7ec6\u4ecb\u7ecd\u3002 @Path(\"disks\") TemplateDisksResource getDisksResource();","title":"2.8.\u865a\u62df\u673a\u6a21\u677f\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#281","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max Integer url \u53ef\u9009\uff0c\u6307\u5b9a\u8fd4\u56de\u7684\u6700\u5927\u865a\u62df\u673a\u6a21\u677f\u78c1\u76d8\u6570\u91cf \u8bf7\u6c42\uff1a GET /acloudageks/api/templates/{templateId}/disks?max=1 \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"2.8.1\u83b7\u5f97\u865a\u62df\u673a\u6a21\u677f\u78c1\u76d8\u5217\u8868"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#282","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 storageDomain StorageDomainModel body \u5fc5\u8981\u53c2\u6570\uff0c\u6307\u5b9a\u590d\u5236\u7684\u78c1\u76d8\u6240\u5728\u7684\u5b58\u50a8\u57df\uff0c\u9700\u8981\u6307\u5b9aStorageDomainModel\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/templates/{templateId}/disks/{diskId}/copy Body: { \"storageDomain\": { \"id\": \"263612f2-d67b-4ce3-9c3e-af05fd4795bf\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"2.8.2.\u590d\u5236\u865a\u62df\u673a\u6a21\u677f\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#283","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/templates/{templateId}/disks/{diskId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"2.8.3.\u83b7\u5f97\u865a\u62df\u673a\u6a21\u677f\u6307\u5b9a\u7684\u78c1\u76d8\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#284","text":"\u4ec5\u5f53\u5176\u4ed6\u5b58\u50a8\u57df\u4e0a\u8fd8\u6709\u5176\u4ed6\u73b0\u6709\u78c1\u76d8\u526f\u672c\u65f6\uff0c\u624d\u4f1a\u5220\u9664\u8be5\u78c1\u76d8 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e storage_domain String url \u5fc5\u8981\u53c2\u6570\uff0c\u5f53\u5220\u9664\u865a\u62df\u673a\u6a21\u677f\u7684\u78c1\u76d8\u65f6\u5fc5\u987b\u6307\u5b9a\u78c1\u76d8\u6240\u5728\u7684\u5b58\u50a8\u57dfId force Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u5f3a\u5236\u5220\u9664\u6307\u5b9a\u7684\u78c1\u76d8\uff0c\u9ed8\u8ba4\u503c\u4e3afalse \u8bf7\u6c42\uff1a DELETE /acloudageks/api/templates/{templateId}/disks/{diskId}?storage_domain=263612f2-d67b-4ce3-9c3e-af05fd4795bf \u8bf7\u6c42\u7ed3\u679c\uff1a\u5f85\u6d4b\u8bd5","title":"2.8.4.\u5220\u9664\u865a\u62df\u673a\u6a21\u677f\u6307\u5b9a\u7684\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#29","text":"\u4e0e 2.8 \u4e2d\u7684\u63a5\u53e3\u533a\u522b\u5728\u4e8e\u8fd4\u56de\u5bf9\u8c61\u7684\u5c5e\u6027\u4e0d\u540c\uff0c\u662f ovirt3.0 \u5230 ovirt4.0 \u7248\u672c\u53d8\u8fc1\u7684\u7ed3\u679c\uff0c\u4e0e 2.8 \u4e2d\u63a5\u53e3\u76f8\u6bd4\u7f3a\u5c11\u4e86\u590d\u5236\u78c1\u76d8\u7684\u63a5\u53e3\u3002","title":"2.9.\u865a\u62df\u6a21\u677f\u9644\u52a0\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#291","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/templates/{templateId}/diskattachments \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.9.1\u83b7\u5f97\u865a\u62df\u673a\u6a21\u677f\u9644\u52a0\u78c1\u76d8\u5217\u8868"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#292","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/templates/{templateId}/diskattachments/{diskattachmentId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.9.2.\u83b7\u5f97\u865a\u62df\u673a\u6a21\u677f\u6307\u5b9a\u7684\u9644\u52a0\u78c1\u76d8\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#293","text":"\u4ec5\u5f53\u5176\u4ed6\u5b58\u50a8\u57df\u4e0a\u8fd8\u6709\u5176\u4ed6\u73b0\u6709\u78c1\u76d8\u526f\u672c\u65f6\uff0c\u624d\u4f1a\u5220\u9664\u8be5\u78c1\u76d8 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e storage_domain String url \u5fc5\u8981\u53c2\u6570\uff0c\u5f53\u5220\u9664\u865a\u62df\u673a\u6a21\u677f\u7684\u78c1\u76d8\u65f6\u5fc5\u987b\u6307\u5b9a\u78c1\u76d8\u6240\u5728\u7684\u5b58\u50a8\u57dfId force Boolean url \u53ef\u9009\u53c2\u6570\uff0c\u8868\u793a\u662f\u5426\u5f3a\u5236\u5220\u9664\u6307\u5b9a\u7684\u78c1\u76d8\uff0c\u9ed8\u8ba4\u503c\u4e3afalse \u8bf7\u6c42\uff1a DELETE /acloudageks/api/templates/{templateId}/disks/{diskId}?storage_domain=263612f2-d67b-4ce3-9c3e-af05fd4795bf \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"2.9.3.\u5220\u9664\u865a\u62df\u673a\u6a21\u677f\u6307\u5b9a\u7684\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#30","text":"","title":"3.0\u7528\u6237\u767b\u5165\u767b\u51fa"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#301","text":"\u767b\u5165\u7684\u8fc7\u7a0b\u662f\u4e00\u4e2a\u7528\u6237\u8ba4\u8bc1\u52a0\u9875\u9762\u8df3\u8f6c\u7684\u8fc7\u7a0b\u3002 \u5728\u9875\u9762\u9009\u62e9\u4e09\u5458\u7684\u64cd\u4f5c\u65f6\uff0c\u5b9e\u9645\u6267\u884c /acloudageks/webadmin/?locale=zh_CN \u8bf7\u6c42\uff0c\u5bf9\u5e94\u7684\u76f8\u5e94\u670d\u52a1\u672a\u627e\u5230\uff0c\u8be5\u8bf7\u6c42\u4f1a\u8fd4\u56de302\u91cd\u5b9a\u5411\u72b6\u6001\u7801\u3002\u5c06\u9875\u9762\u91cd\u5b9a\u5411\u81f3 /acloudageks/webadmin/sso/login \u5e76\u4e14\u5bf9 app_url \u53c2\u6570\u8fdb\u884c\u4e86\u8d4b\u503c\uff0c /acloudageks/webadmin/sso/login \u5bf9\u5e94\u7684\u670d\u52a1\u4e5f\u6ca1\u6709\u627e\u5230\uff0c\u8be5\u8bf7\u6c42\u4e5f\u8fd4\u56de302\u72b6\u6001\u7801\uff0c\u5c06\u8bf7\u6c42\u91cd\u5b9a\u5411\u81f3 /acloudageks/sso/interactive-to-auth \uff08\u7531InteractiveToAuthServlet\u8fdb\u884c\u5904\u7406\uff09\u5e76\u4e14\u5bf9 redirect_uri \u3001 scope \u3001 reauthenticate \u53c2\u6570\u8fdb\u884c\u8d4b\u503c\uff0c\u7136\u540e\u8df3\u8f6c\u5230 /acloudageks/sso/login.html \u767b\u5165\u9875\u9762\u3002 \u6240\u4ee5\u4e09\u5458\u9009\u62e9\u5b9e\u9645\u4e0a\u662f\u5728\u540e\u53f0\u5bf9 redirect_uri \u3001 scope \u3001 reauthenticate \u548c app_url \u53c2\u6570\u8fdb\u884c\u8d4b\u503c\uff0c\u7136\u540e\u70b9\u51fb\u767b\u5165\u6309\u94ae\u624d\u662f\u6b63\u5219\u7684\u7528\u6237\u8ba4\u8bc1\u8fc7\u7a0b\u3002 \u7528\u6237\u7684\u8ba4\u8bc1\u4e5f\u5728 InteractiveToAuthServlet \u4e2d\uff08url\u4e3a /acloudageks/sso/interactive-to-auth \uff09\u8fdb\u884c\uff0c\u8ba4\u8bc1\u6210\u529f\u4ee5\u540e\u4f1a\u5c06\u8ba4\u8bc1\u4fe1\u606f\uff08\u5305\u62ecaccess_token\uff09\u50a8\u5b58\u5230request\u7684Session\u7684 ovirt-ssoSession \u57df\u6240\u6307\u5411\u7684SsoSession\u5bf9\u8c61\u4e2d\uff0c\u5e76SsoSession\u5bf9\u8c61\u6ce8\u518c\u5230\u8ba4\u8bc1\u4e2d\u5fc3\uff08 SsoContext \uff09\u3002\u7136\u540e\u5411\u524d\u53f0\u53d1\u8d77Redirect\u6307\u4ee4\uff08302\uff09\uff0c\u8bf7\u6c42\u5730\u5740\u4e3a /acloudageks/sso/interactive-to-app \uff0c\u8be5\u8bf7\u6c42\u5728 InteractiveToAppServlet \u4e2d\u8fdb\u884c\u5904\u7406\uff0c\u505a\u7684\u64cd\u4f5c\u53ea\u662f\u7b80\u5355\u7684\u5c06SsoSession\u5bf9\u8c61\u7684access_token\u5b57\u6bb5\u548capp_url\u5b57\u6bb5\u505a\u4e3aRedirect\u6307\u4ee4\uff08302\uff09\u7684\u53c2\u6570\uff0c\u91cd\u5b9a\u5411\u5230 /acloudagekswebadmin/sso/oauth2-callback \uff0c\u8be5\u8bf7\u6c42\u7531 SsoPostLoginServlet \u8fdb\u884c\u5904\u7406\uff0c\u4e3b\u8981\u662f\u5bf9access_token\u8fdb\u884c\u9a8c\u8bc1\uff0c\u5e76\u5c06\u4f1a\u8bdd\u5b58\u50a8\u5230\u6570\u636e\u5e93\uff0c\u6700\u540e\u8df3\u8f6c\u5230app_url\u6307\u5411\u7684\u5730\u5740\u3002\u6240\u4ee5\u767b\u5165\u8bf7\u6c42\u4e0d\u4f1a\u8fd4\u56detoken\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e source_mac String url/body \u5fc5\u8981\u53c2\u6570\uff0c\u8868mac\u5730\u5740\uff1f\uff0c\u9ed8\u8ba4\u4f20\u7684\u662f00:00:00:00:00:00 username String url/body \u5fc5\u8981\u53c2\u6570\uff0c\u4ee3\u8868\u767b\u5f55\u7528\u6237\u540d password String url/body \u5fc5\u8981\u53c2\u6570\uff0c\u4ee3\u8868\u7528\u6237\u5bc6\u7801 profile String url/body \u5fc5\u8981\u53c2\u6570\uff0c\u4ee3\u8868\u57df\u540d redirect_uri String url/body \u5fc5\u8981\u53c2\u6570\uff0c\u5fc5\u987b\u624b\u52a8\u6307\u5b9a ip:port/acloudageks/webadmin/sso/oauth2-callback \u5426\u5219\u65e0\u6cd5\u6b63\u786e\u8fdb\u5165SsoPostLoginServlet\u7684\u5904\u7406\u903b\u8f91\u5c06\u4f1a\u8bdd\u5b58\u50a8\u5230\u6570\u636e\u5e93\u3002 app_url String url/body \u5fc5\u8981\u53c2\u6570\uff1f\u4ee3\u8868\u8ba4\u8bc1\u5de5\u4f5c\u5b8c\u6210\u4ee5\u540e\u8981\u8df3\u8f6c\u7684\u9875\u9762\u3002 scope String url/body \u53ef\u9009\u53c2\u6570\uff1f\u610f\u4e49\u4e0d\u660e reauthenticate String url/body \u53ef\u9009\u53c2\u6570\uff1f\u8ba4\u8bc1\u5931\u8d25\u91cd\u8bd5\u6b21\u6570 dynamicKey String url/body \u53ef\u9009\u53c2\u6570\uff0c\u5f53\u5f00\u542f\u52a8\u6001\u53e3\u4ee4\u65f6\uff0c\u9700\u8981\u6307\u5b9a\u6b64\u53c2\u6570\u3002 \u8bf4\u660e\uff1a\u8fd9\u4e9b\u53c2\u6570\u65e2\u53ef\u4ee5\u5728url\u4f20\u9012\uff0c\u4e5f\u53ef\u4ee5\u5728body\u4f20\u9012\u3002\u5728body\u4f20\u9012\u65f6\u5fc5\u987b\u4ee5\u8868\u5355\uff08\u5373Content-Type\u4e3aapplication/x-www-form-urlencoded\uff09\u7684\u5f62\u5f0f\u8fdb\u884c\u3002\u8fd9\u4e9b\u53c2\u6570\u90fd\u662f\u4ee5\u660e\u6587\u7684\u65b9\u5f0f\u4f20\u9012\u7684\u3002 \u8bf7\u6c42\uff1a \u4efb\u4f55http\u8bf7\u6c42\u65b9\u6cd5\u90fd\u53ef\u4ee5 POST /acloudageks/sso/interactive-to-auth?source_mac=00:00:00:00:00:00&username=systemAdmin&password=abcd1234&profile=internal&redirect_uri=http://172.16.2.240:8080/acloudageks/webadmin/sso/oauth2-callback&scope=ovirt-app-admin ovirt-app-api&app_url=http://172.16.2.240:8080/acloudageks/webadmin/&reauthenticate=0 \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.0.1.\u767b\u5165"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#302","text":"\u767b\u51fa\u7684\u903b\u8f91\u662f\u4e00\u4e2a\u6e05\u9664Session\u52a0\u9875\u9762\u8df3\u8f6c\u7684\u8fc7\u7a0b\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a \u4efb\u4f55http\u8bf7\u6c42\u65b9\u6cd5\u90fd\u53ef\u4ee5 GET /acloudageks/webadmin/sso/logout \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.0.2\u767b\u51fa"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#31","text":"","title":"3.1\u865a\u62df\u673a\u4e3b\u673a\u8bbe\u5907"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#311","text":"\u6dfb\u52a0\u4e3b\u673a\u8bbe\u5907\u7684\u5230\u865a\u62df\u673a\u7684\u524d\u63d0\u662f\u5148\u628a\u865a\u62df\u673a\u56fa\u5b9a\u5230\u4e3b\u673a\u4e0a \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e id String body \u53ef\u9009\u5fc5\u8981\u53c2\u6570\uff0c\u6dfb\u52a0\u4e3b\u673a\u8bbe\u5907\u5230\u865a\u62df\u673a\u65f6\uff0c\u9700\u8981\u6307\u5b9a\u4e3b\u673a\u8bbe\u5907\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\uff0cid\u5b57\u6bb5\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8ename\u5b57\u6bb5\u3002 name String body \u53ef\u9009\u5fc5\u8981\u53c2\u6570\uff0c\u6dfb\u52a0\u4e3b\u673a\u8bbe\u5907\u5230\u865a\u62df\u673a\u65f6\uff0c\u9700\u8981\u6307\u5b9a\u4e3b\u673a\u8bbe\u5907\u7684id\u5b57\u6bb5\u6216\u8005name\u5b57\u6bb5\uff0cid\u5b57\u6bb5\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8ename\u5b57\u6bb5\u3002 \u8bf7\u6c42\uff1a POST /acloudageks/api/vms/{vmid}/hostdevices/ Body: { \"name\": \"pci_0000_00_07_1\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.1.1\u6dfb\u52a0\u865a\u62df\u673a\u4e3b\u673a\u8bbe\u5907"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#312","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/hostdevices/ \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.1.2\u83b7\u5f97\u865a\u62df\u673a\u4e3b\u673a\u8bbe\u5907\u5217\u8868"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#313","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/vms/{vmid}/hostdevices/{hostdeviceId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.1.3.\u83b7\u5f97\u865a\u62df\u673a\u6307\u5b9a\u7684\u4e3b\u673a\u8bbe\u5907"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#314","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/vms/{vmid}/hostdevices/{hostdeviceId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.1.4.\u5220\u9664\u865a\u62df\u673a\u6307\u5b9a\u7684\u4e3b\u673a\u8bbe\u5907"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#32","text":"","title":"3.2.\u7f51\u7edc"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#321","text":"\u8bf7\u6c42\uff1a GET /acloudageks/api/networks \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.2.1.\u83b7\u53d6\u7f51\u7edc"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#322id","text":"\u8bf7\u6c42\uff1a GET /acloudageks/api/networks/{network_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.2.2.\u83b7\u53d6\u6307\u5b9aid\u7684\u7f51\u7edc"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#323","text":"\u8bf7\u6c42\u53c2\u6570 \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body \u7f51\u7edc\u540d\u5b57 dataCenter String body \u865a\u62df\u673a\u6240\u5728\u6570\u636e\u4e2d\u5fc3\uff0c\u9700\u8981\u6307\u5b9a\u540d\u5b57\u6216\u8005id ... ... body \u4e0e\u7f51\u7edc\u76f8\u5173\u7684\u6240\u6709\u5c5e\u6027 \u8bf7\u6c42\uff1a POST /acloudageks/api/networks Body: { \"name\": \"myTest\", \"description\": \"\u6d4b\u8bd5postman\", \"dataCenter\": { \"id\": \"5dc116ca-02db-01cb-014d-000000000343\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"NetworkModel [name, dataCenter.name|id] required for add\", \"reason\": \"Incomplete parameters\" }","title":"3.2.3.\u6dfb\u52a0\u7f51\u7edc"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#324","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/networks/{network_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.2.4.\u5220\u9664\u7f51\u7edc"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#325","text":"\u66f4\u65b0\u7f51\u7edc\u7684\u4fe1\u606f \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 network Network body \u8bf7\u6c42\uff1a PUT /acloudageks/api/networks/{network_id} Body: { \"description\": \"\u6d4b\u8bd5\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.2.5.\u66f4\u65b0\u7f51\u7edc"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#326vnic","text":"\u8bf7\u6c42\uff1a GET /acloudageks/api/networks/{network_id}/vnicprofiles \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.2.6.\u83b7\u53d6\u7f51\u7edc\u7684vnic\u914d\u7f6e"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#327vnic","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body vnicprofile\u914d\u7f6e\u6587\u4ef6\u540d\u5b57 `... ... body \u4e0evnicprofile\u76f8\u5173\u7684\u6240\u6709\u5c5e\u6027 \u8bf7\u6c42\uff1a POST /acloudageks/api/networks/{network_id}/vnicprofiles Body\uff1a { \"name\": \"test\", \"description\": \"\u589e\u52a0vnicprofile\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"VnicProfileModel [name] required for validateParameters\", \"reason\": \"Incomplete parameters\" }","title":"3.2.7.\u589e\u52a0\u7f51\u7edc\u7684vnic\u914d\u7f6e"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#328vnic","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 networkFilter.id ID body \u53ef\u9009\uff0c\u7f51\u7edc\u8fc7\u6ee4\u5668 description String body \u63cf\u8ff0 ... VnicProfile body profile\u7684\u914d\u7f6e \u8bf7\u6c42\uff1a PUT /acloudageks/api/vnicprofiles/{vnicProfiles_id} Body\uff1a { \"description\": \"\u6d4b\u8bd5\u4fee\u6539vnicprofile\u63cf\u8ff0\", \"networkFilter\": { \"id\": \"5dc116cb-03ac-0143-0396-0000000003c1\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.2.8.\u66f4\u65b0\u7f51\u7edc\u7684vnic\u914d\u7f6e"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#329vnic","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/networks/{network_id}/vnicprofiles/{vnicProfiles_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.2.9.\u5220\u9664\u7f51\u7edc\u7684vnic\u914d\u7f6e"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#3210","text":"\u8bf7\u6c42\uff1a GET /acloudageks/api/networks/{network_id}/networklabels \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.2.10.\u67e5\u627e\u7f51\u7edc\u7684\u7f51\u7edc\u6807\u7b7e"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#3211","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e id String body \u8bf7\u6c42\uff1a POST /acloudageks/api/networks/{network_id}/networklabels Body { \"id\": \"abb\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"NetworkLabelModel [id] required for add\", \"reason\": \"Incomplete parameters\" }","title":"3.2.11.\u6dfb\u52a0\u7f51\u7edc\u7684\u7f51\u7edc\u6807\u7b7e"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#3212","text":"\u8bf7\u6c42\uff1a DELETE /acloudageks/api/networks/{network_id}/vnicprofiles/{vnicProfiles_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.2.12.\u5220\u9664\u7f51\u7edc\u7684\u7f51\u7edc\u6807\u7b7e"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#3213","text":"\u8bf7\u6c42\uff1a GET /acloudageks/api/networks/{network_id}/getvmnetwork \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.2.13.\u83b7\u53d6\u4f7f\u7528\u8fd9\u4e2a\u7f51\u7edc\u7684\u865a\u62df\u673a\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#33","text":"","title":"3.3.\u5b58\u50a8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#331","text":"\u521b\u5efa\u65b0\u7684StorageDomain\u9700\u8981\u540d\u79f0\uff0c\u7c7b\u578b\uff0c\u4e3b\u673a\u548c\u5b58\u50a8\u5c5e\u6027\u3002\u7528id\u6216name\u5c5e\u6027\u6807\u8bc6\u4e3b\u673a\u5c5e\u6027\u3002\u5728oVirt 3.6\u53ca\u66f4\u9ad8\u7248\u672c\u4e2d\uff0c\u60a8\u53ef\u4ee5\u9ed8\u8ba4\u5728\u5b58\u50a8\u57df\u4e0a\u542f\u7528\u201c\u5220\u9664\u540e\u64e6\u9664\u201d\u9009\u9879\u3002\u8981\u8fdb\u884c\u914d\u7f6e\uff0c\u8bf7\u5728POST\u8bf7\u6c42\u4e2d\u6307\u5b9awipe_after_delete\u3002\u521b\u5efa\u57df\u540e\u53ef\u4ee5\u7f16\u8f91\u6b64\u9009\u9879\uff0c\u4f46\u662f\u8fd9\u6837\u505a\u4e0d\u4f1a\u66f4\u6539\u5df2\u5b58\u5728\u7684\u78c1\u76d8\u7684delete after delete\u5c5e\u6027\u540e\u7684\u64e6\u9664\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body type String body \u57df\u7c7b\u578b\uff1aMASTER, DATA,ISO,IMPORTEXPORT,IMAGE,VOLUME host.name/host.id String body \u4e3b\u673a\u5c5e\u6027 storage.type String body \u5b58\u50a8\u7c7b\u578b\uff1aISCSI,FCP,NFS,LOCALFS,POSIXFS,GLANCE; storage.address String body \u57df\u7684ip storage.path String body \u57df\u7684\u5730\u5740 ... StorageDomain body StorageDomain\u7ed3\u6784\u4f53 \u8bf7\u6c42\uff1a\u6dfb\u52a0\u4e00\u4e2adata\u57df\u7684nfs\u5b58\u50a8 POST /acloudageks/api/storagedomains Body { \"name\": \"mydata\", \"type\": \"DATA\", \"storage\": { \"type\": \"NFS\", \"address\": \"mynfs.example.com\", \"path\": \"/exports/mydata\" }, \"host\": { \"name\": \"myhost\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"StorageDomainModel [host.id|name, type, storage] required for add\", \"reason\": \"Incomplete parameters\" } \u8bf7\u6c42\uff1a\u6dfb\u52a0\u4e00\u4e2aiso\u57df\u7684nfs\u5b58\u50a8 POST /acloudageks/api/storagedomains Body { \"name\": \"myisos\", \"type\": \"ISO\", \"storage\": { \"type\": \"NFS\", \"address\": \"mynfs.example.com\", \"path\": \"/export/myisos\" }, \"host\": { \"name\": \"myhost\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"StorageDomainModel [host.id|name, type, storage] required for add\", \"reason\": \"Incomplete parameters\" } \u8bf7\u6c42\uff1a\u6dfb\u52a0\u4e00\u4e2adata\u57df\u7684iscsi\u5b58\u50a8 POST /acloudageks/api/storagedomains Body { \"name\": \"myiscsi\", \"type\": \"DATA\", \"storage\": { \"type\": \"ISCSI\", \"logicalUnits\": { \"logicalUnits\": [ { \"id\": \"3600144f09dbd050000004eedbd340001\" }, { \"id\": \"3600144f09dbd050000004eedbd340002\" } ] } }, \"host\": { \"name\": \"myhost\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"StorageDomainModel [host.id|name, type, storage] required for add\", \"reason\": \"Incomplete parameters\" }","title":"3.3.1.\u6dfb\u52a0\u5b58\u50a8\u57df"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#332","text":"\u8bf7\u6c42\uff1a GET /acloudageks/api/storagedomains \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.3.2.\u83b7\u53d6\u5b58\u50a8\u57df"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#333id","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e filter Boolean body \u6307\u793a\u662f\u5426\u5e94\u6839\u636e\u7528\u6237\u6743\u9650\u8fc7\u6ee4\u7ed3\u679c\u3002 \u8bf7\u6c42\uff1a GET /acloudageks/api/storagedomains/{storagedomainId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.3.3.\u6839\u636e\u5b58\u50a8\u57dfID\u83b7\u53d6\u5b58\u50a8\u57df\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#334","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean In \u53ef\u9009\uff0c\u6307\u793a\u662f\u5426\u5e94\u5f02\u6b65\u6267\u884c\u64cd\u4f5c host.id/host.name Host In \u4e3b\u673a\u540d\u6216\u4e3b\u673aid \u8bf7\u6c42\uff1a POST /acloudageks/api/storagedomains/{storagedomainId}/isattached Body { \"host\":{ \"name\":\"172\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"ActionModel [host.id|name] required for isAttached\", \"reason\": \"Incomplete parameters\" }","title":"3.3.4.\u5b58\u50a8\u9644\u52a0\u5230\u6570\u636e\u4e2d\u5fc3"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#335lun","text":"\u5728\u5b58\u50a8\u670d\u52a1\u5668\u4e0a\u589e\u52a0\u57fa\u7840LUN\u7684\u5927\u5c0f\u540e\uff0c\u7528\u6237\u53ef\u4ee5\u5237\u65b0LUN\u7684\u5927\u5c0f\u3002\u5982\u679c\u9700\u8981\uff0c\u6b64\u64cd\u4f5c\u5c06\u5f3a\u5236\u91cd\u65b0\u626b\u63cf\u63d0\u4f9b\u7684LUN\u5e76\u4f7f\u7528\u65b0\u5927\u5c0f\u66f4\u65b0\u6570\u636e\u5e93\u3002 \u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean In \u53ef\u9009\uff0c\u6307\u793a\u662f\u5426\u5e94\u5f02\u6b65\u6267\u884c\u64cd\u4f5c logicalUnits LogicalUnit In \u6307\u5b9a\u7684luns \u4f8b\u5982\uff0c\u4e3a\u4e86\u5237\u65b0\u4e24\u4e2aLUN\u7684\u5927\u5c0f\uff0c\u8bf7\u53d1\u9001\u5982\u4e0b\u8bf7\u6c42\uff1a POST /acloudageks/api/storagedomains/{storageDomainId}/refreshluns { \"logicalUnits\": { \"logicalUnits\": [ { \"id\": \"3600144f09dbd050000004eedbd340001\" }, { \"id\": \"3600144f09dbd050000004eedbd340002\" } ] } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a\u6ca1\u6709iscsi\u5b58\u50a8\u7c7b\u578b { \"detail\": \"[Cannot edit Storage. Storage Domain type is illegal.]\", \"reason\": \"Operation Failed\" }","title":"3.3.5.\u5237\u65b0lun\u7684\u5927\u5c0f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#336","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u5e94\u5f02\u6b65\u6267\u884c\u64cd\u4f5c destroy Boolean url \u6307\u793a\u8be5\u64cd\u4f5c\u662f\u5426\u5e94\u8be5\u6210\u529f\uff0c\u5e76\u4e14\u5373\u4f7f\u65e0\u6cd5\u8bbf\u95ee\u5b58\u50a8\u4e5f\u4ece\u6570\u636e\u5e93\u4e2d\u5220\u9664\u4e86\u5b58\u50a8\u57df format Boolean url \u53ef\u9009\uff1a\u9ed8\u8ba4\u503c\u4e3afalse\u3002\u6307\u793a\u662f\u5426\u5e94\u683c\u5f0f\u5316\u5b9e\u9645\u5b58\u50a8\uff0c\u5e76\u4ece\u57fa\u7840LUN\u6216\u76ee\u5f55\u4e2d\u5220\u9664\u6240\u6709\u5143\u6570\u636e\uff1a[\u6e90\u4ee3\u7801] ----\u5220\u9664/ ovirt-engine / api / storagedomains / 123\uff1fformat = true host String url \u6307\u793a\u5e94\u4f7f\u7528\u54ea\u4e2a\u4e3b\u673a\u5220\u9664\u5b58\u50a8\u57df\u3002id/name \u8bf7\u6c42\uff1a DELETE /acloudageks/api/storagedomains/{storageDomainId}?host={hostName} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.3.6.\u5220\u9664\u5b58\u50a8\u57df"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#337","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u6307\u793a\u662f\u5426\u5e94\u5f02\u6b65\u6267\u884c\u64cd\u4f5c name String body \u4fee\u6539\u540d\u79f0 ... StorageDomain body StorageDomain\u7684\u5c5e\u6027 \u8bf7\u6c42\uff1a PUT /acloudageks/api/storagedomains/{storageDomainId} Body { \"name\": \"test2\", \"description\":\"\u6d4b\u8bd5\u4fee\u6539\u57df\u7684\u63cf\u8ff0\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.3.7.\u4fee\u6539\u57df\u7684\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#338","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max integer body \u53ef\u9009\uff0c\u8bbe\u7f6e\u8981\u8fd4\u56de\u7684\u865a\u62df\u673a\u7684\u6700\u5927\u6570\u91cf\u3002 \u8bf7\u6c42\uff1a GET /acloudageks/api/storagedomains/{storageDomainId}/vms \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.3.8.\u83b7\u53d6\u4f7f\u7528\u6b64\u5b58\u50a8\u57df\u7684\u865a\u62df\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#339","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max integer body \u53ef\u9009\uff0c\u8bbe\u7f6e\u8981\u8fd4\u56de\u7684\u6a21\u7248\u7684\u6700\u5927\u6570\u91cf\u3002 \u8bf7\u6c42\uff1a GET /acloudageks/api/storagedomains/{storageDomainId}/templates \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.3.9.\u83b7\u53d6\u4f7f\u7528\u6b64\u5b58\u50a8\u57df\u7684\u6a21\u7248"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#3310id","text":"\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max integer body \u53ef\u9009\uff0c\u8bbe\u7f6e\u8981\u8fd4\u56de\u7684\u865a\u62df\u673a\u7684\u6700\u5927\u6570\u91cf\u3002 \u8bf7\u6c42\uff1a GET /acloudageks/api/storagedomains/{storageDomainId}/vms/{vm_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.3.10.\u6839\u636e\u865a\u62df\u673aid\u83b7\u53d6\u57df\u4e2d\u7684\u865a\u62df\u673a\u7684\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#3311","text":"\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u6307\u793a\u662f\u5426\u5e94\u5f02\u6b65\u6267\u884c\u64cd\u4f5c clone Boolean body \u53ef\u9009\uff0c\u6307\u793a\u662f\u5426\u5e94\u91cd\u65b0\u751f\u6210\u5bfc\u5165\u7684\u865a\u62df\u673a\u7684\u6807\u8bc6\u7b26\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5bfc\u5165\u865a\u62df\u673a\u65f6\u5c06\u4fdd\u7559\u6807\u8bc6\u7b26\u3002\u8fd9\u610f\u5473\u7740\u540c\u4e00\u865a\u62df\u673a\u4e0d\u80fd\u591a\u6b21\u5bfc\u5165\uff0c\u56e0\u4e3a\u6807\u8bc6\u7b26\u5fc5\u987b\u552f\u4e00\u3002\u8981\u5141\u8bb8\u591a\u6b21\u5bfc\u5165\u540c\u4e00\u53f0\u8ba1\u7b97\u673a\uff0c\u8bf7\u5c06\u6b64\u53c2\u6570\u8bbe\u7f6e\u4e3atrue\uff0c\u56e0\u4e3a\u9ed8\u8ba4\u503c\u4e3afalse\u3002 cluster Cluster body collapseSnapshots Boolean body \u53ef\u9009\uff0c\u6307\u793a\u5e94\u8be5\u6298\u53e0\u5bfc\u5165\u7684\u865a\u62df\u673a\u7684\u5feb\u7167\uff0c\u4ee5\u4f7f\u7ed3\u679c\u5c06\u662f\u6ca1\u6709\u5feb\u7167\u7684\u865a\u62df\u673a\u3002\u6b64\u53c2\u6570\u662f\u53ef\u9009\u7684\uff0c\u5982\u679c\u672a\u660e\u786e\u6307\u5b9a\uff0c\u5219\u9ed8\u8ba4\u503c\u4e3afalse\u3002 storageDomains StorageDomain body \u53ef\u9009 vm Vm body \u53ef\u9009 \u8bf7\u6c42\uff1a POST /acloudageks/api/storagedomains/{storageDomainId}/vms/{vm_id}/import Body { \"storageDomain\": { \"name\": \"mydata\" }, \"cluster\": { \"name\": \"mycluster\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"ActionModel [cluster.id|name, storageDomain.id|name] required for doImport\", \"reason\": \"Incomplete parameters\" }","title":"3.3.11.\u5bfc\u5165\u865a\u62df\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#3312","text":"\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean In \u53ef\u9009\uff0c\u6307\u793a\u662f\u5426\u5e94\u5f02\u6b65\u6267\u884c\u64cd\u4f5c \u8bf7\u6c42\uff1a DELETE /acloudageks/api/storagedomains/{storageDomainId}/vms/{vm_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.3.12.\u5220\u9664\u57df\u4e2d\u7684\u865a\u62df\u673a"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#3313id","text":"\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max integer url \u53ef\u9009\uff0c\u8bbe\u7f6e\u8981\u8fd4\u56de\u7684\u865a\u62df\u673a\u7684\u6700\u5927\u6570\u91cf\u3002 \u8bf7\u6c42\uff1a GET /acloudageks/api/storagedomains/{storageDomainId}/vms/{vm_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.3.13.\u6839\u636e\u6a21\u7248id\u83b7\u53d6\u57df\u4e2d\u7684\u6a21\u7248\u7684\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#3314","text":"\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u6307\u793a\u662f\u5426\u5e94\u5f02\u6b65\u6267\u884c\u64cd\u4f5c clone Boolean body \u53ef\u9009\uff0c\u6307\u793a\u662f\u5426\u5e94\u91cd\u65b0\u751f\u6210\u5bfc\u5165\u7684\u6a21\u7248\u7684\u6807\u8bc6\u7b26\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5bfc\u5165\u865a\u62df\u673a\u65f6\u5c06\u4fdd\u7559\u6807\u8bc6\u7b26\u3002\u8fd9\u610f\u5473\u7740\u540c\u4e00\u865a\u62df\u673a\u4e0d\u80fd\u591a\u6b21\u5bfc\u5165\uff0c\u56e0\u4e3a\u6807\u8bc6\u7b26\u5fc5\u987b\u552f\u4e00\u3002\u8981\u5141\u8bb8\u591a\u6b21\u5bfc\u5165\u540c\u4e00\u53f0\u8ba1\u7b97\u673a\uff0c\u8bf7\u5c06\u6b64\u53c2\u6570\u8bbe\u7f6e\u4e3atrue\uff0c\u56e0\u4e3a\u9ed8\u8ba4\u503c\u4e3afalse\u3002 cluster Cluster body exclusive Boolean body \u53ef\u9009 storageDomains StorageDomain body \u53ef\u9009 template vm Vm body \u53ef\u9009 \u8bf7\u6c42\uff1a POST /acloudageks/api/storagedomains/{storageDomainId}/templates/{templates_id}/import Body { \"storageDomain\": { \"name\": \"mydata\" }, \"cluster\": { \"name\": \"mycluster\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"ActionModel [cluster.id|name, storageDomain.id|name] required for doImport\", \"reason\": \"Incomplete parameters\" }","title":"3.3.14.\u5bfc\u5165\u6a21\u7248"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#3315","text":"\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u6307\u793a\u662f\u5426\u5e94\u5f02\u6b65\u6267\u884c\u64cd\u4f5c \u8bf7\u6c42\uff1a DELETE /acloudageks/api/storagedomains/{storageDomainId}/templates/{vm_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.3.15.\u5220\u9664\u57df\u4e2d\u7684\u6a21\u7248"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#3316","text":"\u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max integer body \u53ef\u9009\uff0c\u8bbe\u7f6e\u8981\u8fd4\u56de\u7684\u6700\u5927\u6570\u91cf\u3002 \u8bf7\u6c42\uff1a GET /acloudageks/api/storagedomains/{storageDomainId}/disks \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.3.16.\u83b7\u53d6\u57df\u4e2d\u7684\u78c1\u76d8\u5217\u8868"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#3317id","text":"\u8bf7\u6c42\uff1a DELETE /acloudageks/api/storagedomains/{storageDomainId}/disks/{disk_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.3.17.\u6839\u636e\u78c1\u76d8id\u5220\u9664\u57df\u4e2d\u7684\u67d0\u4e2a\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#3318","text":"\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max integer body \u53ef\u9009\uff0c\u8bbe\u7f6e\u8981\u8fd4\u56de\u7684\u6700\u5927\u6570\u91cf\u3002 \u8bf7\u6c42\uff1a GET /acloudageks/api/storagedomains/{storageDomainId}/disksnapshots \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.3.18.\u83b7\u53d6\u78c1\u76d8\u5feb\u7167"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#3319","text":"\u8bf7\u6c42\uff1a DELETE /acloudageks/api/storagedomains/{storageDomainId}/disksnapshots/{disksnapshots_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.3.19.\u5220\u9664\u78c1\u76d8\u5feb\u7167"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#3320","text":"\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body storageDomain.id String body \u5b58\u50a8\u57df\u7684id ... diskprofile body \u5176\u4ed6\u7684\u4e00\u4e9b\u5c5e\u6027 \u8bf7\u6c42\uff1a POST /acloudageks/api/storagedomains/{storageDomainId}/diskprofiles { \"name\": \"333\", \"storageDomain\": { \"id\": \"{{storageDomainId}}\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 { \"detail\": \"DiskProfile [name] required for validateParameters\", \"reason\": \"Incomplete parameters\" }","title":"3.3.20.\u6dfb\u52a0\u78c1\u76d8\u914d\u7f6e\u96c6"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#3321","text":"\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e max integer body \u53ef\u9009\uff0c\u8bbe\u7f6e\u8981\u8fd4\u56de\u7684\u6700\u5927\u6570\u91cf\u3002 \u8bf7\u6c42\uff1a GET /acloudageks/api/storagedomains/{storageDomainId}/diskprofiles \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.3.21.\u83b7\u53d6\u78c1\u76d8\u914d\u7f6e\u96c6"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#3322","text":"\u8bf7\u6c42\uff1a GET /acloudageks/api/storagedomains/{{storageDomainId}}/diskprofiles/diskprofile_id \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.3.22.\u83b7\u53d6\u6307\u5b9a\u78c1\u76d8\u914d\u7f6e\u96c6\u7684\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#3323","text":"\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body ... diskprofile body \u5176\u4ed6\u7684\u4e00\u4e9b\u5c5e\u6027 \u8bf7\u6c42\uff1a PUT /acloudageks/api/diskprofiles/diskprofiles_id Body { \"name\":\"3333\", \"description\":\"\u6d4b\u8bd5\u66f4\u65b0\u78c1\u76d8\u914d\u7f6e\u96c6\u63cf\u8ff0\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.3.23.\u66f4\u65b0\u78c1\u76d8\u914d\u7f6e\u96c6\u5c5e\u6027"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#3324","text":"\u8bf7\u6c42\uff1a DELETE /acloudageks/api/storagedomains/{storageDomainId}/diskprofiles/{diskprofile_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.3.24.\u5220\u9664\u78c1\u76d8\u914d\u7f6e\u96c6"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#34","text":"","title":"3.4.\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#341","text":"\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e case_sensitive Boolean url \u53ef\u9009\uff1b\u6307\u793a\u662f\u5426\u5e94\u8003\u8651\u5927\u5c0f\u5199\u6765\u6267\u884c\u4f7f\u7528\u641c\u7d22\u53c2\u6570\u6267\u884c\u7684\u641c\u7d22\u3002 max integer url \u53ef\u9009\uff1b\u8bbe\u7f6e\u8981\u8fd4\u56de\u7684\u6700\u5927\u78c1\u76d8\u6570\u3002 search String url \u67e5\u8be2\u5b57\u7b26\u4e32\uff0c\u7528\u4e8e\u9650\u5236\u8fd4\u56de\u7684\u78c1\u76d8\u3002 \u8bf7\u6c42\uff1a GET /acloudageks/api/disks \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.4.1.\u83b7\u53d6\u6240\u6709\u78c1\u76d8\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#342","text":"\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body format DiskFormat body cow\uff0craw\uff0crow\uff1a\u201c\u5199\u65f6\u590d\u5236\u201d\u683c\u5f0f\u5141\u8bb8\u5feb\u7167\uff0c\u800c\u6027\u80fd\u5f00\u9500\u5f88\u5c0f\u3002raw\uff1a\u539f\u59cb\u683c\u5f0f\u4e0d\u5141\u8bb8\u4f7f\u7528\u5feb\u7167\uff0c\u4f46\u662f\u53ef\u4ee5\u63d0\u9ad8\u6027\u80fd\u3002 provisionedSize integer body \u78c1\u76d8\u7684\u865a\u62df\u5927\u5c0f\uff0c\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\u3002 .... Disk body \u5176\u4ed6\u7684disks\u5c5e\u6027 \u8bf7\u6c42\uff1a POST /acloudageks/api/disks Body { \"storageDomain\": { \"id\": \"{storageDomainId}\" }, \"name\": \"test_add_disk\", \"description\":\"test_add_disk\", \"provisionedSize\":1073741824, \"format\": \"COW\" } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"DiskModel [provisionedSize|size, format] required for add\", \"reason\": \"Incomplete parameters\" }","title":"3.4.2.\u6dfb\u52a0\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#343","text":"\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u53ef\u9009\uff0c\u6307\u793a\u662f\u5426\u5e94\u5f02\u6b65\u6267\u884c\u64cd\u4f5c \u8bf7\u6c42\uff1a DELETE /acloudageks/api/disks/{disk_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.4.3.\u5220\u9664\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#344","text":"\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u6307\u793a\u662f\u5426\u5e94\u5f02\u6b65\u6267\u884c\u590d\u5236\u3002 disk Disk body filter Boolean body \u6307\u793a\u662f\u5426\u5e94\u6839\u636e\u7528\u6237\u6743\u9650\u8fc7\u6ee4\u7ed3\u679c\u3002 storageDomain StorageDomain body \u5176\u4ed6\u7684disks\u5c5e\u6027 \u8bf7\u6c42\uff1a POST /acloudageks/api/disks/{disk_id}/copy Body { \"storageDomain\": { \"id\": \"{{storageDomainId}}\" }, \"disk\": { \"name\": \"mydisk\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"ActionModel [storageDomain.id|name] required for copy\", \"reason\": \"Incomplete parameters\" }","title":"3.4.4.\u590d\u5236\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#345","text":"\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean body \u6307\u793a\u662f\u5426\u5e94\u5f02\u6b65\u6267\u884c\u590d\u5236\u3002 filter Boolean body \u6307\u793a\u662f\u5426\u5e94\u6839\u636e\u7528\u6237\u6743\u9650\u8fc7\u6ee4\u7ed3\u679c\u3002 storageDomain StorageDomain body \u5176\u4ed6\u7684disks\u5c5e\u6027 \u8bf7\u6c42\uff1a POST /acloudageks/api/disks/{disk_id}/copy Body { \"storageDomain\": { \"id\": \"{{storageDomainId}}\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a\u5931\u8d25 \u5931\u8d25\u539f\u56e0\uff1a { \"detail\": \"ActionModel [storageDomain.id|name] required for move\", \"reason\": \"Incomplete parameters\" }","title":"3.4.5.\u79fb\u52a8\u78c1\u76d8"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#35","text":"","title":"3.5.\u865a\u62df\u673a\u6c60"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#351","text":"\u5f53\u6a21\u7248\u4e3a\u7cbe\u7b80\u5206\u914d\uff0c\u6a21\u7248\u7684\u78c1\u76d8\u4e3aRAW\u65f6\uff0c\u521b\u5efa\u865a\u62df\u673a\u6c60\u4f1a\u5931\u8d25\uff0c \u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e name String body cluster.id String body \u96c6\u7fa4id template.id String body \u6a21\u7248id size integer body \u865a\u62df\u673a\u6570\u91cf maxUserVms integer body \u5176\u4ed6\u7684disks\u5c5e\u6027 prestartedVms integer body \u9884\u542f\u52a8\u7684\u865a\u62df\u673a\u6570\u91cf ...... VmPool body \u5176\u4f59\u7684VmPool\u7684\u5c5e\u6027 \u8bf7\u6c42\uff1a POST /acloudageks/api/vmpools Body { \"name\": \"test_add_pool\", \"size\": 2, \"maxUserVms\": 1, \"prestartedVms\": 0, \"cluster\": { \"id\": \"{{test_add_cluster_id}}\" }, \"template\": { \"id\": \"{{test_export_domain_template_id}}\" } } \u8bf7\u6c42\u7ed3\u679c\uff1a \u5f53\u6a21\u7248\u4e3a\u7cbe\u7b80\u5206\u914d\uff0c\u6a21\u7248\u7684\u78c1\u76d8\u4e3aRAW\u65f6\uff0c\u521b\u5efa\u865a\u62df\u673a\u6c60\u4f1a\u5931\u8d25\uff0c\u8fd4\u56de\u7ed3\u679c\u4e3a\u4e0b \u8bf7\u6c42\u539f\u56e0\uff1a { \"detail\": \"[Cannot create VM-Pool. Thin provisioned template disks can not be defined as Raw.]\", \"reason\": \"Operation Failed\" } \u5f53\u78c1\u76d8\u4e3aQCOW2\u65f6\uff0c\u6210\u529f","title":"3.5.1 .\u6dfb\u52a0\u865a\u62df\u673a\u6c60"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#352","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e case_sensitive Boolean url \u6307\u793a\u662f\u5426\u5e94\u8be5\u8003\u8651\u5927\u5c0f\u5199\u6765\u6267\u884c\u4f7f\u7528\u641c\u7d22\u53c2\u6570\u6267\u884c\u7684\u641c\u7d22 filter Boolean url \u6307\u793a\u662f\u5426\u5e94\u6839\u636e\u7528\u6237\u6743\u9650\u8fc7\u6ee4\u7ed3\u679c\u3002 max Integer url \u8bbe\u7f6e\u8981\u8fd4\u56de\u7684\u6700\u5927\u6c60\u6570\u3002 search String url \u67e5\u8be2\u5b57\u7b26\u4e32\uff0c\u7528\u4e8e\u9650\u5236\u8fd4\u56de\u7684\u6c60 \u8bf7\u6c42\uff1a GET /acloudageks/api/vmpools \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.5.2.\u83b7\u53d6\u865a\u62df\u673a\u6c60"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#353","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e filter Boolean url \u6307\u793a\u662f\u5426\u5e94\u6839\u636e\u7528\u6237\u6743\u9650\u8fc7\u6ee4\u7ed3\u679c\u3002 \u8bf7\u6c42\uff1a GET /acloudageks/api/vmpools/{vm_pool_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.5.3.\u83b7\u53d6\u6307\u5b9a\u7684\u865a\u62df\u673a\u6c60\u7684\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#354","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e description String body \u63cf\u8ff0 size integer body \u589e\u52a0\u7684\u865a\u62df\u673a\u6570\u91cf maxUserVms integer body \u5176\u4ed6\u7684disks\u5c5e\u6027 prestartedVms integer body \u9884\u542f\u52a8\u7684\u865a\u62df\u673a\u6570\u91cf ...... VmPool body \u5176\u4f59\u7684VmPool\u7684\u5c5e\u6027 \u8bf7\u6c42\uff1a POST /acloudageks/api/vmpools/{vm_pool_id} Body \uff5b \"description\": \"update vm pool\" \uff5d \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.5.4.\u66f4\u65b0\u865a\u62df\u673a\u6c60\u7684\u4fe1\u606f"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#355","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e async Boolean url \u53ef\u9009\uff0c\u8868\u793a\u662f\u5426\u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\u8c03\u7528\u8be5\u8bf7\u6c42 \u8bf7\u6c42 DELETE /acloudageks/api/vmpools/{vm_pool_id} \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.5.5 .\u5220\u9664\u865a\u62df\u673a\u6c60"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#36","text":"","title":"3.6.\u7cfb\u7edf\u65e5\u5fd7"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#361","text":"\u53ea\u5b9a\u4e49\u4e86\u63a5\u53e3\uff0c\u5b9e\u73b0\u4e3a\u7a7a \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/logs \u8bf7\u6c42\u7ed3\u679c\uff1a\u672a\u5b9e\u73b0\u7684\u63a5\u53e3","title":"3.6.1.\u83b7\u5f97\u65e5\u5fd7"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#362","text":"\u53ea\u5b9a\u4e49\u4e86\u63a5\u53e3\uff0c\u5b9e\u73b0\u4e3a\u7a7a \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/logs/{logId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u672a\u5b9e\u73b0\u7684\u63a5\u53e3","title":"3.6.2.\u83b7\u5f97\u6307\u5b9a\u7684\u65e5\u5fd7"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#363","text":"\u53ea\u5b9a\u4e49\u4e86\u63a5\u53e3\uff0c\u5b9e\u73b0\u4e3a\u7a7a \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a DELETE /acloudageks/api/logs/{logId} \u8bf7\u6c42\u7ed3\u679c\uff1a\u672a\u5b9e\u73b0\u7684\u63a5\u53e3","title":"3.6.3.\u5220\u9664\u6307\u5b9a\u65e5\u5fd7"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#364","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/logs/export \u8bf7\u6c42\u7ed3\u679c\uff1a \u63a5\u53e3\u4e0d\u6b63\u786e\uff0c\u65e0\u6cd5\u4e0b\u8f7d\u6587\u4ef6\uff0c\u8fd4\u56de\u7684\u5185\u5bb9\u5982\u4e0b\uff1a file/log_file_75117da0-6b10-4377-92dc-85138ae49a1a.csv","title":"3.6.4.\u5bfc\u51fa\u65e5\u5fd7"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#365","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e page=1&username=systemAdmin%40internal&start=0&limit=20 \u539f\u751f\u53c2\u6570 body \u67e5\u8be2\u6761\u4ef6 \u8bf7\u6c42\uff1a POST /acloudageks/api/logs/notifications Body limit=1 \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f \u5efa\u8bae\uff1a\u8bf7\u6c42\u53c2\u6570\u7684\u683c\u5f0f\u53ef\u80fd\u4e0d\u592a\u5408\u9002\uff0c\u5efa\u8bae\u6539\u4e3aurl\u5f62\u5f0f\uff0c\u6216\u8005\u4ee5model\u7684\u5f62\u5f0f\u8fdb\u884c\u4f20\u9012\u3002","title":"3.6.5.\u83b7\u53d6\u6240\u6709\u8b66\u544a\u65e5\u5fd7"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#366","text":"\u8bf7\u6c42\u53c2\u6570\uff1a \u53c2\u6570\u540d \u7c7b\u578b \u4f4d\u7f6e \u8bf4\u660e moduleType=&sendIP=&riskLevel=&behaviourType=... \u539f\u751f\u53c2\u6570 body \u67e5\u8be2\u6761\u4ef6 \u8bf7\u6c42\uff1a POST /acloudageks/api/logs/getByConditions Body limit=1 \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f \u5efa\u8bae\uff1a\u8bf7\u6c42\u53c2\u6570\u7684\u683c\u5f0f\u53ef\u80fd\u4e0d\u592a\u5408\u9002\uff0c\u5efa\u8bae\u6539\u4e3aurl\u5f62\u5f0f\uff0c\u6216\u8005\u4ee5model\u7684\u5f62\u5f0f\u8fdb\u884c\u4f20\u9012\u3002","title":"3.6.6.\u6309\u6761\u4ef6\u67e5\u8be2\u65e5\u5fd7"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#366_1","text":"\u7531\u4e8e\u6e05\u7a7a\u65e5\u5fd7\u7684\u64cd\u4f5c\u662f\u4e00\u4e2a\u4f2a\u5220\u9664\u64cd\u4f5c\uff0c\u6240\u4ee5\u9700\u8981\u8fc7\u6ee4\u72b6\u6001\u7684\u4e3adeleted\u7684\u65e5\u5fd7\uff0c\u4f46\u662f\u6b64\u63a5\u53e3\u6ca1\u6709\u8fdb\u884c\u8fc7\u6ee4\uff0c\u9700\u8981\u4fee\u6539\u8be5\u63a5\u53e3\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/logs/getAll \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f","title":"3.6.6.\u83b7\u5f97\u6240\u6709\u7684\u65e5\u5fd7"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#367","text":"\u8fd9\u662f\u4e00\u4e2a\u4f2a\u5220\u9664\u64cd\u4f5c\uff0c\u53ea\u662f\u5c06\u65e5\u5fd7\u7684\u72b6\u6001\u8bbe\u7f6e\u4e3adeleted\uff0c\u5b9e\u9645\u4e0a\u5e76\u6ca1\u6709\u5220\u9664\u65e5\u5fd7\u3002\u5e76\u4e14\u5220\u9664\u7684\u65e5\u5fd7\u4e0e\u767b\u5165\u7684\u89d2\u8272\u76f8\u5173\u3002 \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a POST /acloudageks/api/logs/clear \u8bf7\u6c42\u7ed3\u679c\uff1a\u6210\u529f \u8bf4\u660e\uff1a\u8fd4\u56de\u7684\u7ed3\u679c\u7684\u5f62\u5f0f\u4e0e\u5176\u4ed6\u63a5\u53e3\u4e0d\u7edf\u4e00","title":"3.6.7.\u6e05\u7a7a\u65e5\u5fd7"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#368kvm","text":"\u53ea\u5b9a\u4e49\u4e86\u63a5\u53e3\uff0c\u5b9e\u73b0\u4e3a\u7a7a \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/logs/getKvmLog \u8bf7\u6c42\u7ed3\u679c\uff1a\u672a\u5b9e\u73b0\u7684\u63a5\u53e3","title":"3.6.8.\u83b7\u5f97kvm\u65e5\u5fd7"},{"location":"Work-related/Ovirt/[OvirtEngine]RestApi\u6574\u7406/#368root","text":"\u53ea\u5b9a\u4e49\u4e86\u63a5\u53e3\uff0c\u5b9e\u73b0\u4e3a\u7a7a \u8bf7\u6c42\u53c2\u6570\uff1a \u65e0 \u8bf7\u6c42\uff1a GET /acloudageks/api/logs/getRootLog \u8bf7\u6c42\u7ed3\u679c\uff1a\u672a\u5b9e\u73b0\u7684\u63a5\u53e3","title":"3.6.8.\u83b7\u5f97Root\u65e5\u5fd7"},{"location":"Work-related/Ovirt/[OvirtEngine]\u9501\u673a\u5236/","text":"EngineLock OvirtEngine\u662f\u901a\u8fc7 LockManager \u63a5\u53e3\uff0c\u63d0\u4f9b\u5bf9 command \u6267\u884c\u65f6\u5bf9\u5b9e\u9645\u8fdb\u884c\u8d44\u6e90\u7684\u52a0\u89e3\u9501\uff0c\u786e\u4fdd\u5e76\u53d1\u6267\u884c\u65f6\u7684\u5b89\u5168\u6027\u3002\u6839\u636e\u5e94\u7528\u7684\u7279\u70b9\uff0c\u63d0\u4f9b\u4e86\u4e24\u79cd\u7c7b\u578b\u7684\u9501\uff08 \u72ec\u5360\u9501 \u548c \u5171\u4eab\u9501 \uff09\uff0c\u5c01\u88c5\u5728\u4e86 EngineLock \u5bf9\u8c61\u4e2d\u3002 private Map<String, Pair<String, String>> exclusiveLocks; private Map<String, Pair<String, String>> sharedLocks; public EngineLock() { } public EngineLock(Map<String, Pair<String, String>> exclusiveLocks, Map<String, Pair<String, String>> sharedLocks) { this.exclusiveLocks = exclusiveLocks; this.sharedLocks = sharedLocks; } \u72ec\u5360\u9501 \u548c \u5171\u4eab\u9501 \u90fd\u53ef\u4ee5\u540c\u65f6\u9501\u5b9a\u591a\u4e2a\u8d44\u6e90\uff0c\u91c7\u7528\u4e86 Map > \u7684\u6570\u636e\u7ed3\u6784\uff0c\u5176\u4e2d\u5916\u5c42 Map \u7684 Key\uff0c\u5b58\u653e\u4e86 \u52a0\u9501\u8d44\u6e90\u7684 ID\uff0c\u4f8b\u5982\u865a\u62df\u673a ID\u3002 Pair Map Key \u5b58\u653e\u4e86\u9501\u5b9a\u8d44\u6e90\u7ec4\u7684\u7c7b\u578b\uff0c\u5982VM\uff0c Pair Map Value \u4e2d\u5b58\u653e\u4e86\u9501\u7ade\u4e89\u5931\u8d25\u65f6\u7ed9\u51fa\u7684\u9519\u8bef\u63d0\u793a\u4fe1\u606f\u3002 \u8d44\u6e90\u7ec4\u7684\u7c7b\u578b\u5982\u4e0b\uff1a \u5e8f\u53f7 \u53ef\u9501\u5b9a\u8d44\u6e90\u7ec4\u7c7b\u578b\u540d\u79f0 \u63cf\u8ff0 1 POOL \u6c60 2 VDS \u4e3b\u673a 3 VDS_INIT \u4e3b\u673a\u521d\u59cb\u5316 4 VDS_FENCE \u7535\u6e90\u7ba1\u7406 5 VM \u865a\u62df\u673a 6 TEMPLATE \u6a21\u7248 7 DISK \u78c1\u76d8 8 VM_DISK_BOOT \u5f15\u5bfc\u76d8 9 VM_NAME \u865a\u62df\u673a\u540d\u79f0 10 NETWORK \u7f51\u7edc 11 STORAGE \u5b58\u50a8 12 STORAGE_CONNECTION \u5b58\u50a8\u8fde\u63a5 13 REGISTER_VDS \u6ce8\u518c\u4e3b\u673a 14 VM_SNAPSHOTS \u865a\u62df\u673a\u5feb\u7167 15 GLUSTER \u5377 16 USER_VM_POOL \u6c60\u5206\u914d\u865a\u62df\u673a\u7ed9\u7528\u6237 17 REMOTE_TEMPLATE \u5bfc\u51fa\u6a21\u7248 18 REMOTE_VM \u5bfc\u51fa\u865a\u62df\u673a \u5728AbstractCommand\u4e2d\u5bf9\u83b7\u5f97\u72ec\u5360\u9501\u65b9\u6cd5getExclusiveLocks()\u548c\u83b7\u5f97\u5171\u4eab\u65b9\u6cd5 getSharedLocks()\u90fd\u7ed9\u51fa\u4e86\u9ed8\u8ba4\u7684\u7a7a\u5b9e\u73b0\uff0c\u5b50\u7c7b\u53ef\u4ee5\u91cd\u5199\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u6765\u6dfb\u52a0\u9501\u5b9a\u7684\u8d44\u6e90\u3002 \u9501\u8d44\u6e90\u7ade\u4e89\u8fc7\u7a0b \u5728Ovirt\u7684command\u7c7b\u6267\u884c\u771f\u7684\u903b\u8f91\u4e4b\u524d\u4f1a\u5bf9command\u7684\u6267\u884c\u7684\u6761\u4ef6\u8fdb\u884c\u521d\u59cb\u5316\u548c\u6821\u9a8c\u5de5\u4f5c\uff0c\u5176\u4e2d\u5c31\u6d89\u53ca\u4e86\u5bf9\u7ebf\u7a0b\u5171\u4eab\u8d44\u6e90\u7684\u9650\u5236\uff0c\u5728\u6267\u884c\u547d\u4ee4\u524d\u4f1a\u5c1d\u8bd5\u53bb\u83b7\u5f97\u9501\uff0c\u8be5\u65b9\u6cd5\u5728AbstractCommand\u4e2d\u7684\u5b9e\u73b0\u5982\u4e0b\uff1a public boolean acquireLock() { //\u4eceparameters\u4e2d\u83b7\u5f97\u9501\u5c5e\u6027\uff0c\u5982\u679cparameters\u6ca1\u6709\u76f8\u5e94\u7684\u53c2\u6570\uff0c\u5219\u4f7f\u7528\u9ed8\u8ba4\u503c //\u9ed8\u8ba4\u503c\u5305\u62ec\u9501\u8303\u56f4\u4e3anone\uff0c\u5f53\u9501\u7ade\u4e89\u5931\u8d25\u65f6\u4e0d\u7b49\u5f85\u83b7\u53d6\u9501 //\u53ef\u4ee5\u901a\u8fc7\u91cd\u5199applyLockProperties\u65b9\u6cd5\u5bf9\u9501\u7684\u5c5e\u6027\u8fdb\u884c\u4fee\u6539 LockProperties lockProperties = getLockProperties(); boolean result = true; //\u5982\u679c\u9501\u8303\u56f4\u4e3anone\u5219\u4e0d\u53bb\u5c1d\u8bd5\u83b7\u5f97\u9501\uff0c\u89c6\u4e3a\u83b7\u5f97\u9501\u6210\u529f if (!Scope.None.equals(lockProperties.getScope())) { //\u5982\u679c\u9501\u7684\u8303\u56f4\u4e3aExecution\uff0c\u5c06releaseLocksAtEndOfExecute\u8bbe\u4e3atrue //releaseLocksAtEndOfExecute\u8868\u793a\u5728command\u7684Execute\u9636\u6bb5\u7ed3\u675f\u91ca\u653e\u9501 //command\u7684\u591a\u4e2a\u9636\u6bb5\u5728\u8fd9\u91cc\u4e0d\u8fdb\u884c\u8d58\u8ff0 releaseLocksAtEndOfExecute = Scope.Execution.equals(lockProperties.getScope()); //\u5224\u65ad\u662f\u5426\u7b49\u5f85\u83b7\u5f97\u9501\uff0c\u9ed8\u8ba4\u503c\u4e3afalse if (!lockProperties.isWait()) { //\u7531\u4e8e\u9ed8\u8ba4\u503c\u7684\u539f\u56e0\uff0covirt\u4e2d\u5927\u90e8\u5206\u903b\u8f91\u53d1\u751f\u5728\u8fd9\u91cc //\u5f53\u53d1\u751f\u9501\u7ade\u4e89\u65f6\uff0c\u653e\u5f03\u83b7\u5f97\u9501\uff0ccommand\u6267\u884c\u5931\u8d25 result = acquireLockInternal(); } else { //\u5f53\u53d1\u751f\u9501\u7ade\u4e89\u65f6\uff0c\u7b49\u5f85\u83b7\u5f97\u9501\uff0c\u7136\u540e\u7ee7\u7eed\u6267\u884ccommnad acquireLockAndWait(); } } return result; } \u7531\u4e8eacquireLockAndWait()\u65b9\u6cd5\u4e0eacquireLockInternal()\u65b9\u6cd5\u903b\u8f91\u4e0a\u7684\u6700\u4e3b\u8981\u7684\u533a\u522b\u53ea\u6709\u9501\u7ade\u4e89\u5931\u8d25\u65f6\u662f\u5426\u7ee7\u7eed\u7b49\u5f85\u83b7\u5f97\u9501\uff08\u5171\u4eab\u9501\u4e0d\u9700\u8981\u7b49\u5f85\uff09\uff0c\u6240\u4ee5\u8fd9\u91cc\u5c31\u53ea\u5bf9\u4e3b\u8981\u6267\u884c\u903b\u8f91acquireLockInternal()\u65b9\u6cd5\u8fdb\u884c\u5c55\u5f00\u3002 protected boolean acquireLockInternal() { //\u5982\u679c\u5f53\u524d\u7684command\u6ca1\u6709\u9501\uff0c\u5219\u521b\u5efa\u4e00\u4e2a\u65b0\u9501\uff0c\u5426\u5219\u5f88\u53ef\u80fd\u5df2\u7ecf\u83b7\u5f97\u4e86\u7236\u547d\u4ee4\u7684\u9501\u3002 if (context.getLock() == null) { //\u6ca1\u6709\u9501\u5219\u6784\u5efaEngineLock EngineLock lock = buildLock(); //\u5982\u679c\u6784\u5efa\u7684\u9501\u4e0d\u4e3a\u7a7a\u624d\u7ee7\u7eed\u5c1d\u8bd5\u83b7\u5f97\u9501 //\u5373\u5982\u679c\u5b50\u7c7b\u6ca1\u6709\u91cd\u5199getExclusiveLocks()\u6216\u8005getSharedLocks()\u6765\u6dfb\u52a0\u9501\uff0c\u5219\u89c6\u4e3a\u83b7\u5f97\u9501\u6210\u529f if (lock != null) { //\u901a\u8fc7LockManager\u6765\u5c1d\u8bd5\u83b7\u5f97\u9501 Pair<Boolean, Set<String>> lockAcquireResult = getLockManager().acquireLock(lock); if (lockAcquireResult.getFirst()) { log.info(\"Lock Acquired to object '{}'\", lock); //\u83b7\u5f97\u9501\u6210\u529f\u540e\u5c06context\u9501\u8bbe\u7f6e\u4e3a\u6784\u9020\u7684\u9501 context.withLock(lock); } else { log.info(\"Failed to Acquire Lock to object '{}'\", lock); getReturnValue().getValidationMessages() .addAll(extractVariableDeclarations(lockAcquireResult.getSecond())); return false; } } } return true; } private EngineLock buildLock() { EngineLock lock = null; //\u8fd9\u4e2a\u4e24\u4e2a\u65b9\u6cd5\u9ed8\u8ba4\u8fd4\u56de\u503c\u4e3anull\uff0c\u7531\u5b50\u7c7b\u91cd\u5199\u6765\u52a0\u9501 Map<String, Pair<String, String>> exclusiveLocks = getExclusiveLocks(); Map<String, Pair<String, String>> sharedLocks = getSharedLocks(); //\u5982\u679c\u5b50\u7c7b\u6ca1\u6709\u91cd\u5199\u5176\u4e2d\u4efb\u4f55\u4e00\u4e2a\u65b9\u6cd5\uff0c\u5219\u4e0d\u8fdb\u884c\u9501\u7684\u6784\u5efa if (exclusiveLocks != null || sharedLocks != null) { lock = new EngineLock(exclusiveLocks, sharedLocks); } return lock; } \u4ece\u4e0a\u9762\u7684\u4ee3\u7801\u53ef\u4ee5\u770b\uff0c\u51fa\u5982\u679c\u5f53\u524d\u7684command\u62e5\u6709\u9501\uff0c\u5219\u8bf4\u660e\u4f7f\u7528\u7236command\u7684\u9501\uff1b\u5982\u679c\u5f53\u524dcommand\u6ca1\u6709\u9501\uff0c\u5219\u6784\u5efa\u65b0\u7684\u9501\uff0c\u9501\u7684\u6784\u5efa\u4e0e\u5b50\u7c7b\u662f\u5426\u91cd\u5199\u4e86getExclusiveLocks()\u6216\u8005getSharedLocks()\u6765\u6dfb\u52a0\u9501\u6709\u5173\uff0c\u82e5\u6ca1\u91cd\u5199\u4efb\u4f55\u65b9\u6cd5\u6765\u6dfb\u52a0\u9501\u5219\u89c6\u4e3a\u83b7\u5f97\u9501\u6210\u529f\uff0c\u5426\u5219\u8c03\u7528LockManager\u7684 acquireLock \u65b9\u6cd5\u6765\u5c1d\u8bd5\u83b7\u5f97\u9501\u3002 public Pair<Boolean, Set<String>> acquireLock(EngineLock lock) { log.debug(\"Before acquiring lock '{}'\", lock); //\u8fd9\u91cc\u7684globalLock\u4e3aJUC\u7684ReentrantLock\u5bf9\u8c61\uff0c\u662f\u4e00\u4e2a\u5168\u5c40\u9501 //\u4e4b\u6240\u4ee5\u79f0\u4e3a\u5168\u5c40\u9501\uff0c\u662f\u56e0\u4e3a\u6240\u6709\u8fd0\u884c\u7684command\u8c03\u7528\u6b64\u65b9\u6cd5\u65f6\u90fd\u4f1a\u7b49\u5f85\u83b7\u5f97globalLock\uff0c\u7136\u540e\u518d\u6267\u884c\u540e\u7eed\u64cd\u4f5c //\u9501\u7684\u7c92\u5ea6\u6bd4\u8f83\u5927\uff0c\u56e0\u6b64\u79f0\u4e3a\u5168\u5c40\u9501 globalLock.lock(); try { //\u83b7\u5f97\u4e86\u9501\u7684command\u624d\u80fd\u591f\u6267\u884cacquireLockInternal\u65b9\u6cd5 return acquireLockInternal(lock); } finally { globalLock.unlock(); } } \u8fd9\u91cc\u4f7f\u7528\u4e86JUC\u7684ReentrantLock\u6765\u5b9e\u73b0\u540c\u6b65\uff0c\u4fdd\u8bc1\u591a\u4e2acommnad\u7ebf\u7a0b\u6267\u884c\u6b64\u65b9\u6cd5\u65f6\uff0c\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u5728\u6267\u884cacquireLockInternal()\u65b9\u6cd5\u3002 private Pair<Boolean, Set<String>> acquireLockInternal(EngineLock lock) { boolean checkOnly = true; //\u8fd9\u91cc\u6267\u884c\u4e86\u4e24\u6b21\u5faa\u73af\uff0c\u7b2c\u4e00\u6b21checkOnly\u4e3atrue,\u7b2c\u4e8c\u6b21checkOnly\u4e3afalse //\u5373\u7b2c\u4e00\u6b21\u53ea\u6821\u9a8c\u662f\u5426\u80fd\u591f\u63d2\u5165\u9501\uff0c\u7b2c\u4e8c\u6b21\u624d\u53bb\u63d2\u5165\u9501 //\u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u907f\u514d\u5982\u679c\u6821\u9a8c\u548c\u63d2\u5165\u540c\u65f6\u8fdb\u884c\uff0c\u5982\u679c\u540e\u7eed\u6821\u9a8c\u5931\u8d25\u9700\u8981\u5bf9\u4e4b\u524d\u63d2\u5165\u7684\u9501\u8fdb\u884c\u5220\u9664 for (int i = 0; i < 2; i++) { if (lock.getSharedLocks() != null) { for (Entry<String, Pair<String, String>> entry : lock.getSharedLocks().entrySet()) { //\u5c06\u5171\u4eab\u9501\u653e\u5165hashMap\u7f13\u5b58,\u5e76\u8fd4\u56de\u662f\u5426\u83b7\u6210\u529f\u83b7\u5f97\u9501 Pair<Boolean, Set<String>> result = insertSharedLock(buildHashMapKey(entry), entry.getValue().getSecond(), checkOnly); if (!result.getFirst()) { log.debug(\"Failed to acquire lock. Shared lock is taken for key '{}',\" + \"value '{}'\", entry.getKey(), entry.getValue().getFirst()); return result; } } } if (lock.getExclusiveLocks() != null) { for (Entry<String, Pair<String, String>> entry : lock.getExclusiveLocks().entrySet()) { Pair<Boolean, Set<String>> result = //\u5c06\u72ec\u5360\u9501\u653e\u5165hashMap\u7f13\u5b58,\u5e76\u8fd4\u56de\u662f\u5426\u83b7\u6210\u529f\u83b7\u5f97\u9501 insertExclusiveLock(buildHashMapKey(entry), entry.getValue().getSecond(), checkOnly); if (!result.getFirst()) { log.debug(\"Failed to acquire lock. Exclusive lock is taken for key '{}',\" + \"value '{}'\", entry.getKey(), entry.getValue().getFirst()); return result; } } } checkOnly = false; } log.debug(\"Success acquiring lock '{}' succeeded \", lock); return LOCK_INSERT_SUCCESS_RESULT; } \u4e0a\u9762\u7684\u4ee3\u7801\u4f7f\u7528\u4e86\u4e24\u6b21\u5faa\u73af\u6765\u6267\u884c\u9501\u63d2\u5165\u64cd\u4f5c\uff08\u7b2c\u4e00\u6b21\u53ea\u68c0\u67e5\u80fd\u5426\u63d2\u5165\uff0c\u7b2c\u4e8c\u624d\u771f\u6b63\u8fdb\u884c\u63d2\u5165\uff09\uff0c\u76ee\u7684\u662f\u5f53\u6709\u591a\u4e2a\u9501\u9700\u8981\u68c0\u67e5\u7684\u8bdd\uff0c\u907f\u514d\u4e86\u540e\u7eed\u68c0\u67e5\u5931\u8d25\u65f6\u8981\u5bf9\u4e4b\u524d\u63d2\u5165\u7684\u9501\u8fdb\u884c\u5220\u9664\u3002\u800cinsertSharedLock()\u548cinsertExclusiveLock()\u771f\u6b63\u83b7\u5f97\u9501\u7684\u65b9\u6cd5\uff0c\u800c\u9501\u83b7\u5f97\u7684\u903b\u8f91\u5341\u5206\u7b80\u5355\uff0c\u4f7f\u7528MapEntry\u7684key\u4ee5\u53caPair\u7684\u7b2c\u4e00\u4e2a\u503c\u6784\u6210hashMap\u7684\u7684key\uff0cPair\u7684\u7b2c\u4e8c\u503c\u4f5c\u4e3avalue\u5b58\u5165HashMap\u7f13\u5b58\u3002\u533a\u522b\u4e24\u8005\u5bf9\u4e8e\u83b7\u5f97\u9501\u6210\u529f\u7684\u5224\u65ad\u4e0d\u540c\uff1a \u72ec\u5360\u9501\uff1a\u5982\u679c\u5bf9\u5e94\u7684key\u5728HashMap\u4e2d\u4e0d\u5b58\u5728\uff0c\u5c06key\u548cvalue\u5b58\u5165HashMap\uff0c\u89c6\u4e3a\u83b7\u5f97\u9501\u6210\u529f\u3002\u5982\u679c\u5bf9\u5e94\u7684key\u5728HashMap\u4e2d\u5b58\u5728\uff0c\u89c6\u4e3a\u83b7\u5f97\u9501\u5931\u8d25\u3002 \u5171\u4eab\u9501\uff1a\u5982\u679c\u5bf9\u5e94\u7684key\u5728HashMap\u4e2d\u4e0d\u5b58\u5728\uff0c\u5c06key\u548cvalue\u5b58\u5165HashMap\uff0c\u89c6\u4e3a\u83b7\u5f97\u9501\u6210\u529f\u3002\u5982\u679c\u5bf9\u5e94\u7684key\u5728HashMap\u4e2d\u5b58\u5728\uff0c\u5224\u65ad\u9501\u5bf9\u8c61\u662f\u4e0d\u662f\u72ec\u5360\u9501\uff0c\u5982\u679c\u662f\u72ec\u5360\u9501\uff0c\u89c6\u4e3a\u83b7\u5f97\u9501\u5931\u8d25\uff0c\u5426\u5219\u5c06\u5171\u4eab\u9501\u7684count\u6570\u52a0\u4e00\u3002 \u5230\u6b64\uff0c\u9501\u7ade\u4e89\u7684\u903b\u8f91\u5c31\u7ed3\u675f\u4e86\uff0c\u5f53\u83b7\u5f97\u9501\u5931\u8d25\u540e\uff0c\u547d\u4ee4\u7684\u6821\u9a8c\u4e5f\u5c31\u5931\u8d25\u4e86\uff0c\u547d\u4ee4\u4e5f\u5c31\u6267\u884c\u5931\u8d25\u4e86\u3002 \u9501\u7684\u91ca\u653e \u9501\u7684\u91ca\u653e\u5728AbstractCommand\u7684 freeLock() \u65b9\u6cd5\u4e2d\u5b9e\u73b0\uff0c\u5982\u4e0b\uff1a public void freeLock() { // \u5982\u679ccontext\u9501\u4e0d\u4e3a\u7a7a\uff0c\u8fdb\u884c\u91ca\u653e\u9501\u7684\u5de5\u4f5c if (context.getLock() != null) { // \u8c03\u7528LockManager\u7684releaseLock\u65b9\u6cd5\u91ca\u653e\u5f53\u524d\u9501 getLockManager().releaseLock(context.getLock()); log.info(\"Lock freed to object '{}'\", context.getLock()); context.withLock(null); // \u91ca\u653e\u5176\u4ed6\u9501\u81ea\u5b9a\u4e49\u7684\u9501 freeCustomLocks(); } } freeLock\u65b9\u6cd5\u4f1a\u5728\u4ee5\u4e0b\u51e0\u79cd\u60c5\u51b5\u4e0b\u88ab\u8c03\u7528\uff1a command\u7684\u6821\u9a8c\u5de5\u4f5c\u5931\u8d25\uff0c\u6700\u7ec8\u4f1a\u91ca\u653e\u6821\u9a8c\u8fc7\u7a0b\u4e2d\u52a0\u7684\u9501 \u9501\u7684\u8303\u56f4\u4e3aExecute\uff0c\u5728command\u7684Execute\u9636\u6bb5\u7ed3\u675f\u540e\u91ca\u653e\u9501 command\u7684\u6240\u6709action\u7ed3\u675f\uff0c\u5728endAction\u65b9\u6cd5\u4e2d\u91ca\u653e\u9501 \u5728command\u4e2d\u4e3b\u52a8\u8c03\u7528freeLock\u65b9\u6cd5 LockManager\u7684releaseLock\u65b9\u6cd5\u5982\u4e0b\uff1a public void releaseLock(EngineLock lock) { log.debug(\"Before releasing a lock '{}'\", lock); //\u4f7f\u7528\u5168\u5c40\u9501 globalLock.lock(); try { if (lock.getSharedLocks() != null) { for (Entry<String, Pair<String, String>> entry : lock.getSharedLocks().entrySet()) { //\u91ca\u653e\u5171\u4eab\u9501 releaseSharedLock(buildHashMapKey(entry), entry.getValue().getSecond()); } } if (lock.getExclusiveLocks() != null) { for (Entry<String, Pair<String, String>> entry : lock.getExclusiveLocks().entrySet()) { //\u91ca\u653e\u72ec\u5360\u9501 releaseExclusiveLock(buildHashMapKey(entry)); } } //isAwait\u4e3atrue\u7684\u9501\uff0c\u4f1a\u5728\u7ade\u4e89\u9501\u5931\u8d25\u65f6\u6302\u8d77 //\u8fd9\u91cc\u5524\u9192\u7b49\u5f85\u72ec\u5360\u9501\u7684\u7ebf\u7a0b\u5f00\u59cb\u7ade\u4e89\u83b7\u5f97\u9501 releasedLock.signalAll(); } finally { globalLock.unlock(); } } \u91ca\u653e\u9501\u7684\u8fc7\u7a0b\u4e5f\u5f88\u7b80\u5355\uff0c\u5171\u4eab\u9501\u91ca\u653e\u65f6\u5c06count\u51cf1\uff0c\u5f53count\u4e3a0\u65f6\u4ece\u7f13\u5b58\u4e2d\u5220\u9664\u9501\uff1b\u800c\u72ec\u5360\u9501\u91ca\u653e\u65f6\u76f4\u63a5\u5c06\u9501\u4ece\u7f13\u5b58\u4e2d\u5220\u9664\u5373\u53ef\u3002 \u53ea\u6539\u53d8\u6570\u636e\u5e93\u72b6\u6001\u7684\u64cd\u4f5c\u9501 OvirtEngine\u4e2d\u8fd8\u5b58\u5728\u53e6\u4e00\u79cd\u9501\uff0c\u53ea\u662f\u6539\u53d8Entity\u5728\u6570\u636e\u5e93\u7684\u72b6\u6001\uff0c\u4ece\u800c\u5b9e\u73b0\u9650\u5236\u524d\u53f0\u9875\u9762\u64cd\u4f5c\u7684\u529f\u80fd\u3002\u4f8b\u5982\uff0c\u524d\u53f0\u9501\u5b9aVM\u7684\u673a\u5236\uff0c\u5b9e\u9645\u4e0a\u662f\u5c06\u6570\u636e\u5e93\u7684status\u5b57\u6bb5\u8bbe\u7f6e\u4e3a ImageLocked \u72b6\u6001\uff0c\u800c\u524d\u53f0\u4f1a\u6839\u636e\u8fd9\u4e2a\u72b6\u6001\u6765\u9650\u5236\u9875\u9762\u7684\u64cd\u4f5c\u529f\u80fd\u3002VmHandler\u4e2dlockVm\u65b9\u6cd5\u5982\u4e0b\uff1a public static void lockVm(final VmDynamic vm, final CompensationContext compensationContext) { TransactionSupport.executeInNewTransaction(() -> { // \u5728\u4fee\u6539\u72b6\u6001\u524d\uff0c\u5148\u5b58\u50a8vm\u7684\u5feb\u7167\u4fe1\u606f\uff0c\u7528\u4e8e\u64cd\u4f5c\u5931\u8d25\u65f6\u6062\u590d\u6570\u636e compensationContext.snapshotEntityStatus(vm); // \u8c03\u7528lockVm\u65b9\u6cd5\u4fee\u6539vm\u72b6\u6001\uff0c\u4e3b\u8981\u5c31\u662f\u64cd\u4f5c\u6570\u636e\u5e93\u4fee\u6539status\u5b57\u6bb5 lockVm(vm.getId()); compensationContext.stateChanged(); }); } public static void lockVm(Guid vmId) { Backend.getInstance() .getResourceManager() .runVdsCommand(VDSCommandType.SetVmStatus, new SetVmStatusVDSCommandParameters(vmId, VMStatus.ImageLocked)); } \u662f\u5426\u9700\u8981\u52a0\u9501\uff0c\u7531\u4ee3\u7801\u7684\u903b\u8f91\u51b3\u5b9a\uff1b\u800c\u89e3\u9501\u5de5\u4f5c\u4e00\u822c\u5728command\u6267\u884c\u6210\u529f\u6216command\u5931\u8d25\u65f6\u6267\u884c\u3002 \u524d\u53f0\u5982\u4f55\u5b9e\u73b0\u9501\u5b9a\u64cd\u4f5c\uff1f \u5728VmListModel\u7684updateActionsAvailability()\u65b9\u6cd5\u7ef4\u62a4\u7740\u524d\u53f0\u6309\u94ae\u662f\u5426\u53ef\u4ee5\u70b9\u51fb\u7684\u903b\u8f91\uff0c\u4f8b\u5982\u5220\u9664\u865a\u62df\u673a\u6309\u94ae\u7684\u53ef\u6267\u884c\u903b\u8f91\u4e3a\uff1a getRemoveCommand() .setExecutable(vmsSelected && VdcActionUtils.canExecutePartially(items, VmWithStatusForExclusiveLock.class, VdcActionType.RemoveVm)); \u53ef\u4ee5\u770b\u51fa\u662f\u5426\u80fd\u70b9\u51fb\u7684\u4e3b\u8981\u903b\u8f91\u5728\u4e8eVdcActionUtils.canExecutePartially()\u65b9\u6cd5 public static boolean canExecutePartially(List<? extends BusinessEntityWithStatus<?, ?>> entities, Class type, VdcActionType action) { if (blacklist.containsKey(type)) { for (BusinessEntityWithStatus<?, ?> a : entities) { if (a.getClass() == type && (!blacklist.get(type).containsKey(a.getStatus()) || !blacklist.get(type).get(a.getStatus()).contains(action))) { return true; } } } else { return true; } return false; } \u53ef\u4ee5\u770b\u51fa\u524d\u53f0\u7ef4\u62a4\u7740\u4e00\u5f20status\u4e0eAction\u4e4b\u95f4\u7684\u9ed1\u540d\u5355\u5217\u8868\uff0c\u5373\u67d0\u4e9b\u72b6\u6001\u4e0b\u4e00\u4e9bAction\u4e0d\u80fd\u6267\u884c\uff0c VMStatus.ImageLocked \u7684action\u9ed1\u540d\u5355\u5982\u4e0b\uff1a vmBlacklist.put( VMStatus.ImageLocked, EnumSet.of( VdcActionType.RunVm, VdcActionType.CloneVm, VdcActionType.RunVmOnce, VdcActionType.StopVm, VdcActionType.ShutdownVm, VdcActionType.HibernateVm, VdcActionType.MigrateVm, VdcActionType.RemoveVm, VdcActionType.AddVmTemplate, VdcActionType.ExportVm, VdcActionType.ImportVm, VdcActionType.ChangeDisk, VdcActionType.CreateAllSnapshotsFromVm, VdcActionType.AddVmInterface, VdcActionType.UpdateVmInterface, VdcActionType.RemoveVmInterface, VdcActionType.CancelMigrateVm, VdcActionType.ExtendImageSize, VdcActionType.RebootVm));","title":"[OvirtEngine]\u9501\u673a\u5236"},{"location":"Work-related/Ovirt/[OvirtEngine]\u9501\u673a\u5236/#enginelock","text":"OvirtEngine\u662f\u901a\u8fc7 LockManager \u63a5\u53e3\uff0c\u63d0\u4f9b\u5bf9 command \u6267\u884c\u65f6\u5bf9\u5b9e\u9645\u8fdb\u884c\u8d44\u6e90\u7684\u52a0\u89e3\u9501\uff0c\u786e\u4fdd\u5e76\u53d1\u6267\u884c\u65f6\u7684\u5b89\u5168\u6027\u3002\u6839\u636e\u5e94\u7528\u7684\u7279\u70b9\uff0c\u63d0\u4f9b\u4e86\u4e24\u79cd\u7c7b\u578b\u7684\u9501\uff08 \u72ec\u5360\u9501 \u548c \u5171\u4eab\u9501 \uff09\uff0c\u5c01\u88c5\u5728\u4e86 EngineLock \u5bf9\u8c61\u4e2d\u3002 private Map<String, Pair<String, String>> exclusiveLocks; private Map<String, Pair<String, String>> sharedLocks; public EngineLock() { } public EngineLock(Map<String, Pair<String, String>> exclusiveLocks, Map<String, Pair<String, String>> sharedLocks) { this.exclusiveLocks = exclusiveLocks; this.sharedLocks = sharedLocks; } \u72ec\u5360\u9501 \u548c \u5171\u4eab\u9501 \u90fd\u53ef\u4ee5\u540c\u65f6\u9501\u5b9a\u591a\u4e2a\u8d44\u6e90\uff0c\u91c7\u7528\u4e86 Map > \u7684\u6570\u636e\u7ed3\u6784\uff0c\u5176\u4e2d\u5916\u5c42 Map \u7684 Key\uff0c\u5b58\u653e\u4e86 \u52a0\u9501\u8d44\u6e90\u7684 ID\uff0c\u4f8b\u5982\u865a\u62df\u673a ID\u3002 Pair Map Key \u5b58\u653e\u4e86\u9501\u5b9a\u8d44\u6e90\u7ec4\u7684\u7c7b\u578b\uff0c\u5982VM\uff0c Pair Map Value \u4e2d\u5b58\u653e\u4e86\u9501\u7ade\u4e89\u5931\u8d25\u65f6\u7ed9\u51fa\u7684\u9519\u8bef\u63d0\u793a\u4fe1\u606f\u3002 \u8d44\u6e90\u7ec4\u7684\u7c7b\u578b\u5982\u4e0b\uff1a \u5e8f\u53f7 \u53ef\u9501\u5b9a\u8d44\u6e90\u7ec4\u7c7b\u578b\u540d\u79f0 \u63cf\u8ff0 1 POOL \u6c60 2 VDS \u4e3b\u673a 3 VDS_INIT \u4e3b\u673a\u521d\u59cb\u5316 4 VDS_FENCE \u7535\u6e90\u7ba1\u7406 5 VM \u865a\u62df\u673a 6 TEMPLATE \u6a21\u7248 7 DISK \u78c1\u76d8 8 VM_DISK_BOOT \u5f15\u5bfc\u76d8 9 VM_NAME \u865a\u62df\u673a\u540d\u79f0 10 NETWORK \u7f51\u7edc 11 STORAGE \u5b58\u50a8 12 STORAGE_CONNECTION \u5b58\u50a8\u8fde\u63a5 13 REGISTER_VDS \u6ce8\u518c\u4e3b\u673a 14 VM_SNAPSHOTS \u865a\u62df\u673a\u5feb\u7167 15 GLUSTER \u5377 16 USER_VM_POOL \u6c60\u5206\u914d\u865a\u62df\u673a\u7ed9\u7528\u6237 17 REMOTE_TEMPLATE \u5bfc\u51fa\u6a21\u7248 18 REMOTE_VM \u5bfc\u51fa\u865a\u62df\u673a \u5728AbstractCommand\u4e2d\u5bf9\u83b7\u5f97\u72ec\u5360\u9501\u65b9\u6cd5getExclusiveLocks()\u548c\u83b7\u5f97\u5171\u4eab\u65b9\u6cd5 getSharedLocks()\u90fd\u7ed9\u51fa\u4e86\u9ed8\u8ba4\u7684\u7a7a\u5b9e\u73b0\uff0c\u5b50\u7c7b\u53ef\u4ee5\u91cd\u5199\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u6765\u6dfb\u52a0\u9501\u5b9a\u7684\u8d44\u6e90\u3002","title":"EngineLock"},{"location":"Work-related/Ovirt/[OvirtEngine]\u9501\u673a\u5236/#_1","text":"\u5728Ovirt\u7684command\u7c7b\u6267\u884c\u771f\u7684\u903b\u8f91\u4e4b\u524d\u4f1a\u5bf9command\u7684\u6267\u884c\u7684\u6761\u4ef6\u8fdb\u884c\u521d\u59cb\u5316\u548c\u6821\u9a8c\u5de5\u4f5c\uff0c\u5176\u4e2d\u5c31\u6d89\u53ca\u4e86\u5bf9\u7ebf\u7a0b\u5171\u4eab\u8d44\u6e90\u7684\u9650\u5236\uff0c\u5728\u6267\u884c\u547d\u4ee4\u524d\u4f1a\u5c1d\u8bd5\u53bb\u83b7\u5f97\u9501\uff0c\u8be5\u65b9\u6cd5\u5728AbstractCommand\u4e2d\u7684\u5b9e\u73b0\u5982\u4e0b\uff1a public boolean acquireLock() { //\u4eceparameters\u4e2d\u83b7\u5f97\u9501\u5c5e\u6027\uff0c\u5982\u679cparameters\u6ca1\u6709\u76f8\u5e94\u7684\u53c2\u6570\uff0c\u5219\u4f7f\u7528\u9ed8\u8ba4\u503c //\u9ed8\u8ba4\u503c\u5305\u62ec\u9501\u8303\u56f4\u4e3anone\uff0c\u5f53\u9501\u7ade\u4e89\u5931\u8d25\u65f6\u4e0d\u7b49\u5f85\u83b7\u53d6\u9501 //\u53ef\u4ee5\u901a\u8fc7\u91cd\u5199applyLockProperties\u65b9\u6cd5\u5bf9\u9501\u7684\u5c5e\u6027\u8fdb\u884c\u4fee\u6539 LockProperties lockProperties = getLockProperties(); boolean result = true; //\u5982\u679c\u9501\u8303\u56f4\u4e3anone\u5219\u4e0d\u53bb\u5c1d\u8bd5\u83b7\u5f97\u9501\uff0c\u89c6\u4e3a\u83b7\u5f97\u9501\u6210\u529f if (!Scope.None.equals(lockProperties.getScope())) { //\u5982\u679c\u9501\u7684\u8303\u56f4\u4e3aExecution\uff0c\u5c06releaseLocksAtEndOfExecute\u8bbe\u4e3atrue //releaseLocksAtEndOfExecute\u8868\u793a\u5728command\u7684Execute\u9636\u6bb5\u7ed3\u675f\u91ca\u653e\u9501 //command\u7684\u591a\u4e2a\u9636\u6bb5\u5728\u8fd9\u91cc\u4e0d\u8fdb\u884c\u8d58\u8ff0 releaseLocksAtEndOfExecute = Scope.Execution.equals(lockProperties.getScope()); //\u5224\u65ad\u662f\u5426\u7b49\u5f85\u83b7\u5f97\u9501\uff0c\u9ed8\u8ba4\u503c\u4e3afalse if (!lockProperties.isWait()) { //\u7531\u4e8e\u9ed8\u8ba4\u503c\u7684\u539f\u56e0\uff0covirt\u4e2d\u5927\u90e8\u5206\u903b\u8f91\u53d1\u751f\u5728\u8fd9\u91cc //\u5f53\u53d1\u751f\u9501\u7ade\u4e89\u65f6\uff0c\u653e\u5f03\u83b7\u5f97\u9501\uff0ccommand\u6267\u884c\u5931\u8d25 result = acquireLockInternal(); } else { //\u5f53\u53d1\u751f\u9501\u7ade\u4e89\u65f6\uff0c\u7b49\u5f85\u83b7\u5f97\u9501\uff0c\u7136\u540e\u7ee7\u7eed\u6267\u884ccommnad acquireLockAndWait(); } } return result; } \u7531\u4e8eacquireLockAndWait()\u65b9\u6cd5\u4e0eacquireLockInternal()\u65b9\u6cd5\u903b\u8f91\u4e0a\u7684\u6700\u4e3b\u8981\u7684\u533a\u522b\u53ea\u6709\u9501\u7ade\u4e89\u5931\u8d25\u65f6\u662f\u5426\u7ee7\u7eed\u7b49\u5f85\u83b7\u5f97\u9501\uff08\u5171\u4eab\u9501\u4e0d\u9700\u8981\u7b49\u5f85\uff09\uff0c\u6240\u4ee5\u8fd9\u91cc\u5c31\u53ea\u5bf9\u4e3b\u8981\u6267\u884c\u903b\u8f91acquireLockInternal()\u65b9\u6cd5\u8fdb\u884c\u5c55\u5f00\u3002 protected boolean acquireLockInternal() { //\u5982\u679c\u5f53\u524d\u7684command\u6ca1\u6709\u9501\uff0c\u5219\u521b\u5efa\u4e00\u4e2a\u65b0\u9501\uff0c\u5426\u5219\u5f88\u53ef\u80fd\u5df2\u7ecf\u83b7\u5f97\u4e86\u7236\u547d\u4ee4\u7684\u9501\u3002 if (context.getLock() == null) { //\u6ca1\u6709\u9501\u5219\u6784\u5efaEngineLock EngineLock lock = buildLock(); //\u5982\u679c\u6784\u5efa\u7684\u9501\u4e0d\u4e3a\u7a7a\u624d\u7ee7\u7eed\u5c1d\u8bd5\u83b7\u5f97\u9501 //\u5373\u5982\u679c\u5b50\u7c7b\u6ca1\u6709\u91cd\u5199getExclusiveLocks()\u6216\u8005getSharedLocks()\u6765\u6dfb\u52a0\u9501\uff0c\u5219\u89c6\u4e3a\u83b7\u5f97\u9501\u6210\u529f if (lock != null) { //\u901a\u8fc7LockManager\u6765\u5c1d\u8bd5\u83b7\u5f97\u9501 Pair<Boolean, Set<String>> lockAcquireResult = getLockManager().acquireLock(lock); if (lockAcquireResult.getFirst()) { log.info(\"Lock Acquired to object '{}'\", lock); //\u83b7\u5f97\u9501\u6210\u529f\u540e\u5c06context\u9501\u8bbe\u7f6e\u4e3a\u6784\u9020\u7684\u9501 context.withLock(lock); } else { log.info(\"Failed to Acquire Lock to object '{}'\", lock); getReturnValue().getValidationMessages() .addAll(extractVariableDeclarations(lockAcquireResult.getSecond())); return false; } } } return true; } private EngineLock buildLock() { EngineLock lock = null; //\u8fd9\u4e2a\u4e24\u4e2a\u65b9\u6cd5\u9ed8\u8ba4\u8fd4\u56de\u503c\u4e3anull\uff0c\u7531\u5b50\u7c7b\u91cd\u5199\u6765\u52a0\u9501 Map<String, Pair<String, String>> exclusiveLocks = getExclusiveLocks(); Map<String, Pair<String, String>> sharedLocks = getSharedLocks(); //\u5982\u679c\u5b50\u7c7b\u6ca1\u6709\u91cd\u5199\u5176\u4e2d\u4efb\u4f55\u4e00\u4e2a\u65b9\u6cd5\uff0c\u5219\u4e0d\u8fdb\u884c\u9501\u7684\u6784\u5efa if (exclusiveLocks != null || sharedLocks != null) { lock = new EngineLock(exclusiveLocks, sharedLocks); } return lock; } \u4ece\u4e0a\u9762\u7684\u4ee3\u7801\u53ef\u4ee5\u770b\uff0c\u51fa\u5982\u679c\u5f53\u524d\u7684command\u62e5\u6709\u9501\uff0c\u5219\u8bf4\u660e\u4f7f\u7528\u7236command\u7684\u9501\uff1b\u5982\u679c\u5f53\u524dcommand\u6ca1\u6709\u9501\uff0c\u5219\u6784\u5efa\u65b0\u7684\u9501\uff0c\u9501\u7684\u6784\u5efa\u4e0e\u5b50\u7c7b\u662f\u5426\u91cd\u5199\u4e86getExclusiveLocks()\u6216\u8005getSharedLocks()\u6765\u6dfb\u52a0\u9501\u6709\u5173\uff0c\u82e5\u6ca1\u91cd\u5199\u4efb\u4f55\u65b9\u6cd5\u6765\u6dfb\u52a0\u9501\u5219\u89c6\u4e3a\u83b7\u5f97\u9501\u6210\u529f\uff0c\u5426\u5219\u8c03\u7528LockManager\u7684 acquireLock \u65b9\u6cd5\u6765\u5c1d\u8bd5\u83b7\u5f97\u9501\u3002 public Pair<Boolean, Set<String>> acquireLock(EngineLock lock) { log.debug(\"Before acquiring lock '{}'\", lock); //\u8fd9\u91cc\u7684globalLock\u4e3aJUC\u7684ReentrantLock\u5bf9\u8c61\uff0c\u662f\u4e00\u4e2a\u5168\u5c40\u9501 //\u4e4b\u6240\u4ee5\u79f0\u4e3a\u5168\u5c40\u9501\uff0c\u662f\u56e0\u4e3a\u6240\u6709\u8fd0\u884c\u7684command\u8c03\u7528\u6b64\u65b9\u6cd5\u65f6\u90fd\u4f1a\u7b49\u5f85\u83b7\u5f97globalLock\uff0c\u7136\u540e\u518d\u6267\u884c\u540e\u7eed\u64cd\u4f5c //\u9501\u7684\u7c92\u5ea6\u6bd4\u8f83\u5927\uff0c\u56e0\u6b64\u79f0\u4e3a\u5168\u5c40\u9501 globalLock.lock(); try { //\u83b7\u5f97\u4e86\u9501\u7684command\u624d\u80fd\u591f\u6267\u884cacquireLockInternal\u65b9\u6cd5 return acquireLockInternal(lock); } finally { globalLock.unlock(); } } \u8fd9\u91cc\u4f7f\u7528\u4e86JUC\u7684ReentrantLock\u6765\u5b9e\u73b0\u540c\u6b65\uff0c\u4fdd\u8bc1\u591a\u4e2acommnad\u7ebf\u7a0b\u6267\u884c\u6b64\u65b9\u6cd5\u65f6\uff0c\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u5728\u6267\u884cacquireLockInternal()\u65b9\u6cd5\u3002 private Pair<Boolean, Set<String>> acquireLockInternal(EngineLock lock) { boolean checkOnly = true; //\u8fd9\u91cc\u6267\u884c\u4e86\u4e24\u6b21\u5faa\u73af\uff0c\u7b2c\u4e00\u6b21checkOnly\u4e3atrue,\u7b2c\u4e8c\u6b21checkOnly\u4e3afalse //\u5373\u7b2c\u4e00\u6b21\u53ea\u6821\u9a8c\u662f\u5426\u80fd\u591f\u63d2\u5165\u9501\uff0c\u7b2c\u4e8c\u6b21\u624d\u53bb\u63d2\u5165\u9501 //\u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u907f\u514d\u5982\u679c\u6821\u9a8c\u548c\u63d2\u5165\u540c\u65f6\u8fdb\u884c\uff0c\u5982\u679c\u540e\u7eed\u6821\u9a8c\u5931\u8d25\u9700\u8981\u5bf9\u4e4b\u524d\u63d2\u5165\u7684\u9501\u8fdb\u884c\u5220\u9664 for (int i = 0; i < 2; i++) { if (lock.getSharedLocks() != null) { for (Entry<String, Pair<String, String>> entry : lock.getSharedLocks().entrySet()) { //\u5c06\u5171\u4eab\u9501\u653e\u5165hashMap\u7f13\u5b58,\u5e76\u8fd4\u56de\u662f\u5426\u83b7\u6210\u529f\u83b7\u5f97\u9501 Pair<Boolean, Set<String>> result = insertSharedLock(buildHashMapKey(entry), entry.getValue().getSecond(), checkOnly); if (!result.getFirst()) { log.debug(\"Failed to acquire lock. Shared lock is taken for key '{}',\" + \"value '{}'\", entry.getKey(), entry.getValue().getFirst()); return result; } } } if (lock.getExclusiveLocks() != null) { for (Entry<String, Pair<String, String>> entry : lock.getExclusiveLocks().entrySet()) { Pair<Boolean, Set<String>> result = //\u5c06\u72ec\u5360\u9501\u653e\u5165hashMap\u7f13\u5b58,\u5e76\u8fd4\u56de\u662f\u5426\u83b7\u6210\u529f\u83b7\u5f97\u9501 insertExclusiveLock(buildHashMapKey(entry), entry.getValue().getSecond(), checkOnly); if (!result.getFirst()) { log.debug(\"Failed to acquire lock. Exclusive lock is taken for key '{}',\" + \"value '{}'\", entry.getKey(), entry.getValue().getFirst()); return result; } } } checkOnly = false; } log.debug(\"Success acquiring lock '{}' succeeded \", lock); return LOCK_INSERT_SUCCESS_RESULT; } \u4e0a\u9762\u7684\u4ee3\u7801\u4f7f\u7528\u4e86\u4e24\u6b21\u5faa\u73af\u6765\u6267\u884c\u9501\u63d2\u5165\u64cd\u4f5c\uff08\u7b2c\u4e00\u6b21\u53ea\u68c0\u67e5\u80fd\u5426\u63d2\u5165\uff0c\u7b2c\u4e8c\u624d\u771f\u6b63\u8fdb\u884c\u63d2\u5165\uff09\uff0c\u76ee\u7684\u662f\u5f53\u6709\u591a\u4e2a\u9501\u9700\u8981\u68c0\u67e5\u7684\u8bdd\uff0c\u907f\u514d\u4e86\u540e\u7eed\u68c0\u67e5\u5931\u8d25\u65f6\u8981\u5bf9\u4e4b\u524d\u63d2\u5165\u7684\u9501\u8fdb\u884c\u5220\u9664\u3002\u800cinsertSharedLock()\u548cinsertExclusiveLock()\u771f\u6b63\u83b7\u5f97\u9501\u7684\u65b9\u6cd5\uff0c\u800c\u9501\u83b7\u5f97\u7684\u903b\u8f91\u5341\u5206\u7b80\u5355\uff0c\u4f7f\u7528MapEntry\u7684key\u4ee5\u53caPair\u7684\u7b2c\u4e00\u4e2a\u503c\u6784\u6210hashMap\u7684\u7684key\uff0cPair\u7684\u7b2c\u4e8c\u503c\u4f5c\u4e3avalue\u5b58\u5165HashMap\u7f13\u5b58\u3002\u533a\u522b\u4e24\u8005\u5bf9\u4e8e\u83b7\u5f97\u9501\u6210\u529f\u7684\u5224\u65ad\u4e0d\u540c\uff1a \u72ec\u5360\u9501\uff1a\u5982\u679c\u5bf9\u5e94\u7684key\u5728HashMap\u4e2d\u4e0d\u5b58\u5728\uff0c\u5c06key\u548cvalue\u5b58\u5165HashMap\uff0c\u89c6\u4e3a\u83b7\u5f97\u9501\u6210\u529f\u3002\u5982\u679c\u5bf9\u5e94\u7684key\u5728HashMap\u4e2d\u5b58\u5728\uff0c\u89c6\u4e3a\u83b7\u5f97\u9501\u5931\u8d25\u3002 \u5171\u4eab\u9501\uff1a\u5982\u679c\u5bf9\u5e94\u7684key\u5728HashMap\u4e2d\u4e0d\u5b58\u5728\uff0c\u5c06key\u548cvalue\u5b58\u5165HashMap\uff0c\u89c6\u4e3a\u83b7\u5f97\u9501\u6210\u529f\u3002\u5982\u679c\u5bf9\u5e94\u7684key\u5728HashMap\u4e2d\u5b58\u5728\uff0c\u5224\u65ad\u9501\u5bf9\u8c61\u662f\u4e0d\u662f\u72ec\u5360\u9501\uff0c\u5982\u679c\u662f\u72ec\u5360\u9501\uff0c\u89c6\u4e3a\u83b7\u5f97\u9501\u5931\u8d25\uff0c\u5426\u5219\u5c06\u5171\u4eab\u9501\u7684count\u6570\u52a0\u4e00\u3002 \u5230\u6b64\uff0c\u9501\u7ade\u4e89\u7684\u903b\u8f91\u5c31\u7ed3\u675f\u4e86\uff0c\u5f53\u83b7\u5f97\u9501\u5931\u8d25\u540e\uff0c\u547d\u4ee4\u7684\u6821\u9a8c\u4e5f\u5c31\u5931\u8d25\u4e86\uff0c\u547d\u4ee4\u4e5f\u5c31\u6267\u884c\u5931\u8d25\u4e86\u3002","title":"\u9501\u8d44\u6e90\u7ade\u4e89\u8fc7\u7a0b"},{"location":"Work-related/Ovirt/[OvirtEngine]\u9501\u673a\u5236/#_2","text":"\u9501\u7684\u91ca\u653e\u5728AbstractCommand\u7684 freeLock() \u65b9\u6cd5\u4e2d\u5b9e\u73b0\uff0c\u5982\u4e0b\uff1a public void freeLock() { // \u5982\u679ccontext\u9501\u4e0d\u4e3a\u7a7a\uff0c\u8fdb\u884c\u91ca\u653e\u9501\u7684\u5de5\u4f5c if (context.getLock() != null) { // \u8c03\u7528LockManager\u7684releaseLock\u65b9\u6cd5\u91ca\u653e\u5f53\u524d\u9501 getLockManager().releaseLock(context.getLock()); log.info(\"Lock freed to object '{}'\", context.getLock()); context.withLock(null); // \u91ca\u653e\u5176\u4ed6\u9501\u81ea\u5b9a\u4e49\u7684\u9501 freeCustomLocks(); } } freeLock\u65b9\u6cd5\u4f1a\u5728\u4ee5\u4e0b\u51e0\u79cd\u60c5\u51b5\u4e0b\u88ab\u8c03\u7528\uff1a command\u7684\u6821\u9a8c\u5de5\u4f5c\u5931\u8d25\uff0c\u6700\u7ec8\u4f1a\u91ca\u653e\u6821\u9a8c\u8fc7\u7a0b\u4e2d\u52a0\u7684\u9501 \u9501\u7684\u8303\u56f4\u4e3aExecute\uff0c\u5728command\u7684Execute\u9636\u6bb5\u7ed3\u675f\u540e\u91ca\u653e\u9501 command\u7684\u6240\u6709action\u7ed3\u675f\uff0c\u5728endAction\u65b9\u6cd5\u4e2d\u91ca\u653e\u9501 \u5728command\u4e2d\u4e3b\u52a8\u8c03\u7528freeLock\u65b9\u6cd5 LockManager\u7684releaseLock\u65b9\u6cd5\u5982\u4e0b\uff1a public void releaseLock(EngineLock lock) { log.debug(\"Before releasing a lock '{}'\", lock); //\u4f7f\u7528\u5168\u5c40\u9501 globalLock.lock(); try { if (lock.getSharedLocks() != null) { for (Entry<String, Pair<String, String>> entry : lock.getSharedLocks().entrySet()) { //\u91ca\u653e\u5171\u4eab\u9501 releaseSharedLock(buildHashMapKey(entry), entry.getValue().getSecond()); } } if (lock.getExclusiveLocks() != null) { for (Entry<String, Pair<String, String>> entry : lock.getExclusiveLocks().entrySet()) { //\u91ca\u653e\u72ec\u5360\u9501 releaseExclusiveLock(buildHashMapKey(entry)); } } //isAwait\u4e3atrue\u7684\u9501\uff0c\u4f1a\u5728\u7ade\u4e89\u9501\u5931\u8d25\u65f6\u6302\u8d77 //\u8fd9\u91cc\u5524\u9192\u7b49\u5f85\u72ec\u5360\u9501\u7684\u7ebf\u7a0b\u5f00\u59cb\u7ade\u4e89\u83b7\u5f97\u9501 releasedLock.signalAll(); } finally { globalLock.unlock(); } } \u91ca\u653e\u9501\u7684\u8fc7\u7a0b\u4e5f\u5f88\u7b80\u5355\uff0c\u5171\u4eab\u9501\u91ca\u653e\u65f6\u5c06count\u51cf1\uff0c\u5f53count\u4e3a0\u65f6\u4ece\u7f13\u5b58\u4e2d\u5220\u9664\u9501\uff1b\u800c\u72ec\u5360\u9501\u91ca\u653e\u65f6\u76f4\u63a5\u5c06\u9501\u4ece\u7f13\u5b58\u4e2d\u5220\u9664\u5373\u53ef\u3002","title":"\u9501\u7684\u91ca\u653e"},{"location":"Work-related/Ovirt/[OvirtEngine]\u9501\u673a\u5236/#_3","text":"OvirtEngine\u4e2d\u8fd8\u5b58\u5728\u53e6\u4e00\u79cd\u9501\uff0c\u53ea\u662f\u6539\u53d8Entity\u5728\u6570\u636e\u5e93\u7684\u72b6\u6001\uff0c\u4ece\u800c\u5b9e\u73b0\u9650\u5236\u524d\u53f0\u9875\u9762\u64cd\u4f5c\u7684\u529f\u80fd\u3002\u4f8b\u5982\uff0c\u524d\u53f0\u9501\u5b9aVM\u7684\u673a\u5236\uff0c\u5b9e\u9645\u4e0a\u662f\u5c06\u6570\u636e\u5e93\u7684status\u5b57\u6bb5\u8bbe\u7f6e\u4e3a ImageLocked \u72b6\u6001\uff0c\u800c\u524d\u53f0\u4f1a\u6839\u636e\u8fd9\u4e2a\u72b6\u6001\u6765\u9650\u5236\u9875\u9762\u7684\u64cd\u4f5c\u529f\u80fd\u3002VmHandler\u4e2dlockVm\u65b9\u6cd5\u5982\u4e0b\uff1a public static void lockVm(final VmDynamic vm, final CompensationContext compensationContext) { TransactionSupport.executeInNewTransaction(() -> { // \u5728\u4fee\u6539\u72b6\u6001\u524d\uff0c\u5148\u5b58\u50a8vm\u7684\u5feb\u7167\u4fe1\u606f\uff0c\u7528\u4e8e\u64cd\u4f5c\u5931\u8d25\u65f6\u6062\u590d\u6570\u636e compensationContext.snapshotEntityStatus(vm); // \u8c03\u7528lockVm\u65b9\u6cd5\u4fee\u6539vm\u72b6\u6001\uff0c\u4e3b\u8981\u5c31\u662f\u64cd\u4f5c\u6570\u636e\u5e93\u4fee\u6539status\u5b57\u6bb5 lockVm(vm.getId()); compensationContext.stateChanged(); }); } public static void lockVm(Guid vmId) { Backend.getInstance() .getResourceManager() .runVdsCommand(VDSCommandType.SetVmStatus, new SetVmStatusVDSCommandParameters(vmId, VMStatus.ImageLocked)); } \u662f\u5426\u9700\u8981\u52a0\u9501\uff0c\u7531\u4ee3\u7801\u7684\u903b\u8f91\u51b3\u5b9a\uff1b\u800c\u89e3\u9501\u5de5\u4f5c\u4e00\u822c\u5728command\u6267\u884c\u6210\u529f\u6216command\u5931\u8d25\u65f6\u6267\u884c\u3002 \u524d\u53f0\u5982\u4f55\u5b9e\u73b0\u9501\u5b9a\u64cd\u4f5c\uff1f \u5728VmListModel\u7684updateActionsAvailability()\u65b9\u6cd5\u7ef4\u62a4\u7740\u524d\u53f0\u6309\u94ae\u662f\u5426\u53ef\u4ee5\u70b9\u51fb\u7684\u903b\u8f91\uff0c\u4f8b\u5982\u5220\u9664\u865a\u62df\u673a\u6309\u94ae\u7684\u53ef\u6267\u884c\u903b\u8f91\u4e3a\uff1a getRemoveCommand() .setExecutable(vmsSelected && VdcActionUtils.canExecutePartially(items, VmWithStatusForExclusiveLock.class, VdcActionType.RemoveVm)); \u53ef\u4ee5\u770b\u51fa\u662f\u5426\u80fd\u70b9\u51fb\u7684\u4e3b\u8981\u903b\u8f91\u5728\u4e8eVdcActionUtils.canExecutePartially()\u65b9\u6cd5 public static boolean canExecutePartially(List<? extends BusinessEntityWithStatus<?, ?>> entities, Class type, VdcActionType action) { if (blacklist.containsKey(type)) { for (BusinessEntityWithStatus<?, ?> a : entities) { if (a.getClass() == type && (!blacklist.get(type).containsKey(a.getStatus()) || !blacklist.get(type).get(a.getStatus()).contains(action))) { return true; } } } else { return true; } return false; } \u53ef\u4ee5\u770b\u51fa\u524d\u53f0\u7ef4\u62a4\u7740\u4e00\u5f20status\u4e0eAction\u4e4b\u95f4\u7684\u9ed1\u540d\u5355\u5217\u8868\uff0c\u5373\u67d0\u4e9b\u72b6\u6001\u4e0b\u4e00\u4e9bAction\u4e0d\u80fd\u6267\u884c\uff0c VMStatus.ImageLocked \u7684action\u9ed1\u540d\u5355\u5982\u4e0b\uff1a vmBlacklist.put( VMStatus.ImageLocked, EnumSet.of( VdcActionType.RunVm, VdcActionType.CloneVm, VdcActionType.RunVmOnce, VdcActionType.StopVm, VdcActionType.ShutdownVm, VdcActionType.HibernateVm, VdcActionType.MigrateVm, VdcActionType.RemoveVm, VdcActionType.AddVmTemplate, VdcActionType.ExportVm, VdcActionType.ImportVm, VdcActionType.ChangeDisk, VdcActionType.CreateAllSnapshotsFromVm, VdcActionType.AddVmInterface, VdcActionType.UpdateVmInterface, VdcActionType.RemoveVmInterface, VdcActionType.CancelMigrateVm, VdcActionType.ExtendImageSize, VdcActionType.RebootVm));","title":"\u53ea\u6539\u53d8\u6570\u636e\u5e93\u72b6\u6001\u7684\u64cd\u4f5c\u9501"}]}